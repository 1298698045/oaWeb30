/*
 * This code is for Internal Salesforce use only, and subject to change without notice.
 * Customers shouldn't reference this file in any web pages.
 */
(function(h){if(!h.Sfdc||!h.Sfdc.canvas||!h.Sfdc.canvas.module){var s={};if(h.Sfdc&&h.Sfdc.canvas)for(var p in h.Sfdc.canvas)h.Sfdc.canvas.hasOwnProperty(p)&&(s[p]=h.Sfdc.canvas[p]);var t=Object.prototype,l=Array.prototype,q=h.document,e={hasOwn:function(a,b){return t.hasOwnProperty.call(a,b)},isUndefined:function(a){return void 0===a},isNil:function(a){return e.isUndefined(a)||null===a||""===a},isNumber:function(a){return!!(0===a||a&&a.toExponential&&a.toFixed)},isFunction:function(a){return!(!a||
!a.constructor||!a.call||!a.apply)},isArray:Array.isArray||function(a){return"[object Array]"===t.toString.call(a)},isArguments:function(a){return!(!a||!e.hasOwn(a,"callee"))},isObject:function(a){return null!==a&&"object"===typeof a},isString:function(a){return null!==a&&"string"==typeof a},appearsJson:function(a){return/^\{.*\}$/.test(a)},nop:function(){},invoker:function(a){e.isFunction(a)&&a()},identity:function(a){return a},each:function(a,b,c){if(!e.isNil(a)){var d=l.forEach,f=0,g,m;g=a.length;
c=c||a;if(d&&d===a.forEach)a.forEach(b,c);else if(e.isNumber(g))for(;f<g&&!1!==b.call(c,a[f],f,a);)f+=1;else for(m in a)if(e.hasOwn(a,m)&&!1===b.call(c,a[m],m,a))break}},startsWithHttp:function(a,b){return!e.isString(a)?a:"http"===a.substring(0,4)?a:b},map:function(a,b,c){var d=[],f=l.map;if(e.isNil(a))return d;if(f&&a.map===f)return a.map(b,c);c=c||a;e.each(a,function(a,e,f){d.push(b.call(c,a,e,f))});return d},values:function(a){return e.map(a,e.identity)},slice:function(a,b,c){return l.slice.call(a,
e.isUndefined(b)?0:b,e.isUndefined(c)?a.length:c)},toArray:function(a){return!a?[]:a.toArray?a.toArray:e.isArray(a)?a:e.isArguments(a)?e.slice(a):e.values(a)},size:function(a){return e.toArray(a).length},indexOf:function(a,b){var c=l.indexOf,d;if(!a)return-1;if(c&&a.indexOf===c)return a.indexOf(b);c=0;for(d=a.length;c<d;c+=1)if(a[c]===b)return c;return-1},isEmpty:function(a){if(null===a)return!0;if(e.isArray(a)||e.isString(a))return 0===a.length;for(var b in a)if(e.hasOwn(a,b))return!1;return!0},
remove:function(a,b){var c=e.indexOf(a,b);0<=c&&a.splice(c,1)},param:function(a,b){function c(a,f){e.isNil(f)||(f=e.isFunction(f)?f():f,e.isArray(f)?e.each(f,function(b,d){c(a,b)}):d[d.length]=b?encodeURIComponent(a)+"\x3d"+encodeURIComponent(f):a+"\x3d"+f)}var d=[];b=b||!1;if(e.isArray(a))e.each(a,function(a,b){c(b,a)});else for(var f in a)e.hasOwn(a,f)&&c(f,a[f]);return d.join("\x26").replace(/%20/g,"+")},objectify:function(a){var b={},c,d,f,g;if(e.isNil(a))return b;"?"==a.substring(0,1)&&(a=a.substring(1));
a=a.split("\x26");for(c=0;c<a.length;c+=1)d=a[c].split("\x3d"),f=d[0],d=d[1],g=b[f],e.isNil(g)?b[f]=d:e.isArray(g)?g[g.length]=d:(b[f]=[],b[f][0]=g,b[f][1]=d);return b},stripUrl:function(a){return e.isNil(a)?null:a.replace(/([^:]+:\/\/[^\/\?#]+).*/,"$1")},query:function(a,b){if(e.isNil(b))return a;a=a.replace(/#.*$/,"");return a+=/^\#/.test(b)?b:(/\?/.test(a)?"\x26":"?")+b},extend:function(a){e.each(e.slice(arguments,1),function(b,c){e.each(b,function(b,c){a[c]=b})});return a},endsWith:function(a,
b){return-1!==a.indexOf(b,a.length-b.length)},capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},uncapitalize:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},decode:function(a){var b=[],c,d,f="",g,h="",k=0;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(k++)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(k++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(k++)),
h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(k++)),c=c<<2|d>>4,d=(d&15)<<4|g>>2,f=(g&3)<<6|h,b.push(String.fromCharCode(c)),64!==g&&b.push(String.fromCharCode(d)),64!==h&&b.push(String.fromCharCode(f));while(k<a.length);return e.escapeToUTF8(b.join(""))},escapeToUTF8:function(a){for(var b="",c=0;c<a.length;){var d=a.charCodeAt(c++),f;if(128>d)b+=String.fromCharCode(d);else if(191<d&&224>d)f=a.charCodeAt(c++),b+=String.fromCharCode((d&31)<<6|f&63);else{f=
a.charCodeAt(c++);var e=a.charCodeAt(c++),b=b+String.fromCharCode((d&15)<<12|(f&63)<<6|e&63)}}return b},validEventName:function(a,b){var c,d=a.split(/\./),f=/^[$A-Z_][0-9A-Z_$]*$/i,g={sfdc:!0,canvas:!0,force:!0,salesforce:!0,chatter:!0,s1:!0};e.each(e.isArray(b)?b:[b],function(a){g[a]=!1});return 2<d.length?1:2===d.length&&(c=d[0].toLowerCase(),g[c])?2:!f.test(d[0])||!f.test(d[1])?3:0},prototypeOf:function(a){var b=Object.getPrototypeOf;return e.isFunction(b)?b.call(Object,a):"object"===typeof{}.__proto__?
a.__proto__:a.constructor.prototype},module:function(a,b){var c=a.split("."),d=h.Sfdc.canvas,f,g;"canvas"===c[1]&&(c=c.slice(2));g=c.length;for(f=0;f<g;f+=1)e.isUndefined(d[c[f]])&&(d[c[f]]={}),d=d[c[f]];e.isFunction(b)&&(b=b());return e.extend(d,b)},document:function(){return q},byId:function(a){return q.getElementById(a)},byClass:function(a){return q.getElementsByClassName(a)},attr:function(a,b){var c=a.attributes,d;for(d=0;d<c.length;d+=1)if(b===c[d].name)return c[d].value},onReady:function(a){e.isFunction(a)&&
n.push(a)},console:function(){function a(){try{return"sessionStorage"in window&&null!==window.sessionStorage}catch(a){return!1}}function b(){}function c(){}function d(){b=Function.prototype.bind?Function.prototype.bind.call(console.log,console):function(){Function.prototype.apply.call(console.log,console,arguments)}}function f(){b=function(){}}var e=!1;window&&!window.console&&(window.console={});window&&!window.console.log&&(window.console.log=function(){});window&&!window.console.error&&(window.console.error=
function(){});(e=a()&&"true"===sessionStorage.getItem("canvas_console"))?d():f();c=Function.prototype.bind?Function.prototype.bind.call(console.error,console):function(){Function.prototype.apply.call(console.error,console,arguments)};return{enable:function(){e=!0;a()&&sessionStorage.setItem("canvas_console","true");d()},disable:function(){e=!1;a()&&sessionStorage.setItem("canvas_console","false");f()},log:b,error:c}}()},n=[],r=function(a){e.isFunction(a)&&n.push(a)};(function(){function a(){c||(c=
!0,a=e.nop,e.each(n,e.invoker),n=[])}function b(){if(!c)try{document.documentElement.doScroll("left"),a()}catch(d){setTimeout(b,30)}}var c=!1,d,f;if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1);else if(document.attachEvent){try{d=self!==top}catch(g){}document.documentElement.doScroll&&!d&&b();document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&a()})}window.addEventListener?window.addEventListener("load",a,!1):window.attachEvent?window.attachEvent("onload",
a):(f=window.onload,window.onload=function(){f&&f();a()})})();e.each(e,function(a,b){r[b]=a});e.each(s,function(a,b){r[b]=a});(function(){for(var a,b=function(){},c="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd table time timeEnd timeStamp trace warn".split(" "),d=c.length,e="undefined"!==typeof window&&window.console?window.console:{};d--;)a=c[d],e[a]||(e[a]=b)})();h.Sfdc||(h.Sfdc={});h.Sfdc.canvas=r}})(this);
(function(b,a){var g=function(){var e;return{post:function(f,d,c){var h=Sfdc.JSON||JSON;if(b.isNil(d))throw"ERROR: target_url was not supplied on postMessage";d=b.stripUrl(d);c=c||parent;a.postMessage&&(b.isObject(f)&&(f.targetModule="Canvas"),f=h.stringify(f),b.console.log("Sending Post Message ",f),c.postMessage(f,d))},receive:function(f,d){a.postMessage&&(f&&(e=function(c){var a,e,g=Sfdc.JSON||JSON;b.console.log("Post Message Got callback",c);if(!b.isNil(c)){if("string"===typeof d&&c.origin!==
d)return b.console.log("source origin's don't match",c.origin,d),!1;if(b.isFunction(d)&&(e=d(c.origin,c.data),!1===e))return b.console.log("source origin's function returning false",c.origin,c.data),!1;if(b.appearsJson(c.data)){try{a=g.parse(c.data)}catch(k){}if(!b.isNil(a)&&(b.isNil(a.targetModule)||"Canvas"===a.targetModule))b.console.log("Invoking callback"),f(a,e)}}}),a.addEventListener?a.addEventListener("message",e,!1):a.attachEvent("onmessage",e))},remove:function(){a.postMessage&&(a.removeEventListener?
a.removeEventListener("message",e,!1):a.detachEvent("onmessage",e))}}}();b.module("Sfdc.canvas.xd",g)})(Sfdc.canvas,this);
(function(k){var p=function(){function l(d,a,e,g,b){m(d,a,a,function(a,c,d){a.appendChild(document.createTextNode(e));c.appendChild(document.createTextNode(g));d.appendChild(document.createTextNode(b))})}function m(d,a,e,g){if(!k.isNil(d)){var b,f,c,h;b=k.byId("canvas-notify-styles");k.isNil(b)&&(b=document.createElement("style"),b.setAttribute("name","canvas-notify-styles"),b.setAttribute("id","canvas-notify-styles"),b.type="text/css",window.attachEvent&&!window.opera?b.styleSheet.cssText=n:(f=document.createTextNode(n),
b.appendChild(f)),document.getElementsByTagName("head")[0].appendChild(b));b=document.createElement("div");b.setAttribute("class","canvas-notify-block");f=document.createElement("div");f.setAttribute("class","top-line");c=document.createElement("img");c.setAttribute("src",a);c.setAttribute("width","16");c.setAttribute("height","16");c.setAttribute("class","title-image");a=document.createElement("div");a.setAttribute("class","title-text");f.appendChild(c);f.appendChild(a);b.appendChild(f);f=document.createElement("div");
f.setAttribute("class","content");c=document.createElement("div");c.setAttribute("class","contentIcon");h=document.createElement("img");h.setAttribute("src",e);h.setAttribute("width","32");h.setAttribute("height","32");c.appendChild(h);f.appendChild(c);e=document.createElement("div");e.setAttribute("class","notify-message");c=document.createElement("div");c.setAttribute("class","subject-text");h=document.createElement("div");h.setAttribute("class","body-text");k.isFunction(g)&&g(a,c,h);e.appendChild(c);
e.appendChild(h);f.appendChild(e);for(b.appendChild(f);d.firstChild;)d.removeChild(d.firstChild);d.appendChild(b)}}var n="#canvas-notify-block {background: none repeat scroll 0 0 #FFFFFF;border-radius: 5px 5px 5px 5px;margin-bottom: 20px;overflow: hidden;position: relative;top: 1px;color: #222222;font-family: Arial,Helvetica,sans-serif;padding-left: 10px;}.canvas-notify-block .top-line{background-color: #DEDEDE;border: 1px solid #CCCCCC;border-radius: 5px 5px 0 0;padding-bottom: 15px;color: #222222;font-size: 10px;font-weight: bold;margin-bottom: 0px;margin-top: 0px;padding-left: 5px;padding-top: 0px;height: 10px;}.canvas-notify-block .top-line .title-image{float:left;padding-top:5px;}.canvas-notify-block .top-line .title-text{padding-left:20px;margin-top:8px;display:block;}.canvas-notify-block .content{border-bottom: 1px solid #CCCCCC;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;border-left: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;font-size: 15px;padding-right: 4px;}.canvas-notify-block .content .contentIcon{float: left;height: 40px;margin-bottom: 3px;margin-left: 20px;margin-top: 6px;padding-top: 6px;width: 40px;}.canvas-notify-block .content .notify-message .subject-text{font-weight: bold;}.canvas-notify-block .content .notify-message .body-text{padding-top: 10px;}.canvas-notify-block .content .notify-message{padding-left:80px;padding-top:20px;padding-bottom:20px;font-size: 11px;}";
return{warning:function(d,a,e,g){l(d,"/img/msg_icons/warning32.png",a,e,g)},error:function(d,a,e,g){l(d,"/img/msg_icons/error32.png",a,e,g)},info:function(d,a,e,g){l(d,"/img/msg_icons/info32.png",a,e,g)},show:l,custom:m}}();k.module("Sfdc.canvas.notify",p)})(Sfdc.canvas);
(function(c){var M=function(){var G,l;function v(a,e,b,d,k){var h=LC.getLabel("CanvasParentJs","defaultNotifyTitle",b);b=LC.getLabel("CanvasParentJs","defaultRenderSummary",b);var g=w(1,f[a]);c.isNil(g)?c.notify.show(e,t("/img/msg_icons/error32.png"),h,b,d):g({title:h,summary:b,detail:d});c.isNil(f[a])||(H({name:"render",type:"ERROR",namespace:f[a].app.namespace,canvas:f[a].app.developerName,referenceId:f[a].app.referenceId,startTime:f[a].startTime,authType:f[a].app.authenticationType,payload:{canvasUrl:f[a].url,
localizedMessage:c.isObject(d)?q.stringify(d):d,debugTrace:c.isNil(k)?"\x3cnone\x3e":k},displayLocation:f[a].options.displayLocation,sublocation:f[a].options.sublocation,cversion:f[a].cversion}),A(a));if(!c.isNil(f[a])&&c.isFunction(f[a].options.onCanvasAppError))f[a].options.onCanvasAppError()}function N(a,e,b,d,k,h){var g=t("/img/msg_icons/info32.png"),m=LC.getLabel("CanvasParentJs","defaultNotifyTitle",b),p=LC.getLabel("CanvasParentJs","defaultRenderSummary",b);b=w(2,f[a]);c.isNil(b)?c.notify.custom(e,
g,g,function(a,b,e){a.appendChild(document.createTextNode(m));b.appendChild(document.createTextNode(p));e.appendChild(document.createTextNode(d));c.isNil(h)||(a=document.createElement("a"),a.setAttribute("href",t(h)),a.setAttribute("title",k),a.appendChild(document.createTextNode(k)),e.appendChild(document.createElement("p")),e.appendChild(a))}):b({title:m,summary:p,detail:d});if(!c.isNil(f[a])){H({name:"render",type:"ERROR",namespace:f[a].app.namespace,canvas:f[a].app.developerName,referenceId:f[a].app.referenceId,
startTime:f[a].startTime,authType:f[a].app.authenticationType,payload:{canvasUrl:f[a].url,localizedMessage:d},displayLocation:f[a].options.displayLocation,sublocation:f[a].options.sublocation,cversion:f[a].cversion});if(c.isFunction(f[a].options.onCanvasAppError))f[a].options.onCanvasAppError();A(a)}}function w(a,e){var b=aa[a];return!c.isNil(e)&&(e.options&&!c.isNil(e.options.customCanvasRenderer)&&!c.isNil(e.options.customCanvasRenderer[b]))&&c.isFunction(e.options.customCanvasRenderer[b])?e.options.customCanvasRenderer[b]:
null}function O(a,e){var b=f[a],d;d=w(0,b);var k=c.isNil(b.app.name)?"":b.app.name,k=LC.getLabel("CanvasParentJs","loadingStatus",k);b.options&&b.options.showLoadingStatus&&(c.isNil(d)?(A(a),d=c.byId("loading-"+a),c.isNil(d)?(d=document.createElement("div"),d.setAttribute("id","loading-"+a),d.setAttribute("style","position:relative;width:25%;height:30px;margin-top:20px;margin-bottom:30px;"),d.style.display="block",e.appendChild(d)):d.style.display="block",b.loadingScreen=new LoadingScreen(d,Sfdc.String.escapeToHtml(k)),
b.loadingScreen.show()):d(!0,k))}function A(a){var e=f[a],b=w(0,e);c.isNil(b)?(c.isNil(e.loadingScreen)||(e.loadingScreen.hide(),e.loadingScreen=null),a=c.byId("loading-"+a),c.isNil(a)||(a.style.display="none",P(a))):b(!1)}function P(a){if(!c.isNil(a))for(;a.firstChild;)a.removeChild(a.firstChild)}function Q(a){var e={},b,d;if(!c.isNil(a.record)&&!c.isNil(a.record.Id)&&(e.Id=a.record.Id,!c.isNil(a.record.fields))){a=a.record.fields.split(",");for(b=0;b<a.length;b+=1)d=a[b].trim(),c.isUndefined(e[d])&&
(e[d]=null)}return e}function D(a,c){var b,d,f,h=c?c+a:a;f=window.document.getElementsByTagName("iframe");d=f.length;for(b=0;b<d;b+=1)try{if(f[b].name===h)return f[b].contentWindow}catch(g){}return frames[h]}function t(a,e){var b=null,d=a;c.isNil(I)?c.isNil(J)||(d=J+d):(b=I+a,d=location.protocol+"//"+location.hostname+":"+location.port+"/services/proxy",e.headers["SalesforceProxy-Endpoint"]=b);UserContext&&UserContext.getUrl&&(d=UserContext.getUrl(d),UserContext.isDefaultNetwork||(d=Sfdc.Url.generateUrl(d)));
return d}function M(a,e){var b=e.id;if(c.isNil(b))throw c.console.error(LC.getLabel("CanvasParentJs","missingIdInContext")),LC.getLabel("CanvasParentJs","missingIdInContext");if(a&&a.body){var d=a.body.type,k=a.seq,h=f[b];h&&(h.cversion=a.clientVersion,h.oauthToken=a.body.config.client.oauthToken);c.console.log("xdCallback type [%s] seq [%d] id [%s]",d,k,b);"ctx"===d?n.services(k,b).ctx(a,h):"ajax"===d?n.services(k,b).ajax(a):"resize"===d?n.frame.childResize(a,h):"subscribe"===d?n.events.subscribe(a.body.subscriptions,
h):"unsubscribe"===d?n.events.unsubscribe(a.body.subscriptions,h):"publish"===d?c.s1&&c.s1.canHandle(a.body.event)?c.s1.handleEvent(a.body.event):n.events.publishClient(a.body.event,h):"refresh"===d?n.services(k,b).refresh(a,h):"repost"===d&&n.services(k,b).repost(a,h)}}function R(){K&&c.xd.remove();c.xd.receive(M,function(a,e){if(c.appearsJson(e)){e=q.parse(e);if(c.isNil(e.body)||c.isNil(e.body.config)||c.isNil(e.body.config.client))return c.console.log("JSON from postMessage invalid",e),!1;if(e.body.config.client.isVF)return c.console.log("can't find canvas, instanceId [%s] assuming from VF page",
e.body.config.client.instanceId),{id:e.body.config.client.instanceId};var b=f[e.body.config.client.instanceId];if(!c.isNil(b))return c.console.log("post url: c.url "+b.url),c.console.log("actual canvas url, c.app.canvasUrl"+b.app.canvasUrl),"refresh"===e.body.config.type&&c.stripUrl(b.app.canvasUrl)!==a?(c.console.error("Source origin and canvas url are from different domains",b.app.canvasUrl,a),!1):{id:e.body.config.client.instanceId}}return!1});K=!0}function S(a,e,b,d){var k=f[a].app.namespace,
h=f[a].app.developerName,g=f[a].app.referenceId,m=Q(e),k="/services/data/v"+r+"/platformconnect/signedrequest?"+(!c.isNil(g)?"referenceId\x3d"+g:"canvas\x3d"+h+(!c.isNil(k)?"\x26namespace\x3d"+k:""));a={success:b,failure:d,headers:{Authorization:"OAuth "+C,Accept:"application/json"},contentType:"application/json",method:"PUT",data:q.stringify({canvasRequest:{context:{environment:{dimensions:{height:e.height.value,width:e.width.value,maxHeight:e.height.max,maxWidth:e.width.max,clientWidth:e.clientWidth,
clientHeight:e.clientHeight},parameters:e.parameters,displayLocation:e.displayLocation,sublocation:e.sublocation,record:m}},client:{targetOrigin:document.location.protocol+"//"+document.location.host,instanceId:a}}})};k=t(k,a);Sfdc.Ajax.request(k,a)}function H(a){var e=c.isNil(a.type)?null:a.type.toUpperCase();if(c.isNil(e)||-1===c.indexOf(["FINISH","ERROR"],e))throw LC.getLabel("CanvasParentJs","invalidTraceEventType");if(c.isNil(a.name))throw LC.getLabel("CanvasParentJs","invalidTraceEventName");
if(c.isNil(a.canvas)&&c.isNil(a.referenceId))throw LC.getLabel("CanvasParentJs","invalidTraceCanvasAppNameOrId");var b="/services/data/v"+r+"/platformconnect/traceevent";a={headers:{Authorization:"OAuth "+C,Accept:"application/json"},contentType:"application/json",data:q.stringify({eventName:a.name,eventType:e,namespace:a.namespace,canvas:a.canvas,referenceId:a.referenceId,payload:a.payload,authType:a.authType,startTime:a.startTime,endTime:(new Date).getTime(),parentVersion:r,clientVersion:a.cversion,
appInstallType:a.appInstallType,appApprovalType:a.appApprovalType,displayLocation:a.displayLocation,sublocation:a.sublocation})};b=t(b,a);Sfdc.Ajax.post(b,function(){},a)}function x(a,e,b){f[a].startTime&&(H({name:"render",type:"FINISH",namespace:f[a].app.namespace,canvas:f[a].app.developerName,referenceId:f[a].app.referenceId,startTime:f[a].startTime,authType:f[a].app.authType,payload:{canvasUrl:f[a].url},cversion:f[a].cversion,appInstallType:f[a].aux.appInstallType,appApprovalType:f[a].aux.appApprovalType,
displayLocation:f[a].options.displayLocation,sublocation:f[a].options.sublocation}),f[a].startTime=null,A(a),e.style.display="inline");if(c.isFunction(b.onCanvasAppLoad))b.onCanvasAppLoad()}function ba(a,e,b,d,k,h){var g,m;g=document.createElement("form");g.setAttribute("name","canvas-hidden-form-"+a);g.setAttribute("style","display:none");g.setAttribute("action",c.isNil(h)?f[a].url:h);g.setAttribute("target",y+a);g.setAttribute("method","post");h=document.createElement("input");h.setAttribute("type",
"hidden");h.setAttribute("name","signed_request");h.value=e;e=document.createElement("input");e.setAttribute("type","submit");e.setAttribute("post","post");g.appendChild(h);g.appendChild(e);b.appendChild(g);d=T(a,d,k);f[a].frameElement=d;b.appendChild(d);d.addEventListener?d.onload=function(){x(a,this,k);this.onload=null}:d.attachEvent&&(m=function(){var b=event.srcElement;c.isNil(b)||(x(a,b,k),b.detachEvent("onload",m))},d.attachEvent("onload",m));c.isNil(document.forms["canvas-hidden-form-"+a])||
document.forms["canvas-hidden-form-"+a].submit()}function T(a,c,b){var d=document.createElement("iframe");d.setAttribute("id",c);d.setAttribute("name",y+a);d.setAttribute("title",LC.getLabel("CanvasParentJs","iframeTitle",f[a].app.name));d.style.display="none";d.frameBorder=b.frameborder;d.width=b.width.value;d.height=b.height.value;d.scrolling=b.scrolling;return d}function ca(a,e,b,d,k){var h,g;b=T(a,b,d);f[a].frameElement=b;e=e.appendChild(b);b.addEventListener?b.onload=function(){x(a,this,d);this.onload=
null}:b.attachEvent&&(g=function(){var b=event.srcElement;c.isNil(b)||(x(a,b,d),b.detachEvent("onload",g))},b.attachEvent("onload",g));e.contentDocument?h=e.contentDocument:e.contentWindow&&(h=e.contentWindow.document);h.location.replace(c.isNil(k)?f[a].url:k)}function U(a,e,b){var d=y+a,k,h,g=f[a].sr.split(".");k={};if(2!==g.length)throw LC.getLabel("CanvasParentJs","invalidSignedRequestFormat");g=q.parse(c.decode(g[1]));if(c.isNil(g)||c.isNil(g.context.application))throw LC.getLabel("CanvasParentJs",
"unableToParseApp");f[a].app=g.context.application;f[a].loginUrl=g.context.links.loginUrl;"OAUTH"!=f[a].app.authType&&c.isNil(g.client.oauthToken)&&(k._sfdc_canvas_auth="user_approval_required");f[a].authStatus=k;O(a,e);!c.isNil(f[a].aux)&&!c.isNil(f[a].aux.idpInitiatedUrl)&&(h=f[a].aux.idpInitiatedUrl,delete f[a].aux.idpInitiatedUrl,c.console.log("IdpInitiated Request..."+h));k=decodeURIComponent(f[a].app.canvasUrl);g=document.location.protocol+"//"+document.location.host;if("OAUTH"===f[a].app.authType||
!c.isEmpty(f[a].authStatus)){var m=c.param(f[a].authStatus);!c.isNil(f[a].loginUrl)&&"https://login.salesforce.com"!==f[a].loginUrl&&(m+=(0<m.length?"\x26":"")+c.param({loginUrl:encodeURIComponent(f[a].loginUrl)}));m+="#target_origin\x3d"+encodeURIComponent(g)+"\x26instance_id\x3d"+a;f[a].url=c.query(k,m);ca(a,e,d,b,h)}else f[a].url=k,ba(a,f[a].sr,e,d,b,h)}function V(a,e){var b="",d;if(!c.isNil(a)&&1<a.length)for(d=1;d<a.length;d+=1)b+=a[d],d<a.length-1&&(b+=e);return b}function W(a,e,b){c.isNil(f[a].sr)?
(X(e,b),S(a,b,function(c){c=q.parse(c);f[a].sr=c.response;f[a].aux=c.auxiliary;U(a,e,b)},function(b,k,h){var g=q.parse(b);h=f[a].app.name||f[a].app.developerName||f[a].app.referenceId||"undefined";if(!c.isNil(g)&&1<=g.length)switch(b=g[0],b.errorCode){case "APP_NOT_FOUND":case "NO_ACCESS":case "UNSUPPORTED_LOCATION":case "ACCESS_TOKEN_RETRIEVAL_ERROR":case "APEX_CONFIGURATION_EXCEPTION":case "ADMIN_AUTH_REQUIRED":v(a,e,h,b.message);break;case "INVALID_SESSION_ID":v(a,e,h,LC.getLabel("CanvasParentJs",
"sessionInvalid"));break;case "NO_PERSONAL_ACCESS":b=b.message.split("#");N(a,e,h,b[0],LC.getLabel("CanvasParentJs","appInfo"),V(b,"#"));break;case "NO_ACCESS_SETUP_ALLOWED":case "UNSUPPORTED_LOCATION_SETUP_ALLOWED":case "ADMIN_AUTH_REQUIRED_SETUP_ALLOWED":b=b.message.split("#");N(a,e,h,b[0],LC.getLabel("CanvasParentJs","configureLabel"),V(b,"#"));break;default:v(a,e,h,LC.getLabel("CanvasParentJs","signedRequestRetrievalError",b.errorCode+":"+b.message))}else v(a,e,h,LC.getLabel("CanvasParentJs",
"unsupportedServerResponse",""),"Received invalid response body from server. Status:"+(c.isNil(k)?"\x3cNo Request Object\x3e":k.status+", Body: '"+b+"', windowLocation:"+document.location.href+", requestConfig:"))})):U(a,e,b)}function X(a,e){var b,d,f;c.isNil(a)||(c.isNil(e.clientWidth)&&(b=a.clientWidth,0===b&&(d=a.offsetParent,c.isNil(d)||(b=d.clientWidth)),e.clientWidth=b+"px"),c.isNil(e.clientHeight)&&(b=a.clientHeight,0===b&&(d=a.offsetParent,f=a.offsetTop,c.isNil(d)||(b=d.clientHeight-f),0>
b&&(b=0)),e.clientHeight=b+"px"))}function L(a,e){return(!c.isNil(a.developerName)?(c.isNil(a.namespace)?"_":a.namespace)+":"+a.developerName:a.referenceId)+(c.isNil(e)?":":":"+e)}function Y(a,e,b){var d={frameborder:"0",width:{value:"800px",max:"1000px"},height:{value:"900px",max:"2000px"},scrolling:"no",displayLocation:"NONE",showLoadingStatus:!0};b&&(!c.isObject(b.width)&&!c.isNil(b.width)&&(b.width=c.extend(d.width,{value:b.width})),!c.isObject(b.height)&&!c.isNil(b.height)&&(b.height=c.extend(d.height,
{value:b.height})),b.width=c.extend(d.width,b.width||{}),b.height=c.extend(d.height,b.height||{}));b=c.extend(d,b||{});b.height.value=n.frame.minPixels(b.height.value,b.height.max);b.width.value=n.frame.minPixels(b.width.value,b.width.max);d=c.isObject(e)?e:c.byId(e);if(c.isNil(d))window.alert(LC.getLabel("CanvasParentJs","containerElementNotFound",e));else{e=L(a.app,b.canvasId);try{if(c.isNil(a)||c.isNil(a.sr)&&(c.isNil(a.app)||c.isNil(a.app.developerName)&&c.isNil(a.app.referenceId)))throw LC.getLabel("CanvasParentJs",
"insufficientAppContainerInfo");if(c.isNil(a.version))throw LC.getLabel("CanvasParentJs","missingParentVersionInfo");C=a.sid||C;if(c.isNil(C))throw LC.getLabel("CanvasParentJs","missingSid");if(!c.isNil(Sfdc.userAgent)&&(Sfdc.userAgent.isIE6||Sfdc.userAgent.isIE7||Sfdc.userAgent.isOpera||Sfdc.userAgent.isNetscape))throw LC.getLabel("CanvasParentJs","unsupportedBrowser");u(d,e);f[e]={instanceId:e,app:a.app,sr:a.sr,cversion:null,options:b,startTime:(new Date).getTime(),onCanvasSubscribed:b.onCanvasSubscribed,
parentElem:d};r=a.version;I=b.salesforceBaseUrl;J=b.customPathPrefix;O(e,d);W(e,d,b);R()}catch(k){a=!c.isNil(a.app)?a.app.developerName||a.app.referenceId||"undefined":"undefined",v(e,d,a,k)}}}function u(a,e,b){n.events.unsubscribeAll(f[e]);a=c.isObject(a)?a:c.byId(a);P(a);c.isNil(b)&&delete f[e]}var K=!1;G="canvas.scroll";l="sfdc.streamingapi";var aa=["toggleLoadingScreen","renderError","renderInfo","renderCanvas"],f={},r,C,I,J,y="canvas-frame-",q=Sfdc.JSON||JSON,n=function(){var a=function(){function b(a,
b){var e,d=a.name;c.isNil(b)||(d===l?!c.isNil(b.handlers)&&!c.isNil(b.handlers[d])&&(e=b.handlers[d][a.params.topic]):!c.isNil(b.handlers)&&!c.isNil(b.handlers[d])&&(e=b.handlers[d]));return e}function d(a){var e=!1;c.each(f,function(d){c.isNil(b(a,d))||(e=!0)});return e}function e(a,d){var g;if(c.isNil(a.target)&&c.isNil(d))c.console.log("Targeting all canvas apps"),c.each(f,function(d,e){g=b(a,d);c.isNil(g)||(c.isFunction(g)?g(a.payload):(c.console.log("Found canvas app with handler"),c.xd.post({parentVersion:r,
clientVersion:d.cversion,payload:a,type:"event"},c.stripUrl(d.url),D(e,y))))});else if(!c.isNil(a.target)&&!c.isNil(a.target.canvas)&&"parent"===a.target.canvas)g=b(a,f.parent),c.isFunction(g)&&g(a.payload);else if(c.isNil(d))if(c.isNil(a.target.iframe))c.isNil(a.target.canvas)?c.console.error("Nothing to target"):(c.console.log("Targeting single canvas ",a.target.canvas),c.each(f,function(d,e){var f=e.split(":");f[f.length-1]===a.target.canvas&&(c.console.log("Found targeted canvas app"),g=b(a,d),
c.isNil(g)?c.console.log("Canvas app has no handler"):c.xd.post({parentVersion:r,clientVersion:d.cversion,payload:a,type:"event"},c.stripUrl(d.url),D(e,y)))}));else{c.console.log("Targeting single iframe");var h=D(a.target.iframe);c.isNil(h)||c.xd.post({parentVersion:r,clientVersion:r,payload:a,type:"event"},"*",h)}else c.console.log("Targeting canvas object"),g=b(a,d),(!c.isNil(g)||a.name===l)&&c.xd.post({parentVersion:r,clientVersion:d.cversion,payload:a,type:"event"},c.stripUrl(d.url),D(d.instanceId,
y))}function h(a,c,b,d){a="/services/data/v"+a.cversion;c={success:b,failure:d,headers:c,method:"HEAD"};a=t(a,c);Sfdc.Ajax.request(a,c)}function g(){var a;s.current===s.ninitd&&(s.current=s.initd,a="/cometd/"+r+"/",Sfdc.cometd.init({url:location.protocol+"//"+location.hostname+":"+location.port+a,requestHeaders:{Authorization:"OAuth "+C},appendMessageTypeToURL:!1}),z=Sfdc.cometd,c.isNil(u)&&(s.current=s.hs,u=z.addListener("/meta/handshake",function(a){a.successful?(!x&&Z()&&z.batch(function(){var a,
b=c.toArray(f),d,e,g,h;for(g=0;g<b.length;g+=1){a=e=b[g];d=[];h=l;!c.isNil(a.handlers)&&!c.isNil(a.handlers[h])&&(d=a.handlers[h],d=c.toArray(d));a=d;for(h=0;h<a.length;h+=1)d=a[h][0],$(d,e)}}),x=!1,s.current=s.hsdone,B()):s.current=s.hs})))}function m(a,c){var b=v(a[l]);if(b)p(b,c);else throw"["+l+"] Streaming subscription has no params or topic";}function p(a,b){var d,g=l;b.handlers=b.handlers||{};d=b.handlers;c.isNil(d[g])&&(d[g]={});c.isNil(d[g][a])&&h(b,{Authorization:"OAuth "+b.oauthToken},
function(){n(a,b)},function(c,d){var h;h=401===d.status?LC.getLabel("CanvasParentJs","subscribeRequiresAPI",g):LC.getLabel("CanvasParentJs","subscribeGenericError",d.status,g);e({name:g,params:{topic:a},method:"onComplete",payload:{success:!1,errorMessage:h}},b)})}function n(a,c){var b,d,h=l,f;g();f=function(){b=z.subscribe(a,function(b){e({name:h,params:{topic:a},method:"onData",payload:b},c)});d={success:!0,handle:b};b&&(c.handlers[h][a]=b,e({name:h,params:{topic:a},method:"onComplete",payload:d},
c))};s.current===s.hsdone?f():E.push(f)}function B(){var a;for(a=0;a<E.length;a+=1)if(c.isFunction(E[a]))E[a]();E=[]}function $(a,c){var b,d=l;(b=z.subscribe(a,function(b){e({name:d,params:{topic:a},method:"onData",payload:b},c)}))&&(c.handlers[d][a]=b)}function q(a){z.unsubscribe(a);Z()||(z.removeListener(u),u=null,x=!0,s.current=s.ninitd,z.disconnect())}function Z(){var a=!1;c.each(f,function(b){return!c.isNil(b.handlers)&&!c.isNil(b.handlers[l])?(a=!0,!1):!0});return a}function v(a){return!c.isNil(a.params)&&
!c.isNil(a.params.topic)?a.params.topic:null}function w(a,b){var d,e=c.validEventName(a,b);if(0!==e)throw d={1:LC.getLabel("CanvasParentJs","eventMultipleNamespaces"),2:LC.getLabel("CanvasParentJs","eventNamespaceReserved"),3:LC.getLabel("CanvasParentJs","eventInvalidCharacters")},d[e];}function A(a){var b,e=l,g,h,f;c.isNil(a)||(b=a.handlers,c.isNil(b)||(h=b[e],c.each(h,function(a,d){g=b[e][d];delete b[e][d];0>=c.size(b[e])&&delete b[e];q(g)}),a.handlers={},c.each(b,function(a,b){f=F[b];!c.isNil(f)&&
!d(b)&&f.unsubscribe()})))}var z,x=!0,s={ninitd:"notInitialized",initd:"initialized",hs:"handshake",hsdone:"handshakeDone",current:"notInitialized"},u,E=[],F=[];F[G]=function(){function a(){e({name:G,method:"onData",payload:{heights:{contentHeight:document.documentElement.scrollHeight,pageHeight:document.documentElement.clientHeight,scrollTop:document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop},widths:{contentWidth:document.documentElement.scrollWidth,pageWidth:document.documentElement.clientWidth,
scrollLeft:document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft}}})}var c=!1;return{subscribe:function(b){!0!==c&&(c=!0,window.addEventListener?window.addEventListener("scroll",a,!1):window.attachEvent&&window.attachEvent("onscroll",a))},unsubscribe:function(){!1!==c&&(window.removeEventListener?window.removeEventListener("scroll",a,!1):window.detachEvent&&window.detachEvent("onscroll",a),c=!1)}}}();F["canvas.orientation"]=function(){var a=!1,b;return{subscribe:function(d){!0!==
a&&(a=!0,b=function(){var a={},b;c.isNil(d.parentElem)||X(d.parentElem,a);b={orientation:window.orientation};c.isNil(a.clientHeight)||(b.clientHeight=a.clientHeight);c.isNil(a.clientWidth)||(b.clientWidth=a.clientWidth);e({name:"canvas.orientation",method:"onData",payload:b})},window.addEventListener?window.addEventListener("orientationchange",b,!1):window.attachEvent&&window.attachEvent("orientationchange",b,!1))},unsubscribe:function(){!1!==a&&(window.removeEventListener?window.removeEventListener("orientationchange",
b,!1):window.detachEvent&&window.detachEvent("orientationchange",b),a=!1,b=null)}}}();return{subscribe:function(a,b){var d=b.handlers||{},e,g;c.console.log("Subscribing ",b);if(c.isNil(a[l])){if(c.each(a,function(a,e){c.isNil(e)||(d[e]=a,g=F[e],c.isNil(g)||g.subscribe(b))}),b.handlers=d,c.isFunction(b.onCanvasSubscribed))b.onCanvasSubscribed()}else c.isNil(Sfdc.CometD)?(e=t("/jslibrary/SfdcExtended.js"),Sfdc.Resource.addJavaScript(e,function(){m(a,b)})):m(a,b)},unsubscribe:function(a,e){var g,h;if(c.isNil(a[l])){if(!c.isNil(e))for(g in a)a.hasOwnProperty(g)&&
!c.isNil(e.handlers[g])&&(delete e.handlers[g],h=F[g],!c.isNil(h)&&!d(g)&&h.unsubscribe())}else{var f;h=l;var k;if(g=v(a[h]))f={name:h,params:{topic:g}},f=b(f,e),c.isNil(f)||(f=e.handlers,k=f[h][g],delete f[h][g],0>=c.size(f[h])&&delete f[h],q(k));else throw"["+l+"] unsubscribe has no params or topic";}},unsubscribeAll:function(a){A(a)},parentSubscribe:function(b){var d,e={};K||R();c.isNil(f.parent)&&(f.parent={});d=f.parent;c.each(c.isArray(b)?b:[b],function(a){c.isNil(a.name)||(w(a.name,"canvas"),
e[a.name]=a.onData)});c.console.log("Parent subscribing");a.subscribe(e,d)},parentUnsubscribe:function(b){var d,e={};c.isNil(f.parent)&&(f.parent={});d=f.parent;c.each(c.isArray(b)?b:[b],function(a){c.isNil(a.name)||(w(a.name),e[a.name]=a.onData)});a.unsubscribe(e,d)},publish:function(a,b){e({name:a.name,method:"onData",payload:a.payload,target:a.target},b)},publishClient:function(b){!c.isNil(b.target)&&!c.isNil(b.target.iframe)&&(b.target.iframe=null);a.publish(b)},parentPublish:function(b){w(b.name);
a.publish(b)}}}(),e=function(){function a(b,d){return c.isNil(b)||c.isNil(d)||"final"===d?!1:!0}function d(a,b){if(c.endsWith(a,"%")||"infinite"===b||"final"===b)return c.endsWith(a,"%")||c.endsWith(a,"px")?a:a+"px";a=Number(a.split("px")[0]);b=Number(b.split("px")[0]);return(a<b?a:b)+"px"}function e(f,g){var k,p;!c.isNil(g)&&!c.isNil(g.frameElement)&&(a(f.height,g.options.height.max)&&(p=d(f.height,g.options.height.max),g.frameElement.height=p),a(f.width,g.options.width.max)&&(k=d(f.width,g.options.width.max),
g.frameElement.width=k));return{height:p,width:k}}return{minPixels:d,childResize:function(f,g){var m,p=f.body.config.client.instanceId;c.console.log("Child asking to be resized, id: [%s]",p);if(c.isNil(g)){m=f.body.size;var l,B,q,r,t;c.console.log("Resizing VF [%s] to ",p,m);l=c.byId(p);B=l.getAttribute("data-max-canvas-width")||"final";q=l.getAttribute("data-max-canvas-height")||"infinite";c.console.log("Max Width [%s] Max Height [%s]",B,q);a(m.height,q)&&(t=d(m.height,q),l.style.height=t);a(m.width,
B)&&(r=d(m.width,B),l.style.width=r);m={height:t,width:r};n.events.publish({name:"sfdc.resize",payload:m,target:{iframe:p}});n.events.publish({name:"sfdc.resize",payload:m,target:{canvas:"parent"}})}else m=e(f.body.size,g),n.events.publish({name:"canvas.resize",payload:m},g),n.events.publish({name:"canvas.resize",payload:m,target:{canvas:"parent"}})},parentResize:function(a,b){c.isNil(b)?(c.each(f,function(b){c.isNil(b.instanceId)||(e(a,b),n.events.publish({name:"canvas.resize",payload:a},b))}),n.events.publish({name:"canvas.resize",
payload:a,target:{canvas:"parent"}})):c.isNil(b.canvas)||c.each(f,function(c,d){var f=d.split(":");f[f.length-1]===b.canvas&&(e(a,c),n.events.publish({name:"canvas.resize",payload:a,target:b}),n.events.publish({name:"canvas.resize",payload:a,target:{canvas:"parent"}}))})}}}();return{events:a,services:function(a,d){function e(h,g){var k=g.getResponseHeader("Content-Type"),p={};p.seq=a;p.parentVersion=r;p.clientVersion=f[d].cversion;p.payload=k&&h&&0<=k.indexOf("application/json")?q.parse(h):h;p.status=
g.status;p.statusText=g.statusText;p.responseHeaders=g.getAllResponseHeaders();p.type="callback";c.xd.post(p,c.stripUrl(f[d].app.canvasUrl),D(d,y))}return{ctx:function(a,b){var f=b.app.namespace,p=b.app.developerName,n=b.app.referenceId,l=c.byId(y+d),u=c.isNil(b.cversion)?r:b.cversion,v=Q(b.options),f="/services/data/v"+u+"/platformconnect/canvascontext?"+(!c.isNil(n)?"referenceId\x3d"+n:"canvas\x3d"+p+(!c.isNil(f)?"\x26namespace\x3d"+f:"")),l={success:e,failure:e,headers:{Authorization:"OAuth "+
a.body.accessToken,Accept:"application/json"},contentType:"application/json",method:"PUT",data:q.stringify({environment:{dimensions:{height:l&&l.height||null,width:l&&l.width||null},parameters:b.options.parameters,displayLocation:b.options.displayLocation,sublocation:b.options.sublocation,record:v}})},f=t(f,l);Sfdc.Ajax.request(f,l)},ajax:function(a){var b;a.body.config.success=e;a.body.config.failure=e;b=a.body.url;a=a.body.config;b=t(b,a);Sfdc.Ajax.request(b,a)},refresh:function(a,b){var d,f,l;
if("OAUTH"===b.app.authType)throw LC.getLabel("CanvasParentJs","authTypeMismatch");S(b.instanceId,b.options,function(a,b){200==b.status?(d=q.parse(a),l=d.response.split("."),f=q.parse(c.decode(l[1])),c.isNil(f.client.oauthToken)?e("{}",{status:403,statusText:LC.getLabel("CanvasParentJs","userApprovalRequired"),getAllResponseHeaders:function(){return b.getAllResponseHeaders()},getResponseHeader:function(a){return b.getResponseHeader(a)}}):e(a,b)):e(a,b)},e)},repost:function(a,b){var c=a.body.refresh||
!1;if("OAUTH"===b.app.authType)throw LC.getLabel("CanvasParentJs","authTypeMismatch");c&&(b.sr=null);u(b.parentElem,b.instanceId,!1);b.options.showLoadingStatus=null;b.startTime=(new Date).getTime();W(b.instanceId,b.parentElem,b.options)}}},frame:e}}();return{render:Y,feed:function(a,e,b){var d=c.byId(e),k=c.byId("canvas-icon-"+b.canvasId),h;h=L(a.app,b.canvasId);d&&"block"===d.style.display?(d.style.display="none",k.style.display="block",u(e,h)):c.isNil(f[h])&&(b.onCanvasAppLoad=function(){d.style.display=
"block";k.style.display="none"},b.onCanvasAppError=b.onCanvasAppLoad,b.parameters=q.parse(b.parameters),Y(a,d,b))},subscribe:n.events.parentSubscribe,unsubscribe:n.events.parentUnsubscribe,publish:n.events.parentPublish,resize:n.frame.parentResize,close:function(a,c,b){a=L(a,b);u(c,a)}}}();c.module("Sfdc.canvas.parent",M)})(Sfdc.canvas);
AccessiblePreviewContentDialog=function(a,b){this.id=a;this.title=b;this.content="";this.height=550;this.width=730};AccessiblePreviewContentDialog.prototype=new AccessibleDialog({});AccessiblePreviewContentDialog.prototype.getContent=function(){return this.content};
Sfdc.ns("Sfdc.BaseAccessibleFileDialog");Sfdc.BaseAccessibleFileDialog=function(a){AccessibleDialog.call(this,a)};Sfdc.BaseAccessibleFileDialog.prototype=new AccessibleDialog({});Sfdc.BaseAccessibleFileDialog.prototype.isInAccessibilityMode=function(){return!1};Sfdc.BaseAccessibleFileDialog.prototype.display=function(){this.isInAccessibilityMode()||this.createContent();this.show()};
Sfdc.BaseAccessibleFileDialog.prototype.show=function(){var a=this.isOpen;this.isInAccessibilityMode()?(this.height||(this.height=300),this.createAccessiblePopupWindow(),this.popupWindow&&(this.popupWindow.focus(),this.popupWindow.confirmOnCloseLabel=LC.getLabel("Global","dialogCloseConfirm"),curPopupWindow=this.popupWindow)):OverlayDialog.prototype.show.call(this);!0===a&&chatter.getEventBus().fireEvent("chatter:files","onAfterDialogOpen");document.body.style.overflow="hidden"};
Sfdc.BaseAccessibleFileDialog.prototype.createDialog=function(){this.isInAccessibilityMode()||OverlayDialog.prototype.createDialog.call(this)};Sfdc.BaseAccessibleFileDialog.prototype.hide=function(){if(this.isInAccessibilityMode()){if(this.popupWindow){try{this.popupWindow.confirmOnClose=!1,this.popupWindow.close()}catch(a){}this.popupWindow=null}}else OverlayDialog.prototype.hide.call(this);document.body.style.overflow="visible"};
Sfdc.BaseAccessibleFileDialog.prototype.cancel=function(){var a=Sfdc.BaseAccessibleFileDialog.getDialogById(this.id);a&&a.hide();this.hook_cancel()};Sfdc.BaseAccessibleFileDialog.prototype.hook_cancel=function(){};Sfdc.BaseAccessibleFileDialog.getDialogById=function(a){var c,b;b=Sfdc.BaseAccessibleFileDialog.prototype.isInAccessibilityMode()?window.opener?window.opener:window.parent:window;b.sfdcPage&&(c=b.sfdcPage.getDialogById(a));return c};
BaseAutoCompleteElement=function(a){if(a&&!AutoCompleteInputElement.getInstance(a.id)&&(this.id=a.elementId,a.inDialog&&BaseAutoCompleteElement.removeExistingInstance(this.id),this.element=document.getElementById(this.id),this.id&&this.element)){if(this.valElementId=a.valElementId)this.valElement=document.getElementById(this.valElementId);this.matchBlanks=!0;AutoCompleteInputElement.instanceRefs[this.id]=this;this.servletURI=a.servletURI?a.servletURI:"/chatter/handlers/file/shareAutoComplete";this.minSuggestLen=
a.minSuggestLen&&0<=a.minSuggestLen?a.minSuggestLen:0;this.cache={};this.triedQueries={};this.selected=-1;this.requestParams={};this.lastInput=null;this.enabled=!0;this.disableOnEsc=!1;this.displayHeader=this.shouldCaptureKeyStroke=!0;var b=this;addEvent(this.element,"keyup",function(a){b.handleInput(a)});addEvent(this.element,"keydown",function(a){b.handleNav(a)});this.allowHideAC=!0;this.handleBlur=a.handleBlur?a.handleBlur:function(){b.clearSuggestions()};a.handleFocusExtra&&(this.handleFocusExtra=
a.handleFocusExtra);addEvent(this.element,"blur",function(){b.focused=!1;b.allowHideAC&&b.handleBlur()});addEvent(this.element,"focus",function(){b.focused=!0;b.clearGhostText();b.displaySuggestions();b.handleFocusExtra&&b.handleFocusExtra()});a.inDialog&&(this.inDialog=a.inDialog);this.zIndex=a.zIndex?a.zIndex:8E4;a.disableGhostText||this.displayGhostText();this.handleSelect=a.handleSelect?a.handleSelect:BaseAutoCompleteElement.defaultClickInternal;a.getMinimumWidth&&(this.getMinimumWidth=a.getMinimumWidth);
a.getACXPosition&&(this.getACXPosition=a.getACXPosition);a.getACYPosition&&(this.getACYPosition=a.getACYPosition)}};Ext.extend(BaseAutoCompleteElement,AutoCompleteInputElement);BaseAutoCompleteElement.prototype.getBoxCssClass=function(){return AutoCompleteInputElement.BOX_CSS_CLASS+" ugAC_box"};BaseAutoCompleteElement.prototype.getListOlCssClass=function(){return"ugAC_list"};BaseAutoCompleteElement.prototype.getRowCssClass=function(){return AutoCompleteInputElement.ROW_CSS_CLASS+" ugAC_row"};
BaseAutoCompleteElement.prototype.getRowSelectedCssClass=function(){return AutoCompleteInputElement.ROW_CSS_CLASS_SELECTED+" ugAC_rowSelected"};BaseAutoCompleteElement.prototype.getRowMouseOverCssClass=function(){return this.getRowCssClass()+" ugAC_row_hover"};BaseAutoCompleteElement.prototype.getHintRowCssClass=function(){return this.getRowCssClass()+" ugAC_hintRow"};BaseAutoCompleteElement.prototype.getInputBoxGhostTextCssClass=function(){return"ghostText"};
BaseAutoCompleteElement.prototype.getMoveSelectionUp=function(){return"UP"};BaseAutoCompleteElement.prototype.getMoveSelectionDown=function(){return"DOWN"};BaseAutoCompleteElement.prototype.displayGhostText=function(){var a=Sfdc.get(this.id);a.blur();Sfdc.Dom.addClass(a,this.getInputBoxGhostTextCssClass());a.value=this.getGhostText()};BaseAutoCompleteElement.prototype.getGhostText=function(){return""};
BaseAutoCompleteElement.prototype.clearGhostText=function(){var a=Sfdc.get(this.id);this.inGhostMode()&&(Sfdc.Dom.removeClass(a,this.getInputBoxGhostTextCssClass()),a.value="")};BaseAutoCompleteElement.prototype.inGhostMode=function(){var a=Sfdc.get(this.id);return Sfdc.Dom.hasClass(a,this.getInputBoxGhostTextCssClass())?!0:!1};
BaseAutoCompleteElement.prototype.handleEnter=function(a){var b=this.getRow(this.selected);b&&b.onmousedown?(b.onmousedown(),BaseAutoCompleteElement.needDefer()||AutoCompleteInputElement.captureKeystroke(a)):AutoCompleteInputElement.captureKeystroke(a)};BaseAutoCompleteElement.prototype.getCacheKey=function(a){return a};BaseAutoCompleteElement.prototype.retrieveFromServlet=function(a){};
BaseAutoCompleteElement.prototype.positionACBox=function(a){if(this.element&&this.acBox&&(!a||this.isACBoxVisible())){a=this.getACXPosition(this.element)+1;var b=this.getACYPosition(this.element),c=this.getMinimumWidth();Sfdc.userAgent.isIE8&&(a-=1);this.acBox.setStyle("left",a+"px");this.acBox.setStyle("top",b+"px");this.acBox.setStyle("width",c+"px");this.acBox.setStyle("zIndex",this.zIndex);this.inDialog&&this.acBox.setStyle("position","absolute")}};
BaseAutoCompleteElement.prototype.getMinimumWidth=function(){return this.element.clientWidth+2};BaseAutoCompleteElement.prototype.displaySuggestions=function(a){if(this.element){var b=trim(this.element.value);if(a||b!=this.lastInput||!this.isACBoxVisible())this.setAppliedFlag(!1),this.lastInput=b,a=null,this.hasValidSelection()&&(a=this.curSuggestions[this.selected]),this.curSuggestions=this.getSuggestions(b),this.updateACBox(this.curSuggestions,a)}};
BaseAutoCompleteElement.prototype.getValidSuggestions=function(a,b){for(var c={AllItems:[]},d=c.AllItems,f=this.extractCurrentEntitySuggestions(b),e=0,h=f.length;e<h;e++){var g=f[e];this.isValidSuggestion(a,g)&&d.push(g)}c.length=d.length;return c};BaseAutoCompleteElement.prototype.isValidSuggestion=function(a,b){var c=this.getRegexForInput(a);return b.ItemName.match(c)};
BaseAutoCompleteElement.prototype.updateACBox=function(a,b){Sfdc.get(this.id);!a||0===a.length?(this.displayACBox(a,b),this.scrollDiv(),this.updateWidth()):BaseAutoCompleteElement.superclass.updateACBox.call(this,a,b)};
BaseAutoCompleteElement.prototype.initACBox=function(){if(this.element){this.acBox=document.createElement("div");this.acBox.id=this.id+AutoCompleteInputElement.BOX_ID;this.acBox.className=this.getBoxCssClass();this.addACBoxToPage(this.acBox);this.acBox=new iframeShim(this.acBox);this.acBox.setStyle("width",this.getMinimumWidth()+"px");var a=document.getElementById(this.id+AutoCompleteInputElement.BOX_ID);if(a){var b=this;Sfdc.userAgent.isIE?(addEvent(a,"mouseenter",function(a){b.allowHideAC=!1}),
addEvent(a,"mouseleave",function(a){b.allowHideAC=!0})):(addEvent(a,"mouseover",function(a){b.allowHideAC=!1}),addEvent(a,"mouseout",function(a){b.allowHideAC=!0}))}}};BaseAutoCompleteElement.prototype.constructACBox=function(a,b){var c=["\x3col class\x3d'"+this.getListOlCssClass()+"'\x3e"],d=this.extractCurrentEntitySuggestions(a);this.addSuggestions(c,d,b,0);this.addHintMessage(c,d);c.push("\x3c/ol\x3e");return c};
BaseAutoCompleteElement.prototype.addHintMessage=function(a,b){b&&b.length>BaseAutoCompleteElement.MATCH_DISPLAY_LIMIT&&a.push('\x3cli\x3e\x3cdiv class\x3d"'+this.getHintRowCssClass()+'"\x3e'+LC.getLabel("ChatterFileSharing","tooManyMatchMessage")+"\x3c/div\x3e\x3c/li\x3e")};BaseAutoCompleteElement.prototype.extractCurrentEntitySuggestions=function(a){return a.AllItems};
BaseAutoCompleteElement.prototype.setACBoxHeight=function(a){4<a?(this.acBox.setStyle("height","144px"),this.scrolling=!0):(this.acBox.setStyle("height","auto"),this.scrolling=!1)};BaseAutoCompleteElement.prototype.select=function(a){if(this.selected!=a){if(0<=this.selected){var b=this.getRow(this.selected);b&&(b.className=this.getRowCssClass())}this.selected=a;if(b=this.getRow(a))b.className=this.getRowSelectedCssClass()}};BaseAutoCompleteElement.prototype.addSuggestions=function(a,b,c,d){};
BaseAutoCompleteElement.prototype.getSuggestionHtml=function(a){var b=escapeHTML(this.lastInput);a=BaseAutoCompleteElement.htmlEncode(a.ItemName);var c=this.getRegexForInput(b);return["\x3cspan class\x3d'name'\x3e",""===b?a:a.replace(c,'$1\x3cstrong class\x3d"autocompleteMatch"\x3e$2\x3c/strong\x3e'),"\x3c/span\x3e"].join("")};BaseAutoCompleteElement.prototype.compareSuggestions=function(a,b){return a&&b&&a.ItemId&&b.ItemId&&b.ItemId==a.ItemId};
BaseAutoCompleteElement.prototype.scrollDiv=function(){if(this.hasValidSelection()&&this.scrolling)if(this.selectionMoveDirection===this.getMoveSelectionUp()){var a=this.acBox.div.scrollHeight*((this.selected+1)/this.curSuggestions.length)-34;this.acBox.div.scrollTop>a&&(this.acBox.div.scrollTop=a)}else this.acBox.div.scrollTop=this.acBox.div.scrollHeight*((this.selected+1)/this.curSuggestions.length)-this.acBox.div.clientHeight};
BaseAutoCompleteElement.prototype.handleNav=function(a){AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_TAB?(this.handleEnter(a),this.resizeTextArea()):(AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_ARROW_U?(this.selectionMoveDirection=this.getMoveSelectionUp(),(Sfdc.userAgent.isSafari||Sfdc.userAgent.isChrome)&&AutoCompleteInputElement.captureKeystroke(a)):AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_ARROW_D&&(this.selectionMoveDirection=this.getMoveSelectionDown()),BaseAutoCompleteElement.superclass.handleNav.call(this,
a))};BaseAutoCompleteElement.prototype.saveToCache=function(a,b){!a||""===a?this.emptyInputCache=b:this.cache[this.getCacheKey(a)]=b};BaseAutoCompleteElement.prototype.clearCache=function(){this.cache={};this.triedQueries={};this.emptyInputCache={}};BaseAutoCompleteElement.prototype.checkCacheOrRetrieve=function(a){var b=this.getCacheKey(a);(!a||""===a?this.emptyInputCache:this.cache[b])||this.retrieveFromServlet(a);return!a||""===a?this.emptyInputCache:this.cache[b]};
BaseAutoCompleteElement.mouseOver=function(a,b){var c=AutoCompleteInputElement.getInstance(a);c&&b!=c.selected&&(document.getElementById(AutoCompleteInputElement.getRowIdStatic(a,b)).className=c.getRowMouseOverCssClass())};BaseAutoCompleteElement.mouseOut=function(a,b){var c=AutoCompleteInputElement.getInstance(a);c&&b!=c.selected&&(document.getElementById(AutoCompleteInputElement.getRowIdStatic(a,b)).className=c.getRowCssClass())};
BaseAutoCompleteElement.click=function(a,b,c,d,f,e,h,g,l){var k=AutoCompleteInputElement.getInstance(b);k&&(AutoCompleteInputElement.captureKeystroke(a),k.handleSelect(b,c,d,f,e,h,g,l))};BaseAutoCompleteElement.defaultClickInternal=function(a,b,c,d,f,e){this.element.value=d;this.valElement&&(this.valElement.value=c);this.select(b);this.complete()};BaseAutoCompleteElement.makeACBoxID=function(a){return a+AutoCompleteInputElement.BOX_ID};
BaseAutoCompleteElement.removeExistingInstance=function(a){a=BaseAutoCompleteElement.makeACBoxID(a);(a=Sfdc.get(a))&&Sfdc.Dom.removeChild(a)};BaseAutoCompleteElement.needDefer=function(){return Sfdc.userAgent.isIE&&!Sfdc.userAgent.isIE6&&!Sfdc.userAgent.isIE9?!0:!1};BaseAutoCompleteElement.htmlEncode=function(a){return!a?a:String(a).replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;")};
BaseAutoCompleteElement.htmlEncodeForJS=function(a){return!a?a:String(a).replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;").replace(/&/g,"\x26amp;")};
Sfdc.ns("Sfdc.ChatterFiles");
Sfdc.ChatterFiles={ENTITY_NOT_VIEWABLE_COMMAND_URL:"/file/entitynotviewable/",hideFileSyncBanner:function(){Sfdc.Dom.hideByDisplay(Sfdc.get("fileSyncOnBoardBanner"));UserContext.userPreferences.setBoolean("HideFileSyncBannerMsg",!0)},redirectToOwnerProfileUrl:function(a){a=this.ENTITY_NOT_VIEWABLE_COMMAND_URL+a+"?p\x3dtrue";chatter.getToolbox().get({url:a,success:function(a,c){navigateToUrl(c.ownerUrl)}})},toggleSyncUnsyncFileLinks:function(a,b){var c=chatter.getToolbox(),d=Sfdc.Dom.getParent(a),
e={};e.style=b.style?b.style:"Detail";var f=Ext.get(a);c.mask(f);c.post({url:"/file/filesyncsubscription/"+b.docId+";"+b.action,id:b.docId,params:e,success:function(a,b){if(d)if("ListView"===e.style){var c=Chatter.Files.ContentListViewport.INSTANCE;c.isFileSyncFilter()?c.refresh():d.innerHTML=b.html}else d.innerHTML=b.html},failure:function(a,b){c.unmask(f)}})}};
Sfdc.ChatterFileFeedActions={items:[],selected:-1,link:null,linkId:null,popupLink:null,popup:null,onHover:function(){function b(a){var c,b;a=Ext.get(a);a.setWidth(a.getWidth()).setHeight(a.getHeight());c=a.down(".previewHover");b=a.down("img");c||(c=a.createChild({tag:"div",cls:"previewHover",title:b.getAttribute("title")}),c.setStyle({width:b.getWidth()-b.getBorderWidth("lr")+"px",height:b.getHeight()-b.getBorderWidth("tb")+"px"}),c.setY(b.getY()),c.setVisibilityMode(Ext.Element.DISPLAY));c.show()}
return function(a){a=Ext.get(a);a.set({onmouseover:null,onfocus:null});b(a);a.hover(function(a,d){(d=a.getTarget()?a.getTarget(".contentThumbnail-a"):null)&&b(d)},function(a,b){(b=a.getTarget()?a.getTarget(".contentThumbnail-a"):null)&&Ext.fly(b).child(".previewHover").hide()})}}(),stopIfNav:function(b,a){var c=b.getKey();(37<=c&&40>=c||c===KEY_TAB)&&b.stopEvent()},onNav:function(b,a){function c(){var a;0<e.selected?(e.selected-=1,a=e.items.elements[e.selected],Ext.fly(a).isVisible()?Ext.fly(a).first().hasClass("chatterFollowUnfollow")?
(Ext.fly(a).first().first().isVisible()?Ext.fly(a).first().first().first().focus():Ext.fly(a).first().last().last().focus(),Sfdc.Event.fireEvent(Ext.fly(a).first().dom,"mouseover")):Ext.fly(a).first().focus():c()):0===e.selected&&(e.selected-=1,e.popupLink.focus())}function d(){var a;e.selected<e.items.getCount()-1&&(e.selected+=1,a=e.items.elements[e.selected],Ext.fly(a).isVisible()?Ext.fly(a).first().hasClass("chatterFollowUnfollow")?(Ext.fly(a).first().first().isVisible()?Ext.fly(a).first().first().first().focus():
Ext.fly(a).first().last().last().focus(),Sfdc.Event.fireEvent(Ext.fly(a).first().dom,"mouseover")):Ext.fly(a).first().focus():d())}var f=b.getKey(),e=Sfdc.ChatterFileFeedActions;switch(f){case KEY_ARROW_D:d();break;case KEY_ARROW_U:c();break;case KEY_ESC:e.closePopup();Ext.fly(e.linkId).focus();break;case KEY_TAB:b.shiftKey?c():d()}e.stopIfNav(b,a)},hoverHandler:function(b){var a=this;return function(c,d){var f;if(d=c.getTarget(".contentActionMenuItem"))d=Ext.get(d),b?(a.items.removeClass("hover"),
Ext.isIE7&&(f=d.parent(".contentActionMenu"),f.setWidth(f.getWidth())),d.addClass("hover")):d.removeClass("hover")}},bindEvents:function(b){var a=this,c=b?"on":"un";a.items[c]("mouseover",a.hoverHandler(!0));a.items[c]("mouseout",a.hoverHandler(!1));a.items.each(function(b,f){if(f=b.first())f[c]("focus",a.hoverHandler(!0)),f[c]("blur",a.hoverHandler(!1))});Ext.isGecko?(a.popup[c]("keypress",a.onNav),a.popup[c]("keydown",a.stopIfNav)):(a.popup[c]("keydown",a.onNav),Ext.EventManager[c](window,"keydown",
a.stopIfNav));a.popup[c]("keyup",a.stopIfNav);Ext.getBody()[c]("click",a.closePopup)},openPopup:function(b){var a=this,c=Ext.get("contentActionMenu"+b);if(c.child(".more-file-actions")||Ext.isIE7&&"1"===c.getAttribute("loaded"))a.openPopupCallback(b);else{var d=c.getAttribute("docId"),f={rendition:c.getAttribute("rendition"),subscribed:c.getAttribute("subscribed"),sharing:c.getAttribute("sharing")};chatter.getToolbox().get({url:"/chatterfileactionmenu/"+d,params:f,success:function(d,f){c.update(f.html,
!0);a.openPopupCallback(b)}})}},openPopupCallback:function(b){var a;this.popup=Ext.get("contentActionMenu"+b);this.link=Ext.get(b);this.items=this.popup.select(".contentActionMenuItem",!0);this.linkId=b;this.selected=-1;Ext.isIE7&&!this.popup.hasClass("feedcontainer")&&(this.popup.insertAfter(Ext.getBody().last()),this.popup.addClass("feedcontainer"));this.bindEvents(!0);this.popup.setVisible(!0);this.popupLink=this.popup.child(".more-file-actions");b=this.popup.getX()-this.popupLink.getX()+(Ext.isIE7?
2:0);a=this.popup.getY()-this.popupLink.getY()-(Ext.isIE7?1:0);this.popup.parent(".chatterFileListBlock")?a-=Ext.isIE8&&0<!Ext.query("body.ChatterPage").length?14:3:Ext.isIE7&&0<Ext.getBody().query("div.chatterFileListBlock").length&&(a=16,b=1,this.popup.dom.setAttribute("loaded","1"));this.popup.position("absolute",null,this.link.getX()+b,this.link.getY()+a);Ext.isIE7&&0<Ext.getBody().query("div.chatterFileListBlock").length&&(b=this.link.getY(),a=this.link.getX(),Ext.query("body.FileTabPage")&&
0===Ext.query("body.FileTabPage").length&&(b+=5,a+=4),this.popup.first().position("absolute",null,a,b));this.checkUploadPerms();this.popupLink.focus()},closePopup:function(b){for(var a=Sfdc.select("div.contentActionMenu"),c=null,d=0;d<a.length;d++)c=a[d],Sfdc.Dom.isVisible(c)&&Sfdc.Dom.hideByDisplay(c);Sfdc.ChatterFileFeedActions.bindEvents(!1);"string"===typeof b&&document.getElementById(this.linkId).focus()},checkUploadPerms:function(){var b,a,c,d;c=Ext.query("div.contentActionMenu .unchecked");
if(0!==c.length){a="";for(b=0;b<c.length;b++)d=c[b],d=Ext.get(d),a=a+d.child("span").dom.innerHTML+",",d.removeClass("unchecked"),d.addClass("inverification");b=chatter.getToolbox();b.get({url:"/file/permissionCheck",params:{docIds:a},success:function(a,b){var c,d,h,g,k=Ext.query("div.contentActionMenu .inverification"),l=Ext.toArray(b.Permissions);for(d=0;d<k.length;d++)g=Ext.get(k[d]),c=g.child("span").dom.innerHTML,-1!==l.indexOf(c)?(h=g.child("a"),h.set({href:Sfdc.ChatterFileFeedActions.uploadUrl(c)})):
g.addClass("disabled"),g.removeClass("inverification")}})}},resetDocUpload:function(b){var a,c,d=Ext.query("div.contentActionMenu div.upload span.docid");if(0<d.length)for(a=0;a<d.length;a++)docidSpan=d[a],c=docidSpan.innerHTML,-1!==c.indexOf(b)&&Ext.fly(docidSpan).up(".upload",5).addClass("unchecked");this.checkUploadPerms()},uploadUrl:function(b){return UserContext.getUrl("/"+b+"?fa\x3dnv")},adjustLinkElemWidthForThumbnail:function(b){b=Ext.get(b);var a=b.parent();a&&(a.hasClass("contentThumbnail-a")&&
a.parent(".cxfeedcomment"))&&a.setStyle({width:b.getWidth()+"px",height:b.getHeight()+"px"})}};
Sfdc.ns("Sfdc.ContentMenuActionOverlayDialog");Sfdc.ContentMenuActionOverlayDialog=function(){};Ext.extend(Sfdc.ContentMenuActionOverlayDialog,NonaccessibleDialog);Sfdc.ContentMenuActionOverlayDialog.DIALOG_ID="ContentMenuActionOverlayDialog";
Sfdc.ContentMenuActionOverlayDialog.open=function(a){var b=sfdcPage.getDialogById(Sfdc.ContentMenuActionOverlayDialog.DIALOG_ID);b?(b.url=a.url,b.title=a.title):b=new NonaccessibleDialog(Sfdc.ContentMenuActionOverlayDialog.DIALOG_ID,a.title,a.url,a.width,a.height);b.display()};Sfdc.ContentMenuActionOverlayDialog.prototype.hide=function(){NonaccessibleDialog.superclass.hide.call(this)};
Sfdc.ns("Sfdc.DropdownPanel");Sfdc.DropdownPanel=function(a,b){this.id=a;this.clazz=b||"dropdownPanel";this.domObj=null;Sfdc.DropdownPanel.registerPanel(this)};Sfdc.DropdownPanel.list={};Sfdc.DropdownPanel.getPanel=function(a){return Sfdc.DropdownPanel.list[a]};Sfdc.DropdownPanel.registerPanel=function(a){Sfdc.DropdownPanel.list[a.id]=a};Sfdc.DropdownPanel.prototype.resizeEventHandler=function(a){return function(){a.close()}};Sfdc.DropdownPanel.prototype.scrollEventHandler=function(a){return function(){a.close()}};
Sfdc.DropdownPanel.prototype.clickEventHandler=function(a,b){return function(){!a.hasFocus&&Sfdc.Dom.isVisible(b)&&a.close();a.hasFocus=!1}};Sfdc.DropdownPanel.prototype.keydownEventHandler=function(a){return function(b){getEvent(b).keyCode==KEY_ESC&&a.close()}};
Sfdc.DropdownPanel.prototype.init=function(){if(!this.domObj){var a=document.createElement("div");a.id=this.id;a.className=this.clazz;document.body.appendChild(a);var b=this;addEvent(a,"mouseover",function(){b.hasFocus=!0});addEvent(a,"mouseout",function(){b.hasFocus=!1});addEvent(window,"resize",b.resizeEventHandler(b));addEvent(window,"scroll",b.scrollEventHandler(b));addEvent(document.body,"click",b.clickEventHandler(b,a));addEvent(document.body,"keydown",b.keydownEventHandler(b),!1);this.initCustomEvents();
this.domObj=a}return this.domObj};Sfdc.DropdownPanel.prototype.initCustomEvents=function(){};Sfdc.DropdownPanel.prototype.getXY=function(a){var b=0,c=0;a&&a.x&&(b=a.x);a&&a.y&&(c=a.y);return{x:b,y:c}};Sfdc.DropdownPanel.prototype.getSize=function(){return null};Sfdc.DropdownPanel.prototype.getContent=function(a){return""};Sfdc.DropdownPanel.prototype.hasFocusInitially=function(){return!0};
Sfdc.DropdownPanel.prototype.show=function(a,b){var c=this.init();if(c){this.hasFocus=this.hasFocusInitially();this.anchorElem=a;Sfdc.Dom.show(c);var d=this.getXY(b);c.style.left=d.x+"px";c.style.top=d.y+"px";if(d=this.getSize())d.width&&(c.style.width=d.width+"px"),d.height&&(c.style.height=d.height+"px");if(d=this.getContent(b))c.innerHTML=d}};Sfdc.DropdownPanel.prototype.close=function(){this.domObj&&(Sfdc.Dom.hideByDisplay(this.domObj),this.hasFocus=!1)};
Sfdc.ns("Sfdc.FileSyncOnboardSetup");
Sfdc.FileSyncOnboardSetup.platform_switch=function(a){var b=document.getElementById("chatterbox_onboarding_download_container"),c="chatterbox_onboarding_download chatterbox_onboarding_download_bkground";Sfdc.FileSyncOnboardSetup.forSetupNode&&(c="chatterbox_onboarding_download");switch(a){case "win":b.className=c+" chatterbox_onboarding_download_os_win";Sfdc.FileSyncOnboardSetup.current_platform="win";break;case "mac":b.className=c+" chatterbox_onboarding_download_os_mac",Sfdc.FileSyncOnboardSetup.current_platform=
"mac"}};Sfdc.FileSyncOnboardSetup.download_installer=function(){var a="https://"+Sfdc.FileSyncOnboardSetup.config.umpsUrl,a="mac"===Sfdc.FileSyncOnboardSetup.current_platform?a+Sfdc.FileSyncOnboardSetup.config.macDownloadPath:a+Sfdc.FileSyncOnboardSetup.config.windowsDownloadPath;location.href=a};
Sfdc.FileSyncOnboardSetup.download_1_init=function(a){document.getElementById("chatterbox_onboarding_download_2").className="hidden";document.getElementById("chatterbox_onboarding_download_1").className="chatterbox_onboarding_download_1";Sfdc.FileSyncOnboardSetup.platform_switch(a)};
Sfdc.FileSyncOnboardSetup.download_2_init=function(){document.getElementById("chatterbox_onboarding_download_1").className="hidden";document.getElementById("chatterbox_onboarding_download_2").className="chatterbox_onboarding_download_2";Sfdc.FileSyncOnboardSetup.download_installer()};Sfdc.FileSyncOnboardSetup.forSetupNode=!1;Sfdc.FileSyncOnboardSetup.config={};Sfdc.FileSyncOnboardSetup.current_platform="";
Sfdc.FileSyncOnboardSetup.fileSyncOnboardSetupInit=function(a,b){a&&(Sfdc.FileSyncOnboardSetup.forSetupNode=!0);Sfdc.FileSyncOnboardSetup.config=b;-1!=navigator.appVersion.indexOf("Mac")?Sfdc.FileSyncOnboardSetup.download_1_init("mac"):Sfdc.FileSyncOnboardSetup.download_1_init("win")};
Sfdc.ns("Sfdc.MultiUploadConfirmDialog");Sfdc.MultiUploadConfirmDialog=function(a){OverlayDialogElement.call(this,a.id);this.width=500;this.isModal=!1;this.setTitle(a.dialogTitle);this.warningMsg=a.warningMsg;this.yesButtonValue=a.yesButtonValue;this.noButtonValue=a.noButtonValue;this.extraClass="multiUploadConfirmDialog";this.initContent()};Ext.extend(Sfdc.MultiUploadConfirmDialog,OverlayDialogElement);Sfdc.MultiUploadConfirmDialog.DIALOG_ID="multiUploadConfirmationDialog";
Sfdc.MultiUploadConfirmDialog.multiUploadConfirmationDialog=null;Sfdc.MultiUploadConfirmDialog.open=function(a){a=sfdcPage.getDialogById(a.id);a||(a={id:Sfdc.MultiUploadConfirmDialog.DIALOG_ID},a=new Sfdc.MultiUploadCancelSingleFileConfirmDialog(a),a.created=!0,a.register());a.show()};Sfdc.MultiUploadConfirmDialog.prototype.show=function(){OverlayDialogElement.prototype.show.call(this);Sfdc.get("chatterFilesMultiUploadDialog").style.zIndex=50100};
Sfdc.MultiUploadConfirmDialog.prototype.initContent=function(){var a=[];a.push('\x3cdiv class\x3d"message chatterDeprecationMessage multiUploadWarningMessage"\x3e\x3ctable\x3e\x3ctr\x3e');a.push('\x3ctd\x3e\x3cimg src\x3d"/s.gif" alt\x3d"'+LC.getLabel("Icon","WARNING")+'" class\x3d"msgIcon" title\x3d"'+LC.getLabel("Icon","WARNING")+'"\x3e\x3c/td\x3e');a.push('\x3ctd class\x3d"messageCell"\x3e\x3cdiv class\x3d"messageText"\x3e'+this.warningMsg+"\x3c/div\x3e\x3c/td\x3e");a.push("\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e");
this.contents=a.join("");a=[];a.push('\x3cinput type\x3d"button" class\x3d"btn" onclick\x3d"sfdcPage.getDialogById(\''+this.id+'\').yesButtonClicked();" value\x3d"'+this.yesButtonValue+'"/\x3e');this.noButtonValue&&a.push('\x3cinput type\x3d"button" class\x3d"btn" onclick\x3d"sfdcPage.getDialogById(\''+this.id+'\').noButtonClicked();" value\x3d"'+this.noButtonValue+'"/\x3e');this.buttonContents=a.join("")};Sfdc.MultiUploadConfirmDialog.prototype.yesButtonClicked=function(){this.cancel()};
Sfdc.MultiUploadConfirmDialog.prototype.noButtonClicked=function(){this.cancel()};Sfdc.MultiUploadConfirmDialog.prototype.cancel=function(){Sfdc.get("chatterFilesMultiUploadDialog").style.zIndex=50101;OverlayDialogElement.prototype.cancel.call(this)};Sfdc.ns("Sfdc.MultiUploadCancelRemainingConfirmDialog");Sfdc.MultiUploadCancelRemainingConfirmDialog=function(a){Sfdc.MultiUploadConfirmDialog.call(this,a)};Ext.extend(Sfdc.MultiUploadCancelRemainingConfirmDialog,Sfdc.MultiUploadConfirmDialog);
Sfdc.MultiUploadCancelRemainingConfirmDialog.DIALOG_ID="MultiUploadCancelRemainingConfirmDialog";
Sfdc.MultiUploadCancelRemainingConfirmDialog.open=function(){var a=sfdcPage.getDialogById(Sfdc.MultiUploadCancelRemainingConfirmDialog.DIALOG_ID);a||(a={id:Sfdc.MultiUploadCancelRemainingConfirmDialog.DIALOG_ID,dialogTitle:LC.getLabel("ChatterFileMultiUpload","cancelRemainingUploadsTitle"),warningMsg:LC.getLabel("ChatterFileMultiUpload","cancelRemainingUploadsMsg"),yesButtonValue:LC.getLabel("ChatterFileMultiUpload","yesButtonCancelRemainingPanel"),noButtonValue:LC.getLabel("ChatterFileMultiUpload",
"noButtonCancelRemainingPanel")},a=new Sfdc.MultiUploadCancelRemainingConfirmDialog(a),a.created=!0,a.register());a.show()};Sfdc.MultiUploadCancelRemainingConfirmDialog.prototype.yesButtonClicked=function(){Sfdc.MultiUploadConfirmDialog.prototype.yesButtonClicked.call(this);Sfdc.AccessibleMultiUploadFilesDialog.uploader.cancelRemainingUploads()};Sfdc.ns("Sfdc.MultiUploadStoppedConfirmDialog");Sfdc.MultiUploadStoppedConfirmDialog=function(a){Sfdc.MultiUploadConfirmDialog.call(this,a)};
Ext.extend(Sfdc.MultiUploadStoppedConfirmDialog,Sfdc.MultiUploadConfirmDialog);Sfdc.MultiUploadStoppedConfirmDialog.DIALOG_ID="MultiUploadStoppedConfirmDialog";
Sfdc.MultiUploadStoppedConfirmDialog.open=function(){var a=sfdcPage.getDialogById(Sfdc.MultiUploadStoppedConfirmDialog.DIALOG_ID);a||(a={id:Sfdc.MultiUploadStoppedConfirmDialog.DIALOG_ID,dialogTitle:LC.getLabel("ChatterFileMultiUpload","uploadStoppedTitle"),warningMsg:LC.getLabel("ChatterFileMultiUpload","uploadStoppedMsg"),yesButtonValue:LC.getLabel("ChatterFileMultiUpload","yesButtonStopPanel"),noButtonValue:LC.getLabel("ChatterFileMultiUpload","noButtonStopPanel")},a=new Sfdc.MultiUploadStoppedConfirmDialog(a),
a.created=!0,a.register());a.show()};Sfdc.ns("Sfdc.MultiUploadResumeConfirmDialog");Sfdc.MultiUploadResumeConfirmDialog=function(a){Sfdc.MultiUploadConfirmDialog.call(this,a)};Ext.extend(Sfdc.MultiUploadResumeConfirmDialog,Sfdc.MultiUploadConfirmDialog);Sfdc.MultiUploadResumeConfirmDialog.DIALOG_ID="MultiUploadResumeConfirmDialog";
Sfdc.MultiUploadResumeConfirmDialog.open=function(){var a=sfdcPage.getDialogById(Sfdc.MultiUploadResumeConfirmDialog.DIALOG_ID);a||(a={id:Sfdc.MultiUploadResumeConfirmDialog.DIALOG_ID,dialogTitle:LC.getLabel("ChatterFileMultiUpload","resumeUploadTitle"),warningMsg:LC.getLabel("ChatterFileMultiUpload","resumeUploadMsg"),yesButtonValue:LC.getLabel("ChatterFileMultiUpload","yesButtonResumePanel"),noButtonValue:LC.getLabel("ChatterFileMultiUpload","noButtonResumePanel")},a=new Sfdc.MultiUploadResumeConfirmDialog(a),
a.created=!0,a.register());a.show()};Sfdc.ns("Sfdc.MultiUploadErrorHandlingDialog");Sfdc.MultiUploadErrorHandlingDialog=function(a){Sfdc.MultiUploadConfirmDialog.call(this,a)};Ext.extend(Sfdc.MultiUploadErrorHandlingDialog,Sfdc.MultiUploadConfirmDialog);Sfdc.MultiUploadErrorHandlingDialog.DIALOG_ID="MultiUploadErrorHandlingDialog";
Sfdc.MultiUploadErrorHandlingDialog.open=function(a){var b=sfdcPage.getDialogById(Sfdc.MultiUploadErrorHandlingDialog.DIALOG_ID);b?(b.warningMsg=a,b.initContent()):(a={id:Sfdc.MultiUploadErrorHandlingDialog.DIALOG_ID,dialogTitle:LC.getLabel("Global","error"),warningMsg:a,yesButtonValue:LC.getLabel("Global","close")},b=new Sfdc.MultiUploadErrorHandlingDialog(a),b.created=!0,b.register());b.show();return b};Sfdc.MultiUploadErrorHandlingDialog.prototype.yesButtonClicked=function(){Sfdc.MultiUploadConfirmDialog.prototype.yesButtonClicked.call(this)};
UserAndGroupAutoCompleteInputElement=function(a){if(a&&!AutoCompleteInputElement.getInstance(a.id)&&(this.id=a.elementId,a.inDialog&&UserAndGroupAutoCompleteInputElement.removeExistingInstance(this.id),this.element=document.getElementById(this.id),this.id&&this.element)){this.entityType=a.entityType?a.entityType:UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER;if(this.valElementId=a.valElementId)this.valElement=document.getElementById(this.valElementId);this.matchBlanks=!0;AutoCompleteInputElement.instanceRefs[this.id]=
this;this.servletURI=a.servletURI?a.servletURI:"/chatter/handlers/file/shareAutoComplete";this.minSuggestLen=a.minSuggestLen&&0<=minSuggestLen?a.minSuggestLen:this.entityType===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?0:1;this.cache={};this.triedQueries={};this.selected=-1;this.requestParams={};this.lastInput=null;this.enabled=!0;this.disableOnEsc=!1;this.displayHeader=this.shouldCaptureKeyStroke=!0;var b=this;addEvent(this.element,"keyup",function(a){b.handleInput(a)});addEvent(this.element,
"keydown",function(a){b.handleNav(a)});this.allowHideAC=!0;this.handleBlur=a.handleBlur?a.handleBlur:function(){b.clearSuggestions()};a.handleFocusExtra&&(this.handleFocusExtra=a.handleFocusExtra);addEvent(this.element,"blur",function(){b.focused=!1;b.allowHideAC&&b.handleBlur()});addEvent(this.element,"focus",function(){b.focused=!0;b.clearGhostText();b.displaySuggestions();b.handleFocusExtra&&b.handleFocusExtra()});a.inDialog&&(this.inDialog=a.inDialog);this.zIndex=a.zIndex?a.zIndex:200;a.ghostText&&
(this.ghostText=a.ghostText);a.disableGhostText||this.displayGhostText();this.handleSelect=a.handleSelect?a.handleSelect:UserAndGroupAutoCompleteInputElement.defaultClickInternal;a.getMinimumWidth&&(this.getMinimumWidth=a.getMinimumWidth);a.getACXPosition&&(this.getACXPosition=a.getACXPosition);a.getACYPosition&&(this.getACYPosition=a.getACYPosition);this.suggestions=[]}};UserAndGroupAutoCompleteInputElement.prototype=new AutoCompleteInputElement;
UserAndGroupAutoCompleteInputElement.BOX_CSS_CLASS=AutoCompleteInputElement.BOX_CSS_CLASS+" ugAC_box";UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS=AutoCompleteInputElement.ROW_CSS_CLASS+" ugAC_row";UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS_SELECTED=AutoCompleteInputElement.ROW_CSS_CLASS_SELECTED+" ugAC_rowSelected";UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS_MOUSE_OVER=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS+" ugAC_row_hover";
UserAndGroupAutoCompleteInputElement.HINT_ROW_CSS_CLASS=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS+" ugAC_hintRow";UserAndGroupAutoCompleteInputElement.INPUTBOX_GHOSTTEXT_CSS_CLASS="ghostText";UserAndGroupAutoCompleteInputElement.MATCH_DISPLAY_LIMIT=25;UserAndGroupAutoCompleteInputElement.MOVE_SELECTION_UP="UP";UserAndGroupAutoCompleteInputElement.MOVE_SELECTION_DOWN="DOWN";UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER="u";UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP="g";
UserAndGroupAutoCompleteInputElement.prototype.displayGhostText=function(){var a=Sfdc.get(this.id);a.blur();Sfdc.Dom.addClass(a,UserAndGroupAutoCompleteInputElement.INPUTBOX_GHOSTTEXT_CSS_CLASS);a.value="";a.value=this.ghostText?this.ghostText:this.entityType&&this.entityType===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?LC.getLabel("ChatterFileSharing","sharedWithGroupGhostText"):LC.getLabel("ChatterFileSharing","sharedWithUserGhostText")};
UserAndGroupAutoCompleteInputElement.prototype.clearGhostText=function(){var a=Sfdc.get(this.id);this.inGhostMode()&&(Sfdc.Dom.removeClass(a,UserAndGroupAutoCompleteInputElement.INPUTBOX_GHOSTTEXT_CSS_CLASS),a.value="")};UserAndGroupAutoCompleteInputElement.prototype.inGhostMode=function(){var a=Sfdc.get(this.id);return Sfdc.Dom.hasClass(a,UserAndGroupAutoCompleteInputElement.INPUTBOX_GHOSTTEXT_CSS_CLASS)};
UserAndGroupAutoCompleteInputElement.prototype.handleEnter=function(a){var b=this.getRow(this.selected);b&&b.onmousedown&&(b.onmousedown(),UserAndGroupAutoCompleteInputElement.needDefer()||AutoCompleteInputElement.captureKeystroke(a))};UserAndGroupAutoCompleteInputElement.prototype.getCacheKey=function(a){return a};
UserAndGroupAutoCompleteInputElement.prototype.retrieveFromServlet=function(a){if(!this.inGhostMode()){if(!this.isInputOk(a))return!1;this.requestParams.str=a;this.entityType&&this.entityType===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP&&(this.requestParams.etype=UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP);var b=this;this.ajaxState="initialized";var c=this.servletURI;"/chatter/handlers"==c.substr(0,17)&&(c=c.substring(17));chatter.getToolbox().get({url:c,params:this.requestParams,
success:function(c,d){b.ajaxState="finished";b.saveToCache(a,d);b.displaySuggestions(!0)}});return!0}};
UserAndGroupAutoCompleteInputElement.prototype.positionACBox=function(a){if(this.element&&this.acBox&&(!a||this.isACBoxVisible())){a=this.getACXPosition(this.element)+1;var b=this.getACYPosition(this.element),c=this.getMinimumWidth();Sfdc.userAgent.isIE8&&(a-=1);this.acBox.setStyle("left",a+"px");this.acBox.setStyle("top",b+"px");this.acBox.setStyle("width",c+"px");this.acBox.setStyle("zIndex",this.zIndex);this.inDialog&&this.acBox.setStyle("position","absolute")}};
UserAndGroupAutoCompleteInputElement.prototype.getMinimumWidth=function(){return this.element.clientWidth+2};
UserAndGroupAutoCompleteInputElement.prototype.displaySuggestions=function(a){if(this.element&&this.focused){var b=trim(this.element.value);if(a||b!=this.lastInput||!this.isACBoxVisible())this.setAppliedFlag(!1),this.lastInput=b,a=null,this.isInputOk(b)?(this.hasValidSelection()&&(a=this.curSuggestions[this.selected]),this.curSuggestions=this.getSuggestions(b),this.updateACBox(this.curSuggestions,a)):this.handleEmptyInput()}};
UserAndGroupAutoCompleteInputElement.prototype.isInputOk=function(a){return this.entityType===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER&&(!a||""===a||2>a.length&&!/^[\u4E00-\u9FAF]+$/.test(a))?!1:!0};
UserAndGroupAutoCompleteInputElement.prototype.getValidSuggestions=function(a,b){var c={},e=UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER===this.entityType?"AllUsers":"AllGroups";c[e]=[];for(var e=c[e],d=this.extraCurrentEntitySuggestions(b),f=0,g=d.length;f<g;f++){var h=d[f];this.isValidSuggestion(a,h)&&e.push(h)}c.length=e.length;return c};UserAndGroupAutoCompleteInputElement.prototype.isValidSuggestion=function(a,b){return!0};
UserAndGroupAutoCompleteInputElement.prototype.updateACBox=function(a,b){var c=Sfdc.get(this.id).value;this.isInputOk(c)&&(!a||0===a.length?(this.displayACBox(a,b),this.scrollDiv(),this.updateWidth()):this.constructor.prototype.updateACBox.call(this,a,b))};
UserAndGroupAutoCompleteInputElement.prototype.initACBox=function(){if(this.element){this.acBox=document.createElement("div");this.acBox.id=this.id+AutoCompleteInputElement.BOX_ID;this.acBox.className=AutoCompleteInputElement.BOX_CSS_CLASS+" ugAC_box";this.addACBoxToPage(this.acBox);this.acBox=new iframeShim(this.acBox);this.acBox.setStyle("width",this.getMinimumWidth()+"px");var a=document.getElementById(this.id+AutoCompleteInputElement.BOX_ID);if(a){var b=this;Sfdc.userAgent.isIE?(addEvent(a,"mouseenter",
function(a){b.allowHideAC=!1}),addEvent(a,"mouseleave",function(a){b.allowHideAC=!0})):(addEvent(a,"mouseover",function(a){b.allowHideAC=!1}),addEvent(a,"mouseout",function(a){b.allowHideAC=!0}))}}};UserAndGroupAutoCompleteInputElement.prototype.constructACBox=function(a,b){var c=["\x3col class\x3d'ugAC_list'\x3e"],e=this.extraCurrentEntitySuggestions(a);this.addSuggestions(c,e,b,0);this.addHintMessage(c,e);c.push("\x3c/ol\x3e");return c};
UserAndGroupAutoCompleteInputElement.prototype.addHintMessage=function(a,b){b&&b.length>UserAndGroupAutoCompleteInputElement.MATCH_DISPLAY_LIMIT&&a.push('\x3cli\x3e\x3cdiv class\x3d"'+UserAndGroupAutoCompleteInputElement.HINT_ROW_CSS_CLASS+'" onmousedown\x3d\'UserAndGroupAutoCompleteInputElement.hideACBox("'+this.id+"\")'\x3e"+LC.getLabel("ChatterFileSharing","tooManyMatchMessage")+"\x3c/div\x3e\x3c/li\x3e")};
UserAndGroupAutoCompleteInputElement.prototype.extraCurrentEntitySuggestions=function(a){return a[UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER===this.entityType?"AllUsers":"AllGroups"]};UserAndGroupAutoCompleteInputElement.prototype.setACBoxHeight=function(a){4<a?(this.acBox.setStyle("height","144px"),this.scrolling=!0):(this.acBox.setStyle("height","auto"),this.scrolling=!1)};
UserAndGroupAutoCompleteInputElement.prototype.select=function(a){if(this.selected!=a){if(0<=this.selected){var b=this.getRow(this.selected);b&&(b.className=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS)}this.selected=a;if(b=this.getRow(a))b.className=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS_SELECTED}};
UserAndGroupAutoCompleteInputElement.prototype.addSuggestions=function(a,b,c,e){if(b)if(0===b.length)b="\x3cb\x3e\x26quot;"+Sfdc.String.escapeToHtml(Sfdc.get(this.id).value)+"\x26quot;\x3c/b\x3e",a.push('\x3cli\x3e\x3cdiv class\x3d"ugAC_noMatch"\x3e'),this.entityType&&this.entityType===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?""===Sfdc.get(this.id).value?(c=UserContext.getUrl("/_ui/core/chatter/groups/GroupListPage"),b=UserContext.getUrl("/_ui/core/chatter/groups/GroupCreatePage"),c=
'\x3ca href\x3d"'+c+'"\x3e'+LC.getLabel("FeedFilter","GroupEmptyFeedJoinLink")+"\x3c/a\x3e",b='\x3ca href\x3d"'+b+'"\x3e'+LC.getLabel("FeedFilter","GroupEmptyFeedCreateLink")+"\x3c/a\x3e",a.push(LC.getLabel("ChatterFileSharing","doesNotBelongToAnyGroup",c,b))):a.push(LC.getLabel("ChatterFileSharing","noMatchGroupText",b)):a.push(LC.getLabel("ChatterFileSharing","noMatchText",b)),a.push("\x3c/div\x3e\x3c/li\x3e");else{e=b.length<UserAndGroupAutoCompleteInputElement.MATCH_DISPLAY_LIMIT?b.length:UserAndGroupAutoCompleteInputElement.MATCH_DISPLAY_LIMIT;
for(var d=0;d<e;d++){var f=b[d];if(f&&(f.ItemName||f.value)){var g=this.id;this.suggestions[d]={id:g,rowIndex:d,itemId:b[d].ItemId,itemName:Sfdc.String.escapeToHtml(b[d].ItemName),itemTitle:Sfdc.String.escapeToHtml(b[d].Title),imageLink:b[d].ImageLink,badgeHtml:b[d].BadgeHtml,imageHtml:b[d].ImageHtml||null,itemPrivacy:b[d].ItemPrivacy||null,isExternalUserOrGroup:!b[d].InternalUserOrGroup};a.push("\x3cli\x3e");a.push("\x3cdiv ");a.push("onmouseover\x3d'UserAndGroupAutoCompleteInputElement.mouseOver("+
d+', "'+g+"\")' ");a.push("onmouseout\x3d'UserAndGroupAutoCompleteInputElement.mouseOut("+d+', "'+g+"\")' ");a.push("onmousedown\x3d'UserAndGroupAutoCompleteInputElement.click(event, "+d+', "'+g+"\")' ");c&&this.compareSuggestions(c,f)||!c&&0===d?(a.push("class\x3d'"+UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS_SELECTED+"' "),this.selected=d,this.select(d)):a.push("class\x3d'"+UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS+"' ");a.push("title\x3d'"+Sfdc.String.escapeToHtml(b[d].ItemName)+
"' ");a.push("id\x3d'"+AutoCompleteInputElement.getRowIdStatic(g,d)+"'\x3e");a.push(this.getSuggestionHtml(f));a.push("\x3c/div\x3e");a.push("\x3c/li\x3e")}}}};
UserAndGroupAutoCompleteInputElement.prototype.getSuggestionHtml=function(a){var b=escapeHTML(this.lastInput),c=Sfdc.String.escapeToHtml(a.ItemName),e=Sfdc.String.escapeToHtml(a.Title),d=this.getRegexForInput(b),b=""===b?c:c.replace(d,'$1\x3cstrong class\x3d"autocompleteMatch"\x3e$2\x3c/strong\x3e');return["\x3cdiv class\x3d'ugAC_entityImgDiv'\x3e",a.ImageHtml,"\x3c/div\x3e\x3cspan class\x3d'name'\x3e",b,a.BadgeHtml,"\x3c/span\x3e \x3cdiv class\x3d'ugAC_userRole'\x3e",e,"\x3c/div\x3e"].join("")};
UserAndGroupAutoCompleteInputElement.prototype.compareSuggestions=function(a,b){return a&&b&&a.ItemId&&b.ItemId&&b.ItemId==a.ItemId};
UserAndGroupAutoCompleteInputElement.prototype.scrollDiv=function(){if(this.hasValidSelection()&&this.scrolling)if(this.selectionMoveDirection===UserAndGroupAutoCompleteInputElement.MOVE_SELECTION_UP){var a=this.acBox.div.scrollHeight*((this.selected+1)/this.curSuggestions.length)-34;this.acBox.div.scrollTop>a&&(this.acBox.div.scrollTop=a)}else this.acBox.div.scrollTop=this.acBox.div.scrollHeight*((this.selected+1)/this.curSuggestions.length)-this.acBox.div.clientHeight};
UserAndGroupAutoCompleteInputElement.prototype.handleNav=function(a){AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_TAB?(this.handleEnter(a),this.resizeTextArea()):(AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_ARROW_U?(this.selectionMoveDirection=UserAndGroupAutoCompleteInputElement.MOVE_SELECTION_UP,(Sfdc.userAgent.isSafari||Sfdc.userAgent.isChrome)&&AutoCompleteInputElement.captureKeystroke(a)):AutoCompleteInputElement.isNav(a)&&a.keyCode==KEY_ARROW_D&&(this.selectionMoveDirection=UserAndGroupAutoCompleteInputElement.MOVE_SELECTION_DOWN),
this.constructor.prototype.handleNav.call(this,a))};UserAndGroupAutoCompleteInputElement.prototype.saveToCache=function(a,b){!a||""===a?this.emptyInputCache=b:this.cache[this.getCacheKey(a)]=b};UserAndGroupAutoCompleteInputElement.prototype.clearCache=function(){this.cache={};this.triedQueries={};this.emptyInputCache={}};
UserAndGroupAutoCompleteInputElement.prototype.checkCacheOrRetrieve=function(a){var b=this.getCacheKey(a);(!a||""===a?this.emptyInputCache:this.cache[b])||this.retrieveFromServlet(a);return!a||""===a?this.emptyInputCache:this.cache[b]};UserAndGroupAutoCompleteInputElement.mouseOver=function(a,b){var c=AutoCompleteInputElement.getInstance(b);c&&a!=c.selected&&(document.getElementById(AutoCompleteInputElement.getRowIdStatic(b,a)).className=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS_MOUSE_OVER)};
UserAndGroupAutoCompleteInputElement.mouseOut=function(a,b){var c=AutoCompleteInputElement.getInstance(b);c&&a!=c.selected&&(document.getElementById(AutoCompleteInputElement.getRowIdStatic(b,a)).className=UserAndGroupAutoCompleteInputElement.ROW_CSS_CLASS)};UserAndGroupAutoCompleteInputElement.click=function(a,b,c){if(c=AutoCompleteInputElement.getInstance(c))AutoCompleteInputElement.captureKeystroke(a),c.handleSelect(c.suggestions[b])};
UserAndGroupAutoCompleteInputElement.hideACBox=function(a){(a=AutoCompleteInputElement.getInstance(a))&&a.handleBlur()};UserAndGroupAutoCompleteInputElement.defaultClickInternal=function(a){this.element.value=Sfdc.String.unescapeHtml(a.itemName);this.valElement&&(this.valElement.value=a.itemId);this.select(a.rowIndex);this.complete()};UserAndGroupAutoCompleteInputElement.makeACBoxID=function(a){return a+AutoCompleteInputElement.BOX_ID};
UserAndGroupAutoCompleteInputElement.removeExistingInstance=function(a){a=UserAndGroupAutoCompleteInputElement.makeACBoxID(a);(a=Sfdc.get(a))&&Sfdc.Dom.removeChild(a)};UserAndGroupAutoCompleteInputElement.needDefer=function(){return Sfdc.userAgent.isIE7||Sfdc.userAgent.isIE8?!0:!1};
Sfdc.ns("Sfdc.MultiFileUploaderFile");Sfdc.MultiFileUploaderFile=function(a){this.name="undefined"!=typeof a.fileName?a.fileName:a.name;this.size="undefined"!=typeof a.fileSize?a.fileSize:a.size;this.type=a.type;a=this.name;var b=a.lastIndexOf(".");-1!=b&&(a=a.substr(0,b));this.shortName=a;this.docId=null};
Sfdc.ns("Sfdc.MultiFileUploaderUi");
Sfdc.MultiFileUploaderUi={showSingleFileModeUploadList:function(){var a=Sfdc.get("multifile-upload-list").childNodes.item(0);Sfdc.Dom.removeClass(a,"multi-item");Sfdc.Dom.addClass(a,"single-item")},showOverallProgressBar:function(){var a=Sfdc.get("overallProgress");Sfdc.Dom.setStyle(a,"display","inline-block");a=Sfdc.get("uploadingStatusInfo");Sfdc.Dom.hasClass(a,"canceledAllStatusInfo")&&(Sfdc.Dom.removeClass(a,"canceledAllStatusInfo"),Sfdc.Dom.addClass(a,"uploadingStatusInfo"))},hideOverallProgressBar:function(){var a=
Sfdc.get("overallProgress");Sfdc.Dom.hideByDisplay(a)},showListTableHeader:function(){var a=Sfdc.get("multiUploadListTableHeader");Sfdc.Dom.hasClass(a,"canceledAllBackGround")&&(Sfdc.Dom.removeClass(a,"canceledAllBackGround"),Sfdc.Dom.addClass(a,"ongoingBackGround"));Sfdc.Dom.show(a)},hideListTableHeader:function(){Sfdc.Dom.hideByDisplay("multiUploadListTableHeader")},showCancelRemainingUploadsButton:function(){Sfdc.Dom.show(Sfdc.get("multiUploadCancelRemainingBtn"))},hideCancelRemainingUploadsButton:function(){Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCancelRemainingBtn"))},
showCloseButton:function(){Sfdc.Dom.show(Sfdc.get("multiUploadCloseBtn"))},hideCloseButton:function(){Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCloseBtn"))},showSharingSettingsBtn:function(a,b){Sfdc.Dom.setStyle(Sfdc.get("multiUploadSharingSettingsBtn"),"display","inline-block");Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCancelRemainingBtn"));Sfdc.Dom.show(Sfdc.get("multiUploadCloseBtn"));addEvent(Sfdc.get("multiUploadSharingSettingsBtn"),"click",function(){navigateToUrl(a+"/"+b+"?so\x3dlst")})},
hideSharingSettingBtn:function(){Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadSharingSettingsBtn"))},updateUploadingStatusInfoWithSuccessMessage:function(a){1<a?Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","uploadSucessfulStatusHeaderMsg",a.toString()):Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","singleUploadSucessfulStatusHeaderMsg")},updateUploadingStatusInfoWithInProgressMessage:function(a,b){var c=Sfdc.get("overallProgress");
1<b?(Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","uploadingInProgressHeaderMsg",(a+1).toString(),b.toString()),Sfdc.Dom.setStyle(c,"display","inline-block")):(Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","singleUploadingInProgressHeaderMsg"),Sfdc.Dom.hideByDisplay(c))},updateUploadingStatusInfoWithAllCanceledMessage:function(a){1<a?Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","uploadCanceledAllStatusHeaderMsg",
a):Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","singleUploadCanceledAllStatusHeaderMsg");a=Sfdc.get("multiUploadListTableHeader");Sfdc.Dom.removeClass(a,"ongoingBackGround");Sfdc.Dom.addClass(a,"canceledAllBackGround");a=Sfdc.get("uploadingStatusInfo");Sfdc.Dom.removeClass(a,"uploadingStatusInfo");Sfdc.Dom.addClass(a,"canceledAllStatusInfo")}};
Sfdc.ns("Sfdc.MultiFileUploaderUtil");Sfdc.MultiFileUploaderUtil.extend=function(a,b){for(var c in b)c&&(a[c]=b[c])};Sfdc.MultiFileUploaderUtil.isFileAPISupported=function(){return"undefined"!=typeof File&&"undefined"!=typeof FormData&&"undefined"!=typeof(new XMLHttpRequest).upload};Sfdc.MultiFileUploaderUtil.isMultiFileUploadSupported=function(){var a=document.createElement("input");a.type="file";return"multiple"in a&&Sfdc.MultiFileUploaderUtil.isFileAPISupported()};
Sfdc.MultiFileUploaderUtil.isIE9AndBelow=function(){return Sfdc.userAgent.isIE&&!Sfdc.userAgent.isIE10&&!Sfdc.userAgent.isIE11};Sfdc.MultiFileUploaderUtil.getBrowserName=function(){var a="unknown";Sfdc.userAgent.isIE?a="IE"+Sfdc.userAgent.ieVersion:Sfdc.userAgent.isChrome?a="Chrome":Sfdc.userAgent.isSafari?a="Safari":Sfdc.userAgent.isFirefox?a="Firefox":Sfdc.userAgent.isOpera?a="Opera":Sfdc.userAgent.isNetscape&&(a="Netscape");return a};
Sfdc.MultiFileUploaderUtil.parseResponseResult=function(a){a=a.replace(/\r/g,"\n");0===a.indexOf("\x3cpre")&&(a=a.replace(/^<pre[^>]*>/,"").replace(/<\/pre>$/,""));var b=a.indexOf(AjaxServlet.CSRF_PROTECT);if(-1===b)return null;0<b&&(a=AjaxServlet.CSRF_PROTECT+a.replace(AjaxServlet.CSRF_PROTECT,""));0<a.indexOf("\x3ctextarea")&&(a=a.replace(/<textarea[^>]*>/,"").replace(/<\/textarea>$/,""));return chatter.getToolbox().evalJson(a)};
Sfdc.MultiFileUploaderUtil.getActionUrl=function(){var a=chatter.getToolbox();return a.sitePrefix()+a.apiurl()};Sfdc.MultiFileUploaderUtil.formatFileSize=function(a){var b=["KB","MB","GB"];if(0<a){var c=-1;do a/=1024,c++;while(1023<a);return Math.max(a,0.1).toFixed(1)+" "+b[c]}return"0 "+b[0]};
Sfdc.MultiFileUploaderUtil.formatFileTypeCSS=function(a,b){b=b||"16";return/^image\/|^.png$|^.jpg$|^.bmp$|^.gif$/.test(a)?"sprite-doctype-image-"+b:/^video\/|^.mov$|^.avi$|^.mp4$|^.mpeg$|^.wmv$|^.rmvb$/.test(a)?"sprite-doctype-video-"+b:/^audio\/|^.mp3$|^.wma$|^.wav$|^.midi$/.test(a)?"sprite-doctype-audio-"+b:/^text\/csv|^.csv$/.test(a)?"sprite-doctype-csv-"+b:/^text\/plain|^.txt$/.test(a)?"sprite-doctype-txt-"+b:/^text\/xml|^.xml$/.test(a)?"sprite-doctype-xml-"+b:/^text\/html|^.html$|^.xhtml$|^.htm$/.test(a)?
"sprite-doctype-html-"+b:/^text\/richtext|^.rtf$|application\/rtf/.test(a)?"sprite-doctype-rtf-"+b:/^application\/.*word|^.doc$|^.docx$/.test(a)?"sprite-doctype-word-"+b:/^application\/.*(excel|sheet)|^.xls$|^.xlsx$/.test(a)?"sprite-doctype-excel-"+b:/^application\/.*powerpoint|^application\/.*presentation|^.ppt$|^.pptx$/.test(a)?"sprite-doctype-ppt-"+b:/^application\/.*visio|^.vsd$/.test(a)?"sprite-doctype-visio-"+b:/^application\/.*pdf|^.pdf$/.test(a)?"sprite-doctype-pdf-"+b:/^application\/.*flash|^.swf$/.test(a)?
"sprite-doctype-flash-"+b:/^application\/.*zip|^.zip$/.test(a)?"sprite-doctype-zip-"+b:/^application\/.*postscript|^.eps$/.test(a)?"sprite-doctype-eps-"+b:/^application\/.*msdownload|^.exe$/.test(a)?"sprite-doctype-exe-"+b:"sprite-doctype-unknown-"+b};Sfdc.MultiFileUploaderUtil.checkFileSyncOption=function(){if(!Sfdc.ChatterFileUploader.isFileSync){var a=Sfdc.get("chatterboxFilesBrowseItem");a&&Sfdc.Dom.hasClass(a,"selectedLinkItem")&&(Sfdc.ChatterFileUploader.isFileSync=!0)}};
Sfdc.MultiFileUploaderUtil.createElementFromHTML=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;b=a.firstChild;a.removeChild(b);return b}}();
Sfdc.MultiFileUploaderUtil.processDirectoriesInFileList=function(a){var b,c,d=[];if(a.items)for(b=0;b<a.items.length;b++){if(c=a.items[b]){var e=null;c.webkitGetAsEntry&&(e=c.webkitGetAsEntry());e&&(e.isDirectory?d.push({name:e.name,size:0,type:""}):e.isFile&&d.push(a.files[b]))}}else{d=a.files;a=[];for(b=0;b<d.length;b++)c=d[b],0===c.size?a.push({name:c.name,size:0,type:""}):a.push(c);d=a}return d};
Sfdc.ns("Sfdc.MultiFileUploaderUiComponents.ProgressBar");Sfdc.MultiFileUploaderUiComponents.ProgressBar=function(a,b){this.element=a;this.totalPixelSize=b;this.element.childNodes.item(0).style.width="0px"};Sfdc.MultiFileUploaderUiComponents.ProgressBar.prototype.update=function(a){this.element.childNodes.item(0).style.width=a*this.totalPixelSize+"px"};
var isIE=-1!=navigator.appVersion.indexOf("MSIE")?!0:!1,isWin=-1!=navigator.appVersion.toLowerCase().indexOf("win")?!0:!1,isOpera=-1!=navigator.userAgent.indexOf("Opera")?!0:!1,isIPad=-1!=navigator.userAgent.indexOf("iPad")?!0:!1,isIPhone=-1!=navigator.userAgent.indexOf("iPhone")?!0:!1;
function controlVersion(){var a,c;try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),a=c.GetVariable("$version")}catch(g){}if(!a)try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),a="WIN 6,0,21,0",c.AllowScriptAccess="always",a=c.GetVariable("$version")}catch(d){}if(!a)try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),a=c.GetVariable("$version")}catch(b){}if(!a)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),a="WIN 3,0,18,0"}catch(e){}if(!a)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),
a="WIN 2,0,0,11"}catch(f){a=-1}return a}
function getSwfVer(){var a=-1;if(null!==navigator.plugins&&0<navigator.plugins.length){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var a=navigator.plugins["Shockwave Flash"+(navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"")].description.split(" "),c=a[2].split("."),g=c[0],c=c[1],d=a[3];""===d&&(d=a[4]);"d"==d[0]?d=d.substring(1):"r"==d[0]&&(d=d.substring(1),0<d.indexOf("d")&&(d=d.substring(0,d.indexOf("d"))));a=g+"."+c+"."+d}}else-1!=navigator.userAgent.toLowerCase().indexOf("webtv/2.6")?
a=4:-1!=navigator.userAgent.toLowerCase().indexOf("webtv/2.5")?a=3:-1!=navigator.userAgent.toLowerCase().indexOf("webtv")?a=2:isIE&&(isWin&&!isOpera)&&(a=controlVersion());return a}
function detectFlashVer(a,c,g){versionStr=getSwfVer();if(-1==versionStr)return!1;if(0!==versionStr){isIE&&isWin&&!isOpera?(tempArray=versionStr.split(" "),tempString=tempArray[1],versionArray=tempString.split(",")):versionArray=versionStr.split(".");var d=versionArray[0],b=versionArray[1],e=versionArray[2];return d>parseFloat(a)||d==parseFloat(a)&&(b>parseFloat(c)||b==parseFloat(c)&&e>=parseFloat(g))?!0:!1}}function ac_AddExtension(a,c){return-1!=a.indexOf("?")?a.replace(/\?/,c+"?"):a+c}
function ac_Generateobj(a,c,g,d){var b="",e;if(isIE&&isWin&&!isOpera){b+="\x3cobject ";for(e in c)"parent"!=e&&(b+=e+'\x3d"'+c[e]+'" ');b+="\x3e";for(e in g)g.hasOwnProperty(e)&&(b+='\x3cparam name\x3d"'+e+'" value\x3d"'+g[e]+'" /\x3e ');b+="\x3cp\x3e"+LC.getLabel("ContentFlashPlayer","flashFilePreview")+"\x3c/p\x3e\x3c/object\x3e"}else{b+="\x3cembed ";for(e in d)d.hasOwnProperty(e)&&"function"!=typeof d[e]&&(b+=e+'\x3d"'+d[e]+'" ');b+="\x3e\x3cnoembed\x3e\x3cp\x3e"+LC.getLabel("ContentFlashPlayer",
"flashFilePreview")+"\x3c/p\x3e\x3c/noembed\x3e\x3c/embed\x3e"}a.innerHTML=b}
function ac_GetArgs(a,c,g,d,b){for(var e={embedAttrs:{},params:{},objAttrs:{}},f=0;f<a.length;f+=2)switch(a[f].toLowerCase()){case "parent":e.parent=a[f+1];break;case "classid":break;case "pluginspage":e.embedAttrs[a[f]]=a[f+1];break;case "src":case "movie":a[f+1]=ac_AddExtension(a[f+1],c);e.embedAttrs.src=a[f+1];e.params[g]=a[f+1];break;case "onafterupdate":case "onbeforeupdate":case "onblur":case "oncellchange":case "onclick":case "ondblClick":case "ondrag":case "ondragend":case "ondragenter":case "ondragleave":case "ondragover":case "ondrop":case "onfinish":case "onfocus":case "onhelp":case "onmousedown":case "onmouseup":case "onmouseover":case "onmousemove":case "onmouseout":case "onkeypress":case "onkeydown":case "onkeyup":case "onload":case "onlosecapture":case "onpropertychange":case "onreadystatechange":case "onrowsdelete":case "onrowenter":case "onrowexit":case "onrowsinserted":case "onstart":case "onscroll":case "onbeforeeditfocus":case "onactivate":case "onbeforedeactivate":case "ondeactivate":case "type":case "codebase":e.objAttrs[a[f]]=a[f+
1];break;case "id":case "width":case "height":case "align":case "vspace":case "hspace":case "class":case "title":case "accesskey":case "name":case "tabindex":e.embedAttrs[a[f]]=e.objAttrs[a[f]]=a[f+1];break;default:e.embedAttrs[a[f]]=e.params[a[f]]=a[f+1]}e.objAttrs.classid=d;b&&(e.embedAttrs.type=b);return e}
function ac_FL_RunContent(){var a=ac_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");ac_Generateobj(a.parent,a.objAttrs,a.params,a.embedAttrs)}function getFlexRoot(a){return-1!=navigator.appName.indexOf("Microsoft")?window[a]:document[a]}
function sizeImagePreview(a,c,g,d){var b=document.getElementById(a),e=b.height/b.width,f="0px";b.width>=c&&e<=g/c?(b.width=c,b.height=b.width*e):b.height>=g&&(b.height=g,b.width=b.height/e);b.height<g&&(f=0.45*(g-b.height)+"px");b.style.marginTop=f;d?Ext.fly(a).removeClass(d):Ext.fly(a).dom.style.display="block"}function onPreviewSuccess(a,c,g,d){sizeImagePreview(a,c,g,d);if(a=Ext.fly("fullPreviewNotSupported"))a.dom.style.display="block"}
function showPreviewError(a){a=Ext.fly(a).parent("div");if("chatterFileViewerPanel"==a.dom.id)a.dom.innerHTML=previewErrorHtml,a.child("div").dom.style.display="block";else{var c=LC.getLabel("ChatterFileListPage","noPreviewOnDevice");a.dom.innerHTML='\x3ctable style\x3d"font-size:1.2em;font-weight:bold;width:100%;height:100%"\x3e\x3ctr\x3e\x3ctd style\x3d"text-align:center;vertical-align:middle;"\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e';a.child("td").dom.innerHTML=c}if(a=Ext.fly("fullPreviewNotSupported"))a.dom.style.display=
"none"}
function doIPadIPhonePreview(a,c,g,d,b,e,f,l,m,n,h){var k;d=g.split("\x26");for(b=0;b<d.length;b++)0===d[b].indexOf("v\x3d")&&(k=d[b].substring(2));c=UserContext.getUrl("/sfc/servlet.shepherd/version/download/"+k+"?asPdf\x3dtrue");k=UserContext.getUrl("/sfc/servlet.shepherd/version/renditionDownload?rendition\x3dTHUMB720BY480\x26versionId\x3d"+k);d=a.clientWidth;b=a.clientHeight-30;previewErrorHtml=a.innerHTML;k='\x3cdiv style\x3d"'+("width:"+d+"px; height:"+b+"px;")+'"\x3e\x3ca href\x3d"'+c+'"\x3e\x3cimg onerror\x3d"showPreviewError(this)" onload\x3d"onPreviewSuccess(\'imageRendition\', \''+
d+"', '"+b+'\')" id\x3d"imageRendition" style\x3d"display:none;margin:auto;" src\x3d"'+k+'"/\x3e\x3c/a\x3e\x3c/div\x3e';d=null;b=!1;h&&h.fileType&&(d=h.fileType,b=h.isImage);h="";b||(b=null,null!==d&&(b=escapeHTML(LC.getLabel("ContentDownloadLinkElement","downloadFeedPost"," "+d))),h='\x3cdiv id\x3d"fullPreviewNotSupported" style\x3d"display:none"\x3e\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"fullPreviewNotSupported"\x3e\x3ctr\x3e\x3ctd class\x3d"iconCell"\x3e\x3cimg class\x3d"warningIcon" width\x3d"1" height\x3d"1" alt\x3d"" src\x3d"/img/s.gif"/\x3e\x3c/td\x3e\x3ctd class\x3d"textCell"\x3e'+
escapeHTML(LC.getLabel("ChatterFileListPage","fullPreviewNotSupported"))+"\x3c/td\x3e",null!==b&&(h+=' \x3ctd\x3e\x3cdiv class\x3d"download"\x3e\x3ca class\x3d"actionLink" href\x3d"'+c+'"\x3e\x3cimg width\x3d"1" height\x3d"1" title\x3d"'+b+'" class\x3d"downloadIcon" alt\x3d"" src\x3d"/img/s.gif"/\x3e\x3cspan class\x3d"actionLabel"\x3e'+b+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/td\x3e"),h+="\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e");a.innerHTML=k+h}
function showDownloadLink(a,c){if("undefined"!=typeof Ext&&"undefined"!=typeof Shepherd){var g=new Ext.Element(Ext.getDom("container_bubble"));g.setSize(500,100);g.center();Shepherd.getHelper("bubble").getBubble().wrapper.style.top=Position.realOffset($("body_content"))[1]+50;new Ext.Panel({id:"noFlashPanel",border:!1,buttonAlign:"center",renderTo:a,frame:!1,bodyStyle:"text-align:center;margin-bottom:20px;",html:c.adobeFlashVersionLbl,buttons:[new Ext.Button({text:c.downloadAdobeLbl,handler:function(){window.open("http://www.adobe.com/go/getflashplayer")}}),
new Ext.Button({text:c.closeDialogLbl,hidden:!Ext.fly(a).up("div#container_bubble"),handler:function(){Shepherd.run("bubble","hide")}})]})}else a.innerHTML="\x3cfont style\x3d'text-align:center' color\x3d'#000'\x3e"+c.adobeFlashVersionLbl+" "+c.downloadAdobeLinkLbl+"\x3cbr/\x3e\x3ca href\x3d'http://www.adobe.com/go/getflashplayer' target\x3d'_blank'\x3ehttp://www.adobe.com/go/getflashplayer\x3c/a\x3e\x3c/font\x3e"}
function insertFlexComponent(a,c,g,d,b,e,f,l,m,n){var h="string"==typeof e?document.getElementById(e):e;isIPad||isIPhone?doIPadIPhonePreview(h,a,c,g,d,b,e,f,l,m,n):(e=detectFlashVer(6,0,65),l=detectFlashVer(9,0,115),e&&!l?showDownloadLink(h,m):l?ac_FL_RunContent("src",a,"FlashVars",c,"width",g,"height",d,"align","middle","id",f,"quality","high","bgcolor",b,"name",f,"allowScriptAccess","sameDomain","allowFullScreen","true","type","application/x-shockwave-flash","pluginspage","http://www.adobe.com/go/getflashplayer",
"wmode","opaque","parent",h):showDownloadLink(h,m))}function closeContentPreviewDialog(){if(window.dialog&&"docViewerOverlay"===window.dialog.id)window.dialog.hide();else if(sfdcPage){var a=sfdcPage.getDialogById("docViewerOverlay");a&&a.hide()}};
Ext.ns("Ninja.Flex");
Ninja.Flex.FlexCoverflow={getApp:function(){return getFlexRoot("Coverflow")},showPreview:function(c){if(Sfdc.ChatterFiles||"undefined"==typeof Shepherd){var b=ChatterFilesConstants.OVERLAY_ID,g=ChatterFilesConstants.DOC_VIEWER_OVERLAY_CLASS,h=ChatterFilesConstants.DOC_VIEWER_CONTAINER_PARENT_CLASS,e=ChatterFilesConstants.DOC_VIEWER_CONTAINER_PARENT_CLASS,f=ChatterFilesConstants.CONTAINER_ID,k=ChatterFilesConstants.CONTAINER_ID,d=Sfdc.Window.getWindowWidth(),a=Sfdc.Window.getWindowHeight(),d=d-40,
a=a-20-48;width=730<d?d:730;height=480<a?a:480;null===Ext.get(b)?(a=new AccessiblePreviewContentDialog(b),a.extraClass=g,a.content="\x3cdiv id\x3d'"+e+"' class\x3d'"+h+"'\x3e\x3cdiv id\x3d'"+f+"' class\x3d'"+k+"'\x3e\x3c/div\x3e\x3c/div\x3e",a.created=!0,a.register(),Ext.get(e).setHeight(height),Ext.get(b).setWidth(width),a.show(),Ext.get(b).setStyle("left","10px")):(a=OverlayDialogElement.getDialog(b),a.setTitle(""),Ext.get(e).setHeight(height),Ext.get(b).setWidth(width),Ext.getBody().setStyle("overflow",
"auto"),a.show());b=chatter&&chatter.getToolbox()?chatter.getToolbox().sitePrefix():"";insertFlexComponent(Ninja.Flex.ContentStaticResourcesBase+"/flex/DocViewer","shepherd_prefix\x3d"+b+Ninja.Flex.ShepherdController+"\x26v\x3d"+c+"\x26mode\x3dbubble\x26in_tests\x3dfalse","100%","100%","#f3f3f3",f,"renditionLarge",!1,{adobeFlashVersionLbl:LC.getLabel("ContentFlashPlayer","adobeFlashVersion"),downloadAdobeLbl:LC.getLabel("ContentFlashPlayer","downloadAdobe"),downloadAdobeLinkLbl:LC.getLabel("ContentFlashPlayer",
"downloadAdobeLink"),closeDialogLbl:LC.getLabel("ContentFlashPlayer","closeDialog")})}else Shepherd.run("document","viewRenditionLarge",{selectedVersionId:c})},showDetails:function(c){Sfdc.ChatterFiles||"undefined"==typeof Shepherd?navigateToUrl(UserContext.getUrl("/"+c)):Shepherd.run("document","view",{selectedDocumentId:c})}};Ninja.Flex.ContentStaticResourcesBase="/sfc";Ninja.Flex.ShepherdController="/sfc/servlet.shepherd";
function ActionProgressDialog(b,a,d,c){this.id=b;this.url=a;this.escapeParams=d;this.parentId=c;this.isModal=!0;this.width=480;this.progressMsgText=this.progressMsgTitleTooltip=this.progressMsgTitle="";this.displayX=!1;this.addEvents();this.helpUrl=null}ActionProgressDialog.prototype=new OverlayDialog;ActionProgressDialog.prototype.hide=function(){OverlayDialog.prototype.hide.apply(this,[]);this.createContent()};
ActionProgressDialog.prototype.createContent=function(){var b=document.getElementById(this.getContentId()),a=[];a.push("\x3cdiv id\x3d'actionProgressPanel' class\x3d'actionProgressPanel'\x3e");if(this.helpUrl){var d=LC.getLabel("ChatterFileMultiUpload","helpWithUploading"),c=LC.getLabel("ChatterFileMultiUpload","helpWithUploading")+"\x26nbsp;"+LC.getLabel("Global","new_window");a.push('\x3cdiv class\x3d"pageHelpIconPanel"\x3e');a.push('\x3ca class\x3d"helpLinkElement" id\x3d"uploadHelpLinkElement" href\x3d"'+
this.helpUrl+'"\x3e');a.push('\x3cspan class\x3d"helpLink"\x3e'+d+"\x3c/span\x3e");a.push('\x3cimg src\x3d"/s.gif" class\x3d"helpIcon" alt\x3d"'+c+'" title\x3d"'+c+'"\x3e');a.push("\x3c/a\x3e");a.push("\x3c/div\x3e")}a.push("\x3cdiv id\x3d'contentContainer'\x3e");a.push("\x3cdiv id\x3d'progressIcon'\x3e\x3c/div\x3e");a.push("\x3cdiv id\x3d'progressMsgContainer'\x3e");a.push("\x3cp id\x3d'progressMsgTitle' title\x3d\""+this.progressMsgTitleTooltip+'"\x3e'+this.progressMsgTitle+" ");a.push("\x3c/p\x3e");
a.push("\x3cp id\x3d'progressMsgText'\x3e"+this.progressMsgText+"\x3c/p\x3e");a.push("\x3c/div\x3e\x3cdiv class\x3d'clear'\x3e\x3c/div\x3e");a.push("\x3c/div\x3e\x3c/div\x3e");this.createButtons(a);b.innerHTML=a.join("");this.clearButtons();this.addButtonBar()};ActionProgressDialog.prototype.addButtonBar=function(){};ActionProgressDialog.prototype.setProgressMsgTitle=function(b,a){this.progressMsgTitle=b;this.progressMsgTitleTooltip=a};
ActionProgressDialog.prototype.setProgressMsgText=function(b){this.progressMsgText=b};ActionProgressDialog.prototype.setHelpUrl=function(b){this.helpUrl=b};
PublisherAutoComplete=function(){};PublisherAutoComplete.prototype.getInputWithEncodedAtMentions=function(){return""};
Sfdc.provide("Sfdc.RechatComposer",{RechatToFollowersHelper:function(){},RechatToGroupHelper:function(){},RechatTargetSelector:function(){}});
(function(){Sfdc.provide("SfdcApp.Chatter.FormHandler",{errorCount:0,hideErrors:function(b){Sfdc.each(Sfdc.select(".errorMsg",b),function(a){Sfdc.Dom.hideByDisplay(a)})},addErrors:function(b,a){chatter.getToolbox();a&&Sfdc.each(Object.keys(a),function(c){var d=Sfdc.get("."+c,b);Sfdc.Dom.updateHTML(d,a[c]);Sfdc.Dom.show(d)})},disableButtons:function(b){Sfdc.each(Sfdc.select("input.btn",b),function(a){chatter.getToolbox().disableButton(a)})},disableSubmit:function(b){this.errorCount++;0<this.errorCount&&
Sfdc.each(Sfdc.select("input.saveBtn",b),function(a){chatter.getToolbox().disableButton(a)})},enableButtons:function(b){Sfdc.each(Sfdc.select("input.btn",b),function(a){Sfdc.Dom.hasClass(a,"btnNoEnable")||chatter.getToolbox().enableButton(a)})},enableSubmit:function(b){this.errorCount--;0>=this.errorCount&&(this.errorCount=0,Sfdc.each(Sfdc.select("input.saveBtn",b),function(a){chatter.getToolbox().enableButton(a)}))},submit:function(b,a,c){this.disableButtons(b);this.hideErrors(b);var d=sfdcPage.dirtyState!==
GenericSfdcPage.STATE_CLEAN,e=this;chatter.getToolbox().post({url:a,params:c,failure:function(a,f){e.enableButtons(b);e.addErrors(b,f.errors);c.failure&&c.failure(a,f);d&&sfdcPage.updateDirtyState(GenericSfdcPage.STATE_ERROR)},success:function(a,b){chatter.getToolbox().navigateTo(b.url)}})},getCheckedValue:function(b){for(var a=0;a<b.length;a++)if(b[a].checked)return b[a].value}})})();
Sfdc.provide("SfdcApp.Chatter.SubscribeButton",{onHover:function(){},onKeyUp:function(){},onClick:function(){return!1}});
function getOpenDialog(){for(var a in sfdcPage.dialogs)if(sfdcPage.dialogs.hasOwnProperty(a)){var b=sfdcPage.dialogs[a];if(b.isOpen)return b}}function closeDialog(a){var b=getOpenDialog();b&&b.close();a&&(Sfdc.userAgent.isSafari3?window.location.href=window.location.href:window.location.reload())}function resizeDialog(a,b){var d=getOpenDialog();d&&d.resize(a,b)}function CollaborationAccessibleDialogHelper(){}CollaborationAccessibleDialogHelper.addUrlObserver=function(a){CollaborationAccessibleDialogHelper.urlObservers.push(a)};
CollaborationAccessibleDialogHelper.urlObservers=[];CollaborationAccessibleDialogHelper.transformUrl=function(a){for(var b=0;b<CollaborationAccessibleDialogHelper.urlObservers.length;b++)a=CollaborationAccessibleDialogHelper.urlObservers[b](a);return a};function CollaborationAccessibleDialog(a,b,d,e,c){this.id=a;this.contentId=a+"ContentId";this.height=e;this.url=d;""!==c&&void 0!==c&&(this.width=parseInt(c,10));this.register();Ext.fly(window).on("focus",function(){closeDialog()})}
CollaborationAccessibleDialog.prototype=new SimpleDialog;CollaborationAccessibleDialog.prototype.display=function(){for(var a in sfdcPage.dialogs)if(sfdcPage.dialogs.hasOwnProperty(a)){var b=sfdcPage.dialogs[a];b.isOpen&&b.popupWindow.close()}this.popupWindow=window.open(CollaborationAccessibleDialogHelper.transformUrl(this.url),this.id,"height\x3d"+this.height+",width\x3d"+this.width+",location\x3d0,status\x3d0");this.popupWindow.focus();this.isOpen=!0};
CollaborationAccessibleDialog.prototype.resize=function(a,b){this.popupWindow.resizeTo(b,a+100)};CollaborationAccessibleDialog.prototype.close=function(){this.popupWindow.close()};function NonaccessibleDialog(a,b,d,e,c){this.id=a;this.contentId=a+"ContentId";this.displayX=this.isMovable=!0;this.height=e;this.url=d;""!==c&&void 0!==c&&(this.width=parseInt(c,10));this.setTitle(b);this.register()}NonaccessibleDialog.prototype=new SimpleDialog;
NonaccessibleDialog.prototype.display=function(){var a=[];a.push('\x3ciframe frameborder\x3d"no" id\x3d"'+this.contentId+'" style\x3d"border:0;height:'+this.height+"px;width:"+(Sfdc.userAgent.isIE6?"93%":"100%")+';" src\x3d"'+CollaborationAccessibleDialogHelper.transformUrl(this.url)+'"\x3e\x3c/iframe\x3e');this.setContentInnerHTML(a.join(""));this.show();this.setWidth(this.width)};NonaccessibleDialog.prototype.resize=function(a,b){document.getElementById(this.contentId).style.height=a+"px";this.setWidth(b)};
NonaccessibleDialog.superclass=SimpleDialog.prototype;NonaccessibleDialog.prototype.hide=function(){var a=this.getContentElement().firstChild.contentWindow;try{a.closePopup&&a.closePopup()}catch(b){}finally{NonaccessibleDialog.superclass.hide.call(this)}};NonaccessibleDialog.prototype.close=function(){this.hide()};
var chatter=new function(){function g(){function b(){function b(){document.title=c?l:g;c&&h++;c=!c;h<=d?a=setTimeout(b,k):document.title=g}var c=!0;b()}function c(){clearTimeout(a);document.title=l;h=0}var a,k,d,h=0,f=chatter.getEventBus(),l=document.title,g=LC.getLabel("Feeds","pageTitleFlipMessage");this.init=function(a,h){f.addEventListener("chatter:feed","onAfterLiveFeedMessageShown",b);f.addEventListener("chatter:feed","onAfterFeedRefresh",c);k=a;d=h}}function d(){function b(a){Ext.get("notFavorited").addClass("hidden");
var b=Ext.get("alreadyFavorited");b.removeClass("hidden");b.set({feedFavoriteId:a});a=!!Sfdc.select("#Chatter_Tab:first-child").length;HelpBubble.display({parentDiv:"Chatter_Tab",pointerDirection:a?HelpBubble.BOTTOMLEFT:HelpBubble.BOTTOM,contentText:LC.getLabel("FeedFavorites","SavedFeedFavoriteBubble"),hideCloseX:!0,additionalClass:"feedFavoriteHelpBubble",fadeInCallBackFn:function(){setTimeout("HelpBubble.hideBubble('feedFavoriteHelpBubble');",3E3)}})}this.remove=function(a){omnitureWrapper.trackEvent(chatter.getOmnitureEventMap().removeFavorite);
Perf.mark("DeleteFeedFavoriteStart");var b=a.name,c=!0;a.noalert||(b=LC.getLabel("Feeds","FeedFavoriteDeleteAlert",b),c=confirm(b));c&&chatter.getToolbox().post({url:"/feed/favorites/"+a.feedFavoriteId+";delete",params:a,success:function(){var b=Ext.get("feedFavoriteDelete{0}".replace("{0}",a.feedFavoriteId));b&&(b=Sfdc.Dom.getParent(b.dom,"li"),Sfdc.Dom.hasClass(b,"selected")&&chatter.getNavigationGroups().getAssociatedGroup("chatterTabNavigation").mainNavigation.selectDefaultItem(!0),Sfdc.Dom.removeChild(b));
a.calledByWidget&&(Ext.get("alreadyFavorited").addClass("hidden"),Ext.get("notFavorited").removeClass("hidden"));Perf.endMark("DeleteFeedFavoriteStart")}})};var c=this.add=function(a){omnitureWrapper.trackEvent(chatter.getOmnitureEventMap().addFavorite);chatter.getToolbox().post({url:"/feed/favorite/term;create",params:a,success:function(c,d){a.calledByWidget&&b(d.feedFavoriteId)}})};this.addFavoriteFromSearchResult=function(a){c({searchText:a,calledByWidget:!0,type:"S"})};this.addFavoriteFromListView=
function(a,b){c({entityId:a,calledByWidget:!0,name:b,type:"L"})};this.addFavoriteFromTopic=function(a,b){c({entityId:a,calledByWidget:!0,name:b,type:"T"})};this.widgetRemove=function(){var b=Ext.get("alreadyFavorited").dom.getAttribute("feedFavoriteId");chatter.getFeedFavoriteHelper().remove({feedFavoriteId:b,noalert:!0,calledByWidget:!0})};this.favoriteDeleteRemoveZenAssist=function(b){b=Sfdc.get(".delete",b);chatter.getToolbox().removeZenAssist(b)};this.favoriteDeleteAddZenAssist=function(b){b=
Sfdc.get(".delete",b);chatter.getToolbox().addZenAssist(b)}}function r(){var b=0,c,a,k=!1,d="idle",h=chatter.getEventBus();h.addEventListener("chatter:feed","onAfterShowMoreFeedItems",function(){d="idle"});h.addEventListener("chatter:feed","onAfterFeedRefresh",function(){b=0;d="idle";k=!1});this.init=function(f){c=f.max||3;a=f.factor||0.75;Ext.EventManager.on(window,"scroll",function(){if(chatter.isFeedVisible()){var f=(Ext.get("contentWrapper")||Ext.get("bodyInner")||Ext.getBody()).getHeight();if(Ext.get(document).getScroll().top+
(Ext.isIE?document.documentElement.clientHeight:window.innerHeight)>f*a&&(!(b>=c)&&!k)&&"processing"!=d)d="processing",f=Ext.select("div.showmorefeeditemscontainer a").elements,1==f.length?(f[0].onclick(),b+=1):(k=!0,d="idle")}})};this.getMax=function(){return c};this.resetShownCount=function(){b=0};this.isReachedMaxExecutions=function(){return b>=c}}function s(){this.onMouseOver=function(b){b=Ext.get(b);b.hasClass("newFeedItemsMessageHover")||b.addClass("newFeedItemsMessageHover")};this.onMouseOut=
function(b){b=Ext.get(b);b.hasClass("newFeedItemsMessageHover")&&b.removeClass("newFeedItemsMessageHover")}}function m(){StringBuffer=function(){this.buffer=[];this.append=function(b){this.buffer.push(b);return this};this.toString=function(){return this.buffer.join("")}};return new StringBuffer}function p(){function b(e){chatter.isInvalidSession(e.responseText)&&(f.log("Handling redirect"),chatter.getToolbox().refresh())}function c(e){var a=e.params||{},c=e.dieSilently||!1,k=u.sitePrefix()+f.apiurl()+
(e.url||"");f.log("XHR request "+e.method+" "+k+(a.q?a.q:""));Ext.each(chatter.getConfig().getUrlObservers(),function(e){k=e(k);return!0});f.log("Rewritten URL: "+k);var d=f.now(),l;m&&(l=["XHR ",e.method,": ",a.q?k+"?q\x3d"+a.q:k].join(""),Perf.mark(l));y&&(a.trace="sqltrace");a={url:k,params:a,method:e.method,headers:e.headers,timeout:e.timeout||6E4,callback:null,failure:function(a){var q=f.now();f.log("Request completed in "+(q-d)+"ms");if(c)f.log("Request to "+k+" failed.");else{var h;try{h=f.evalJson(a.responseText)}catch(l){f.log("Oops, an error occurred parsing JSON: "+
l+" from text"+a.responseText),h={},b(a)}f.xhrFailure(a,h);if(e.failure)try{e.failure(a,h)}catch(g){f.log("Failure handler caught an exception: "+g)}h.redirecturl&&f.navigateTo(h.redirecturl)}},success:function(a){var c=f.now();f.log("Request completed in "+(c-d)+"ms");var h;try{h=f.evalJson(a.responseText)}catch(q){f.log("Oops, an error occurred parsing JSON: "+q+" from text"+a.responseText),h={},b(a)}if(e.success)try{e.success(a,h),f.log("Success handler completed in "+(f.now()-c)+"ms")}catch(k){f.log("Success handler caught an exception: "+
k),e.failure&&e.failure(a,{}),f.log("Success handler completed with failure in "+(f.now()-c)+"ms")}m&&Perf.endMark(l)}};e.form&&(a.form=e.form);Ext.Ajax.defaultHeaders={Authorization:f.token()};var g=e.abortTargets;if(g&&Sfdc.isArray(g))for(var t=0;t<g.length;t++)Ext.Ajax.abort(h[g[t]]);e.ajaxInstanceKey?h[e.ajaxInstanceKey]=Ext.Ajax.request(a):Ext.Ajax.request(a)}function a(e,a){for(var b=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/ig,c=/\ssrc=([\'\"])(.*?)\1/i,f,h,k=[],d=[],l=function(){for(;k.length;)window.execScript?
window.execScript(k.shift()):window.eval(k.shift());Sfdc.isFunction(a)&&a()};f=b.exec(e);)(h=(h=f[1])?h.match(c):!1)&&h[2]?d.push(h[2]):f[2]&&0<f[2].length&&k.push(f[2]);d.length?Sfdc.Resource.addJavaScripts(d,l):l()}function k(e,b,c){Ext.lib.Event.onAvailable(c,function(){a(e,b)})}function d(e){return Array(e.length-1).join("\x26nbsp;")+" "}var h={},f=this,l=null,g="",m=window.Perf&&Perf.enabled,y=!1,n;this.enableSqlTrace=function(){y=!0};this.disableSqlTrace=function(){y=!1};this.handleRedirect=
function(e){b(e)};this.log=function(e){"undefined"!=typeof console&&"undefined"!=typeof console.info&&console.info(e)};this.now=function(){return(new Date).getTime()};this.disableButton=function(e){e=f.returnHtmlElementIfExtElement(e,"disableButton");Sfdc.Dom.addClass(e,["btnDisabled",ZenCss.disabledBtn]);f.disable(e)};this.enableButton=function(e){e=f.returnHtmlElementIfExtElement(e,"enableButton");Sfdc.Dom.removeClass(e,["btnDisabled",ZenCss.disabledBtn]);f.enable(e)};this.addZenAssist=function(e){e&&
Sfdc.Dom.addClass(e,"zen-assistiveText")};this.removeZenAssist=function(e){e&&Sfdc.Dom.removeClass(e,"zen-assistiveText")};this.removeClassOnMouseOut=function(e,a,b){Sfdc.Event.mouseExited(e,a)&&Sfdc.Dom.removeClass(a,b)};this.expandableTextArea=function(e,a,b){Sfdc.on(e,Sfdc.userAgent.isIE8||Sfdc.userAgent.isIE7?"keyup":"input",this.updateHeight.bind(this,e,a,a*b))};this.updateHeight=function(e,a,b){Sfdc.isDefAndNotNull(n)||(n=Sfdc.Dom.create(document.body),Sfdc.Dom.addClass(n,"shadowDiv"));a=n;
var c=Sfdc.Dom.getStyles(e,"paddingTop paddingBottom paddingLeft paddingRight lineHeight fontSize fontStyle fontWeight fontFamily wordWrap".split(" ")),f=parseInt(c.paddingLeft)||0,h=parseInt(c.paddingRight)||0;c.width=Sfdc.Dom.getWidth(e)-(f+h)+"px";Sfdc.Dom.setStyles(a,c);c=e.value;Sfdc.Dom.updateHTML(a,c.replace(/<|>|&/g,"\x26lt;").replace(/\n$/,"\x3cbr/\x3e\x26nbsp;").replace(/\n/g,"\x3cbr/\x3e\x26nbsp;").replace(/ {2,}/g,d));a.value=c;a=Sfdc.Dom.getActualHeight(a);a<b&&(a=b);if(a!==parseInt(e.style.height||
0))e.style.height=a+"px"};this.initializeIE8JPNTypingFix=function(e){if(Sfdc.userAgent.isIE8&&"ENTITY"===chatter.getFeed().getConfig().feedType){var a=Sfdc.get("bodyTable");a&&(Sfdc.Event.add(e,"focus",function(){a.width=a.offsetWidth+"px";Sfdc.Dom.addClass(a,"recordTableBodyIE8Fix")}),Sfdc.Event.add(e,"blur",function(){a.width="100%";Sfdc.Dom.removeClass(a,"recordTableBodyIE8Fix")}))}};this.disable=function(){Sfdc.Array.forEach(Sfdc.Array.toArray(arguments),function(e){f.returnHtmlElementIfExtElement(e,
"disable").disabled=!0})};this.enable=function(){Sfdc.Array.forEach(Sfdc.Array.toArray(arguments),function(e){f.returnHtmlElementIfExtElement(e,"enable").disabled=!1})};this.poll=function(e){e=new z(e);e.start();return e};this.xhrFailure=function(e,a){var b;b="XHR Failure."+(a&&a.errorid?" Error ID: "+a.errorid+". ":"");b+="\nResponse text:\n"+e.responseText;f.log(b);a&&a.errormessage&&alert(a.errormessage)};this.stopPropagation=function(e){e=e||event;e.stopPropagation?e.stopPropagation():e.cancelBubble=
!0};this.stringIsEmpty=function(e){return 0==e.replace(/\s+$/g,"").length};this.stringTrim=function(e){return e.replace(/^\s+|\s+$/g,"")};this.setToken=function(e){l=e};this.token=function(){return l};this.apiurl=function(){return"/chatter/handlers"};this.setImageSrc=function(e,a){var b=Sfdc.Dom.get(e,"src");return!b||a!==Sfdc.Url.stripDomainFromUrl(b)?(Sfdc.Dom.set(e,{src:a}),!0):!1};this.setSitePrefix=function(e){g=e};this.sitePrefix=function(){return""!==g?g:UserContext.siteUrlPrefix?UserContext.siteUrlPrefix:
""};this.evalJson=function(e){return Util.evalAjaxServletOutput(e)||{}};this.get=function(e){e.method="GET";c(e)};this.post=function(e){e.method="POST";c(e)};this.navigateTo=function(e,a){navigateToUrl(e,"CHATTER",a)};this.refresh=function(){f.navigateTo(window.location)};this.showMoreDescription=function(a){a=Ext.get(a).parent(".chatterDescription");a.child(".truncatedDescription").remove();a.child(".fullDescription").enableDisplayMode().show()};this.htmlEncode=function(a){return!a?a:String(a).replace(/&/g,
"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;")};this.htmlDecode=function(a){return!a?a:String(a).replace(/&gt;/g,"\x3e").replace(/&lt;/g,"\x3c").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"\x26")};this.getEmptyPublisherHTML=function(){return emptyPublisherHTML};this.hide=function(a){if(!Ext.isEmpty(a))return a.setVisibilityMode(Ext.Element.DISPLAY).hide()};this.show=function(a){if(!Ext.isEmpty(a))return a.setVisibilityMode(Ext.Element.DISPLAY).show()};
this.runScriptReturnHtml=function(a,b,c){a=a||"";var f=Ext.id();a+='\x3cspan id\x3d"'+f+'"\x3e\x3c/span\x3e';k(a,function(){var a=Sfdc.get(f);a&&Sfdc.Dom.removeChild(a);Sfdc.isFunction(b)&&b()},f);!0!==c&&(a=a.replace(/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,""));return a};this.updateHTMLFromConfig=function(a){var b=a.el,c=a.callback;if(!b)return b;b.dom&&(b=b.dom);var f=a.html||"";if(!0!==a.loadScripts)return b.innerHTML=f,Ext.isFunction(c)&&c(),b;b.innerHTML=this.runScriptReturnHtml(f,c,a.leaveScripts);
return b};this.updateHTML=function(a,b,c,f){this.updateHTMLFromConfig({el:a,html:b,loadScripts:c,callback:f})};this.fixIE7Haslayout=function(a){Sfdc.userAgent.isIE7&&setTimeout(function(){a.style.display="block"},0)};this.mask=function(a,b,c){var f=Ext.Element.data,h=a.dom,k=Ext.DomHelper,d;!/^body/i.test(h.tagName)&&"static"==a.getStyle("position")&&a.addClass("toolkit-masked-relative");(d=f(h,"maskMsg"))&&d.remove();(d=f(h,"mask"))&&d.remove();d=k.append(h,{cls:"toolkit-el-mask",onclick:"chatter.getToolbox().stopPropagation(event); return false;"},
!0);f(h,"mask",d);a.addClass("toolkit-masked");d.setDisplayed(!0);"string"==typeof b&&(k=k.append(h,{cls:"toolkit-el-mask-msg",cn:{tag:"div"}},!0),f(h,"maskMsg",k),k.dom.className=c?"toolkit-el-mask-msg "+c:"toolkit-el-mask-msg",k.dom.firstChild.innerHTML=b,k.setDisplayed(!0),k.center(a));Ext.isIE&&((!Ext.isIE7||!Ext.isStrict)&&"auto"==a.getStyle("height"))&&this.setSize(d,void 0,a.getHeight());return d};this.unmask=function(a){var b=Ext.Element.data,c=a.dom,f=b(c,"mask"),h=b(c,"maskMsg");f&&(h&&
(h.remove(),b(c,"maskMsg",void 0)),f.remove(),b(c,"mask",void 0),a.removeClass(["toolkit-masked","toolkit-masked-relative"]))};this.setSize=function(a,b,c,f){"object"==typeof b&&(c=b.height,b=b.width);b=a.adjustWidth(b);c=a.adjustHeight(c);!f||!a.anim?(a.dom.style.width=a.addUnits(b),a.dom.style.height=a.addUnits(c)):a.anim({width:{to:b},height:{to:c}},a.preanim(arguments,2));return a};this.isVisible=function(a,b){var c=!a.isStyle("visibility","hidden")&&!a.isStyle("display","none"),f=a.dom.parentNode,
h=chatter.getToolbox();if(!0!==b||!c)return c;for(;f&&!/body/i.test(f.tagName);){if(!h.isVisible(Ext.fly(f,"_isVisible")))return!1;f=f.parentNode}return!0};this.getStyles=function(a,b){var c={};Ext.each(b,function(b){c[b]=a.getStyle(b)},a);return c};this.validateTextFieldLength=function(a,b){var c=Ext.get(a),f=c.getValue().length>b.maxlength,h=c.hasClass("maxlengthfielderror"),k=chatter.getToolbox();f!=h&&(h=c.parent().child(".errorMsg"),null==h&&(h=c.parent().child(".zen-errorMessage")),f?(k.updateHTML(h,
b.msg),k.show(h),c.addClass("maxlengthfielderror"),c=a.form,SfdcApp.Chatter.FormHandler.disableSubmit(c)):(k.hide(h),c.removeClass("maxlengthfielderror"),c=a.form,SfdcApp.Chatter.FormHandler.enableSubmit(c)))};this.getPerfEnabled=function(){return m};this.getElementErrorContainer=function(a){return a.parent("div").child(".errorMsg")};this.validateElement=function(a,b,c){if(b())return a.addClass("hidden"),!0;this.updateHTML(a,c);a.removeClass("hidden");return!1};this.wireFieldChange=function(a,b,c){a.on("keyup",
b);if(!c)a.on("blur",b);a.on("paste",function(){b.defer(10)});a.on("cut",function(){b.defer(10)})};this.dismissMessage=function(a,b,c){Ext.get(a).remove();UserContext.userPreferences.setBoolean(b,c)};this.returnHtmlElementIfExtElement=function(a,b){return a.dom?(Sfdc.warn("By 182 the method "+b+" will only accept html dom elements. Please stop passing in Ext Elements."),a.dom):a}}function z(b){function c(){var b=chatter.getToolbox();if(0==a.intervalCount){if(a.index>=a.intervals.length){a.run=!1;
b.log("Ending polling sequence: "+a.configName);return}var d=a.intervals[a.index++];a.currentInterval=d[0];a.intervalCount=d[1]}a.intervalCount--;b.log("Polling timeout: "+a.configName+" \x3c"+a.currentInterval+"\x3e");a.pollerId=setTimeout(function(){b.log("Polling: "+a.configName);a.config.callback()&&a.run?c():b.log("Ending polling sequence: "+a.configName)},1E3*a.currentInterval)}var a=this;this.config=b;this.configName=b.name||(new Date).getTime();this.index=0;this.run=!0;this.intervals=b.intervals||
[[90,-1]];this.currentInterval=90;this.intervalCount=-1;this.pollerId=null;this.start=function(){if(!a.pollerId){chatter.getToolbox().log("Starting to poll: "+a.configName);a.index=0;a.run=!0;var b=a.intervals[a.index++];a.currentInterval=b[0];a.intervalCount=b[1];c()}};this.stop=function(){a.pollerId&&(chatter.getToolbox().log("Stopping polling of: "+a.configName),clearTimeout(a.pollerId),a.pollerId=null)}}function A(){var b=function(b){b=Ext.get(b).parent(".cxchattertextareacontainer");return{parent:b,
messageContainer:b.child(".cxchattermessagecontainer")}};this.enableSubmitButtonIfNoErrorsInternal=function(b,a){var k=Sfdc.Dom.getParent(b,".feeditemcommentnew");0===Sfdc.select(".cxchattertextareaerror",k).length&&u.enableButton(a)};this.isMessageDisplayed=function(b,a){return!!Ext.get(b+"_"+a)};this.showMessage=function(c){var a=c.el,k=chatter.getToolbox(),d=b(a),a=a+"_"+c.msg_id,h=document.getElementById(a);h||(h=document.createElement("div"),h.id=a,1==c.type?(h.className="cxchattertextareaerror chattertextareaerror",
d.parent.addClass("chattertextareahaserror")):h.className="chattertextareanotice",c.append||(d.messageContainer.dom.innerHTML=""),h.innerHTML=c.msg_html,d.messageContainer.appendChild(h));k.show(d.messageContainer);return h.id};this.hideMessage=function(c){var a=c.el,k=b(a),d=!0,h=c.hideAll||!1;if((c=document.getElementById(a+"_"+c.msg_id))||h)return a=chatter.getToolbox(),h?(Sfdc.Dom.setText(k.messageContainer.dom,""),a.hide(k.messageContainer),d=!1):(Ext.fly(c).remove(),0===k.messageContainer.query(".cxchattertextareaerror").length&&
(d=!1,0===k.messageContainer.query("div").length&&a.hide(k.messageContainer))),d||k.parent.removeClass("chattertextareahaserror"),d}}function N(){this.NODE_TYPES={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION_NODE:12};this.insertBreak=function(){if(document.selection){var b=document.selection.createRange();b.pasteHTML("\x3cbr/\x3e");b.moveEnd("character",1);b.collapse();b.select()}};
this.isText=function(b){return b.nodeType===this.NODE_TYPES.TEXT};this.isBreak=function(b){var c,a;try{if(c=(new String(b.nodeName)).toUpperCase(),a=b.nodeType,"BR"==c||"BR"==a)return!0}catch(k){}return!1};this.getContentValue=function(b){for(var c="",a=this.NODE_TYPES,k=a.TEXT,d=a.CDATA_SECTION,a=a.COMMENT,h=0,f=b.length;h<f;h++){var l=b[h];l.nodeType===k||l.nodeType===d?c+=l.nodeValue:this.isBreak(l)?c+="\n":this.isMention(l)?c+="{@"+l.name+"}":l.nodeType!==a&&(c+=this.getContentValue(l.childNodes))}return c};
this.toArray=function(b){for(var c=[],a=0,k=b.length;a<k;a++)c[a]=b[a];return c};this.getText=function(b){for(var c="",a=this.NODE_TYPES,k=a.TEXT,d=a.CDATA_SECTION,a=a.COMMENT,h=0,f=b.length;h<f;h++){var l=b[h];l.nodeType===k||l.nodeType===d?c+=l.nodeValue:l.nodeType!==a&&(c+=this.getText(l.childNodes))}return c};this.getCaretLocation=function(b){if("number"===typeof b.selectionStart)return b.selectionStart;if(document.selection){b.focus();var c=document.selection.createRange();if(null==c)return 0;
var a=b.value.replace(/(\r\n)+$/,""),k=c.duplicate();k.moveToElementText(b);k.setEndPoint("StartToStart",c);return a.length-k.text.length}return 0};this.setCaretLocation=function(b,c){if(document.selection){var a=b.createTextRange();a.collapse(!0);a.moveEnd("character",c);a.moveStart("character",c);a.select()}else if(b.selectionStart||"0"==b.selectionStart)b.selectionStart=c,b.selectionEnd=c,b.focus()};this.getValue=function(b){return b.value}}function O(){var b=new Sfdc.Event.EventManager;b.onError=
function(b){Sfdc.sendGack("CHATTEREVENTBUS",b)};this.addEventListener=function(c,a,k,d){b.add(this,c+":"+a,k,d||this)};this.fireEvent=function(c,a,k){var d=chatter.getToolbox().now();b.fireEvent(this,c+":"+a,{data:k});var h=chatter.getToolbox().now(),f=m();f.append("CEB EVENT! ns\x3c");f.append(c);f.append("\x3e en\x3c");f.append(a);f.append("\x3e pld\x3c");f.append(k);f.append("\x3e exec-time\x3c");f.append(h-d);f.append("\x3e");chatter.getToolbox().log(f.toString())};this.removeEventListener=function(c,
a,k){b.remove(this,c+":"+a,k)}}function w(b){var c=this;this.config=b;this.id=b.id;this.title=b.title||"";this.url=b.url;this.content="";this.height=b.height||400;this.width=b.width||500;this.extraClass=b.extraClass;this.isAbsolutePositioned=this.isDialogPositionAbsolute=b.isDialogPositionAbsolute;Sfdc.userAgent.isIE6||(this.useCSS=!0);this.closeDialog=function(){return(UserContext.isAccessibleMode?window.opener?window.opener:window.parent:window).sfdcPage.getDialogById(c.id).cancel()};this.open=
function(){var a={i:c.subjectId};if(this.config.params)for(var b in this.config.params)a[b]=this.config.params[b];var d=chatter.getToolbox();chatter.getToolbox().get({url:c.url,params:a,success:function(a,b){chatter.getEventBus().fireEvent("chatter:modalOverlay","onBeforeOverlayShown",{});c.content=UserContext.isAccessibleMode?b.html:d.runScriptReturnHtml(b.html);c.display()},failure:function(a,b){b&&!b.errormessage&&alert(LC.getLabel("Feeds","GenericFailureNoGack"))}});if(this.config.onOpen)this.config.onOpen(c.id)}}
function P(){this.toggle=function(b,c){var a=Ext.get(b),k=chatter.getToolbox();if(a){var d=a.dom.getAttribute("entityid");if(d){k.mask(a);var h=!0;a.hasClass("unfollow")&&(h=!1);var f=this;k.post({url:"/subscriptions/"+d+(h?";new":";delete"),params:{entityid:d},failure:function(){k.unmask(a)},success:function(b,d){a&&(k.unmask(a),f.updateFollowActionLink(h,a.dom),c&&Ext.isFunction(c)&&c(b,d));return!1}})}}};this.updateFollowActionLink=function(b,c){var a=Ext.get(c);a.setVisible(!1);b?a.addClass("unfollow"):
a.removeClass("unfollow");var d=a.dom.getAttribute("title"),g=a.dom.getAttribute("revtitle");d&&g&&a.set({title:g,revtitle:d});a.setVisible(!0)}}function Q(){this.wire=function(b){var c=function(a,c){if(c.followersHtml&&c.entityId==b){var d=Ext.select("."+b).filter(".followers");d&&d.hasClass("followers")&&d.replaceWith({html:c.followersHtml})}};chatter.getEventBus().addEventListener("chatter:FollowUnfollow","onAfterFollow",c);chatter.getEventBus().addEventListener("chatter:FollowUnfollow","onAfterUnfollow",
c)}}function R(){this.deleteProfilePhoto=function(b){if(!confirm(LC.getLabel("UserProfilePage","ConfirmPhotoDelete")))return!1;var c=chatter.getToolbox();c.log("delete photo for subject id: "+b);c.post({url:"/profilephoto/"+b+";delete",success:function(){window.location.reload()},failure:function(a,b){b.reloadOnFail&&window.loation.reload()}});return!0}}function S(b,c,a){var d=this;this.pollForPhotoTimeout=function(){clearTimeout(d.timeoutId);chatter.getToolbox().navigateTo(a)};this.pollForPhoto=
function(){var h=chatter.getToolbox(),f=h.now()-g;Ext.Ajax.request({url:h.sitePrefix()+h.apiurl()+"/pollphotoresize/"+b,method:"GET",params:{timeElapsed:f,token:h.token()},success:function(b){200==b.status?(clearTimeout(d.timeoutId),window.opener?(window.opener.closeDialog(!1),window.opener.location=c):(window.parent.closeDialog(!1),window.parent.location=c)):202==b.status?setTimeout("chatter.getPhotoPoller().pollForPhoto()",1E3):(clearTimeout(d.timeoutId),window.location=a)},failure:function(){clearTimeout(d.timeoutId);
window.location=a}})};var g=u.now();setTimeout("chatter.getPhotoPoller().pollForPhoto()",1E3);d.timeoutId=setTimeout("chatter.getPhotoPoller().pollForPhotoTimeout()",6E4)}function T(){function b(){if(Ext.fly("chatterFile"+d)){var a=Ext.fly("chatterFile"+d).dom.value;return a&&""!=a}return!0}var c=chatter.getToolbox(),a=!1,d="",g=new function(){this.decode=function(a){var b=[],c,d,k="",g,n="",e=0;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(e++)),
d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(e++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(e++)),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(a.charAt(e++)),c=c<<2|d>>4,d=(d&15)<<4|g>>2,k=(g&3)<<6|n,b.push(String.fromCharCode(c)),64!=g&&b.push(String.fromCharCode(d)),64!=n&&b.push(String.fromCharCode(k));while(e<a.length);a=b.join("");b="";for(n=g=0;g<a.length;)n=a.charCodeAt(g++),
128>n?b+=String.fromCharCode(n):191<n&&224>n?(e=a.charCodeAt(g++),b+=String.fromCharCode((n&31)<<6|e&63)):(e=a.charCodeAt(g++),c=a.charCodeAt(g++),b+=String.fromCharCode((n&15)<<12|(e&63)<<6|c&63));return b}};this.setDialogAppendix=function(a){d=a};this.resetDialogAppendix=function(){d=""};this.createFromContentHubDocument=function(a,b,c){var d=a.indexOf(":"),k=a.substring(0,d),g=a.substring(d+1);a=chatter.getToolbox().sitePrefix()+chatter.getToolbox().apiurl()+"/chatterfile/";d=b.lastIndexOf(".");
b={fileName:0<d?b.substring(0,d):b,desc:"",fileFullName:b,chubRepositoryId:k,chubDocumentId:g,chubCreateAsExternalFile:c,shareOption_upload:"lst"};this.createUploadFormIfMissing();c={failureHandler:Sfdc.AccessibleUploadFileDialog.getFailureAndErrorHandler(),errorHandler:Sfdc.AccessibleUploadFileDialog.getFailureAndErrorHandler(),successHandler:Sfdc.AccessibleUploadFileDialog.getSuccessHandler()};this.upload(a,b,c)};this.createUploadFormIfMissing=function(){var a="chatterFileForm"+d;Ext.getDom(a)||
Ext.DomHelper.append(Ext.getBody(),"\x3cform style\x3d'display:none' id\x3d'"+a+"'\x3e\x3cinput type\x3d'file' name\x3d'file'/\x3e\x3c/form\x3e",!1)};this.upload=function(a,b,g,m){b=b||{};window.checkSessionTimeout&&checkSessionTimeout();var r=this,y=b.fileName||Ext.get("fileName"+d).getValue(),n=b.desc||""==b.desc||Ext.get("desc"+d).getValue(),e=b.fileFullName||Ext.get("chatterFile"+d).getValue(),q=e.lastIndexOf("."),p="";-1<q&&(p=e.substring(q));var t;t=b.chubRepositoryId?ExternalFileProgressDialog.showOnPostFile("extFileProgress",
b.chubCreateAsExternalFile):FeedPostContentUploadDialog.getDialog("uploadProgressDialog",chatter.getToolbox().htmlEncode(y),p,m);t.show();b.token=c.token();b.fileName=y;b.desc=n;var v=!0,s=(m=Ext.getDom("shareOptionPRIVATE"))?m.checked:!1;Ext.Ajax.request({url:a,params:b,isUpload:!0,form:"chatterFileForm"+d,method:"POST",failure:function(){v=!1;t.hide()},success:function(a){if(a.responseText){v=!1;t.hide();var b=a.responseText.replace(/\r/g,"\n");0==b.indexOf("\x3cpre")&&(b=b.replace(/^<pre[^>]*>/,
"").replace(/<\/pre>$/,""));b.substring(0,AjaxServlet.CSRF_PROTECT.length)!==AjaxServlet.CSRF_PROTECT&&0<=b.indexOf("/img/s.gif")||(!a.responseXML||chatter.isInvalidSession(a.responseXML.location+"")?chatter.getToolbox().refresh():(b=c.evalJson(b),b.html=b.html&&r.getBase64Decoder().decode(b.html),"Failure"===b.message?g&&g.failureHandler&&g.failureHandler.call(this,a,b):"Error"===b.message?(b.errormessage=b.errormessage&&r.getBase64Decoder().decode(b.errormessage),g&&g.errorHandler?g.errorHandler.call(this,
a,b):c.xhrFailure(a,b)):b.errormessage?g&&g.errorHandler?g.errorHandler.call(this,a,b):c.xhrFailure(a,b):g&&g.successHandler&&g.successHandler.call(this,a,b,s)))}}});(function(){v&&Ext.Ajax.request({url:a,method:"POST",failure:function(a,b){v=!1},success:function(a,b){c.handleRedirect(a)}})}).defer(1E4)};this.initValidation=function(c,f,g,m){var r=!f,p=f||Ext.get("fileName"+d),n=g||Ext.get("desc"+d),e=m||Ext.get("reason"+d),q=chatter.getToolbox(),t=q.getElementErrorContainer(n),s=q.getElementErrorContainer(p);
q.updateHTML(t,"");q.updateHTML(s,"");var v;e&&(v=q.getElementErrorContainer(e),q.updateHTML(v,""));var u=LC.getLabel("Publisher","postValueMaxLen",255),w=LC.getLabel("Publisher","postFileNameRequired"),A=LC.getLabel("Publisher","postContentDescriptionMaxLen",1E3),x=LC.getLabel("ChatterFileSharing","postWhatChangedMaxLen",1E3),z=function(){var a=q.stringTrim(p.getValue()).length,d=q.stringTrim(n.getValue()).length,f=q.validateElement(s,function(){return 0<a},w)&&q.validateElement(s,function(){return 255>=
a},u)&&q.validateElement(t,function(){return 1E3>=d},A);if(e)var g=q.stringTrim(e.getValue()).length,f=f&&q.validateElement(v,function(){return 1E3>=g},x);f=f&&b();c&&c.call(this,f)};f=function(){a=!0;return z()};chatter.getToolbox().wireFieldChange(p,f,!0);chatter.getToolbox().wireFieldChange(n,z,!0);g=function(){(!r||b())&&z()};p.on("blur",g);n.on("blur",g);e&&chatter.getToolbox().wireFieldChange(e,f);p.focus()};this.reset=function(b,c,d){this.initFields(c,d);a=c?!0:!1;this.resetFileSelectPanel(b);
b=Ext.get("slideDownError_chatterFileStageTwo");null!==b&&b.setDisplayed(!1);b=Ext.get("slideDownError_chatterLinkPost");null!==b&&b.setDisplayed(!1)};this.initFields=function(a,b){Ext.fly("chatterFile"+d).dom.value="";Ext.fly("fileName"+d).dom.value=a||"";Ext.fly("desc"+d).dom.value=b||"";Ext.fly("reason"+d)&&(Ext.fly("reason"+d).dom.value="");Ext.getDom("shareOptionPUBLIC")&&(Ext.getDom("shareOptionPUBLIC").checked=!0)};this.fileInfoUpdate=function(){var b=Ext.get("fileName"+d),f=""==b.dom.value;
Ext.fly("hiddenFileName"+d).dom.value=Ext.fly("chatterFile"+d).dom.value;if(!a||f){var g=Util.getFileNameFromFileInputUsingJS(Ext.fly("chatterFile"+d).dom),g=Util.convertPathToTitle(g);b.dom.value=g.name;b=c.getElementErrorContainer(b);c.updateHTML(b,"");f&&(a=!1)}};this.resetFileSelectPanel=function(a){var b=this,c={id:"chatterFile"+d,name:"chatterFile"+d,tag:"input",cls:"file",type:"file",size:20};Ext.fly("chatterFile"+d).replaceWith(c);c=Ext.fly("chatterFile"+d);c.dom.onchange=function(){b.fileInfoUpdate();
a&&a.call(this,!0)}};this.getBase64Decoder=function(){return g}}var U=new function(){function b(){return Ext.get("recentFilesPanel")}this.refresh=function(c){b().replaceWith({html:c})};this.isWidgetPresent=function(){return null!==b()};this.getEntityId=function(){return b().child(".entityId").dom.innerHTML}},u,B,C,D,E,F,G,H,I,J,K,L,M,x=this,V={addFavorite:"add-favorite",follow:"follow",filterByTopic:"filter-by-topic",inviteCoWorkers:"invite-coworkers",invite:"invite",inviteSuccess:"invite-success",
joinGroupsSplash:"join-groups-splash",joinGroup:"join-group",post:"post",postFile:"post-file",postLink:"post-link",postComment:"post-comment",postThanks:"post-thanks",removeFavorite:"remove-favorite",showListView:"show-list-view",showDropdownFilter:"show-dropdown-filter",showMainFilter:"show-main-filter",unfollow:"unfollow",unjoinGroup:"unjoin-group"};this.extend=function(b,c,a){function d(){var a=b.charAt(0);return a!==a.toUpperCase()?(h+="\n name has to start with a capital letter.",!1):!0}var g=
"ext_"+b,h="Error extending "+b,f;x.hasOwnProperty("get"+b)?(h+="\n'"+g+"' already exists in the chatter object",f=!0):f=!1;!f&&d()?x["get"+b]=function(){x[g]||(x[g]=new c(a));return x[g]}:alert(h)};this.getPageTitleController=function(){L||(L=new g);return L};this.getAutoShowOlder=function(){K||(K=new r);return K};this.createModalOverlay=function(b){return new w(b)};this.getFeedFavoriteHelper=function(){M||(M=new d);return M};this.getRecentFiles=function(){return U};this.isInvalidSession=function(b){return b.match("ec\x3d302")};
this.getToolbox=function(){u||(u=new p);return u};this.getTextareaMessageUtil=function(){C||(C=new A);return C};this.getTextUtil=function(){B||(B=new N);return B};this.getEventBus=function(){D||(D=new O);return D};this.getModalOverlay=function(b){var c=window[b];if((!c||!c.closeDialog)&&window.opener)c=window.opener[b];return c};this.getFeedUpdatesMessage=function(){J||(J=new s);return J};this.getFollowUnfollowListAction=function(){E||(E=new P);return E};this.getFollowersPanel=function(){G||(G=new Q);
return G};this.getProfilePhoto=function(){F||(F=new R);return F};this.getPhotoPoller=function(b,c,a){H||(H=new S(b,c,a));return H};this.getFileUploader=function(){I||(I=new T);return I};this.isFeedVisible=function(){var b=Sfdc.get(".feedcontainer");return b?Sfdc.Dom.isVisible(b,!0):!1};this.notifyFrameActive=function(){if(Ext.isGecko){var b=Ext.get("chatterexpando").dom;if("none"!=b.style.display){var c=document.createElement("div");b.parentNode.insertBefore(c,b);c.appendChild(b);c.parentNode.insertBefore(b,
c);Ext.removeNode(c)}}};this.getOmnitureEventMap=function(){return V};this.onDeferLoad=function(b){Sfdc.on(this,"chatter:onDeferLoad",b)};w.prototype=new AccessibleDialog({});w.prototype.display=function(){UserContext.isAccessibleMode||this.createContent();this.show();if(this.isDialogPositionAbsolute&&!UserContext.isAccessibleMode){(Sfdc.userAgent.isFirefox?document.body.style:document.documentElement.style).overflow=Sfdc.userAgent.isIE7?"":"visible";var b=Sfdc.Window.getScrollY(),c=Sfdc.Dom.getHeight(this.dialog),
a=Sfdc.Window.getWindowHeight(),b=Math.max(a-c,10)/2+b;Sfdc.Dom.setStyles(this.dialog,{top:b+"px",marginTop:"0px"})}};w.prototype.hide=function(){AccessibleDialog.prototype.hide.call(this);if(this.config.onClose)this.config.onClose(this.id)};w.prototype.getContent=function(){return this.content};w.prototype.writeAccessiblePopupHeaderIncludes=function(b){if(this.config.jsLibs)for(var c=0;c<this.config.jsLibs.length;c++)b.write('\x3cscript src\x3d"'),b.write(this.config.jsLibs[c]),b.writeln('" type\x3d"text/javascript"\x3e\x3c/script\x3e')};
var W=new function(){var b=[];this.addUrlObserver=function(c){if(!Ext.isFunction(c))throw Error("A URL observer must be a function and instead is a "+typeof c+". Wit documentation.");b.push(c)};this.getUrlObservers=function(){return b}};this.getConfig=function(){return W}};
UserPanelAccessibleUrlDialog=function(g,d,r,s,m){var p=this;this.id=g;this.title=d;this.url=r;this.subjectId=s;this.content="";this.height=m;this.width=0;this.open=function(){chatter.getToolbox().get({url:p.url,params:{i:p.subjectId,dialogId:p.id},success:function(d,g){p.content=g.html;p.display()}})}};UserPanelAccessibleUrlDialog.prototype=new AccessibleDialog({});UserPanelAccessibleUrlDialog.prototype.getContent=function(){return this.content};
UserPanelAccessibleUrlDialog.prototype.display=function(){UserContext.isAccessibleMode||this.createContent();this.show()};GroupListAccessibleUrlDialog=function(g,d,r,s,m){var p=this;this.id=g;this.title=d;this.url=r;this.subjectId=s;this.content="";this.height=m;this.width=0;this.open=function(){chatter.getToolbox().get({url:p.url,success:function(d,g){p.content=g.html;p.display()}})}};GroupListAccessibleUrlDialog.prototype=new AccessibleDialog({});
GroupListAccessibleUrlDialog.prototype.getContent=function(){return this.content};GroupListAccessibleUrlDialog.prototype.display=function(){UserContext.isAccessibleMode||this.createContent();SfdcApp.ChatterGroupMembership.setCurrentUserProfileId(this.subjectId);this.show()};
GroupListAccessibleUrlDialog.prototype.hide=function(){AccessibleDialog.prototype.hide.call(this);var g=Ext.get("groupListPanel");g&&chatter.getToolbox().get({url:"/user/"+this.subjectId+"/grouplistpanel",success:function(d,r){Ext.DomHelper.insertBefore(g,r.html);g.remove()}});SfdcApp.ChatterGroupMembership.setCurrentUserProfileId("")};Ext.ns("Sfdc.Chatter");
Sfdc.Chatter.TutorialWindow=function(g,d){var r=LC.getLabel("CSNWelcomeMessage","videoTitle"),s=d?d:635,m;Sfdc.Chatter.TutorialWindow.dialogInstance?m=Sfdc.Chatter.TutorialWindow.dialogInstance:(m=Sfdc.Chatter.TutorialWindow.dialogInstance=new VideoDialog("Sfdc.Chatter.TutorialWindow",!1),m.displayX=!0,m.setTitle(r),m.setWidth(840),m.register());this.show=function(){m.setContentInnerHTML(String.format('\x3ciframe width\x3d"{0}" height\x3d"{1}" src\x3d"{2}" frameborder\x3d"no" scrolling\x3d"no"\x3e',
810,s,g));m.show()};this.hide=function(){m.hide()}};
Sfdc.Chatter.ChatterDesktopWindow=function(g){var d;Sfdc.Chatter.ChatterDesktopWindow.dialogInstance?d=Sfdc.Chatter.ChatterDesktopWindow.dialogInstance:(d=Sfdc.Chatter.ChatterDesktopWindow.dialogInstance=new SimpleDialog("Sfdc.Chatter.ChatterDesktopWindow",!1),d.displayX=!0,d.setTitle("Chatter Desktop"),d.setWidth(728),d.register());this.show=function(){d.setContentInnerHTML(String.format('\x3ciframe width\x3d"{0}" height\x3d"{1}" src\x3d"{2}" frameborder\x3d"no"\x3e',705,500,g));d.show()};this.hide=
function(){d.hide()}};
Sfdc.Chatter.ChatterMobileWindow=function(g){var d;Sfdc.Chatter.ChatterMobileWindow.dialogInstance?d=Sfdc.Chatter.ChatterMobileWindow.dialogInstance:(d=Sfdc.Chatter.ChatterMobileWindow.dialogInstance=new SimpleDialog("Sfdc.Chatter.ChatterMobileWindow",!1),d.displayX=!0,d.setWidth(632),d.register());this.show=function(){d.setContentInnerHTML(String.format('\x3ciframe id\x3d"getChatterMobileIFrame" width\x3d"{0}" height\x3d"{1}" src\x3d"{2}" frameborder\x3d"0" scrolling\x3d"no"\x3e',600,520,g));d.show()};
this.hide=function(){d.hide()}};
var topicForm=new function(){var g=chatter.getToolbox();this.onKeyUpNameField=function(d){g.validateTextFieldLength(d,{maxlength:255,msg:LC.getLabel("TopicPage","nameExceedsMaxLength",255)})};this.onKeyUpDescriptionField=function(d){g.validateTextFieldLength(d,{maxlength:1E3,msg:LC.getLabel("TopicPage","descriptionExceedsMaxLength",1E3)})}},requestdeclineform=new function(){var g=chatter.getToolbox();this.onKeyUpResponseMessageField=function(d){g.validateTextFieldLength(d,{maxlength:255,msg:LC.getLabel("ChatterGroups",
"declinedMessageExceedsMaxLengthJs",255)})}};Ext.ns("Sfdc.Feed.ViewFileConfirmDialog");Sfdc.Feed.ViewFileConfirmDialog=function(g){this.id=g.id;this.docId=g.docId;this.fileName=g.fileName;this.subjectName=g.subjectName;this.windowName=id;this.setupDefaultButtons();this.addEvents();this.buttonContents=this.contents="";this.hasButtonsBar=!0};Ext.extend(Sfdc.Feed.ViewFileConfirmDialog,OverlayDialogElement);Sfdc.Feed.ViewFileConfirmDialog.ID="viewFileConfirmDialog";
Sfdc.Feed.ViewFileConfirmDialog.showIt=function(g){var d=null;document.getElementById(Sfdc.Feed.ViewFileConfirmDialog.ID)?(d=OverlayDialogElement.getDialog(Sfdc.Feed.ViewFileConfirmDialog.ID),d.fileName=g.fileName,d.subjectName=g.subjectName):(g.id=Sfdc.Feed.ViewFileConfirmDialog.ID,d=new Sfdc.Feed.ViewFileConfirmDialog(g),d.register());d.showDialog(g)};Sfdc.Feed.ViewFileConfirmDialog.closeIt=function(){OverlayDialogElement.getDialog(Sfdc.Feed.ViewFileConfirmDialog.ID).cancel()};
Sfdc.Feed.ViewFileConfirmDialog.prototype.showDialog=function(g){this.makeContent(g);this.createContent();this.setWidth(440);this.show()};
Sfdc.Feed.ViewFileConfirmDialog.prototype.makeContent=function(g){this.setTitle(LC.getLabel("Publisher","privatelyShareConfirmTitle"));var d=[];d.push('\x3cdiv class\x3d"confirmationMsgPanel"\x3e');var r=LC.getLabel("Publisher","privatelyShareConfirmMsg",this.fileName,this.subjectName);d.push('\x3cimg src\x3d"/s.gif" class\x3d"icon"\x3e\x3cdiv class\x3d"confirmationMsg"\x3e'+r+"\x3c/div\x3e");d.push("\x3c/div\x3e");this.contents=d.join("");d=[];d.push('\x3cinput type\x3d"button" value\x3d"');d.push(LC.getLabel("Publisher",
"viewFile"));d.push('" class\x3d"btn"');d.push(' onclick\x3d"Sfdc.Feed.ViewFileConfirmDialog.execute(');d.push("{docId: '");d.push(g.docId);d.push("'}");d.push(');"/\x3e');d.push('\x3cinput type\x3d"button" value\x3d"');d.push(LC.getLabel("Buttons","close"));d.push('" class\x3d"btn" onclick\x3d"Sfdc.Feed.ViewFileConfirmDialog.closeIt();"/\x3e');this.buttonContents=d.join("")};Sfdc.Feed.ViewFileConfirmDialog.execute=function(g){navigateToUrl("/"+g.docId)};
function ContentListViewport(p,k,g,u,I,v,m,w,x,y,z,A,B,C){function s(b,a,d,c,e,f){b={"ContentListViewport.entityId":b,ptype:"ftab"};if(a=D[a])b[a]=!0,"ct"===a&&(b.contentTypes=x,b.contentTypes||(b.contentTypes=JSON.stringify({type:"SNOTE"})));if(l()){b.ptype="sfs";a:{if((a=(a=window.opener&&window.opener.chatter||parent.chatter||parent.opener&&parent.opener.chatter||window.chatter)&&a.getPublisher&&a.getPublisher()||null)&&a.getHandler)if((a=a.getHandler("ContentPost"))&&a.getCurrentFeedParentId){a=
a.getCurrentFeedParentId();break a}a=""}b.feedParentId=a}!0==d&&(b.isCustom=!0);c&&(b.customFilterParams=Sfdc.JSON.stringify(c));e&&(b.fldr=e);Sfdc.get("chatterListViewContainer")&&(b.ptype="ctab");"ContentVersionFlaggedFileSearch"==k&&(b.ptype="ncon");!0===f&&(b.cc="true");return b}function t(b,a,d,c,e){if(b)return b;b=null;switch(a){case "ContentVersionRecentlyViewedFileSearch":e&&(b=LC.getLabel("ChatterFileListPage","findAllFilesWithFileSync"));break;case "ContentVersionSharedWithMeFileSearch":b=
e?LC.getLabel("ChatterFileListPage","findFilesSharedWithMeWithFileSync"):LC.getLabel("ChatterFileListPage","findFilesSharedWithMe");break;case "ContentVersionAllUserFileSearch":b=LC.getLabel("ChatterFileListPage","searchMyFiles");break;case "ContentVersionFollowedFileSearch":b=e?LC.getLabel("ChatterFileListPage","findFilesIFollowWithFileSync"):LC.getLabel("ChatterFileListPage","findFilesIFollow");break;case "ContentVersionMyGroupsFileSearch":b=LC.getLabel("ChatterFileListPage","findFilesInMyGroups");
break;case "ContentVersionMyWorkspacesFileSearch":b=LC.getLabel("ChatterFileListPage","findAllFilesInMyLibraries");break;case "ContentVersionPersonalWorkspaceFileSearch":b=LC.getLabel("ChatterFileListPage","searchPersonalWorkspace");break;case "ContentVersionMyFoldersFileSearch":b=LC.getLabel("ChatterFileListPage","searchChatterbox");break;case "ContentVersionFileTypeSearch":b=LC.getLabel("ChatterNotesList","searchAllNotes");break;case "ContentVersionUserFileSearch":b=UserContext.userId==d?e?LC.getLabel("ChatterFileListPage",
"findFilesIOwnWithFileSync"):LC.getLabel("ChatterFileListPage","findFilesIOwn"):LC.getLabel("ChatterFileListPage","searchOwnedFiles");break;case "ContentVersionGroupFileSearch":case "ContentVersionWorkspaceFileSearch":b=LC.getLabel("ChatterFileListPage","searchInGroupOrWorkspace",c);break;case "ContentVersionFlaggedFileSearch":b=LC.getLabel("ChatterFileListPage","searchFlaggedFiles")}return b||LC.getLabel("ChatterFileListPage","findAllFiles")}function q(b){switch(b||""){case "ChatterOrganizationContentSearchFilter":case "ChatterWorkspaceFilesSearchFilter":case "ChatterGroupFilesSearchFilter":case "ChatterUserFilesSearchFilter":case "ContentVersionOrganizationFileSearch":case "ContentVersionGroupFileSearch":case "ContentVersionUserFileSearch":case "ContentVersionWorkspaceFileSearch":case "ContentVersionPersonalWorkspaceFileSearch":case "ContentVersionFileSearch":case "ContentVersionSharedWithMeFileSearch":case "ContentVersionRecentlyViewedFileSearch":case "ContentVersionMyGroupsFileSearch":case "ContentVersionMyWorkspacesFileSearch":case "ContentVersionAllUserFileSearch":case "ContentVersionFollowedFileSearch":case "ContentVersionMyFoldersFileSearch":case "ContentVersionFlaggedFileSearch":return!0}return!1}
function l(){return!!Sfdc.get("sfsContentWrapper")}function E(b,a){if(a.columns)for(var d=0;d<a.columns.length;d++)switch(a.columns[d].sortable=!1,a.columns[d].fieldName){case "actions":a.columns[d].className+=m?" limited":"";break;case "type":a.columns[d].className+=q()?" narrow":"";break;case "following":switch(UserContext.initialized&&UserContext.language||""){case "de":case "fr":case "it":case "ru":className+=" medium";break;case "nl_NL":className+=" wide"}}var d=b.target.labels.listView,c=e.viewType,
h='\x3ca class\x3d"uploadFileLink" href\x3d"javascript: void(0);" onclick\x3d"{onclick}"\x3e{label}\x3c/a\x3e',f=Sfdc.String.format(h,{onclick:"Sfdc.AccessibleUploadFileDialog.open();",label:LC.getLabel("ChatterFilesTabPage","uploadingFileLinkText")}),h=Sfdc.ChatterFileUploader.isMultiFileUpload?Sfdc.ChatterFileUploader.isIEMultiFileUpload?LC.getLabel("ChatterFilesTabPage","uploadMultiFilesTextForIE"):Sfdc.String.format(h,{onclick:"document.getElementById(Sfdc.UploadButton.HIDDEN_MULTI_INPUT_ID).click();",
label:LC.getLabel("ChatterFilesTabPage","uploadMultiFilesLinkText")}):Sfdc.String.format(h,{onclick:"Sfdc.AccessibleUploadFileDialog.open();",label:LC.getLabel("ChatterFilesTabPage","uploadFileLinkText")});if(e.searchTerm)c="ContentVersionFileTypeSearch"===c?LC.getLabel("ChatterNotesList","noNotesFoundSearch"):LC.getLabel("ChatterFilesTabPage","noFilesFoundSearch");else switch(c){case "ContentVersionRecentlyViewedFileSearch":c=LC.getLabel("ChatterFilesTabPage","noFilesFoundRecentlyViewed");break;
case "ContentVersionSharedWithMeFileSearch":c=m?LC.getLabel("ChatterFilesTabPage","noFilesFoundSharedWithMeExternal"):LC.getLabel("ChatterFilesTabPage","noFilesFoundSharedWithMe");break;case "ContentVersionGroupFileSearch":c=LC.getLabel("ChatterFilesTabPage","noFilesFoundGroup");break;case "ContentVersionOrganizationFileSearch":c=LC.getLabel("ChatterFilesTabPage","noFilesFoundAllFiles");l()||(c+=" "+LC.getLabel("ChatterFilesTabPage","noFilesFoundUpload",h));break;case "ContentVersionUserFileSearch":c=
LC.getLabel("ChatterFilesTabPage","noFilesFoundFilesIOwn");l()||(c=m?c+(" "+LC.getLabel("ChatterFilesTabPage","noFilesFoundUploadExternal",h)):c+(" "+LC.getLabel("ChatterFilesTabPage","noFilesFoundUpload",h)));break;case "ContentVersionWorkspaceFileSearch":case "ContentVersionPersonalWorkspaceFileSearch":c=LC.getLabel("ChatterFilesTabPage","noFilesFoundWorkspace");break;case "ContentVersionFollowedFileSearch":c=LC.getLabel("ChatterFilesTabPage","noFilesFoundFilesIFollow");break;case "ContentVersionMyGroupsFileSearch":c=
LC.getLabel("ChatterFilesTabPage","noFilesFoundMyGroups");break;case "ContentVersionMyWorkspacesFileSearch":c=LC.getLabel("ChatterFilesTabPage","noFilesFoundMyWorkspaces");break;case "ContentVersionAllUserFileSearch":c=m?LC.getLabel("ChatterFilesTabPage","noFilesFoundMyFilesExternal"):LC.getLabel("ChatterFilesTabPage","noFilesFoundMyFiles");l()||(c+=" "+LC.getLabel("ChatterFilesTabPage","noFilesFoundGetStarted",f));break;case "ContentVersionMyFoldersFileSearch":c=LC.getLabel("ChatterFilesTabPage",
"noFilesFoundFileSync");break;case "ContentVersionFileTypeSearch":c=LC.getLabel("ChatterNotesList","noNotesFound");break;default:c=LC.getLabel("ChatterFilesTabPage","noFilesFound")}d.emptyMessage=c}function F(b,a){e&&a&&1==a.searchTerm.replace(RegExp(UnifiedSearchUI.RESERVED_CHAR_REGEX,"g"),"").length&&(alert(LC.getLabel("ChatterFilesTabPage","searchTermHasTwoOrMore")),a.cancel=!0)}function G(b,a){var d=Sfdc.get(".listBody");if(d){var c=Sfdc.get(".sync",d);if(c)if(!0===r){if(d=Sfdc.get(".zen-data",
d))d.className+=" hideSync",0===a.items.length&&(d=Sfdc.get(".emptyText",d))&&d.setAttribute("colspan",a.columns.length-1)}else c.title=LC.getLabel("FileSyncRemoveLink","syncColumnHeaderTooltip")}}function H(b,a,d){var c=Sfdc.get("000000000000000_topNav");c&&(a&&a.target&&a.target.viewType&&"ContentVersionFileTypeSearch"===a.target.viewType?Sfdc.Dom.addClass(c,"hidden"):Sfdc.Dom.removeClass(c,"hidden"));b.labels.listView.errorMessage=d&&d.data&&d.data.displayErrorMessage?d.data.exDesc:LC.getLabel("List",
"error")||"No records to display."}Perf.mark("Sfdc.Content:Start");var f,e,n,r,D={ContentVersionRecentlyViewedFileSearch:"rv",ContentVersionPersonalWorkspaceFileSearch:"pw",ContentVersionSharedWithMeFileSearch:"sm",ContentVersionMyGroupsFileSearch:"ag",ContentVersionMyWorkspacesFileSearch:"al",ContentVersionAllUserFileSearch:"auf",ContentVersionFollowedFileSearch:"ff",ContentVersionMyFoldersFileSearch:"fs",ContentVersionFileTypeSearch:"ct",ContentVersionFlaggedFileSearch:"flg"};this.load=function(b,
a,d,c,h,k,g,l,m,p){e&&(e.viewType=a,e.additionalParams=s(b,a,g,l,void 0,p),e.sortBy="",e.searchTerm="",e.currentPage=1,e.provide());if(!1===h)f.setNavigationVisible(!1);else{if(n&&n.length)for(h=0;h<n.length;h++)g=n[h],g.searchTerm="",g.setPlaceholder(k?k:t("",a,b,d,c)),g.setSearchButtonLabel(q(a)?LC.getLabel("Buttons","search"):LC.getLabel("Buttons","go")),g.update();f.setNavigationVisible(!0)}r=m};this.isFileSyncFilter=function(){return e&&!!e.additionalParams.fs};this.refresh=function(){if(e){var b=
e.items.length,a=e.currentPage;1<a&&1==b&&(a-=1);e.currentPage=a;e.provide()}};Sfdc.ns("Chatter.Files.ContentListViewport");Chatter.Files.ContentListViewport.INSTANCE=this;Sfdc.onload(function(){var b=t(v,k),a=w||"",b=Sfdc.String.format('\x3csfdc:listView class\x3d"FileListView {className}zen-listViewFixed"\x3e\x3cdata:provider type\x3d"ListServlet" pageSize\x3d"{pageSize}" resourceUri\x3d"{resourceUri}" viewType\x3d"{viewType}" additionalParams\x3d"{additionalParams}" autoProvide\x3d"false"\x3e\x3c/data:provider\x3e\x3cfacet:header\x3e\x3c/facet:header\x3e\x3cfacet:navigation\x3e\x3cui:searchbox className\x3d"zen-searchBox" labelText\x3d"" labelClass\x3d"zen-assistiveText" placeholder\x3d"{searchBoxPlaceholder}" title\x3d"{searchBoxTitle}" delay\x3d"1000" searchButtonLabel\x3d"{searchButtonLabel}" searchTerm\x3d"{searchTerm}" searchMode\x3d"explicit" maxLength\x3d"100"\x3e\x3c/ui:searchbox\x3e\x3c/facet:navigation\x3e\x3cfacet:footer\x3e\x3cui:pagerPageInfo\x3e\x3c/ui:pagerPageInfo\x3e\x3cui:pagerNextPrevious\x3e\x3c/ui:pagerNextPrevious\x3e\x3cui:pagerJumpToPage readOnly\x3d"true"\x3e\x3c/ui:pagerJumpToPage\x3e\x3c/facet:footer\x3e\x3c/sfdc:listView\x3e',
{additionalParams:Sfdc.String.escapeToHtml(Sfdc.JSON.stringify(s(u,k,z,A,B))),className:l()?"SfsListView zen-listViewFixedHeader ":"",pageSize:g&&g.rowsPerPage||25,resourceUri:UserContext.getUrl("/_ui/core/chatter/content/FileListServlet"),viewType:k,searchBoxPlaceholder:Sfdc.String.escapeToHtml(b),searchBoxTitle:Sfdc.String.escapeToHtml(b),searchTerm:a,searchButtonLabel:q(k)?LC.getLabel("Buttons","search"):LC.getLabel("Buttons","go")}),d=Sfdc.get(p+"_listBody");Sfdc.Dom.updateHTML(d,b);SfdcCmp.init(d);
f=SfdcCmp.findInstance(d,SfdcCmp.Sfdc.ListView);f.attach("onbeforesearch",F);f.attach("onbeforeupdate",E);f.attach("onupdate",G);g&&g.displayErrorMessage&&(f.labels.listView.errorMessage=g.exDesc);e=f.getProvider();e.attach("onreceive",H.bind(this,f));e.viewType=k;e.searchTerm=a;e.setPayload(g);r=C;n=SfdcCmp.findInstances(d,SfdcCmp.Ui.ISearchable,!0);!1===y&&f.setNavigationVisible(!1);Perf.endMark("Sfdc.Content:Start")})};
DirectMessageDialog={dialogs:{},showDialog:function(a,b){window.checkSessionTimeout&&checkSessionTimeout();DirectMessageDialog.getDialog(a,b).display()},getDialog:function(a,b){if(DirectMessageDialog.dialogs[a])return DirectMessageDialog.dialogs[a];var c="conversationComposeDialog"+a,d=null;Perf.mark(OverlayDialog.LOAD_MARK);d=UserContext.isAccessibleMode?new CollaborationAccessibleDialog(c,LC.getLabel("DirectMessage","sendMessageDialogTitle"),b,249,530):new NonaccessibleDialog(c,LC.getLabel("DirectMessage",
"sendMessageDialogTitle"),b,249,530);return DirectMessageDialog.dialogs[a]=d}};
var JoinGroupsSplash=new function(){this.showGroupsOverlay=function(a){chatter.getToolbox().post({url:"/chatterEditionSplash",params:{nextAction:"groupOverlay",lastOverlay:a},success:function(a,d){"true"==d.isLastOverlay&&(document.getElementById("csn_onboarding_splashX").style.display="inline");document.getElementById("csn_onboarding_splashContent").innerHTML=d.html;omnitureWrapper.trackEvent(chatter.getOmnitureEventMap().joinGroupsSplash)},failure:function(a,d){"true"==d.showInviteOverlay?ViralInviteDialog.showOnboardingInviteUsersOverlay():
sfdcPage.getDialogById("csn_onboarding_splash").cancel()}})};this.showInviteCoworkersOverlay=function(){chatter.getToolbox().get({url:"/ui/members/inviteOnboarding?firstPage\x3dfalse",params:{},success:function(a,c){document.getElementById("csn_onboarding_splashContent").innerHTML=c.html;omnitureWrapper.trackEvent(chatter.getOmnitureEventMap().inviteCoWorkers)}})};this.finishForExternalUser=function(a){var c=window.sfdcPage.getDialogById("csn_onboarding_splash").cancel(),d=document.getElementById("csn_onboarding_splash");
d&&(d.parentNode.removeChild(d),""!=a&&(window.location=a));return c};this.joinGroup=function(a){this.takeAction(a,"joinGroup",!1)};this.leaveGroup=function(a){this.takeAction(a,"leaveGroup",!1)};this.createGroup=function(a){this.takeAction(a,"createGroup",!0)};this.goToGroupCreatePage=function(){chatter.getToolbox().post({url:"/chatterEditionSplash",params:{nextAction:"GoToGroupCreatePage"},success:function(a,c){navigateToUrl(c.url)}})};this.takeAction=function(a,c,d){var e=Ext.get("joinGroupsOverlay-"+
a);e.dom.innerHTML='\x3cdiv class\x3d"inprogress"\x3e\x3cimg class\x3d"check" src\x3d"/s.gif"\x3e'+LC.getLabel("Images","search_loading")+"\x3c/div\x3e";params={nextAction:c};params[d?"groupNumber":"groupId"]=a;chatter.getToolbox().post({url:"/chatterEditionSplash",params:params,success:function(d,b){e.dom.id="joinGroupsOverlay-"+b.groupId;if("true"==b.groupOwner)e.update('\x3cdiv class\x3d"owner"\x3e\x3cimg class\x3d"check" src\x3d"/s.gif"\x3e'+b.label+"\x3c/div\x3e");else if("true"==b.joinGroup){var c=
"onclick\x3d\"JoinGroupsSplash.joinGroup('"+a+"');\"";e.update('\x3cdiv class\x3d"asktojoin"\x3e\x3ca '+c+' href\x3d"javascript:void(0);" title\x3d\''+b.tooltip+'\'\x3e\x3cimg class\x3d"check" src\x3d"/s.gif"\x3e'+b.label+"\x3c/a\x3e\x3c/div\x3e")}else if("true"==b.groupMember){var f="csnLeaveGroupIcon-"+b.groupId,c="onclick\x3d\"JoinGroupsSplash.leaveGroup('"+b.groupId+"');\"";e.update('\x3cdiv class\x3d"member"\x3e\x3cimg class\x3d"check" src\x3d"/s.gif"\x3e'+b.label+"\x3cspan onmouseout\x3d\"Ext.get('"+
f+"').removeClass('active');\" onmouseover\x3d\"Ext.get('"+f+"').addClass('active');\"\x3e\x3ca "+c+'"  title\x3d"'+b.tooltip+'" href\x3d"javascript:void(0);"\x3e\x3cimg src\x3d"/s.gif" class\x3d"leave" id\x3d"'+f+'"\x3e\x3c/a\x3e\x3c/span\x3e\x3c/div\x3e')}},failure:function(a,b){e.update('\x3cdiv class\x3d"errorResponse"\x3e\x3cimg class\x3d"check" src\x3d"/s.gif"\x3e'+b.errMsg+"\x3c/div\x3e")}});"joinGroup"==c&&omnitureWrapper.trackEvent(chatter.getOmnitureEventMap().joinGroup)}};
var moderateChatter=function(){return{executeCommand:function(a,b){chatter.getToolbox().post({url:"/moderateChatter/"+b+"/"+a,params:{},success:function(a,b){window.location.reload()}})},confirmTask:function(a,b,c){confirmDelete(a)&&this.executeCommand(b,c)}}}();
var swfobject=function(){function v(){if(!t){try{var a=f.getElementsByTagName("body")[0].appendChild(f.createElement("span"));a.parentNode.removeChild(a)}catch(b){return}t=!0;for(var a=z.length,c=0;c<a;c++)z[c]()}}function I(a){t?a():z[z.length]=a}function J(a){if(typeof p.addEventListener!=k)p.addEventListener("load",a,!1);else if(typeof f.addEventListener!=k)f.addEventListener("load",a,!1);else if(typeof p.attachEvent!=k)S(p,"onload",a);else if("function"==typeof p.onload){var b=p.onload;p.onload=
function(){b();a()}}else p.onload=a}function K(){return!A&&D("6.0.65")&&(d.win||d.mac)&&!(d.wk&&312>d.wk)}function L(a,b,c,e){A=!0;E=e||null;M={success:!1,id:c};var h=r(c);if(h){"OBJECT"==h.nodeName?(x=T(h),B=null):(x=h,B=c);a.id=N;if(typeof a.width==k||!/%$/.test(a.width)&&310>parseInt(a.width,10))a.width="310";if(typeof a.height==k||!/%$/.test(a.height)&&137>parseInt(a.height,10))a.height="137";f.title=f.title.slice(0,47)+" - Flash Player Installation";e=d.ie&&d.win?"ActiveX":"PlugIn";e="MMredirectURL\x3d"+
encodeURI(window.location).toString().replace(/&/g,"%26")+"\x26MMplayerType\x3d"+e+"\x26MMdoctitle\x3d"+f.title;b.flashvars=typeof b.flashvars!=k?b.flashvars+("\x26"+e):e;d.ie&&(d.win&&4!=h.readyState)&&(e=f.createElement("div"),c+="SWFObjectNew",e.setAttribute("id",c),h.parentNode.insertBefore(e,h),h.style.display="none",function(){4==h.readyState?h.parentNode.removeChild(h):setTimeout(arguments.callee,10)}());F(a,b,c)}}function T(a){var b=f.createElement("div");if(d.win&&d.ie)b.innerHTML=a.innerHTML;
else if(a=a.getElementsByTagName(u)[0])if(a=a.childNodes)for(var c=a.length,e=0;e<c;e++)!(1==a[e].nodeType&&"PARAM"==a[e].nodeName)&&8!=a[e].nodeType&&b.appendChild(a[e].cloneNode(!0));return b}function F(a,b,c){var e,h=r(c);if(d.wk&&312>d.wk)return e;if(h)if(typeof a.id==k&&(a.id=c),d.ie&&d.win){var l="",g;for(g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?l+=' class\x3d"'+a[g]+'"':"classid"!=g.toLowerCase()&&(l+=" "+g+'\x3d"'+a[g]+'"'));g="";
for(var m in b)b[m]!=Object.prototype[m]&&(g+='\x3cparam name\x3d"'+m+'" value\x3d"'+b[m]+'" /\x3e');h.outerHTML='\x3cobject classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+l+"\x3e"+g+"\x3c/object\x3e";C[C.length]=a.id;e=r(a.id)}else{m=f.createElement(u);m.setAttribute("type",G);for(var q in a)a[q]!=Object.prototype[q]&&("styleclass"==q.toLowerCase()?m.setAttribute("class",a[q]):"classid"!=q.toLowerCase()&&m.setAttribute(q,a[q]));for(l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&
(a=m,g=l,q=b[l],c=f.createElement("param"),c.setAttribute("name",g),c.setAttribute("value",q),a.appendChild(c));h.parentNode.replaceChild(m,h);e=m}return e}function O(a){var b=r(a);b&&"OBJECT"==b.nodeName&&(d.ie&&d.win?(b.style.display="none",function(){if(4==b.readyState){var c=r(a);if(c){for(var d in c)"function"==typeof c[d]&&(c[d]=null);c.parentNode.removeChild(c)}}else setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function r(a){var b=null;try{b=f.getElementById(a)}catch(c){}return b}
function S(a,b,c){a.attachEvent(b,c);w[w.length]=[a,b,c]}function D(a){var b=d.pv;a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return b[0]>a[0]||b[0]==a[0]&&b[1]>a[1]||b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]?!0:!1}function P(a,b,c,e){if(!d.ie||!d.mac){var h=f.getElementsByTagName("head")[0];if(h){c=c&&"string"==typeof c?c:"screen";e&&(H=n=null);if(!n||H!=c)e=f.createElement("style"),e.setAttribute("type","text/css"),e.setAttribute("media",c),n=h.appendChild(e),
d.ie&&(d.win&&typeof f.styleSheets!=k&&0<f.styleSheets.length)&&(n=f.styleSheets[f.styleSheets.length-1]),H=c;d.ie&&d.win?n&&typeof n.addRule==u&&n.addRule(a,b):n&&typeof f.createTextNode!=k&&n.appendChild(f.createTextNode(a+" {"+b+"}"))}}}function y(a,b){if(Q){var c=b?"visible":"hidden";t&&r(a)?r(a).style.visibility=c:P("#"+a,"visibility:"+c)}}function R(a){return null!=/[\\\"<>\.;]/.exec(a)&&typeof encodeURIComponent!=k?encodeURIComponent(a):a}var k="undefined",u="object",G="application/x-shockwave-flash",
N="SWFObjectExprInst",p=window,f=document,s=navigator,z=[],C=[],w=[],x,B,E,M,t=!1,A=!1,n,H,Q=!0,d=function(){var a=typeof f.getElementById!=k&&typeof f.getElementsByTagName!=k&&typeof f.createElement!=k,b=s.userAgent.toLowerCase(),c=s.platform.toLowerCase(),d=c?/win/.test(c):/win/.test(b),c=c?/mac/.test(c):/mac/.test(b),b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,h=!+"\v1",l=[0,0,0],g=null;if(typeof s.plugins!=k&&typeof s.plugins["Shockwave Flash"]==u){if((g=s.plugins["Shockwave Flash"].description)&&
!(typeof s.mimeTypes!=k&&s.mimeTypes[G]&&!s.mimeTypes[G].enabledPlugin))h=!1,g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),l[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10),l[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10),l[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof p.ActiveXObject!=k)try{var m=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(m&&(g=m.GetVariable("$version")))h=!0,g=g.split(" ")[1].split(","),l=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],
10)]}catch(q){}return{w3:a,pv:l,wk:b,ie:h,win:d,mac:c}}();(function(){d.w3&&((typeof f.readyState!=k&&"complete"==f.readyState||typeof f.readyState==k&&(f.getElementsByTagName("body")[0]||f.body))&&v(),t||(typeof f.addEventListener!=k&&f.addEventListener("DOMContentLoaded",v,!1),d.ie&&d.win&&(f.attachEvent("onreadystatechange",function(){"complete"==f.readyState&&(f.detachEvent("onreadystatechange",arguments.callee),v())}),p==top&&function(){if(!t){try{f.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,
0);return}v()}}()),d.wk&&function(){t||document.addEventListener("DOMContentLoaded",function(a){v()})}(),J(v)))})();(function(){d.ie&&d.win&&window.attachEvent("onunload",function(){for(var a=w.length,b=0;b<a;b++)w[b][0].detachEvent(w[b][1],w[b][2]);a=C.length;for(b=0;b<a;b++)O(C[b]);for(var c in d)d[c]=null;d=null;for(var e in swfobject)swfobject[e]=null;swfobject=null})})();return{registerObject:function(a,b,c,e){d.w3&&a&&b?y(a,!1):e&&e({success:!1,id:a})},getObjectById:function(a){if(d.w3){var b=
null;if((a=r(a))&&"OBJECT"==a.nodeName)typeof a.SetVariable!=k?b=a:(a=a.getElementsByTagName(u)[0])&&(b=a);return b}},embedSWF:function(a,b,c,e,f,l,g,m,q,p){var r={success:!1,id:b};d.w3&&!(d.wk&&312>d.wk)&&a&&b&&c&&e&&f?(y(b,!1),I(function(){c+="";e+="";var d={};if(q&&typeof q===u)for(var n in q)d[n]=q[n];d.data=a;d.width=c;d.height=e;n={};if(m&&typeof m===u)for(var s in m)n[s]=m[s];if(g&&typeof g===u)for(var t in g)n.flashvars=typeof n.flashvars!=k?n.flashvars+("\x26"+t+"\x3d"+g[t]):t+"\x3d"+g[t];
if(D(f))s=F(d,n,b),d.id==b&&y(b,!0),r.success=!0,r.ref=s;else{if(l&&K()){d.data=l;L(d,n,b,p);return}y(b,!0)}p&&p(r)})):p&&p(r)},switchOffAutoHideShow:function(){Q=!1},ua:d,getFlashPlayerVersion:function(){return{major:d.pv[0],minor:d.pv[1],release:d.pv[2]}},hasFlashPlayerVersion:D,createSWF:function(a,b,c){if(d.w3)return F(a,b,c)},showExpressInstall:function(a,b,c,e){d.w3&&K()&&L(a,b,c,e)},removeSWF:function(a){d.w3&&O(a)},createCSS:function(a,b,c,e){d.w3&&P(a,b,c,e)},addDomLoadEvent:I,addLoadEvent:J,
getQueryParamValue:function(a){var b=f.location.search||f.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(null==a)return R(b);for(var b=b.split("\x26"),c=0;c<b.length;c++)if(b[c].substring(0,b[c].indexOf("\x3d"))==a)return R(b[c].substring(b[c].indexOf("\x3d")+1))}return""},expressInstallCallback:function(){if(A){var a=r(N);a&&x&&(a.parentNode.replaceChild(x,a),B&&(y(B,!0),d.ie&&d.win&&(x.style.display="block")),E&&E(M));A=!1}}}}();
var whatToDoNext=new function(){function f(a,b,c){chatter.getEventBus().addEventListener(a,b,function(a,b){try{c(a,b)}catch(g){Sfdc.Debug.error("whatToDoNext: Event listener could not be executed.",{error:g,eventname:a,payload:b})}})}this.logClicks=this.accessibilityMode=!0;this.contextId=this.tabNameType=null;this.inAjaxCall=!1;this.dismissThisItem=function(a,b){Sfdc.get("ReadOnlyBanner")?alert(LC.getLabel("Exception","InvalidReadOnlyUserDmlException_desc")):(("getSalesforce1"==a||"getFileSync"==
a)&&Sfdc.logServer("WTDN",{userAction:a+"TaskDismissed",location:window.location.pathname}),this.doAjaxCall(a,b,"dismiss",!1))};this.completeThisItem=function(a,b,c,e){Ext.fly("todoItem")&&Ext.fly("todoItem").addClass("success");this.doAjaxCall(a,b,e?"completeAndLog":"complete",!0)};this.hideWTDN=function(){Ext.fly("todoItem")&&Ext.fly("todoItem").remove()};this.logThisItem=function(a){!0===whatToDoNext.logClicks&&chatter.getToolbox().post({url:"/whatToDoNext",params:{taskName:a,taskAction:"log"}})};
this.doAjaxCall=function(a,b,c,e){if(!this.inAjaxCall){this.inAjaxCall=!0;var d=this;chatter.getToolbox().post({url:"/whatToDoNext",params:{taskName:a,taskAction:c,tabNameType:whatToDoNext.tabNameType||"CHATTER",contextId:whatToDoNext.contextId},success:function(a,c){Ext.fly(b)&&d.replaceItem(b,c.html,c.selfFade,e)},failure:function(a,b){d.inAjaxCall=!1}})}};this.replaceItem=function(a,b,c,e){var d,g,f=this;b&&(d=Ext.get(a),g=d.parent(),setTimeout(function(){d.fadeOut({endOpacity:0,duration:0.5,remove:!0,
callback:function(a){c?Ext.fly("todoItem").addClass("success"):Ext.fly("todoItem").removeClass("success");a=g.createChild(b);a.is("script")&&(a=a.prev());a.fadeIn({endOpacity:1,duration:1,callback:function(){f.inAjaxCall=!1;c&&setTimeout(function(){Ext.get("todoItem").parent().fadeOut({endOpacity:0,duration:1,remove:!0})},5E3)}})}})},e?5E3:0))};this.markListItemComplete=function(a){var b="listItem-"+a;null!==Ext.get(b)&&this.completeThisItem(a,b)};this.markInvitePeopleAsComplete=function(){this.markListItemComplete("invitePeople")};
this.setProfileProperties=function(){};this.uploadPhoto=function(){this.logThisItem("addPhoto");SfdcApp.ChatterProfileSection.showDialog("uploadPhoto");return!1};this.editContactInfo=function(){this.logThisItem("contactInfo");SfdcApp.ChatterProfileSection.showDialog("contactInfo");return!1};this.shortBio=function(){this.logThisItem("shortBio");SfdcApp.ChatterProfileSection.showDialog("aboutMe");return!1};this.showProfilePage=function(){whatToDoNext.logThisItem("profileTask");navigateToUrl("/_ui/core/userprofile/UserProfilePage")};
this.getPeopleListNavigationElement=function(){return Sfdc.select("div#mainNavigation li.peopleListView a")[0]};this.isProfileTab=function(){return 0<document.URL.indexOf("_ui/core/userprofile/UserProfilePage")};this.isPeopleListTab=function(){return 0<document.URL.indexOf("_ui/core/chatter/people/PeopleListPage")};this.isGroupDetailTab=function(){return 0<document.URL.indexOf("_ui/core/chatter/groups/GroupProfilePage")};this.isGroupListTab=function(){return 0<document.URL.indexOf("_ui/core/chatter/groups/GroupListPage")};
this.isHomeTab=function(){return 0<document.URL.indexOf("home/home.jsp")};this.isGroupListFilter=function(){return Sfdc.select("div[title\x3d'"+LC.getLabel("ChatterGroups","listheader_membership")+"']")[0]||null};this.isPeopleListFilter=function(){return Sfdc.get('div[title\x3d"'+LC.getLabel("Feeds","Following")+'"]')?!0:!1};this.getGroupListNavigationElement=function(){return Sfdc.select("div#mainNavigation li.groupListView")[0]};this.getInviteLink=function(){var a=Sfdc.get("viralInviteMembersButtonId");
return a?a:Sfdc.get("externalInviteLinkId")};this.showInvite=function(){whatToDoNext.getInviteLink().click()};this.invitePeople=function(){whatToDoNext.logThisItem("invitePeople");whatToDoNext.getInviteLink()&&whatToDoNext.showInvite()};this.joinGroup=function(){whatToDoNext.logThisItem("findGroups");navigateToUrl("/_ui/core/chatter/ui/ChatterPage?listViewType\x3dgroups")};this.showCreateGroupsPage=function(){whatToDoNext.createGroup()};this.createGroup=function(){whatToDoNext.logThisItem("createGroup");
navigateToUrl("/_ui/core/chatter/groups/GroupCreatePage")};this.uploadGroupPhoto=function(){whatToDoNext.logThisItem("addGroupPhoto");SfdcApp.ChatterProfileSection.showDialog("uploadPhoto");return!1};this.updateGroupDescription=function(){whatToDoNext.logThisItem("addGroupDesc");SfdcApp.ChatterProfileSection.showDialog("groupDescription");return!1};this.addGroupMembers=function(){whatToDoNext.logThisItem("addGroupMembers");Sfdc.get("manageUsersLink").click();return!1};this.showHomePage=function(){whatToDoNext.logThisItem("showProfile");
navigateToUrl("/home/home.jsp")};this.showFilesPage=function(){whatToDoNext.logThisItem("shareFile");navigateToUrl("/_ui/core/chatter/files/FileTabPage")};this.getChatterMobile=function(){this.completeThisItem("getChatterMobile","listItem-getChatterMobile","completedItemClass",!0);(new Sfdc.Chatter.ChatterMobileWindow("/mobile/chattersplash/chatterMobileOverlay.apexp")).show()};this.showShortVideo=function(){!0===this.accessibilityMode||1==this.accessibilityMode?(whatToDoNext.completeThisItem("shortVideo",
"listItem-shortVideo","completedItemClass",!0),(new Sfdc.Chatter.TutorialWindow("/collaboration/tutorial/chatter.htm")).show()):chatter.getToolbox().post({url:"/whatToDoNext",params:{taskName:"shortVideo",taskAction:"shortVideo"},success:function(a,b){whatToDoNext.completeThisItem("shortVideo","listItem-shortVideo","completedItemClass",!0);(new Sfdc.Chatter.TutorialWindow(b.shortVideoURL,435)).show()}})};this.getSalesforce1=function(){this.completeThisItem("getSalesforce1","listItem-getSalesforce1",
"completedItemClass",!0);Sfdc.logServer("WTDN",{userAction:"getSalesforce1TaskCompleted",linkUrl:"http://www..com//",location:window.location.pathname});window.open("http://www..com//")};this.getFileSync=function(){this.completeThisItem("getFileSync","listItem-getFileSync","completedItemClass",!0);Sfdc.logServer("WTDN",{userAction:"getFileSyncTaskCompleted",linkUrl:"/ui/setup/filesync/FileSyncPage",location:window.location.pathname});window.open("/ui/setup/filesync/FileSyncPage")};
this.clickS1LinkInDesc=function(a){Sfdc.logServer("WTDN",{userAction:"s1LinkClicked",linkUrl:a,location:window.location.pathname});window.open(a)};this.getChatterDesktop=function(){this.completeThisItem("getChatterDesktop","listItem-getChatterDesktop","completedItemClass",!0);(new Sfdc.Chatter.ChatterDesktopWindow("/setup/chatterdesktop/chatterdesktopoverlay.apexp")).show()};Ext.onReady(function(){f("chatter:joinGroup","onAfterJoin",function(){Ext.fly("listItem-findGroups")&&whatToDoNext.completeThisItem("findGroups",
"listItem-findGroups","completedItemClass",!1)});f("chatter:joinGroup","onAfterJoin",function(){Ext.fly("listItem-findGroupsIfCreated")&&whatToDoNext.completeThisItem("findGroupsIfCreated","listItem-findGroupsIfCreated","completedItemClass",!1)})},this)};
var omnitureWrapper={trackEvent:function(a){try{"undefined"==typeof OmniturePage?Sfdc.require("SfdcApp.Omni.Config",function(b){b.trackActivity(a,{events:["event8"]})}):OmniturePage.setStage(a)}catch(c){}}};
Sfdc.provide("SfdcApp.social.intents",function(d){return{follow:function(b,a,c){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/follow/"+a),params:{follower:b},success:c.success,failure:c.failure})},unfollow:function(b,a,c){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/follow/"+a)+";delete",params:{follower:b},success:c.success,failure:c.failure})},favorite:function(b,a,c){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/twitter/favorite/"+
b),params:{accountId:a},success:c.success,failure:c.failure})},unfavorite:function(b,a){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/twitter/favorite/"+b)+";delete",success:a.success,failure:a.failure})},deletePost:function(b,a){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/socialPost/"+b)+";delete",success:a.success,failure:a.failure})},getFollowList:function(b,a){return chatter.getToolbox().get({url:UserContext.getUrl("/social/engage/twitter/following/"+
b),success:a.success,failure:a.failure})},like:function(b,a){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/facebook/like/"+b),success:a.success,failure:a.failure})},unlike:function(b,a){return chatter.getToolbox().post({url:UserContext.getUrl("/social/engage/facebook/like/"+b.id)+";delete",success:a.success,failure:a.failure})}}}(Sfdc));
Sfdc.provide("SfdcApp.social.attachmentsBuilder",function(f){function h(b){var c=b.type;if(c){c=b.type.split("/")[0].toLowerCase();if("video"==c)return k(b.url);if("image"==c)return l(b.url)}return d(b.url,c)}function k(b){if(document.createElement("video").canPlayType){var c=document.createElement("SPAN"),a=document.createElement("VIDEO");a.className="embeddedmedia";a.src=b;a.onerror=function(){var a=d(b,"video",LC.getLabel("EmbeddedSocialPost","AttachmentError"));f.Dom.hideByDisplay(c);c.parentNode.appendChild(a)};
a.onfocus=function(){this.setAttribute("controls","");this.play()};a.onblur=function(){this.removeAttribute("controls");this.pause()};a.onclick=function(){this.focus()};a.tabIndex=-1;c.appendChild(a);c.appendChild(g("/img/chatter/play.png",a));return c}return d(b,"video")}function g(b,c){var a=document.createElement("IMG");a.tabIndex=-1;a.src=b;a.className="overlay";a.onclick=function(){c.click()};a.onfocus=function(){c.focus()};return a}function l(b){var c=document.createElement("SPAN"),a=document.createElement("IMG");
a.className="embeddedmedia";a.src=b;a.onerror=function(){var a=d(b,"image",LC.getLabel("EmbeddedSocialPost","AttachmentError"));f.Dom.hideByDisplay(c);c.parentNode.appendChild(a)};a.tabIndex=-1;a.onclick=function(){this.focus()};c.appendChild(a);c.appendChild(g("/img/chatterfiles/zoom24withbg.png",a));return c}function d(b,c,a){var e=document.createElement("A");e.href=f.Url.generateUrl(f.Url.resolveUrl("/servlet/servlet.ExternalRedirect"),{url:b});e.target="_blank";var d=document.createElement("SPAN");
d.appendChild(document.createTextNode(b));d.className="filename";e.appendChild(d);e.className+="embeddedmedia "+c;a&&(b=document.createElement("SPAN"),b.appendChild(document.createTextNode(a)),b.className="error",e.appendChild(b));return e}return{buildAttachments:function(b){if(b.attachments&&0<b.attachments.length){var c=document.createElement("div");c.className="attachments";for(var a=0;a<b.attachments.length;a++)c.appendChild(h(b.attachments[a]));return c}return document.createTextNode("")}}}(Sfdc));
Sfdc.provide("SfdcApp.social.embeddedPost",function(a){function m(c){window.setTimeout(function(){a.Dom.hideByDisplay(c.parentNode)},2E3)}function l(c){h(c);a.Dom.addClass(c,"failed")}function g(c,a){c&&c.errors&&SfdcApp.social.postBuilder.setFailMessage(a,c.errors.message)}function h(c){a.Dom.removeClass(c,["failed","activated","processing"])}function q(c,d,b){return{success:function(){var e=f[b];e||(e={});e[d]=d;h(c);a.Dom.addClass(c,"activated");m(c)},failure:function(){l(c)}}}function r(a,d,b){return{success:function(){var e=
f[b];e&&delete e[d];h(a);m(a)},failure:function(){l(a)}}}function n(c,d){a.Dom.removeClass(d,"loading");d.focus()}function p(c,d,b){var e=f[b];(b=a.select(".personainfo",d))&&a.Array.forEach(b,function(b){a.Dom.removeClass(b,"failed");var c=a.Data.get(b,"managedAccountId");c&&e[c]?a.Dom.addClass(b,"activated"):a.Dom.removeClass(b,"activated")});n(c,d)}var f={};return{followOptionOnClick:function(c,d,b,e){var k=f[e];a.Dom.addClass(c,"processing");k&&k[d]?SfdcApp.social.intents.unfollow(d,b,r(c,d,e)):
SfdcApp.social.intents.follow(d,b,q(c,d,e))},favoriteOptionOnClick:function(c,d,b){a.Dom.addClass(c,"processing");var e=a.Dom.getParent(c,"div.socialpost");SfdcApp.social.postBuilder.removeFailMessage(e);a.Dom.addClass(e,"favoriting");d&&b&&SfdcApp.social.intents.favorite(b,d,{success:function(){a.Dom.addClass(e,"favorited");a.Dom.removeClass(e,["unfavorited","favoriting"]);h(c)},failure:function(b,d){l(c);g(d,a.Dom.getParent(c,"div.socialpost"));a.Dom.removeClass(e,"favoriting")}});a.Dom.hideByDisplay(c.parentNode)},
unfavoriteOnClick:function(c,d){var b=a.Dom.getParent(c,"div.socialpost");SfdcApp.social.postBuilder.removeFailMessage(b);a.Dom.addClass(b,"favoriting");d&&SfdcApp.social.intents.unfavorite(d,{success:function(){a.Dom.addClass(b,"unfavorited");a.Dom.removeClass(b,["favorited","favoriting"])},failure:function(d,k){g(k,a.Dom.getParent(c,"div.socialpost"));a.Dom.removeClass(b,"favoriting")}})},deleteOnClick:function(c,d){if(!0==confirm(LC.getLabel("DeleteIntentAction","DeleteConfirmation"))){var b=a.Dom.getParent(d),
e=a.Dom.getParent(b),b=a.get(".socialPostActionFail",e);a.Dom.removeClass(b,"socialPostActionFailMessage");SfdcApp.social.intents.deletePost(c,{success:function(b,c){a.Dom.addClass(e,"deleted");c&&SfdcApp.social.postBuilder.renderDeletedByElement(e,c)},failure:function(a,b){g(b,e)}})}},followOnClick:function(c,d,b){var e=a.Dom.getLocalOffsetXY(c);a.Dom.setStyle(d,"left",e.x+"px");a.Dom.show(d);f[b]?p(c,d,b):SfdcApp.social.intents.getFollowList(b,{success:function(a,e){f[b]=e;p(c,d,b)},failure:function(a,
b){n(c,d)}})},likeOnClick:function(c,d){var b=a.Dom.getParent(d,".socialpost");a.Dom.hasClass(b,"liking")||(SfdcApp.social.postBuilder.removeFailMessage(b),a.Dom.addClass(b,"liking"),SfdcApp.social.intents.like(c,{success:function(c,d){a.Dom.addClass(b,"liked");a.Dom.removeClass(b,"liking")},failure:function(c,d){g(d,b);a.Dom.removeClass(b,"liking")}}))},unlikeOnClick:function(c,d){var b=a.Dom.getParent(d,".socialpost");a.Dom.hasClass(b,"liking")||(SfdcApp.social.postBuilder.removeFailMessage(b),
a.Dom.addClass(b,"liking"),SfdcApp.social.intents.unlike(c,{success:function(c,d){a.Dom.removeClass(b,"liked");a.Dom.removeClass(b,"liking")},failure:function(c,d){g(d,b);a.Dom.removeClass(b,"liking")}}))}}}(Sfdc));
Sfdc.provide("SfdcApp.social.intentBuilder",function(f){function l(a,b,c){return c&&b?(a=g(LC.getLabel("WebIntents","Reply"),"javascript:void(0);","reply"),a.onclick=function(){SfdcApp.social.publisher.revealPublisher(c,b.actionId,b.apiName)},a):a?g(LC.getLabel("WebIntents","Reply"),a,"reply"):document.createTextNode("")}function m(a,b){if(b&&0<b.length&&a&&"Twitter"===a.provider.apiValue){var c=g(LC.getLabel("WebIntents","Favorite"),"javascript:void(0);","favorite"),e=h(b,a,c,{customizeListItem:function(a,
b,c){a.onclick=function(d){SfdcApp.social.embeddedPost.favoriteOptionOnClick(a,b.id,c.id);f.Event.stopPropagation(d);return!1}},showLoading:function(){return!1}}),d=f.get(".intentAnchor",c);f.Event.add(d,"click",function(){var a=f.Dom.getLocalOffsetXY(c);f.Dom.setStyle(e,"left",a.x+"px");f.Dom.show(e);d.focus()});f.Event.add(d,"blur",function(){window.setTimeout(function(){f.Dom.hideByDisplay(e)},200)});return c}return document.createTextNode("")}function n(a){if(a&&"Twitter"===a.provider.apiValue){var b=
g(LC.getLabel("WebIntents","Unfavorite"),"javascript:void(0);","unfavorite");b.onclick=function(){SfdcApp.social.embeddedPost.unfavoriteOnClick(b,a.id);return!1};return b}return document.createTextNode("")}function p(a){if("Facebook"==a.provider.apiValue){var b=g(LC.getLabel("WebIntents","Like"),"javascript:void(0);","like",!1);b.onclick=function(){SfdcApp.social.embeddedPost.likeOnClick(a.id,b)};return b}return document.createTextNode("")}function q(a){if("Facebook"==a.provider.apiValue){var b=g(LC.getLabel("WebIntents",
"Unlike"),"javascript:void(0);","unlike",!1);b.onclick=function(){SfdcApp.social.embeddedPost.unlikeOnClick(a,b)};return b}return document.createTextNode("")}function k(a,b,c){return b&&c?(a=k("javascript:void(0);"),a.onclick=function(){SfdcApp.social.publisher.revealPublisher(c,b.actionId,b.apiName)},a):a?g(LC.getLabel("WebIntents","Retweet"),a,"retweet"):document.createTextNode("")}function r(a,b){var c=null;if((c=a.messageType&&"Retweet"===a.messageType.apiValue?a.replyTo:a)&&!c.isOutbound){if(b&&
0<b.length&&c&&c.author&&c.author.externalId)return s(b,c);if(c&&c.postUrl)return g(LC.getLabel("WebIntents","Follow"),c.postUrl,"follow",!0)}return document.createTextNode("")}function s(a,b){var c=g(LC.getLabel("WebIntents","Follow"),"javascript:void(0);","follow"),e=h(a,b,c,{customizeListItem:function(a,b,c){a.onclick=function(){SfdcApp.social.embeddedPost.followOptionOnClick(a,b.id,c.author.id,c.author.externalId);!1};a.appendChild(t())},showLoading:function(){return!0}});c.onclick=function(){SfdcApp.social.embeddedPost.followOnClick(c,
e,b.author.externalId)};return c}function h(a,b,c,e){a=u(a,b,e);c.appendChild(a);return a}function v(){var a=LC.getLabel("Global","loading"),b=document.createElement("LI");b.className="loadingHolder";var c=document.createElement("IMG");b.appendChild(c);c.src=UserContext.getUrl("/img/loading.gif");c.className="loadingImage";c=document.createElement("SPAN");b.appendChild(c);c.innerHTML=a;c.className="loadingDescription";return b}function u(a,b,c){var e,d=document.createElement("UL");d.tabIndex=-1;d.onblur=
function(){f.Dom.hideByDisplay(d)};f.Dom.hideByDisplay(d);c.showLoading()&&(d.appendChild(v()),d.className="loading");for(e=0;e<a.length;e++)d.appendChild(w(a[e],b,c));return d}function t(){var a=document.createElement("SPAN");a.className="followingSuffix";a.appendChild(document.createTextNode(" "+LC.getLabel("FollowIntentAction","FollowSuffix")));return a}function x(a){if(a.name){var b=document.createElement("SPAN");b.className="realname";b.appendChild(document.createTextNode(a.name));return b}return document.createTextNode("")}
function y(a){if(a.handle){var b=document.createElement("SPAN");b.className="handle";b.appendChild(document.createTextNode(a.handle));return b}return document.createTextNode("")}function z(a){if(f.isDefAndNotNull(a.author)&&!f.isEmpty(a.accounts))for(var b in a.accounts)if(a.accounts[b].id===a.author.id)return!0;return!1}function A(a){if(a&&a.isOutbound&&f.isDefAndNotNull(a.externalId)&&f.isDefAndNotNull(a.status)&&("SENT"==a.status.statusType||"REPLIED"==a.status.statusType)&&z(a)){var b=g(LC.getLabel("WebIntents",
"Delete"),"javascript:void(0);","delete");b.onclick=function(){SfdcApp.social.embeddedPost.deleteOnClick(a.id,b)};return b}return document.createTextNode("")}function g(a,b,c,e){var d=document.createElement("LI");d.className="intent";c&&(d.className+=" "+c);b=f.Dom.create(d,{href:b,className:"intentAnchor"},"A");f.Dom.setText(b,a);e&&(b.target="_blank");return d}var w=function(a,b,c){var e=document.createElement("LI");e.className="personainfo";f.Data.set(e,"managedAccountId",a.id);e.appendChild(x(a));
e.appendChild(y(a));c.customizeListItem(e,a,b);return e};return{buildIntents:function(a,b,c,e){var d=document.createElement("UL");d.className="intents";d.appendChild(l(a.postUrl,b,c));d.appendChild(m(a,a.accounts));d.appendChild(n(a));d.appendChild(p(a));d.appendChild(q(a));d.appendChild(k(a.postUrl,b,e));d.appendChild(r(a,a.accounts));d.appendChild(A(a));d.appendChild(a.postUrl?g(LC.getLabel("WebIntents","ViewSource"),a.postUrl,"viewsource",!0):document.createTextNode(""));return d}}}(Sfdc));
Sfdc.provide("SfdcApp.social.postBuilder",function(d){function s(a,b){var c=document.createElement("DIV");c.className+=" "+t(a);var f;f=a&&a.messageType&&"RETWEET"===a.messageType.dbValue?u:v;var e=f.getBlueprint(a);e&&d.Array.forEach(e,function(b){(b=b.call(f,a))&&c.appendChild(b)});c.appendChild(w());b&&c.appendChild(b);return c}function h(a){return SfdcApp.social.attachmentsBuilder.buildAttachments(a)}function w(){var a=document.createElement("DIV");a.className="socialPostActionFail";return a}
function k(a){var b=document.createElement("DIV");b.className="deletedByContainer";b.appendChild(l(a));return b}function l(a){var b=document.createElement("DIV");b.className="deletedBy";if(a&&a.deletedByUserUrl&&a.deletedByUserName){var c=document.createElement("SPAN");b.appendChild(c);d.Dom.setText(c,(a.messageType&&"RETWEET"===a.messageType.dbValue?LC.getLabel("DeleteIntentAction","RetweetDeletedBy"):LC.getLabel("DeleteIntentAction","DeletedBy"))+" ");c=document.createElement("A");c.href=a.deletedByUserUrl;
d.Dom.setText(c,a.deletedByUserName);b.appendChild(c)}return b}function t(a){var b="socialpost";a.provider&&(b+=" "+e(a));if(a.messageType){var c;c=a.messageType&&a.messageType.apiValue?a.messageType.apiValue.toLowerCase():"";b+=" "+c}b=a.isOutbound?b+" outbound":b+" inbound";a.status&&(b+=" "+(a.status.statusType?a.status.statusType.toLowerCase():""));"twitter"===e(a)&&(b+=a.likedBy?" favorited":" unfavorited");"facebook"===e(a)&&a.likedBy&&(b+=" liked");return b}function e(a){return a.provider&&
a.provider.apiValue?a.provider.apiValue.toLowerCase():""}function m(a){return a.author?n(a.author,"author"):document.createTextNode("")}function p(a){return a.recipient?n(a.recipient,"recipient"):document.createTextNode("")}function n(a,b){var c=document.createElement("A");c.className="personainfo "+b;a.profileUrl&&(c.href=a.profileUrl,c.target="_blank");a.name&&c.appendChild(g("SPAN",a.name,"realname"));a.handle&&c.appendChild(g("SPAN",a.handle,"handle"));return c}function q(a){var b=document.createElement("DIV");
b.className+="content";var c=a.content;!c&&!a.isReplyable&&(c=a.name);if(c)if("twitter"===e(a))try{b.innerHTML=twttr.txt.autoLink(d.String.escapeToHtml(c),{targetBlank:!0,usernameIncludeSymbol:!0,symbolTag:"s",textWithSymbolTag:"b"})}catch(f){b.innerHTML=SfdcApp.social.urlAutoLinker.autoLink(c)}else b.innerHTML=SfdcApp.social.urlAutoLinker.autoLink(c);return b}function r(a){return a.status&&a.status.statusMessage?g("DIV",a.status.statusMessage,"status "+(a.status.statusType?a.status.statusType.toLowerCase():
"")):document.createTextNode("")}function g(a,b,c){a=document.createElement(a);a.appendChild(document.createTextNode(b));c&&(a.className=c);return a}var v={getBlueprint:function(a){return[m,p,q,h,r,k]}},u={getBlueprint:function(a){return!a.replyTo?null:[this.buildAuthor,this.buildRecipient,this.buildContent,this.buildAttachment,this.buildRetweetedBy,this.buildStatus,k]},buildAuthor:function(a){return m(a.replyTo)},buildRecipient:function(a){return p(a.replyTo)},buildContent:function(a){return q(a.replyTo)},
buildAttachment:function(a){return h(a)},buildStatus:function(a){return r(a)},buildRetweetedBy:function(a){if(a.author&&a.author.handle){var b=document.createElement("DIV");b.className="retweetedBy";d.Dom.setText(b,LC.getLabel("EmbeddedSocialPost","RetweetedBy")+" @"+a.author.handle);return b}}};return{buildPost:function(a,b){return s(a,b)},renderDeletedByElement:function(a,b){var c=d.get(".deletedByContainer",a);if(c){var e=d.get(".deletedBy",c);e&&c.removeChild(e)}c.appendChild(l(b))},setDeleteFailMessage:function(a,
b){var c=d.get(".socialPostActionFail",a);d.Dom.setText(c,b);d.Dom.addClass(c,"socialPostActionFailMessage")},setFailMessage:function(a,b){var c=d.get(".socialPostActionFail",a);d.Dom.setText(c,b);d.Dom.addClass(c,"socialPostActionFailMessage")},removeFailMessage:function(a){a=d.get(".socialPostActionFail",a);d.Dom.setText(a,"");d.Dom.removeClass(a,"socialPostActionFailMessage")}}}(Sfdc));
Sfdc.provide("SfdcApp.social.urlAutoLinker",function(f){var g=/\b(https?|ftp):\/\//ig,h=RegExp("("+g.source+")?("+/[-+a-z0-9]+\./ig.source+")*("+/[-a-zA-Z0-9]{1,62}\./ig.source+")("+/(com|edu|gov|int|mil|net|org|arpa|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|fi|fj|fk|fm|fo|fr|fx|ga|gb|gd|ge|gf|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|in|io|iq|ir|is|it|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nt|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|pt|pw|py|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zr|zw)\b/ig.source+
")("+/:\d{2,5}/ig.source+")?("+/\/((\.|!)?((%[a-f0-9]{2})|[-a-z0-9$&'()*+,;=_~:@<>]))*/ig.source+")*("+/\?((\.|!)?((%[a-f0-9]{2})|[-a-z0-9$&'()*+,;=_~:@?\/|]))*/ig.source+")?("+/#((\.|!)?((%[a-f0-9]{2})|[-a-z0-9$&'()*+,;=_~:@?\/]))*/ig.source+")?","igm");return{autoLink:function(b){if(b){var c=b.match(h),a=b;b=[];if(c&&0<c.length)for(i=0;i<c.length;i++)b[b.length]=a.substring(0,a.indexOf(c[i])),a=a.substring(a.indexOf(c[i])+c[i].length);0<a.length&&(b[b.length]=a);a="";for(i=0;i<b.length;i++)if(a+=
f.String.escapeToHtml(b[i]),c&&c[i]){var d,e=d=c[i];RegExp("^"+g.source,"i").test(e)||(e="http://"+e);d='\x3ca href\x3d"'+e+'" target\x3d"_blank"\x3e'+f.String.escapeToHtml(d)+"\x3c/a\x3e";a+=d}return a}return""}}}(Sfdc));
Sfdc.provide("SfdcApp.social.sina.txt",function(f){return{getPostLength:function(b){var a;a=String(b);for(var c=0,d=0;d<a.length;d++)var e=a.charCodeAt(d),c=c+(255>=e?0.5:65535>=e?1:2);a=c;c=twttr.txt.extractUrlsWithIndices(b,{extractUrlsWithoutProtocol:!1});twttr.txt.modifyIndicesFromUTF16ToUnicode(b,c);for(b=0;b<c.length;b++)a+=Math.max(-140,c[b].indices[0]-c[b].indices[1])/2,a+=10;return Math.ceil(a)}}}(Sfdc));
Sfdc.provide("SfdcApp.social.publisher",function(e){function w(a,b){var c=g(b);if(c){var d=function(){m(b)};c.onkeyup=d;c.onkeypress=d;c.oncut=d;c.onpaste=d;c.onfocus=d;c.oninput=d;c.ondrop=d}}function x(a){return a&&140<a.length?(a=a.substring(0,139),e.String.rtrim(a)+"..."):a}function n(a,b,c){var d=e.JSON.parse(a);if(d.provider){k[c]=d.provider;if(a=f("Provider",c))a.value=d.provider.dbValue,a=e.get(".socialPubProvider",e.Dom.getParent(a)),e.Dom.setText(a,d.provider.label);m(c);p(c)}if(d.replyTo){var h=
f("ReplyTo",c);if(h){b=d.replyTo;h.value=b.id;for(a=e.get(".socialPubReplyTo .socialpostcontainer",e.Dom.getParent(h));a.firstChild;)a.removeChild(a.firstChild);b.content=x(b.content);a.appendChild(SfdcApp.social.postBuilder.buildPost(b))}}d.accounts&&(a=l(c))&&q(a,r(d.accounts,function(a){return new Option(a.label,a.id)}));if(d.author&&d.author.id){var g=l(c);s(g,d.author.id,!0)}d.messageTypes&&(a=f("MessageType",c))&&q(a,r(d.messageTypes,function(a){return new Option(a.label,a.dbValue)}));d.messageType&&
d.messageType.dbValue&&(a=f("MessageType",c),s(a,d.messageType.dbValue),y(c,d.messageType));z(d.content?d.content:"","replace",c);h=f("ReplyTo",c);g=l(c);d.recipient&&(d.recipient.externalId&&d.provider&&"Twitter"==d.provider.apiValue&&h&&g&&!(1==g.options.length&&""==g.options[0].value))&&chatter.getToolbox().get({url:UserContext.getUrl("/social/engage/twitter/followsus/"+d.recipient.externalId),success:function(a,c){var b=g;if(h.value==d.replyTo.id)for(var e=LC.getLabel("SocialPublisher","FromAccountCantDirectMessage"),
f=0;f<b.options.length;f++)!c[b.options[f].value]&&(""!=b.options[f].value&&-1==b.options[f].text.indexOf(e))&&(b.options[f].text+=" "+e)}})}function z(a,b,c){if(c=g(c))e.resolve("Sfdc.EntityFeed.QuickAction")?e.EntityFeed.QuickAction.insertIntoTextField(c,a,b):"replace"===b&&(c.value=a)}function y(a,b){if(b&&b.dbValue&&"RETWEET"===b.dbValue){var c=t(a);c&&e.Dom.hideByDisplay(c)}else u(a)}function A(a){if(!e.Data.get(a,"animationInProgress")){e.Data.set(a,"animationInProgress","true");var b=e.Dom.getStyle(a,
"backgroundColor");e.Units.HexColor.isHexColor(b)||(b=(new e.Units.RGBColor(b)).toHex().toString());e.Animation.css(a,"backgroundColor","#F6F6A6",b,{duration:1500,onComplete:function(){e.Data.clear(a,"animationInProgress")}})}}function q(a,b){if(a){a.options.length=b.length;for(var c=0;c<b.length;c++)a.options[c]=b[c]}}function r(a,b){var c=[];a||(a={length:0});0==a.length&&c.push(new Option(LC.getLabel("SelectElement","Required"),""));for(var d=0;d<a.length;d++)c.push(b(a[d]));return c}function s(a,
b,c){if(a){for(var d=!1,e=0;e<a.options.length;e++)if(a.options[e].value===b){a.options.selectedIndex=e;d=!0;break}if(!d&&c&&(b=0<a.options.length?a.options[0]:null,null===b||""!==b.value))a.add(new Option(LC.getLabel("SelectElement","Required"),""),b),a.options.selectedIndex=0}}function p(a){a=k[a];var b=e.get("publishersharebutton");a&&b&&(b.value=a.createButtonText?a.createButtonText:LC.getLabel("Publisher","Create"))}function m(a){var b=g(a);if(b){e.Window.getScrollY();e.Dom.setStyle(b,"height",
0);var c=10*Math.ceil(b.scrollHeight/10);e.Dom.setStyle(b,"height",Math.max(c+10,100)+"px");var c=k[a],d="";c&&(c.contentLengthLimit&&-1!=c.contentLengthLimit)&&(d=e.String.trim(b.value),b=c.contentLengthLimit,c=c&&"SinaWeibo"==c.apiValue?SfdcApp.social.sina.txt.getPostLength(d):twttr.txt.getTweetLength(d),d=b-c);a=f("socialPubCharCount_Content",a);a.innerHTML=d;0>d?e.Dom.addClass(a,"charLimit"):e.Dom.removeClass(a,"charLimit")}}function f(a,b){return e.get(a+"__"+b)}function l(a){return f("OutboundSocialAccount",
a)}function g(a){return f("Content",a)}function v(a){return e.get("."+a+".publisherTemplate .pbBody")}function t(a){return(a=g(a))?e.Dom.getParent(a,".quickActionField"):null}function u(a){(a=t(a))&&e.Dom.show(a)}function B(a){a=v(a);var b=e.select(".errorMsg",a).concat(e.select(".pbError",a));e.each(b,function(a){e.Dom.hideByDisplay(a)});e.each(e.select(".error",a),function(a){e.Dom.removeClass(a,"error")})}var k={};return{initializePublisher:function(a,b,c){e.onReady(function(){w(b,c);if(g(c)&&
"undefined"!==typeof QuickTextAutoCompleteTextArea){var d=e.JSON.parse(a);new QuickTextAutoCompleteTextArea(d)}if(d=f("ReplyTo",c))d=e.Dom.getParent(d,".quickActionField"),e.Dom.addClass(d,"ReplyTo")})},setPublisherValues:function(a,b,c){e.onReady(function(){n(a,b,c)})},revealPublisher:function(a,b,c){B(b);u(b);e.canvas.parent.publish({name:"publisher.selectAction",payload:{actionName:c}});n(a,c,b);if(a=g(b))a.selectionStart=a.selectionEnd=a.value.length,a.focus();(a=v(b))&&a.scrollIntoView(!1);A(e.get("ReplyTo__"+
b+"_container"))},onShowPanel:function(a){p(a)}}}(Sfdc));
(function(){function g(e,d){d=d||"";"string"!==typeof e&&(e.global&&0>d.indexOf("g")&&(d+="g"),e.ignoreCase&&0>d.indexOf("i")&&(d+="i"),e.multiline&&0>d.indexOf("m")&&(d+="m"),e=e.source);return RegExp(e.replace(/#\{(\w+)\}/g,function(e,d){var m=a.txt.regexen[d]||"";"string"!==typeof m&&(m=m.source);return m}),d)}function r(a,d){return a.replace(/#\{(\w+)\}/g,function(a,e){return d[e]||""})}function f(a,d,b){var h=String.fromCharCode(d);b!==d&&(h+="-"+String.fromCharCode(b));a.push(h);return a}function s(a){var d=
{},b;for(b in a)a.hasOwnProperty(b)&&(d[b]=a[b]);return d}function p(a,d,b){return!b?"string"===typeof a&&a.match(d)&&RegExp["$\x26"]===a:!a||a.match(d)&&RegExp["$\x26"]===a}if("undefined"===typeof a||null===a)var a={};a.txt={};a.txt.regexen={};var y={"\x26":"\x26amp;","\x3e":"\x26gt;","\x3c":"\x26lt;",'"':"\x26quot;","'":"\x26#39;"};a.txt.htmlEscape=function(a){return a&&a.replace(/[&"'><]/g,function(a){return y[a]})};a.txt.regexSupplant=g;a.txt.stringSupplant=r;a.txt.addCharsToCharClass=f;var k=
String.fromCharCode,c=[k(32),k(133),k(160),k(5760),k(6158),k(8232),k(8233),k(8239),k(8287),k(12288)];f(c,9,13);f(c,8192,8202);var u=[k(65534),k(65279),k(65535)];f(u,8234,8238);a.txt.regexen.spaces_group=g(c.join(""));a.txt.regexen.spaces=g("["+c.join("")+"]");a.txt.regexen.invalid_chars_group=g(u.join(""));a.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~\$/;a.txt.regexen.rtl_chars=/[\u0600-\u06FF]|[\u0750-\u077F]|[\u0590-\u05FF]|[\uFE70-\uFEFF]/mg;a.txt.regexen.non_bmp_code_pairs=/[\uD800-\uDBFF][\uDC00-\uDFFF]/mg;
c=[];f(c,1024,1279);f(c,1280,1319);f(c,11744,11775);f(c,42560,42655);f(c,1425,1471);f(c,1473,1474);f(c,1476,1477);f(c,1479,1479);f(c,1488,1514);f(c,1520,1524);f(c,64274,64296);f(c,64298,64310);f(c,64312,64316);f(c,64318,64318);f(c,64320,64321);f(c,64323,64324);f(c,64326,64335);f(c,1552,1562);f(c,1568,1631);f(c,1646,1747);f(c,1749,1756);f(c,1758,1768);f(c,1770,1775);f(c,1786,1788);f(c,1791,1791);f(c,1872,1919);f(c,2208,2208);f(c,2210,2220);f(c,2276,2302);f(c,64336,64433);f(c,64467,64829);f(c,64848,
64911);f(c,64914,64967);f(c,65008,65019);f(c,65136,65140);f(c,65142,65276);f(c,8204,8204);f(c,3585,3642);f(c,3648,3662);f(c,4352,4607);f(c,12592,12677);f(c,43360,43391);f(c,44032,55215);f(c,55216,55295);f(c,65441,65500);f(c,12449,12538);f(c,12540,12542);f(c,65382,65439);f(c,65392,65392);f(c,65296,65305);f(c,65313,65338);f(c,65345,65370);f(c,12353,12438);f(c,12441,12446);f(c,13312,19903);f(c,19968,40959);f(c,173824,177983);f(c,177984,178207);f(c,194560,195103);f(c,12291,12291);f(c,12293,12293);f(c,
12347,12347);a.txt.regexen.nonLatinHashtagChars=g(c.join(""));c=[];f(c,192,214);f(c,216,246);f(c,248,255);f(c,256,591);f(c,595,596);f(c,598,599);f(c,601,601);f(c,603,603);f(c,611,611);f(c,616,616);f(c,623,623);f(c,626,626);f(c,649,649);f(c,651,651);f(c,699,699);f(c,768,879);f(c,7680,7935);a.txt.regexen.latinAccentChars=g(c.join(""));a.txt.regexen.hashSigns=/[#\uff03]/;a.txt.regexen.hashtagAlpha=g(/[a-z_#{latinAccentChars}#{nonLatinHashtagChars}]/i);a.txt.regexen.hashtagAlphaNumeric=g(/[a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}]/i);
a.txt.regexen.endHashtagMatch=g(/^(?:#{hashSigns}|:\/\/)/);a.txt.regexen.hashtagBoundary=g(/(?:^|$|[^&a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}])/);a.txt.regexen.validHashtag=g(/(#{hashtagBoundary})(#{hashSigns})(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi);a.txt.regexen.validMentionPrecedingChars=/(?:^|[^a-zA-Z0-9_!#$%&*@\uff20]|RT:?)/;a.txt.regexen.atSigns=/[@\uff20]/;a.txt.regexen.validMentionOrList=g("(#{validMentionPrecedingChars})(#{atSigns})([a-zA-Z0-9_]{1,20})(/[a-zA-Z][a-zA-Z0-9_-]{0,24})?",
"g");a.txt.regexen.validReply=g(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/);a.txt.regexen.endMentionMatch=g(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/);a.txt.regexen.validUrlPrecedingChars=g(/(?:[^A-Za-z0-9@\uff20$#\uff03#{invalid_chars_group}]|^)/);a.txt.regexen.invalidUrlWithoutProtocolPrecedingChars=/[-_.\/]$/;a.txt.regexen.invalidDomainChars=r("#{punct}#{spaces_group}#{invalid_chars_group}",a.txt.regexen);a.txt.regexen.validDomainChars=g(/[^#{invalidDomainChars}]/);a.txt.regexen.validSubdomain=
g(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/);a.txt.regexen.validDomainName=g(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/);a.txt.regexen.validGTLD=g(/(?:(?:aero|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel|xxx)(?=[^0-9a-zA-Z]|$))/);a.txt.regexen.validCCTLD=g(RegExp("(?:(?:ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)(?\x3d[^0-9a-zA-Z]|$))"));
a.txt.regexen.validPunycode=g(/(?:xn--[0-9a-z]+)/);a.txt.regexen.validDomain=g(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/);a.txt.regexen.validAsciiDomain=g(/(?:(?:[\-a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi);a.txt.regexen.invalidShortDomain=g(/^#{validDomainName}#{validCCTLD}$/);a.txt.regexen.validPortNumber=g(/[0-9]+/);a.txt.regexen.validGeneralUrlPathChars=g(/[a-z0-9!\*';:=\+,\.\$\/%#\[\]\-_~@|&#{latinAccentChars}]/i);
a.txt.regexen.validUrlBalancedParens=g(/\(#{validGeneralUrlPathChars}+\)/i);a.txt.regexen.validUrlPathEndingChars=g(/[\+\-a-z0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i);a.txt.regexen.validUrlPath=g("(?:(?:#{validGeneralUrlPathChars}*(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*#{validUrlPathEndingChars})|(?:@#{validGeneralUrlPathChars}+/))","i");a.txt.regexen.validUrlQueryChars=/[a-z0-9!?\*'@\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i;a.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i;
a.txt.regexen.extractUrl=g("((#{validUrlPrecedingChars})((https?:\\/\\/)?(#{validDomain})(?::(#{validPortNumber}))?(\\/#{validUrlPath}*)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))","gi");a.txt.regexen.validTcoUrl=/^https?:\/\/t\.co\/[a-z0-9]+/i;a.txt.regexen.urlHasProtocol=/^https?:\/\//i;a.txt.regexen.urlHasHttps=/^https:\/\//i;a.txt.regexen.cashtag=/[a-z]{1,6}(?:[._][a-z]{1,2})?/i;a.txt.regexen.validCashtag=g("(^|#{spaces})(\\$)(#{cashtag})(?\x3d$|\\s|[#{punct}])","gi");a.txt.regexen.validateUrlUnreserved=
/[a-z0-9\-._~]/i;a.txt.regexen.validateUrlPctEncoded=/(?:%[0-9a-f]{2})/i;a.txt.regexen.validateUrlSubDelims=/[!$&'()*+,;=]/i;a.txt.regexen.validateUrlPchar=g("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|[:|@])","i");a.txt.regexen.validateUrlScheme=/(?:[a-z][a-z0-9+\-.]*)/i;a.txt.regexen.validateUrlUserinfo=g("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:)*","i");a.txt.regexen.validateUrlDecOctet=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i;
a.txt.regexen.validateUrlIpv4=g(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i);a.txt.regexen.validateUrlIpv6=/(?:\[[a-f0-9:\.]+\])/i;a.txt.regexen.validateUrlIp=g("(?:#{validateUrlIpv4}|#{validateUrlIpv6})","i");a.txt.regexen.validateUrlSubDomainSegment=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i;a.txt.regexen.validateUrlDomainSegment=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i;a.txt.regexen.validateUrlDomainTld=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i;a.txt.regexen.validateUrlDomain=g(/(?:(?:#{validateUrlSubDomainSegment]}\.)*(?:#{validateUrlDomainSegment]}\.)#{validateUrlDomainTld})/i);
a.txt.regexen.validateUrlHost=g("(?:#{validateUrlIp}|#{validateUrlDomain})","i");a.txt.regexen.validateUrlUnicodeSubDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i;a.txt.regexen.validateUrlUnicodeDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i;a.txt.regexen.validateUrlUnicodeDomainTld=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i;
a.txt.regexen.validateUrlUnicodeDomain=g(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i);a.txt.regexen.validateUrlUnicodeHost=g("(?:#{validateUrlIp}|#{validateUrlUnicodeDomain})","i");a.txt.regexen.validateUrlPort=/[0-9]{1,5}/;a.txt.regexen.validateUrlUnicodeAuthority=g("(?:(#{validateUrlUserinfo})@)?(#{validateUrlUnicodeHost})(?::(#{validateUrlPort}))?","i");a.txt.regexen.validateUrlAuthority=g("(?:(#{validateUrlUserinfo})@)?(#{validateUrlHost})(?::(#{validateUrlPort}))?",
"i");a.txt.regexen.validateUrlPath=g(/(\/#{validateUrlPchar}*)*/i);a.txt.regexen.validateUrlQuery=g(/(#{validateUrlPchar}|\/|\?)*/i);a.txt.regexen.validateUrlFragment=g(/(#{validateUrlPchar}|\/|\?)*/i);a.txt.regexen.validateUrlUnencoded=g("^(?:([^:/?#]+):\\/\\/)?([^/?#]*)([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$","i");var z={urlClass:!0,listClass:!0,usernameClass:!0,hashtagClass:!0,cashtagClass:!0,usernameUrlBase:!0,listUrlBase:!0,hashtagUrlBase:!0,cashtagUrlBase:!0,usernameUrlBlock:!0,listUrlBlock:!0,hashtagUrlBlock:!0,
linkUrlBlock:!0,usernameIncludeSymbol:!0,suppressLists:!0,suppressNoFollow:!0,targetBlank:!0,suppressDataScreenName:!0,urlEntities:!0,symbolTag:!0,textWithSymbolTag:!0,urlTarget:!0,invisibleTagAttrs:!0,linkAttributeBlock:!0,linkTextBlock:!0,htmlEscapeNonEntities:!0},v={disabled:!0,readonly:!0,multiple:!0,checked:!0};a.txt.tagAttrs=function(e){var d="",b;for(b in e){var h=e[b];v[b]&&(h=h?b:null);null!=h&&(d+=" "+a.txt.htmlEscape(b)+'\x3d"'+a.txt.htmlEscape(h.toString())+'"')}return d};a.txt.linkToText=
function(e,d,b,h){h.suppressNoFollow||(b.rel="nofollow");h.linkAttributeBlock&&h.linkAttributeBlock(e,b);h.linkTextBlock&&(d=h.linkTextBlock(e,d));e={text:d,attr:a.txt.tagAttrs(b)};return r("\x3ca#{attr}\x3e#{text}\x3c/a\x3e",e)};a.txt.linkToTextWithSymbol=function(e,d,b,h,m){var c=m.symbolTag?"\x3c"+m.symbolTag+"\x3e"+d+"\x3c/"+m.symbolTag+"\x3e":d;b=a.txt.htmlEscape(b);b=m.textWithSymbolTag?"\x3c"+m.textWithSymbolTag+"\x3e"+b+"\x3c/"+m.textWithSymbolTag+"\x3e":b;return m.usernameIncludeSymbol||
!d.match(a.txt.regexen.atSigns)?a.txt.linkToText(e,c+b,h,m):c+a.txt.linkToText(e,b,h,m)};a.txt.linkToHashtag=function(e,d,b){d=d.substring(e.indices[0],e.indices[0]+1);var h=a.txt.htmlEscape(e.hashtag),m=s(b.htmlAttrs||{});m.href=b.hashtagUrlBase+h;m.title="#"+h;m["class"]=b.hashtagClass;h[0].match(a.txt.regexen.rtl_chars)&&(m["class"]+=" rtl");b.targetBlank&&(m.target="_blank");return a.txt.linkToTextWithSymbol(e,d,h,m,b)};a.txt.linkToCashtag=function(e,d,b){d=a.txt.htmlEscape(e.cashtag);var h=s(b.htmlAttrs||
{});h.href=b.cashtagUrlBase+d;h.title="$"+d;h["class"]=b.cashtagClass;b.targetBlank&&(h.target="_blank");return a.txt.linkToTextWithSymbol(e,"$",d,h,b)};a.txt.linkToMentionAndList=function(e,d,b){d=d.substring(e.indices[0],e.indices[0]+1);var h=a.txt.htmlEscape(e.screenName),m=a.txt.htmlEscape(e.listSlug),c=e.listSlug&&!b.suppressLists,f=s(b.htmlAttrs||{});f["class"]=c?b.listClass:b.usernameClass;f.href=c?b.listUrlBase+h+m:b.usernameUrlBase+h;!c&&!b.suppressDataScreenName&&(f["data-screen-name"]=
h);b.targetBlank&&(f.target="_blank");return a.txt.linkToTextWithSymbol(e,d,c?h+m:h,f,b)};a.txt.linkToUrl=function(e,d,b){d=e.url;var h=a.txt.htmlEscape(d),m=b.urlEntities&&b.urlEntities[d]||e;m.display_url&&(h=a.txt.linkTextWithEntity(m,b));var c=s(b.htmlAttrs||{});d.match(a.txt.regexen.urlHasProtocol)||(d="http://"+d);c.href=d;b.targetBlank&&(c.target="_blank");b.urlClass&&(c["class"]=b.urlClass);b.urlTarget&&(c.target=b.urlTarget);!b.title&&m.display_url&&(c.title=m.expanded_url);return a.txt.linkToText(e,
h,c,b)};a.txt.linkTextWithEntity=function(e,d){var b=e.display_url,h=e.expanded_url,c=b.replace(/\u2026/g,"");if(-1!=h.indexOf(c)){var f=h.indexOf(c),b={displayUrlSansEllipses:c,beforeDisplayUrl:h.substr(0,f),afterDisplayUrl:h.substr(f+c.length),precedingEllipsis:b.match(/^\u2026/)?"\u2026":"",followingEllipsis:b.match(/\u2026$/)?"\u2026":""},g;for(g in b)b.hasOwnProperty(g)&&(b[g]=a.txt.htmlEscape(b[g]));b.invisible=d.invisibleTagAttrs;return r("\x3cspan class\x3d'tco-ellipsis'\x3e#{precedingEllipsis}\x3cspan #{invisible}\x3e\x26nbsp;\x3c/span\x3e\x3c/span\x3e\x3cspan #{invisible}\x3e#{beforeDisplayUrl}\x3c/span\x3e\x3cspan class\x3d'js-display-url'\x3e#{displayUrlSansEllipses}\x3c/span\x3e\x3cspan #{invisible}\x3e#{afterDisplayUrl}\x3c/span\x3e\x3cspan class\x3d'tco-ellipsis'\x3e\x3cspan #{invisible}\x3e\x26nbsp;\x3c/span\x3e#{followingEllipsis}\x3c/span\x3e",
b)}return b};a.txt.autoLinkEntities=function(e,d,b){b=s(b||{});b.hashtagClass=b.hashtagClass||"tweet-url hashtag";b.hashtagUrlBase=b.hashtagUrlBase||"https://twitter.com/#!/search?q\x3d%23";b.cashtagClass=b.cashtagClass||"tweet-url cashtag";b.cashtagUrlBase=b.cashtagUrlBase||"https://twitter.com/#!/search?q\x3d%24";b.listClass=b.listClass||"tweet-url list-slug";b.usernameClass=b.usernameClass||"tweet-url username";b.usernameUrlBase=b.usernameUrlBase||"https://twitter.com/";b.listUrlBase=b.listUrlBase||
"https://twitter.com/";b.htmlAttrs=a.txt.extractHtmlAttrsFromOptions(b);b.invisibleTagAttrs=b.invisibleTagAttrs||"style\x3d'position:absolute;left:-9999px;'";var h,c,f;if(b.urlEntities){h={};c=0;for(f=b.urlEntities.length;c<f;c++)h[b.urlEntities[c].url]=b.urlEntities[c];b.urlEntities=h}h="";f=0;d.sort(function(a,b){return a.indices[0]-b.indices[0]});var g=b.htmlEscapeNonEntities?a.txt.htmlEscape:function(a){return a};for(c=0;c<d.length;c++){var l=d[c];h+=g(e.substring(f,l.indices[0]));l.url?h+=a.txt.linkToUrl(l,
e,b):l.hashtag?h+=a.txt.linkToHashtag(l,e,b):l.screenName?h+=a.txt.linkToMentionAndList(l,e,b):l.cashtag&&(h+=a.txt.linkToCashtag(l,e,b));f=l.indices[1]}return h+=g(e.substring(f,e.length))};a.txt.autoLinkWithJSON=function(e,d,b){var h=[],c;for(c in d)h=h.concat(d[c]);for(d=0;d<h.length;d++)entity=h[d],entity.screen_name?entity.screenName=entity.screen_name:entity.text&&(entity.hashtag=entity.text);a.txt.modifyIndicesFromUnicodeToUTF16(e,h);return a.txt.autoLinkEntities(e,h,b)};a.txt.extractHtmlAttrsFromOptions=
function(a){var d={},b;for(b in a){var h=a[b];z[b]||(v[b]&&(h=h?b:null),null!=h&&(d[b]=h))}return d};a.txt.autoLink=function(e,d){var b=a.txt.extractEntitiesWithIndices(e,{extractUrlsWithoutProtocol:!1});return a.txt.autoLinkEntities(e,b,d)};a.txt.autoLinkUsernamesOrLists=function(e,d){var b=a.txt.extractMentionsOrListsWithIndices(e);return a.txt.autoLinkEntities(e,b,d)};a.txt.autoLinkHashtags=function(e,d){var b=a.txt.extractHashtagsWithIndices(e);return a.txt.autoLinkEntities(e,b,d)};a.txt.autoLinkCashtags=
function(e,d){var b=a.txt.extractCashtagsWithIndices(e);return a.txt.autoLinkEntities(e,b,d)};a.txt.autoLinkUrlsCustom=function(e,d){var b=a.txt.extractUrlsWithIndices(e,{extractUrlsWithoutProtocol:!1});return a.txt.autoLinkEntities(e,b,d)};a.txt.removeOverlappingEntities=function(a){a.sort(function(a,b){return a.indices[0]-b.indices[0]});for(var d=a[0],b=1;b<a.length;b++)d.indices[1]>a[b].indices[0]?(a.splice(b,1),b--):d=a[b]};a.txt.extractEntitiesWithIndices=function(e,d){var b=a.txt.extractUrlsWithIndices(e,
d).concat(a.txt.extractMentionsOrListsWithIndices(e)).concat(a.txt.extractHashtagsWithIndices(e,{checkUrlOverlap:!1})).concat(a.txt.extractCashtagsWithIndices(e));if(0==b.length)return[];a.txt.removeOverlappingEntities(b);return b};a.txt.extractMentions=function(e){var d=[];e=a.txt.extractMentionsWithIndices(e);for(var b=0;b<e.length;b++)d.push(e[b].screenName);return d};a.txt.extractMentionsWithIndices=function(e){for(var d=[],b=a.txt.extractMentionsOrListsWithIndices(e),h=0;h<b.length;h++)e=b[h],
""==e.listSlug&&d.push({screenName:e.screenName,indices:e.indices});return d};a.txt.extractMentionsOrListsWithIndices=function(e){if(!e||!e.match(a.txt.regexen.atSigns))return[];var d=[];e.replace(a.txt.regexen.validMentionOrList,function(b,e,c,f,g,l,k){k.slice(l+b.length).match(a.txt.regexen.endMentionMatch)||(g=g||"",b=l+e.length,d.push({screenName:f,listSlug:g,indices:[b,b+f.length+g.length+1]}))});return d};a.txt.extractReplies=function(e){if(!e)return null;e=e.match(a.txt.regexen.validReply);
return!e||RegExp.rightContext.match(a.txt.regexen.endMentionMatch)?null:e[1]};a.txt.extractUrls=function(e,d){for(var b=[],h=a.txt.extractUrlsWithIndices(e,d),c=0;c<h.length;c++)b.push(h[c].url);return b};a.txt.extractUrlsWithIndices=function(e,d){d||(d={extractUrlsWithoutProtocol:!0});if(!e||(d.extractUrlsWithoutProtocol?!e.match(/\./):!e.match(/:/)))return[];for(var b=[];a.txt.regexen.extractUrl.exec(e);){var h=RegExp.$2,c=RegExp.$3,f=RegExp.$5,g=RegExp.$7,l=a.txt.regexen.extractUrl.lastIndex,k=
l-c.length;if(RegExp.$4)c.match(a.txt.regexen.validTcoUrl)&&(c=RegExp.lastMatch,l=k+c.length),b.push({url:c,indices:[k,l]});else if(d.extractUrlsWithoutProtocol&&!h.match(a.txt.regexen.invalidUrlWithoutProtocolPrecedingChars)){var n=null,t=!1,q=0;f.replace(a.txt.regexen.validAsciiDomain,function(e){var d=f.indexOf(e,q);q=d+e.length;n={url:e,indices:[k+d,k+q]};(t=e.match(a.txt.regexen.invalidShortDomain))||b.push(n)});null!=n&&g&&(t&&b.push(n),n.url=c.replace(f,n.url),n.indices[1]=l)}}return b};a.txt.extractHashtags=
function(e){var d=[];e=a.txt.extractHashtagsWithIndices(e);for(var b=0;b<e.length;b++)d.push(e[b].hashtag);return d};a.txt.extractHashtagsWithIndices=function(e,d){d||(d={checkUrlOverlap:!0});if(!e||!e.match(a.txt.regexen.hashSigns))return[];var b=[];e.replace(a.txt.regexen.validHashtag,function(e,d,c,h,f,g){g.slice(f+e.length).match(a.txt.regexen.endHashtagMatch)||(e=f+d.length,b.push({hashtag:h,indices:[e,e+h.length+1]}))});if(d.checkUrlOverlap){var c=a.txt.extractUrlsWithIndices(e);if(0<c.length){c=
b.concat(c);a.txt.removeOverlappingEntities(c);for(var b=[],f=0;f<c.length;f++)c[f].hashtag&&b.push(c[f])}}return b};a.txt.extractCashtags=function(e){var d=[];e=a.txt.extractCashtagsWithIndices(e);for(var b=0;b<e.length;b++)d.push(e[b].cashtag);return d};a.txt.extractCashtagsWithIndices=function(e){if(!e||-1==e.indexOf("$"))return[];var d=[];e.replace(a.txt.regexen.validCashtag,function(a,e,c,f,g,l){a=g+e.length;d.push({cashtag:f,indices:[a,a+f.length+1]})});return d};a.txt.modifyIndicesFromUnicodeToUTF16=
function(e,d){a.txt.convertUnicodeIndices(e,d,!1)};a.txt.modifyIndicesFromUTF16ToUnicode=function(e,d){a.txt.convertUnicodeIndices(e,d,!0)};a.txt.getUnicodeTextLength=function(e){return e.replace(a.txt.regexen.non_bmp_code_pairs," ").length};a.txt.convertUnicodeIndices=function(a,d,b){if(0!=d.length){var c=0,f=0;d.sort(function(a,b){return a.indices[0]-b.indices[0]});for(var g=0,k=d[0];c<a.length;){if(k.indices[0]==(b?c:f)){var l=k.indices[1]-k.indices[0];k.indices[0]=b?f:c;k.indices[1]=k.indices[0]+
l;g++;if(g==d.length)break;k=d[g]}l=a.charCodeAt(c);55296<=l&&(56319>=l&&c<a.length-1)&&(l=a.charCodeAt(c+1),56320<=l&&57343>=l&&c++);f++;c++}}};a.txt.splitTags=function(a){a=a.split("\x3c");for(var d,b=[],c=0;c<a.length;c+=1)if(d=a[c]){d=d.split("\x3e");for(var f=0;f<d.length;f+=1)b.push(d[f])}else b.push("");return b};a.txt.hitHighlight=function(e,d,b){d=d||[];b=b||{};if(0===d.length)return e;b=b.tag||"em";b=["\x3c"+b+"\x3e","\x3c/"+b+"\x3e"];e=a.txt.splitTags(e);var c,f,g="",k=0,l=e[0],p=0,n=0,
t=!1,q=l,s=[],r;for(c=0;c<d.length;c+=1)for(f=0;f<d[c].length;f+=1)s.push(d[c][f]);for(d=0;d<s.length;d+=1){f=s[d];c=b[d%2];for(r=!1;null!=l&&f>=p+l.length;)g+=q.slice(n),t&&f===p+q.length&&(g+=c,r=!0),e[k+1]&&(g+="\x3c"+e[k+1]+"\x3e"),p+=q.length,n=0,k+=2,q=l=e[k],t=!1;!r&&null!=l?(t=f-p,g+=q.slice(n,t)+c,n=t,t=0===d%2?!0:!1):r||(g+=c)}if(null!=l){n<q.length&&(g+=q.slice(n));for(d=k+1;d<e.length;d+=1)g+=0===d%2?e[d]:"\x3c"+e[d]+"\x3e"}return g};var w=[k(65534),k(65279),k(65535),k(8234),k(8235),k(8236),
k(8237),k(8238)];a.txt.getTweetLength=function(e,d){d||(d={short_url_length:22,short_url_length_https:23});var b=a.txt.getUnicodeTextLength(e),c=a.txt.extractUrlsWithIndices(e);a.txt.modifyIndicesFromUTF16ToUnicode(e,c);for(var f=0;f<c.length;f++)b+=c[f].indices[0]-c[f].indices[1],b=c[f].url.toLowerCase().match(a.txt.regexen.urlHasHttps)?b+d.short_url_length_https:b+d.short_url_length;return b};a.txt.isInvalidTweet=function(e){if(!e)return"empty";if(140<a.txt.getTweetLength(e))return"too_long";for(var d=
0;d<w.length;d++)if(0<=e.indexOf(w[d]))return"invalid_characters";return!1};a.txt.isValidTweetText=function(e){return!a.txt.isInvalidTweet(e)};a.txt.isValidUsername=function(e){if(!e)return!1;var d=a.txt.extractMentions(e);return 1===d.length&&d[0]===e.slice(1)};var A=g(/^#{validMentionOrList}$/);a.txt.isValidList=function(a){a=a.match(A);return!(!a||!(""==a[1]&&a[4]))};a.txt.isValidHashtag=function(e){if(!e)return!1;var d=a.txt.extractHashtags(e);return 1===d.length&&d[0]===e.slice(1)};a.txt.isValidUrl=
function(e,d,b){null==d&&(d=!0);null==b&&(b=!0);if(!e)return!1;var c=e.match(a.txt.regexen.validateUrlUnencoded);if(!c||c[0]!==e)return!1;e=c[1];var f=c[2],g=c[3],k=c[4],c=c[5];return b&&(!p(e,a.txt.regexen.validateUrlScheme)||!e.match(/^https?$/i))||!p(g,a.txt.regexen.validateUrlPath)||!p(k,a.txt.regexen.validateUrlQuery,!0)||!p(c,a.txt.regexen.validateUrlFragment,!0)?!1:d&&p(f,a.txt.regexen.validateUrlUnicodeAuthority)||!d&&p(f,a.txt.regexen.validateUrlAuthority)};"undefined"!=typeof module&&module.exports&&
(module.exports=a.txt);if("undefined"!=typeof window)if(window.twttr)for(var x in a)window.twttr[x]=a[x];else window.twttr=a})();
function HelpBubble(){this.isOpen=!1;this.currentParentDivElement=this.bubbleDivElement=null;this.isParentDivHighlighted=!1;this.preferenceConfigOnBubbleClose=this.additionalClass=null;this.currentParentOriginalBorderColor="transparent";this.hideCloseX=!1;this.TAB_MAP={invitePeople:{tabId:"OtherUserProfile_Tab",contentText:LC.getLabel("whatToDoNext","showPeopleTabBubble"),redirectUrl:"/_ui/core/chatter/people/PeopleListPage?displayInviteTip\x3dtrue",additionalClass:"showPeopleTabBubble"},followPeople:{tabId:"OtherUserProfile_Tab",
contentText:LC.getLabel("whatToDoNext","showPeopleTabBubble"),redirectUrl:"/_ui/core/chatter/people/PeopleListPage?displayFollowTip\x3dtrue",additionalClass:"showPeopleTabBubble"},createGroup:{tabId:"CollaborationGroup_Tab",contentText:LC.getLabel("whatToDoNext","showGroupsTabBubble"),redirectUrl:"/_ui/core/chatter/groups/GroupListPage?displayCreateGroupTip\x3dtrue",additionalClass:"showGroupsTabBubble"},joinGroup:{tabId:"CollaborationGroup_Tab",contentText:LC.getLabel("whatToDoNext","showGroupsTabBubble"),
redirectUrl:"/_ui/core/chatter/groups/GroupListPage?filter\x3dall\x26displayJoinGroupTip\x3dtrue",additionalClass:"showGroupsTabBubble"},showProfile:{tabId:"UserProfile_Tab",contentText:LC.getLabel("whatToDoNext","showProfileTabBubble"),redirectUrl:"/_ui/core/userprofile/UserProfilePage",additionalClass:"showProfileTabBubble"}}}HelpBubble.prototype.getBubbleDivId=function(){return HelpBubble.HELP_BUBBLE};HelpBubble.prototype.getBubbleTextContainerId=function(){return"helpBubbleContent"};
HelpBubble.prototype.getBubbleDirectionId=function(){return"helpBubbleDirection"};HelpBubble.prototype.getCloseXId=function(){return"helpBubbleCloseX"};HelpBubble.prototype.hasClass=function(a){return Sfdc.Dom.hasClass(this.bubbleDivElement,a)};
HelpBubble.prototype.resetParentAndBubbleDiv=function(){this.isOpen&&(this.isParentDivHighlighted&&this.currentParentDivElement&&Sfdc.Dom.setStyle(this.currentParentDivElement,HelpBubble.BORDER_COLOR_PROPERTY,this.currentParentOriginalBorderColor),this.additionalClass&&(Sfdc.Dom.removeClass(this.bubbleDivElement,this.additionalClass),this.additionalClass=null),this.hideCloseX&&(Sfdc.Dom.removeClass(Sfdc.get(this.getCloseXId()),HelpBubble.INVISIBLE_CLASS),this.hideCloseX=!1),this.bubbleUniqueId=this.preferenceConfigOnBubbleClose=
this.currentParentDivElement=null,this.isOpen=!1)};HelpBubble.prototype.close=function(a){this.isOpen&&(this.hide(),this.preferenceConfigOnBubbleClose&&UserContext.userPreferences.setBoolean(this.preferenceConfigOnBubbleClose.preferenceBit,this.preferenceConfigOnBubbleClose.value,function(){a&&a()}))};HelpBubble.prototype.hide=function(){this.isOpen&&this.fadeOut()};HelpBubble.prototype.fadeIn=function(a){Sfdc.Effects.fadeIn(this.bubbleDivElement,a)};
HelpBubble.prototype.fadeOut=function(){var a=this;Sfdc.Effects.fadeOut(this.bubbleDivElement,function(){a.resetParentAndBubbleDiv()})};HelpBubble.LEFT={align:"l-r",pointerClass:"left",offset:[25,0],pointerAlign:"r-l",pointerOffset:[2,0]};HelpBubble.RIGHT={align:"r-l",pointerClass:"right",offset:[-25,0],pointerAlign:"l-r",pointerOffset:[0,0]};HelpBubble.TOP={align:"t-b",pointerClass:"top",offset:[0,16],pointerAlign:"b-t",pointerOffset:[0,2]};
HelpBubble.BOTTOM={align:"b-t",pointerClass:"bottom",offset:[0,-10],pointerAlign:"t-b",pointerOffset:[0,-4]};HelpBubble.BOTTOMLEFT={align:"bl-t",pointerClass:"bottom",offset:[-30,-10],pointerAlign:"t-bl",pointerOffset:[30,0]};HelpBubble.BORDER_COLOR_PROPERTY="borderColor";HelpBubble.HIGHTLIGHT_BORDER_COLOR="#FFE5A9";HelpBubble.INVISIBLE_CLASS="helpBubbleInvisible";HelpBubble.HELP_BUBBLE="helpBubble";HelpBubble.helpBubble=null;HelpBubble.getElement=function(a){return Sfdc.get(a)||Sfdc.select(a)[0]};
HelpBubble.getTabMap=function(){return HelpBubble.getBubble().TAB_MAP};HelpBubble.hideBubble=function(a){HelpBubble.isBubblePresent(a)&&HelpBubble.getBubble().hide()};HelpBubble.closeBubble=function(a,b){HelpBubble.isBubblePresent(a)&&HelpBubble.getBubble().close(b)};HelpBubble.isBubblePresent=function(a){return HelpBubble.helpBubble&&(!a||HelpBubble.getBubble().hasClass(a))};
HelpBubble.display=function(a){var b=HelpBubble.getElement(a.parentDiv);if(b){var c=HelpBubble.getBubble();c.resetParentAndBubbleDiv();c.currentParentDivElement=b;if(c.isParentDivHighlighted=a.highLightParentDiv)c.currentParentOriginalBorderColor=Sfdc.Dom.getStyle(b,HelpBubble.BORDER_COLOR_PROPERTY),Sfdc.Dom.setStyle(b,HelpBubble.BORDER_COLOR_PROPERTY,HelpBubble.HIGHTLIGHT_BORDER_COLOR);Sfdc.Dom.updateHTML(c.getBubbleTextContainerId(),a.contentText);var f=c.bubbleDivElement;a.additionalClass&&(c.additionalClass=
a.additionalClass,Sfdc.Dom.addClass(f,a.additionalClass));c.preferenceConfigOnBubbleClose=a.preferenceConfigOnBubbleClose;var e=a.pointerDirection;LC.isRtlPage()&&(a.pointerDirection==HelpBubble.LEFT?e=HelpBubble.RIGHT:a.pointerDirection==HelpBubble.RIGHT&&(e=HelpBubble.LEFT));a.hideCloseX&&(Sfdc.Dom.addClass(Sfdc.get(c.getCloseXId()),HelpBubble.INVISIBLE_CLASS),this.hideCloseX=!0);var d=e.offset;a.customExtraOffset&&(d=[d[0]+(LC.isRtlPage()?-a.customExtraOffset[0]:a.customExtraOffset[0]),d[1]+a.customExtraOffset[1]]);
Sfdc.Dom.alignTo(f,b,e.align,d);b=Sfdc.get(c.getBubbleDirectionId());a.hidePointer?Sfdc.Dom.addClass(b,HelpBubble.INVISIBLE_CLASS):(Sfdc.Dom.removeClass(b,[HelpBubble.LEFT.pointerClass,HelpBubble.RIGHT.pointerClass,HelpBubble.TOP.pointerClass,HelpBubble.BOTTOM.pointerClass,HelpBubble.INVISIBLE_CLASS]),Sfdc.Dom.addClass(b,e.pointerClass),Sfdc.Dom.alignTo(b,f,e.pointerAlign,e.pointerOffset));c.fadeIn(a.fadeInCallBackFn);c.isOpen=!0}};
HelpBubble.displayBubble=function(a,b,c,f,e){HelpBubble.display({parentDiv:a,pointerDirection:b,contentText:c,highLightParentDiv:e,additionalClass:f})};HelpBubble.showTabBubble=function(a){HelpBubble.display({parentDiv:a.tabId,pointerDirection:HelpBubble.BOTTOM,contentText:a.contentText,fadeInCallBackFn:function(){navigateToUrl(a.redirectUrl)},additionalClass:a.additionalClass})};
HelpBubble.createBubble=function(){var a=new HelpBubble,b=document.createElement("div");b.id=a.getBubbleDivId();b.className="helpBubbleCommon";var c=[];c.push(Sfdc.String.format('\x3ca id\x3d"{0}" href\x3d"#" class\x3d"closeHelpBubble" onclick\x3d"HelpBubble.getBubble().close();"\x3e',[a.getCloseXId()]));c.push('\x3cimg title\x3d"Close" class\x3d"dialogClose" src\x3d"/s.gif"\x3e');c.push("\x3c/a\x3e");c.push(Sfdc.String.format('\x3cdiv class\x3d"helpBubbleContainer" id\x3d"{0}"\x3e\x3c/div\x3e',[a.getBubbleTextContainerId()]));
c.push(Sfdc.String.format('\x3cdiv class\x3d"helpBubblePointer" id\x3d"{0}"/\x3e',[a.getBubbleDirectionId()]));b.innerHTML=c.join("");document.body.appendChild(b);a.bubbleDivElement=b;return a};HelpBubble.getBubble=function(){var a=HelpBubble.helpBubble;a||(a=HelpBubble.createBubble(),HelpBubble.helpBubble=a);return a};
HelpBubble.getHelpTextWithTitleAndLink=function(a,b,c,f){a=Sfdc.String.format("\x3cdiv class\x3d'helpBubbleTitle'\x3e{0}\x3c/div\x3e\x3cp\x3e{1}\x3c/p\x3e",[a,b]);c=Sfdc.String.format('\x3ca href\x3d"{0}"\x3e{1}\x3c/a\x3e',[f,c]);return a+c};
HelpBubble.showWhatAreGuestsBubble=function(a){a=HelpBubble.getHelpTextWithTitleAndLink(LC.getLabel("onboarding","whatAreGuestsMsgTitle"),LC.getLabel("onboarding","whatAreGuestsMsgText"),LC.getLabel("onboarding","whatAreGuestsMsgOnlineHelpText"),a);HelpBubble.display({parentDiv:"allowGuests",pointerDirection:HelpBubble.LEFT,contentText:a,additionalClass:"widerHelpBubble",preferenceConfigOnBubbleClose:{preferenceBit:"HideWhatAreGuestsMsg",value:!0}})};
HelpBubble.getHelpTitleWithNew=function(a){return Sfdc.String.format("\x3cdiv class\x3d'helpBubbleTitle'\x3e\x3cspan class\x3d'new'\x3e{0}\x3c/span\x3e {1}\x3c/div\x3e",[LC.getLabel("Global","exciting_and_new"),a])};
HelpBubble.showQueueHelpBubble=function(a,b){var c=HelpBubble.getHelpTitleWithNew(LC.getLabel("QueueCallouts","bubbleTitle")),f=Sfdc.String.format('\x3ca id\x3d"{0}" href\x3d"{1}"\x3e{2}\x3c/a\x3e',[BaseAssociationConstants.HELP_LINK_ID,a,LC.getLabel("QueueCallouts","bubbleOnlineHelpText")]),e=Sfdc.String.format('\x3ca id\x3d"{0}" href\x3d"{1}"\x3e{2}\x3c/a\x3e',[BaseAssociationConstants.VIDEO_LINK_ID,b,LC.getLabel("QueueCallouts","bubbleVideoLinkText")]),f=LC.getLabel("QueueCallouts","queueHelpBubble",
f,e),d=Sfdc.select("div#queueTabs ul\x3eli"),d=(e=0<d.length)?d[d.length-1]:"input[name\x3d'save']",g=[];g.push(c);g.push(f);HelpBubble.display({parentDiv:d,pointerDirection:e?HelpBubble.LEFT:HelpBubble.RIGHT,contentText:g.join(""),additionalClass:"queueHelpBubble",preferenceConfigOnBubbleClose:{preferenceBit:"HideAssociationQueueCallout",value:!0},hidePointer:!0})};
HelpBubble.showInfluenceHelpBubble=function(a){var b=Sfdc.String.format("\x3cdiv class\x3d'helpBubbleTitle'\x3e{0}\x3c/div\x3e{1}",a?[LC.getLabel("Influence","otherUserNotStarted_0",a),LC.getLabel("Influence","otherUserNotStarted_1",a)]:[LC.getLabel("Influence","selfNotStarted_0"),LC.getLabel("Influence","selfNotStarted_1")]);HelpBubble.display({parentDiv:"influenceBox",pointerDirection:HelpBubble.LEFT,contentText:b,additionalClass:"influenceHelpBubble",customExtraOffset:[-15,0],preferenceConfigOnBubbleClose:{preferenceBit:a?
"HideOtherInfluenceGetStarted":"HideSelfInfluenceGetStarted",value:!0}})};HelpBubble.showEnhancedProfileHelpBubble=function(a){a=LC.getLabel("UserProfilePage","WelcomeText",a);HelpBubble.display({parentDiv:"profileTabSetHeader",pointerDirection:HelpBubble.TOP,contentText:a,additionalClass:"enhancedProfileHelpBubble",customExtraOffset:[-280,10],preferenceConfigOnBubbleClose:{preferenceBit:"HideEnhancedProfileHelpBubble",value:!0}})};
HelpBubble.showDomainOverflowHelpBubble=function(a,b){HelpBubble.display({parentDiv:a,pointerDirection:HelpBubble.TOP,hidePointer:!0,contentText:b,additionalClass:"domainOverflowHelpBubble",customExtraOffset:[0,-8]})};
HelpBubble.showSmartSearchBubble=function(a){var b=HelpBubble.getHelpTitleWithNew(LC.getLabel("SmartSearchOneTimeCallOut","title")),c='\x3cli class\x3d"smartSearchCallOutFeeds"\x3e\x3cimg alt\x3d\''+LC.getLabel("Page_UnifiedSearch","feedsToggleLabel")+"' src\x3d'/s.gif' /\x3e\x3cspan\x3e"+LC.getLabel("SmartSearchOneTimeCallOut","chatterFeeds")+"\x3c/span\x3e\x3c/li\x3e",f='\x3cli class\x3d"smartSearchCallOutResults"\x3e\x3cimg alt\x3d\''+LC.getLabel("Page_UnifiedSearch","recordsToggleLabel")+"' src\x3d'/s.gif' /\x3e\x3cspan\x3e"+
LC.getLabel("SmartSearchOneTimeCallOut","orderedResults")+"\x3c/span\x3e\x3c/li\x3e",e='\x3cli class\x3d"smartSearchCallOutPinning"\x3e\x3cimg alt\x3d\''+LC.getLabel("Page_UnifiedSearch","pinAlt")+"' src\x3d'/s.gif' /\x3e\x3cspan\x3e"+LC.getLabel("SmartSearchOneTimeCallOut","pinning")+"\x3c/span\x3e\x3c/li\x3e";a="\x3cdiv class\x3d'smartSearchCallOutSeeMore'\x3e"+String.format('\x3ca href\x3d"{0}" id\x3d"smartSearchOneTimeCallOutLink"\x3e{1}\x3c/a\x3e',a,LC.getLabel("SmartSearchOneTimeCallOut","tellMeMore"))+
"\x3cdiv style\x3d'clear:both'\x3e\x3c/div\x3e\x3c/div";var d=[];d.push(b);d.push('\x3cul class\x3d"smartSearchCallOutList"\x3e');d.push(c);d.push(f);d.push(e);d.push("\x3c/ul\x3e");d.push(a);HelpBubble.display({parentDiv:SfdcApp.Search.Sidetabs.RECORD_TOGGLE_ID,pointerDirection:HelpBubble.LEFT,contentText:d.join(""),additionalClass:"smartSearchCallOut",customExtraOffset:[0,-20],preferenceConfigOnBubbleClose:{preferenceBit:"HideSmartSearchCallOut",value:!0}})};
Sfdc.ns("Sfdc.AccessibleFileSyncMobileDownloadDialog");Sfdc.AccessibleFileSyncMobileDownloadDialog=function(a){Sfdc.BaseAccessibleFileDialog.call(this,a);this.id=a.id;this.title=unescape(a.title)};Sfdc.AccessibleFileSyncMobileDownloadDialog.prototype=new Sfdc.BaseAccessibleFileDialog({});Sfdc.AccessibleFileSyncMobileDownloadDialog.ID="AccessibleFileSyncMobileDownloadDialog";Sfdc.AccessibleFileSyncMobileDownloadDialog.DATA_LOAD_URL="/file/filesyncmobiledownload/";
Sfdc.AccessibleFileSyncMobileDownloadDialog.open=function(){var a=Sfdc.AccessibleFileSyncMobileDownloadDialog.ID,b=sfdcPage.getDialogById(a),a={id:a,title:LC.getLabel("FileSyncMobileDownload","fileSyncMobileDownloadLabel")};b||(b=new Sfdc.AccessibleFileSyncMobileDownloadDialog(a),b.width=450,b.register());a=Sfdc.AccessibleFileSyncMobileDownloadDialog.DATA_LOAD_URL;chatter.getToolbox().post({url:a,success:function(a,c){b.content=c.html;b.display()}})};
Sfdc.AccessibleFileSyncMobileDownloadDialog.prototype.getContent=function(){return this.content};
Sfdc.ns("Sfdc.AccessibleFileSyncSetupDialog");Sfdc.AccessibleFileSyncSetupDialog=function(a){Sfdc.BaseAccessibleFileDialog.call(this,a);this.id=a.id;this.title=unescape(a.title)};Sfdc.AccessibleFileSyncSetupDialog.prototype=new Sfdc.BaseAccessibleFileDialog({});Sfdc.AccessibleFileSyncSetupDialog.ID="accessibleFileSyncSetupDialog";Sfdc.AccessibleFileSyncSetupDialog.DATA_LOAD_URL="/file/filesyncsetup/";
Sfdc.AccessibleFileSyncSetupDialog.open=function(){var a=Sfdc.AccessibleFileSyncSetupDialog.ID,b=sfdcPage.getDialogById(a),a={id:a,title:LC.getLabel("FileSyncOnBoard","downloadChatterboxTitle")};b||(b=new Sfdc.AccessibleFileSyncSetupDialog(a),b.width=750,b.register());a=Sfdc.AccessibleFileSyncSetupDialog.DATA_LOAD_URL;chatter.getToolbox().post({url:a,success:function(a,c){b.content=c.html;b.display();var d=Util.evalAjaxServletOutput(c.config)||{};Sfdc.FileSyncOnboardSetup.fileSyncOnboardSetupInit(!1,
d)}})};Sfdc.AccessibleFileSyncSetupDialog.prototype.getContent=function(){return this.content};
Sfdc.ns("Sfdc.AccessibleMultiUploadFilesDialog");Sfdc.AccessibleMultiUploadFilesDialog=function(a,b){Sfdc.BaseAccessibleFileDialog.call(this,{id:a,useCSS:!0,extraClass:"multiUploadFilesDialog"});this.id=a;this.content="";this.height=500;this.width=590;this.filterParentId=b.filterParentId;this.uploaderOrigin=b.uploaderOrigin;this.title=Sfdc.AccessibleMultiUploadFilesDialog.getDialogTitle(this,b.parentEntityName)};Ext.extend(Sfdc.AccessibleMultiUploadFilesDialog,Sfdc.BaseAccessibleFileDialog);
Sfdc.AccessibleMultiUploadFilesDialog.prototype.getContent=function(){return this.content};Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID="chatterFilesMultiUploadDialog";Sfdc.AccessibleMultiUploadFilesDialog.DRAG_AND_DROP_TARGET_DIV_ID="dragAndDropTargetDiv";Sfdc.AccessibleMultiUploadFilesDialog.uploadFileDialog=null;Sfdc.AccessibleMultiUploadFilesDialog.uploader=null;Sfdc.AccessibleMultiUploadFilesDialog.XPATH_CHATTER_PAGE_FILES_LIST="#mainNavigation .primaryNavList .fileListView";
Sfdc.AccessibleMultiUploadFilesDialog.XPATH_CHATTER_PAGE_FILESYNC_LIST="#mainNavigation .primaryNavList .fileSync";
Sfdc.AccessibleMultiUploadFilesDialog.loadForm=function(a,b){var c=sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);c?b(c):chatter.getToolbox().get({url:"/chatterfilemultiuploadform",success:function(d,f){c=new Sfdc.AccessibleMultiUploadFilesDialog(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID,a);c.content="\x3cdiv id\x3dcontentPublisherSlideDown\x3e"+f.html+"\x3c/div\x3e";c.created=!0;c.register();b&&b(c)}})};
Sfdc.AccessibleMultiUploadFilesDialog.prototype.position=function(){if(this.dialog){var a=this.dialog.style;a.marginTop=-0.5*this.dialog.offsetHeight+"px";LC&&LC.isRtlPage()?a.marginRight=-0.5*this.dialog.offsetWidth+"px":a.marginLeft=-0.5*this.dialog.offsetWidth+"px"}};
Sfdc.AccessibleMultiUploadFilesDialog.getDialogTitle=function(a,b){if(a.uploaderOrigin===Sfdc.ChatterFileUploader.GROUP_PAGE)return LC.getLabel("ChatterFileMultiUpload","uploadTo",b);if(a.uploaderOrigin===Sfdc.ChatterFileUploader.PROFILE_PAGE)return LC.getLabel("ChatterFileMultiUpload","uploadToProfile",b);var c=LC.getLabel("ChatterFilesTabPage","myFilesLabel");if(Sfdc.ChatterFileUploader.isFileSync)var c=Sfdc.get("folderNavigationMutton"),d=Sfdc.get("folderNavigationMuttonDropDownElement"),c=c&&
"none"!==c.style.display&&d?d.getAttribute("title"):LC.getLabel("ChatterFilesTabPage","myChatterbox");return LC.getLabel("ChatterFileMultiUpload","uploadTo",c)};Sfdc.AccessibleMultiUploadFilesDialog.getGroupFileListUrl=function(a){return chatter.getToolbox().sitePrefix()+"/_ui/core/chatter/content/GroupFileListPage?g\x3d"+a};Sfdc.AccessibleMultiUploadFilesDialog.getUserFileListUrl=function(a){return chatter.getToolbox().sitePrefix()+"/_ui/core/chatter/content/UserFileListPage?u\x3d"+a};
Sfdc.AccessibleMultiUploadFilesDialog.getFileTabUrl=function(a){return chatter.getToolbox().sitePrefix()+"/_ui/core/chatter/files/FileTabPage?f\x3d"+a};
Sfdc.AccessibleMultiUploadFilesDialog.open=function(a){var b=sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);Sfdc.MultiFileUploaderUtil.checkFileSyncOption();if(b){var c=Sfdc.AccessibleMultiUploadFilesDialog.getDialogTitle(b),d=Sfdc.get(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID+"Title");Sfdc.Dom.setText(d,c);Sfdc.AccessibleMultiUploadFilesDialog.init(b,a)}else Sfdc.AccessibleMultiUploadFilesDialog.loadForm(a,function(b){Sfdc.AccessibleMultiUploadFilesDialog.init(b,
a)})};
Sfdc.AccessibleMultiUploadFilesDialog.init=function(a,b){if(!0!==b.displayDDTargetIcon||Sfdc.ChatterFileUploader.dragAndDropZone.isDragAndDropInProgress())a.config=b,a.show(),Sfdc.get("uploadingStatusInfo").innerHTML=LC.getLabel("ChatterFileMultiUpload","prepareToUpload"),Sfdc.Dom.show(Sfdc.get("overallProgress")),Sfdc.get("overallProgress").childNodes.item(0).style.width=0,Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadSharingSettingsBtn")),!0===b.displayDDTargetIcon?Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!0):Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!1),
Sfdc.AccessibleMultiUploadFilesDialog.uploader=a.uploaderOrigin===Sfdc.ChatterFileUploader.GROUP_PAGE||a.uploaderOrigin===Sfdc.ChatterFileUploader.PROFILE_PAGE?Sfdc.ChatterFileUploader.createInstance(b,a.filterParentId):Sfdc.ChatterFileUploader.createInstance(b),Sfdc.Dom.show(Sfdc.get("multiUploadCancelRemainingBtn")),Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCloseBtn")),a.uploaderOrigin===Sfdc.ChatterFileUploader.PUBLISHER&&(Sfdc.Dom.setStyle(Sfdc.get("multiUploadCancelUploadBtn"),"display","inline-block"),
Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCancelRemainingBtn")),Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCloseBtn")))};Sfdc.AccessibleMultiUploadFilesDialog.closeIt=function(a){var b=sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);b&&b.cancel(a)};
Sfdc.AccessibleMultiUploadFilesDialog.cancelIt=function(){var a=sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);a&&(a.config.customHandlers&&a.config.customHandlers.cancelHandler&&a.config.customHandlers.cancelHandler(),a.cancel(!0))};
Sfdc.AccessibleMultiUploadFilesDialog.prototype.cancel=function(a){if(0<Sfdc.AccessibleMultiUploadFilesDialog.uploader.filesInProgress)this.uploaderOrigin===Sfdc.ChatterFileUploader.PUBLISHER?(this.config.customHandlers&&this.config.customHandlers.cancelHandler&&this.config.customHandlers.cancelHandler(),Sfdc.BaseAccessibleFileDialog.prototype.cancel.call(this)):Sfdc.MultiUploadCancelRemainingConfirmDialog.open();else if(Sfdc.BaseAccessibleFileDialog.prototype.cancel.call(this),!(!0===a||0==Sfdc.AccessibleMultiUploadFilesDialog.uploader.filesCompleted)&&
Sfdc.AccessibleMultiUploadFilesDialog.uploader.filesCompleted===Sfdc.AccessibleMultiUploadFilesDialog.uploader.filesSelected)if(this.uploaderOrigin===Sfdc.ChatterFileUploader.GROUP_PAGE)window.location=Sfdc.AccessibleMultiUploadFilesDialog.getGroupFileListUrl(this.filterParentId);else if(this.uploaderOrigin===Sfdc.ChatterFileUploader.PROFILE_PAGE)window.location=Sfdc.AccessibleMultiUploadFilesDialog.getUserFileListUrl(this.filterParentId);else if(this.uploaderOrigin===Sfdc.ChatterFileUploader.CHATTER_FILE_PAGE){if(a=
Sfdc.select(Sfdc.AccessibleMultiUploadFilesDialog.XPATH_CHATTER_PAGE_FILES_LIST),0===a.length&&(a=Sfdc.select(Sfdc.AccessibleMultiUploadFilesDialog.XPATH_CHATTER_PAGE_FILESYNC_LIST)),a=a[0])if("undefined"===typeof Sfdc.ChatterFileUploader.isFileSync||!Sfdc.ChatterFileUploader.isFileSync)(a=Sfdc.get("myFilesLinkInChatterTab",Sfdc.get(a)))&&Sfdc.Event.fireEvent(a,"click");else if(a=Sfdc.get("chatterboxFilesLinkInChatterTab")){var b=Sfdc.get("folderNavigationMutton");b?(a=b.getAttribute("data-contentsfdc-currentfolderid"))&&
chatter.getChatterTab().refresh("ListViews",{type:"file",filter:"fs",fldr:a}):Sfdc.Event.fireEvent(a,"click")}}else a="undefined"===typeof Sfdc.ChatterFileUploader.isFileSync||!Sfdc.ChatterFileUploader.isFileSync?Sfdc.AccessibleMultiUploadFilesDialog.getFileTabUrl(UserContext.userId):this.config.fldr?"/"+this.config.fldr:Sfdc.AccessibleMultiUploadFilesDialog.getFileTabUrl(UserContext.userId)+"\x26fs\x3dtrue",window.location=a};
Sfdc.AccessibleMultiUploadFilesDialog.isOpened=function(){var a=sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);return a&&a.isOpen};
Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon=function(a){var b='\x3cdiv id\x3d"'+Sfdc.AccessibleMultiUploadFilesDialog.DRAG_AND_DROP_TARGET_DIV_ID+'" class\x3d"'+Sfdc.AccessibleMultiUploadFilesDialog.DRAG_AND_DROP_TARGET_DIV_ID+'"\x3e\x3cdiv class\x3d"dragAndDropTargetImg"\x3e\x3c/div\x3e\x3cdiv class\x3d"dragAndDropTargetTextDiv"\x3e'+LC.getLabel("ChatterFileMultiUpload","dropFiles")+"\x3c/div\x3e\x3c/div\x3e",c=document.getElementById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID);
if(c&&c.childNodes){for(var d=c.childNodes,f=!1,g=0;g<d.length;g++){var e=d[g];Sfdc.Dom.hasClass(e,Sfdc.AccessibleMultiUploadFilesDialog.DRAG_AND_DROP_TARGET_DIV_ID)?(!1!==a?Sfdc.Dom.removeClass(e,"hidden"):Sfdc.Dom.addClass(e,"hidden"),f=!0):!1!==a?Sfdc.Dom.addClass(e,"hidden"):Sfdc.Dom.removeClass(e,"hidden")}f||(b=Sfdc.MultiFileUploaderUtil.createElementFromHTML(b),c.appendChild(b),!1===a&&Sfdc.Dom.addClass(b,"hidden"));Sfdc.Function.delay(function(){sfdcPage.getDialogById(Sfdc.AccessibleMultiUploadFilesDialog.UPLOAD_FILE_DIALOG_ID).position()},
10)}};
Sfdc.ns("Sfdc.BaseAccessibleFileListDialog");Sfdc.BaseAccessibleFileListDialog=function(a){Sfdc.BaseAccessibleFileDialog.call(this,a);this.id=a.id;this.title=unescape(a.title);this.dataLoadUrl=a.dataLoadUrl;this.docId=a.docId;this.height=a.height;this.content="";this.width=0;this.background=Sfdc.select(".overlayBackground")[0]};Ext.extend(Sfdc.BaseAccessibleFileListDialog,Sfdc.BaseAccessibleFileDialog);Sfdc.BaseAccessibleFileListDialog.prototype.getContent=function(){return this.content};
Sfdc.BaseAccessibleFileListDialog.prototype.open=function(a){this.loadList(a)};Sfdc.BaseAccessibleFileListDialog.prototype.loadList=function(a){var c=this.dataLoadUrl+this.docId,b=this;a=a||{};chatter.getToolbox().get({url:c,params:a,success:function(a,d){b.updateContent(d);b.callback&&b.callback(c,d)}})};Sfdc.BaseAccessibleFileListDialog.prototype.updateContent=function(a){this.content=a.html;this.display()};
Sfdc.BaseAccessibleFileListDialog.prototype.nextPage=function(a,c,b){(a=sfdcPage.getDialogById(this.id))&&a.loadList({p:b+1})};Sfdc.BaseAccessibleFileListDialog.prototype.prevPage=function(a,c,b){(a=sfdcPage.getDialogById(this.id))&&a.loadList({p:b-1})};Sfdc.BaseAccessibleFileListDialog.closeDialog=function(a){return(Sfdc.BaseAccessibleFileDialog.prototype.isInAccessibilityMode()?window.opener?window.opener:window.parent:window).sfdcPage.getDialogById(a).cancel()};
Sfdc.BaseAccessibleFileListDialog.prototype.hook_cancel=function(){var a=Sfdc.BaseAccessibleFileDialog.getDialogById(this.id);a&&a.refreshPage&&location.reload(!0)};
Sfdc.ns("Sfdc.AccessibleUploadFileDialog");Sfdc.AccessibleUploadFileDialog=function(a,b,c,d){Sfdc.BaseAccessibleFileDialog.call(this,{id:a});this.id=a;this.title=b;this.docId=c;this.isContentComment=d||!1;this.content="";this.height=400;this.width=520};Ext.extend(Sfdc.AccessibleUploadFileDialog,Sfdc.BaseAccessibleFileDialog);Sfdc.AccessibleUploadFileDialog.prototype.getContent=function(){return this.content};
Sfdc.AccessibleUploadFileDialog.getSuccessHandler=function(){return function(a,b){if(b&&b.docid){var c=Sfdc.AccessibleUploadFileDialog.getBaseUrl()+"/"+b.docid;b.so&&(c+="?so\x3d"+b.so);navigateToUrl(c)}}};Sfdc.AccessibleUploadFileDialog.prototype.getSuccessHandler=function(){return void 0===this.successHandler?Sfdc.AccessibleUploadFileDialog.getSuccessHandler():this.successHandler};Sfdc.AccessibleUploadFileDialog.prototype.setSuccessHandler=function(a){void 0!==a&&(this.successHandler=a)};
Sfdc.AccessibleUploadFileDialog.prototype.setCancelHandler=function(a){void 0!==a&&(this.cancelHandler=a)};
Sfdc.AccessibleUploadFileDialog.getFailureAndErrorHandler=function(){return function(a,b){var c=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();c&&(c.source=null);var c=b&&b.html?b.html:LC.getLabel("ChatterFilesTabPage","uploadGeneralErrorMessage"),d=Dialogs.types.ERROR;Dialogs.createDialog({id:Dialogs.getNextId(),title:LC.getLabel("Global","error"),message:c,backgroundClass:d.backgroundClass,contentClass:d.contentClass,iconClass:d.iconClass,iconAlt:d.getIconAlt(),actions:[null],actionLabels:[LC.getLabel("Buttons",
"ok")]},!0).show()}};Sfdc.AccessibleUploadFileDialog.prototype.getFailureAndErrorHandler=function(){return Sfdc.AccessibleUploadFileDialog.getFailureAndErrorHandler()};Sfdc.AccessibleUploadFileDialog.prototype.setFailureAndErrorHandler=function(a){void 0!==a&&(this.failureAndErrorHandler=a)};Sfdc.AccessibleUploadFileDialog.prototype.enableButton=function(a){var b=Sfdc.get("uploadToMyFilesButton");a?chatter.getToolbox().enableButton(b):chatter.getToolbox().disableButton(b)};
Sfdc.AccessibleUploadFileDialog.prototype.hook_cancel=function(){this.cancelHandler&&this.cancelHandler();var a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();a&&(a.source=null)};Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID="chatterFilesTabPageUploadDialog";Sfdc.AccessibleUploadFileDialog.REQUIRED_LEGEND_ID="requiredLegend"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_FIELD_ID="chatterFile"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;
Sfdc.AccessibleUploadFileDialog.FILE_FIELD_NEW_LABEL_ID="chatterFileNewLabel"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_ROW_ID="chatterFileRow"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_NAME_FIELD_ID="fileName"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_DESCRIPTION_FIELD_ID="desc"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;
Sfdc.AccessibleUploadFileDialog.FILE_NAME_ROW_ID="fileNameRow"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_DESCRIPTION_ROW_ID="descRow"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.FILE_SHARE_OPT_PANEL_ID="sharedWithOptionPanel"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.UPLOAD_MSG_PANEL_ID="uploadFileMsgPanel"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;
Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_FORM_ID="chatterFileForm"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_FIELD_ID="shareOption"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_STATUS_ID="shareOptionStatus"+ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX;Sfdc.AccessibleUploadFileDialog.uploadFileDialog=null;
Sfdc.AccessibleUploadFileDialog.open=function(a,b){var c=sfdcPage.getDialogById(Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID);if(c)Sfdc.AccessibleUploadFileDialog.init(c,a);else{var d={nv:Sfdc.AccessibleUploadFileDialog.isNewVersionUpload(a),cc:Sfdc.AccessibleUploadFileDialog.isContentComment(a)};b&&chatter.getToolbox().setToken(b);chatter.getToolbox().get({url:"/chatterfileuploadform",params:d,success:function(b,d){c=new Sfdc.AccessibleUploadFileDialog(Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID,
Sfdc.AccessibleUploadFileDialog.getDialogTitle(a),a?a[ChatterFilesConstants.FILE_CONFIG_KEY_DOCID]:null,Sfdc.AccessibleUploadFileDialog.isContentComment(a));c.content='\x3cdiv id\x3d"contentPublisherSlideDown" class\x3d"contentPublisherSlideDown"\x3e'+d.html+"\x3c/div\x3e";c.created=!0;c.register();Sfdc.AccessibleUploadFileDialog.init(c,a);var f=Sfdc.get(Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID);Sfdc.on(f,"dragover",function(a){a&&a.preventDefault()});Sfdc.on(f,"drop",function(a){a&&
(a.target&&("INPUT"!==a.target.tagName||"file"!==a.target.type))&&a.preventDefault()})}})}};Sfdc.AccessibleUploadFileDialog.getBaseUrl=function(){return chatter.getToolbox().sitePrefix()};Sfdc.AccessibleUploadFileDialog.getFileDetailPageUrl=function(){return Sfdc.AccessibleUploadFileDialog.getBaseUrl()+"/_ui/core/chatter/files/FileDetailPage"};Sfdc.AccessibleUploadFileDialog.isNewVersionUpload=function(a){return a?a[ChatterFilesConstants.FILE_CONFIG_KEY_DOCID]?!0:!1:!1};
Sfdc.AccessibleUploadFileDialog.isContentComment=function(a){return a?a.isContentComment?!0:!1:!1};Sfdc.AccessibleUploadFileDialog.getDialogTitle=function(a){return a?a.title?a.title:Sfdc.AccessibleUploadFileDialog.isContentComment(a)?LC.getLabel("Publisher","postFileFormTitle"):LC.getLabel("ChatterFileDetailPage","uploadNewVersionDialogTitle"):LC.getLabel("ChatterFilesTabPage","uploadFileDialogTitle")};
Sfdc.AccessibleUploadFileDialog.hideField=function(a,b){a&&(b?Sfdc.Dom.addClass(a,"hidden"):Sfdc.Dom.removeClass(a,"hidden"))};
Sfdc.AccessibleUploadFileDialog.adjustUploadLayout=function(a){var b=Sfdc.AccessibleUploadFileDialog.isNewVersionUpload(a);a=Sfdc.AccessibleUploadFileDialog.isContentComment(a);if(!b&&!a){var c=Sfdc.get(Sfdc.AccessibleUploadFileDialog.FILE_ROW_ID),d=Sfdc.select("th",c)[0];if(d&&(Sfdc.Dom.addClass(d,"hidden"),!Sfdc.get(Sfdc.AccessibleUploadFileDialog.FILE_FIELD_NEW_LABEL_ID))){var c=Sfdc.get(Sfdc.Dom.getParent(c,"table")),e=document.createElement("div");e.id=Sfdc.AccessibleUploadFileDialog.FILE_FIELD_NEW_LABEL_ID;
e.innerHTML=Sfdc.get(d).innerHTML;c.parentNode.insertBefore(e,c)}}Sfdc.AccessibleUploadFileDialog.hideField(Sfdc.get(Sfdc.AccessibleUploadFileDialog.FILE_NAME_ROW_ID),!0);Sfdc.AccessibleUploadFileDialog.hideField(Sfdc.get(Sfdc.AccessibleUploadFileDialog.FILE_DESCRIPTION_ROW_ID),!0);Sfdc.AccessibleUploadFileDialog.hideField(Sfdc.get(Sfdc.AccessibleUploadFileDialog.FILE_SHARE_OPT_PANEL_ID),b||a);(b=Sfdc.get(Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID+"Item1"))&&Sfdc.AccessibleUploadFileDialog.selectShareOption(b,
"pvt");Sfdc.AccessibleUploadFileDialog.hideField(Sfdc.get(Sfdc.AccessibleUploadFileDialog.UPLOAD_MSG_PANEL_ID),!0)};
Sfdc.AccessibleUploadFileDialog.init=function(a,b){chatter.getFileUploader().setDialogAppendix(ChatterFilesConstants.UPLOAD_DIALOG_APPENDIX);Sfdc.AccessibleUploadFileDialog.adjustUploadLayout(b,!1);a.show();a.enableButton(!1);var c="",d="";if(b){b.successHandler&&b.cancelHandler&&(a.setSuccessHandler(b.successHandler),a.setCancelHandler(b.cancelHandler));if(!Sfdc.AccessibleUploadFileDialog.isContentComment(b)){var e=Sfdc.get("fileTitle");e&&(c=unescapeHTML(e.innerHTML));(e=Sfdc.get("fileDescriptionText"))&&
(d=unescapeHTML(e.innerHTML))}b.fldr&&(a.fldr=b.fldr)}chatter.getFileUploader().reset(a.enableButton,c,d);chatter.getFileUploader().initValidation(a.enableButton)};Sfdc.AccessibleUploadFileDialog.close=function(){var a=sfdcPage.getDialogById(Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID);a&&a.cancel()};
Sfdc.AccessibleUploadFileDialog.upload=function(){var a=sfdcPage.getDialogById(Sfdc.AccessibleUploadFileDialog.UPLOAD_FILE_DIALOG_ID);if(a){a.hide();var b=chatter.getToolbox().sitePrefix()+chatter.getToolbox().apiurl()+"/chatterfile/",c={cc:a.isContentComment};a.docId&&(c={id:a.docId});var d=Sfdc.get("browseLabel");d&&"fs"===d.getAttribute("data-contentsfdc-filter")&&(c.fileSync=!0,a.fldr&&(c.fldr=a.fldr));chatter.getFileUploader().upload(b,c,{failureHandler:a.getFailureAndErrorHandler(),errorHandler:a.getFailureAndErrorHandler(),
successHandler:a.getSuccessHandler()})}};Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID="shareOptionDropdown";Sfdc.FileSharedWithOptionDropdown=function(a,b){Sfdc.DropdownPanel.call(this,a);this.pubLinkEnabled=!1;b&&!0===b.pubLinkEnabled&&(this.pubLinkEnabled=!0);this.isRendered=!1};Ext.extend(Sfdc.FileSharedWithOptionDropdown,Sfdc.DropdownPanel);
Sfdc.FileSharedWithOptionDropdown.prototype.getXY=function(){var a=Sfdc.get("chatterFilesTabPageUploadDialog"),b=getObjX(this.anchorElem),c=getObjY(this.anchorElem);0==b&&(b=parseInt(a.style.left)+44);0==c&&(c=parseInt(a.style.top)+182);b+=Sfdc.Window.getScrollX()-1;c+=Sfdc.Window.getScrollY()+this.anchorElem.offsetHeight+1;return{x:b,y:c}};Sfdc.FileSharedWithOptionDropdown.prototype.getSize=function(){return{width:this.anchorElem.offsetWidth}};
Sfdc.FileSharedWithOptionDropdown.prototype.getContent=function(a){return!this.isRendered?(a=[],a.push('\x3cul\x3e\x3cli class\x3d"sharedWithStatusBar checked"\x3e\x3ca id\x3d"'+Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID+'Item1" onclick\x3d"Sfdc.AccessibleUploadFileDialog.selectShareOption(this, \'pvt\');return false;" class\x3d"lockItemIcon" href\x3d"javascript:void(0);"\x3e'+LC.getLabel("ChatterFileSharing","shareOptionPrivate")+"\x3c/a\x3e\x3c/li\x3e"),a.push('\x3cli class\x3d"sharedWithStatusBar"\x3e\x3ca id\x3d"'+
Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID+'Item2"  onclick\x3d"Sfdc.AccessibleUploadFileDialog.selectShareOption(this, \'grp\');return false;" class\x3d"groupItemIcon" href\x3d"javascript:void(0);"\x3e'+LC.getLabel("ChatterFileSharing","shareOptionGroup")+"\x3c/a\x3e\x3c/li\x3e"),a.push('\x3cli class\x3d"sharedWithStatusBar"\x3e\x3ca id\x3d"'+Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID+'Item3"  onclick\x3d"Sfdc.AccessibleUploadFileDialog.selectShareOption(this, \'ppl\');return false;" class\x3d"peopleItemIcon" href\x3d"javascript:void(0);"\x3e'+
LC.getLabel("ChatterFileSharing","shareOptionPeople")+"\x3c/a\x3e\x3c/li\x3e"),this.pubLinkEnabled&&a.push('\x3cli class\x3d"sharedWithStatusBar"\x3e\x3ca id\x3d"'+Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID+'Item4"  onclick\x3d"Sfdc.AccessibleUploadFileDialog.selectShareOption(this, \'lnk\');return false;" class\x3d"linkItemIcon" href\x3d"javascript:void(0);"\x3e'+LC.getLabel("ChatterFileSharing","shareOptionLink")+"\x3c/a\x3e\x3c/li\x3e"),a.push("\x3c/ul\x3e"),this.isRendered=!0,a.join("")):
null};Sfdc.AccessibleUploadFileDialog.getShareOptionDropdown=function(a){var b=Sfdc.DropdownPanel.getPanel(Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID);b||(b=new Sfdc.FileSharedWithOptionDropdown(Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_DROPDOWN_ID,a));return b};Sfdc.AccessibleUploadFileDialog.showShareOptionDropdown=function(a,b){var c=Sfdc.AccessibleUploadFileDialog.getShareOptionDropdown(b);c&&c.show(a)};
Sfdc.AccessibleUploadFileDialog.closeShareOptionDropdown=function(){var a=Sfdc.AccessibleUploadFileDialog.getShareOptionDropdown();a&&a.close()};
Sfdc.AccessibleUploadFileDialog.selectShareOption=function(a,b){for(var c=Sfdc.select("li.sharedWithStatusBar",Sfdc.Dom.getParent(Sfdc.get(a),"ul")),d=0;d<c.length;d++)Sfdc.Dom.removeClass(c[d],"checked");Sfdc.Dom.addClass(Sfdc.Dom.getParent(Sfdc.get(a),"li"),"checked");c=Sfdc.get(Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_STATUS_ID);c.className=a.className;c.firstChild.innerHTML=a.innerHTML;Sfdc.get(Sfdc.AccessibleUploadFileDialog.SHARE_OPTION_FIELD_ID).value=b;Sfdc.AccessibleUploadFileDialog.closeShareOptionDropdown()};
Sfdc.ns("Sfdc.AccessibleSelectFileDropDownPanel");Sfdc.AccessibleSelectFileDropDownPanel=function(a,b){Sfdc.DropdownPanel.call(this,a);this.isFileSyncEnabled=b};Ext.extend(Sfdc.AccessibleSelectFileDropDownPanel,Sfdc.DropdownPanel);Sfdc.AccessibleSelectFileDropDownPanel.prototype.resizeEventHandler=function(a){return function(){}};Sfdc.AccessibleSelectFileDropDownPanel.prototype.scrollEventHandler=function(a){return function(){}};
Sfdc.AccessibleSelectFileDropDownPanel.prototype.clickEventHandler=function(a,b){return function(){}};Sfdc.AccessibleSelectFileDropDownPanel.prototype.keydownEventHandler=function(a){return function(){}};Sfdc.AccessibleSelectFileDropDownPanel.prototype.getXY=function(){var a=getObjX(this.anchorElem),b=getObjY(this.anchorElem);return{x:a+10,y:b+23}};
Sfdc.AccessibleSelectFileDropDownPanel.prototype.getContent=function(a){a=UserContext.isDefaultNetwork?LC.getLabel("Publisher","linkAFile"):LC.getLabel("Publisher","linkAFileChatter");var b=LC.getLabel("Publisher","uploadAFile");if(!this.isRendered){var c=[];c.push("\x3cul\x3e");c.push('\x3cli class\x3d"contentCommentMenuItem"\x3e\x3ca class\x3d"contentCommentLink" onclick\x3d"Sfdc.AccessibleSelectFileDropDownPanel.doAction(\'sfs\');return false;"  href\x3d"javascript:void(0);"\x3e'+chatter.getToolbox().htmlEncode(a)+
"\x3c/a\x3e\x3c/li\x3e");c.push('\x3cli class\x3d"contentCommentMenuItem"\x3e\x3ca class\x3d"contentCommentLink" onclick\x3d"Sfdc.AccessibleSelectFileDropDownPanel.doAction(\'uploadFile\');return false;"  href\x3d"javascript:void(0);"\x3e'+chatter.getToolbox().htmlEncode(b)+"\x3c/a\x3e\x3c/li\x3e");c.push("\x3c/ul\x3e");this.isRendered=!0;return c.join("")}return null};
Sfdc.AccessibleSelectFileDropDownPanel.hideDropDown=function(){var a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();if(a){var b=Sfdc.get(Sfdc.AccessibleSelectFileDropDownPanel.SELECT_FILE_DROPDOWN_ID);b&&Sfdc.Dom.isVisible(b)&&a.close()}};
Sfdc.AccessibleSelectFileDropDownPanel.doAction=function(a){var b=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();chatter.getFeed().setAttachingContent(b.anchorElem,!0);Sfdc.AccessibleSelectFileDropDownPanel.hideDropDown();b.source=a;"uploadFile"==a?chatter.getFeed().showContentCommentUpload(b.anchorElem):"sfs"==a&&chatter.getFeed().showContentCommentLink(b.anchorElem)};Sfdc.AccessibleSelectFileDropDownPanel.SELECT_FILE_DROPDOWN_ID="contentCommentDropdown";
Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown=function(a){var b=Sfdc.AccessibleSelectFileDropDownPanel.SELECT_FILE_DROPDOWN_ID,c=Sfdc.DropdownPanel.getPanel(b);c||(c=new Sfdc.AccessibleSelectFileDropDownPanel(b,a));return c};Sfdc.AccessibleSelectFileDropDownPanel.showSelectFileDropdown=function(a){var b=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown(config);b&&b.show(a)};Sfdc.AccessibleSelectFileDropDownPanel.prototype.hasFocusInitially=function(){return!1};
Sfdc.AccessibleSelectFileDropDownPanel.closeSelectFileDropdown=function(){var a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();a&&a.close()};Sfdc.AccessibleSelectFileDropDownPanel.prototype.close=function(){Sfdc.DropdownPanel.prototype.close.call(this);var a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();a&&a.anchorElem&&chatter.getFeed().setDisableCommentBoxBlur(a.anchorElem,!1)};
var PostToWidget=function(r,h){function s(){return LC.getLabel("Publisher","SearchGroups")}function t(){var a=d();Sfdc.Dom.removeClass(a,"hasFocus");Sfdc.Dom.set(a,"value",s())}function v(){if(!c){var a=d();c=new UserAndGroupAutoCompleteInputElement({elementId:a.id,entityType:UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP,disableGhostText:!0,handleSelect:function(a){var b=a.itemName,c=a.isExternalUserOrGroup,k=a.imageHtml,g="private"===a.itemPrivacy;e=a={subjectId:a.itemId,entityType:LC.getLabel("Publisher",
"CollaborationGroupLabel"),isExternalGroup:c,isPrivateGroup:g};h(a);Sfdc.Dom.hideByDisplay(d());Sfdc.Dom.set(d(),"value","");a=l();m||(m=Sfdc.get(w,f()));c=m;c.innerHTML=k;k=Sfdc.get(".chatter-avatar",c);Sfdc.Dom.removeClass(k,"chatter-avatarMedium");Sfdc.Dom.addClass(k,"chatter-avatarSmall");Sfdc.get(".groupInfo",a).innerHTML=b;b=l();Sfdc.Dom.setStyle(b,"display","inline-block");Sfdc.get(".removeGroup",b).focus();this.clearSuggestions()},getACXPosition:function(){return 8},getACYPosition:function(){return Sfdc.Dom.getHeight(a)-
2},getMinimumWidth:function(){return 209}});c.addACBoxToPage=function(b){Sfdc.Dom.getParent(a).appendChild(b)};c.clearGhostText=function(){a.value===s()&&(Sfdc.Dom.addClass(a,"hasFocus"),Sfdc.Dom.set(a,"value",""))};Sfdc.on(a,"blur",function(){""===a.value&&t()});var b=Sfdc.get(".removeGroup",l());Sfdc.on(b,"click",function(a,b){u();d().focus()})}}function u(){var a={};e=a;h(a);Sfdc.Dom.hideByDisplay(l());Sfdc.Dom.show(d())}function f(){g||(g=Sfdc.get(x,r));return g}function d(){n||(n=Sfdc.get(y,
f()));return n}function l(){p||(p=Sfdc.get(z,f()));return p}var x=".groupSelection",y=".groupSelectionInput",z=".groupRecipient",w=".groupIconContainer",c=null,g=null,n=null,p=null,m=null,A=this,q={subjectId:UserContext.userId,entityType:LC.getLabel("Publisher","UserLabel")},e=q,b="me";this.setTargetToGroup=function(){if("group"!=b){var a={};e=a;h(a);t();v();Sfdc.Dom.setStyle(f(),"display","inline-block");b="group"}};this.setTargetToMyProfile=function(){"me"!=b&&(Sfdc.Dom.hideByDisplay(f()),u(),e=
q,h(q),b="me")};this.reset=function(){A.setTargetToMyProfile();var a=Sfdc.get(".zen-select",r);SfdcCmp.getInstance(a).reset()};this.getSubject=function(){return e}};
Sfdc.ns("Sfdc.ChatterFileUploadHandler");Sfdc.ChatterFileUploadHandler=function(a){this.config=Sfdc.apply(a,{uploadActionUrl:"",onProgressCallback:function(a,d,b,e){},onCompleteCallback:function(a,d,b){},onCancelCallback:function(a,d){},onErrorCallback:function(a,d,b){}});this.uploadActionUrl=this.config.uploadActionUrl;this.fileUploadWaitingQueue=[];this.uploadParams=[];this.inProgressXhrs=new Map;this.filesToUpload=[]};
Sfdc.MultiFileUploaderUtil.extend(Sfdc.ChatterFileUploadHandler.prototype,{addToUploadList:function(a){!a instanceof File&&!a.name&&alert("Not File object in Sfdc.ChatterFileUploadHandler!");var c=new Sfdc.MultiFileUploaderFile(a);this.filesToUpload.push({fileObject:a,fileInfo:c,canceled:!1});return this.filesToUpload.length-1},scheduleUpload:function(a,c){1==this.addToWaitingQueue(a,c)&&this.uploadFileToServer(a)},uploadNextIfExists:function(){0<this.fileUploadWaitingQueue.length&&this.uploadFileToServer(this.fileUploadWaitingQueue[0])},
uploadNextIfNoneInProgress:function(){0===this.inProgressXhrs.getSize()&&this.uploadNextIfExists()},cancelCurrentUpload:function(a){this.cancelUploadFileToServer(a);this.removeFromWaitingQueue(a);this.config.onCancelCallback(a,this.filesToUpload[a].fileObject)},cancelRemainingUploads:function(){this.cancelInProgressUploads();this.cancelWaitingUploads()},removeFromWaitingQueue:function(a){a=Sfdc.Array.indexOf(this.fileUploadWaitingQueue,a);this.fileUploadWaitingQueue.splice(a,1)},addToWaitingQueue:function(a,
c){var d=this.fileUploadWaitingQueue.push(a);this.uploadParams[a]=c||{};return d},removeFromWaitingQueueAndUploadNext:function(a){this.removeFromWaitingQueue(a);this.uploadNextIfExists()},constructFormData:function(a,c,d){var b=new FormData;b.append("token",chatter.getToolbox().token());b.append("fileName_upload",c);b.append("fileName",c);b.append("desc_upload","");b.append("desc","");b.append("hiddenFileName",c);b.append("shareOption_upload","pvt");b.append("mfu","1");b.append("file",a);d.fileSync&&
b.append("fileSync",!0);d.filterParentId&&b.append("fpid",d.filterParentId);d.fldr&&b.append("fldr",d.fldr);if(d.params)for(var e in d.params)e&&d.params[e]&&b.append(e,d.params[e]);return b},uploadFileToServer:function(a){var c=this.constructFormData(this.filesToUpload[a].fileObject,this.filesToUpload[a].fileInfo.shortName,this.uploadParams[a]);this.submitXhr(a,c)},cancelUploadFileToServer:function(a){this.filesToUpload[a].canceled=!0;var c=this.inProgressXhrs.get(a.toString());c&&(c.abort(),this.inProgressXhrs.remove(a.toString()))},
submitXhr:function(a,c){var d=this,b=new XMLHttpRequest,e=this.filesToUpload[a].fileInfo.name;b.upload.onprogress=function(b){if(b.lengthComputable)d.config.onProgressCallback(a,e,b.loaded,b.total)};b.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE&&!(200!==this.status&&Sfdc.userAgent.isChrome))d.onXhrDone(a,this)};this.inProgressXhrs.put(a.toString(),b);b.open("POST",this.config.uploadActionUrl,!0);b.send(c)},parseAndDecodeResponse:function(a){if(a=Sfdc.MultiFileUploaderUtil.parseResponseResult(a))a.html&&
(a.html=chatter.getFileUploader().getBase64Decoder().decode(a.html)),a.errormessage&&(a.errormessage=chatter.getFileUploader().getBase64Decoder().decode(a.errormessage));return a},runCustomHandlers:function(a,c,d){var b=this.config.customHandlers;b&&("Failure"===a&&b.failureHandler?b.failureHandler(d.response,c):"Error"===a&&b.errorHandler?b.errorHandler(d.response,c):"Success"==a&&b.successHandler&&b.successHandler(d.response,c))},onXhrDone:function(a,c){if(!0!==this.filesToUpload[a].canceled){var d=
this.filesToUpload[a].fileObject,b=this.filesToUpload[a].fileInfo.size;this.config.onProgressCallback(a,this.filesToUpload[a].fileInfo.name,b,b);if(200==c.status){b=this.parseAndDecodeResponse(c.responseText);if(null===b)return;if("Failure"===b.message||"Error"===b.message){this.config.onErrorCallback(a,d,b.html);"true"===b.ignoreIt?(this.cancelCurrentUpload(a),this.uploadNextIfExists()):this.cancelRemainingUploads();this.runCustomHandlers(b.message,b,c);return}if(b.errormessage)this.config.onErrorCallback(a,
d,b.errormessage);else this.config.onCompleteCallback(a,d,b),this.runCustomHandlers("Success",b,c)}else this.config.onCompleteCallback(a,d,{});this.inProgressXhrs.remove(a.toString());this.removeFromWaitingQueueAndUploadNext(a)}},cancelInProgressUploads:function(){var a=this;this.inProgressXhrs.each(function(c){c=parseInt(c,10);a.cancelCurrentUpload(c)});this.inProgressXhrs=new Map},cancelWaitingUploads:function(){for(;0<this.fileUploadWaitingQueue.length;){var a=this.fileUploadWaitingQueue[0];a&&
this.cancelCurrentUpload(a)}this.fileUploadWaitingQueue=[]}});
Sfdc.ns("Sfdc.MultiFileUploaderUsageStats");Sfdc.MultiFileUploaderUsageStats=function(a){this.filterParentId=a.filterParentId;this.origin=a.origin;this.uploadMethod=a.uploadMethod;this.statsActionUrl=a.statsActionUrl;this.uploadStats=[]};Sfdc.MultiFileUploaderUsageStats.prototype.start=function(a){var b=(new Date).getTime();this.uploadStats[a.name]={fileType:a.type,fileSize:a.size,startTime:b}};
Sfdc.MultiFileUploaderUsageStats.prototype.finish=function(a){var b=(new Date).getTime();this.uploadStats[a.name].endTime=b};
Sfdc.MultiFileUploaderUsageStats.prototype.sendUsageStats=function(a){var b=Sfdc.MultiFileUploaderUtil.getBrowserName(),c="",e;for(e in this.uploadStats)if(this.uploadStats.hasOwnProperty(e)){var d=this.uploadStats[e],f=0;d.endTime&&(f=d.endTime-d.startTime);c+=d.fileType+",";c+=d.fileSize+",";c+=f+",";c+=";"}b={mfu:"1",stats:c,browser:b,method:this.uploadMethod,count:a,origin:this.origin};this.filterParentId&&(this.origin===Sfdc.ChatterFileUploader.PROFILE_PAGE&&this.filterParentId!=UserContext.userId)&&
(b.fcnt=a,b.fpid=this.filterParentId);chatter.getToolbox().post({url:this.statsActionUrl,params:b,failure:function(a,b){},success:function(a,b){}})};
Sfdc.ns("Sfdc.UploadButton");Sfdc.UploadButton=function(b){this.config={uploadBtnAnchor:null,name:"file",onChange:function(a){}};Sfdc.MultiFileUploaderUtil.extend(this.config,b);this.uploadBtnAnchor=this.config.uploadBtnAnchor;this.uploadBtnAnchor.style.position="relative";this.uploadBtnAnchor.style.overflow="hidden";this.uploadBtnAnchor.style.direction="ltr";this.inputElem=this.createInputBtn()};Sfdc.UploadButton.HIDDEN_MULTI_INPUT_ID="multiFileInput";Sfdc.UploadButton.HIDDEN_SINGLE_INPUT_ID="singleFileInput";
Sfdc.UploadButton.prototype={getInput:function(){return this.inputElem},reset:function(){Sfdc.Dom.removeChild(this.inputElem);this.inputElem=this.createInputBtn()},createFocusInputBtn:function(){var b=document.createElement("input");b.setAttribute("type","button");b.setAttribute("class","btnImportant");b.id="multiUploadBtn";b.value=LC.getLabel("ChatterFilesTabPage","uploadMultiFilesLinkText");return b},createHiddenInputBtn:function(b){var a=document.createElement("input");a.setAttribute("type","file");
a.setAttribute("name","chatterFile_upload");a.setAttribute("title",LC.getLabel("ChatterFilesTabPage","uploadMultiFilesLinkText"));!0===b?(a.setAttribute("multiple","multiple"),a.setAttribute("class","multifile-upload-input-button"),a.id=Sfdc.UploadButton.HIDDEN_MULTI_INPUT_ID):(a.setAttribute("class","singlefile-upload-input-button"),a.id=Sfdc.UploadButton.HIDDEN_SINGLE_INPUT_ID);this.uploadBtnAnchor.appendChild(a);var c=this;addEvent(a,"change",function(){c.config.onChange(a)});return a},createInputBtn:function(){var b=
this.createHiddenInputBtn(!0),a=this.createFocusInputBtn();this.uploadBtnAnchor.appendChild(a);Sfdc.on(this.uploadBtnAnchor,"click",function(a){document.getElementById(Sfdc.UploadButton.HIDDEN_MULTI_INPUT_ID).click()});Sfdc.on(document.getElementById(Sfdc.UploadButton.HIDDEN_MULTI_INPUT_ID),"click",function(a){Sfdc.Event.stopPropagation(a)});return b}};
Sfdc.ns("Sfdc.UploadFileDragDropZone");Sfdc.UploadFileDragDropZone=function(a){this.DRAG_AND_DROP_TARGET_OVERLAY_ID="dragAndDropTargetOverlay";this.config={onEnterCallback:function(){},onLeaveCallback:function(){},onDropCallback:function(a){}};Sfdc.MultiFileUploaderUtil.extend(this.config,a);this.dragFromOS=!0;this.isEntered=!1;this.errorDialog=null;this.attachDragDropEvents()};
Sfdc.UploadFileDragDropZone.prototype={attachDragDropEvents:function(){var a=this;addEvent(document,"dragstart",function(b){a.dragFromOS=!1});addEvent(document,"dragend",function(b){a.dragFromOS=!0});addEvent(document,"dragover",function(b){b.stopPropagation();b.preventDefault();if(a.isValidFileDrag(b)){var c=Sfdc.userAgent.isIE10||Sfdc.userAgent.isIE11?"move":b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect="move"==c||"linkMove"==c?"move":"copy"}});addEvent(document,"dragenter",function(b){b.stopPropagation();
b.preventDefault();if((!a.errorDialog||!a.errorDialog.isOpen)&&!a.isDragAndDropInProgress()&&a.isValidFileDrag(b))a.config.onEnterCallback()});addEvent(document,"dragleave",function(b){b.stopPropagation();b.preventDefault();if(a.isDragAndDropInProgress()&&a.isEventFromDragAndDropOverlay(b))a.config.onLeaveCallback()});addEvent(document,"drop",function(b){b.stopPropagation();b.preventDefault();if(a.isDragAndDropInProgress()&&a.isValidFileDrag(b))a.config.onDropCallback(b)})},createDragAndDropOverlay:function(){var a=
document.createElement("div");a.id=this.DRAG_AND_DROP_TARGET_OVERLAY_ID;document.body.appendChild(a)},destroyDragAndDropOverlay:function(){var a=document.getElementById(this.DRAG_AND_DROP_TARGET_OVERLAY_ID);a.parentNode.removeChild(a)},isEventFromDragAndDropOverlay:function(a){return a.target.id===this.DRAG_AND_DROP_TARGET_OVERLAY_ID},isValidFileDrag:function(a){a=a.dataTransfer;return Sfdc.get(".multifile-upload-draganddrop-indicactor")&&this.dragFromOS&&(Sfdc.userAgent.isIE10||Sfdc.userAgent.isIE11||
a&&"none"!=a.effectAllowed&&(a.files||!Sfdc.userAgent.isWebkit&&a.types.contains&&a.types.contains("Files")))},isDragAndDropInProgress:function(){return this.isEntered}};
Sfdc.ns("Sfdc.MultiFileUploaderUiComponents.FileUploadBadge");
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge=function(a,b,c,g,d){d=Sfdc.MultiFileUploaderUiComponents.FileUploadBadge;var e=d.makeFileTypeIcon(b.type),h=b.name,k=b.name,f=Sfdc.MultiFileUploaderUtil.formatFileSize(b.size),f=LC.getLabel("ChatterFileMultiUpload","valueInParentheses",f);d=Sfdc.String.format(d.HTML_TEMPLATE,{type:e,name:Sfdc.String.escapeToHtml(h),title:Sfdc.String.escapeToHtml(k),size:f});this.dom=d=Sfdc.MultiFileUploaderUtil.createElementFromHTML(d);e=LC.getLabel("ChatterFileMultiUpload",
"waiting");Sfdc.get(".multifile-upload-status",this.dom).innerHTML=e;this.fileDoesNotMeetLimits=!1;this.progressBar=new Sfdc.MultiFileUploaderUiComponents.ProgressBar(Sfdc.get(".singleProgress",this.dom),g);b.size?c&&b.size>c&&(this.displayWarningMessage(LC.getLabel("ChatterFileMultiUpload","fileLargerThanMaxLimit",Sfdc.ChatterFileUploader.maxFileSizeLabel)),this.fileDoesNotMeetLimits=!0):(this.displayWarningMessage(LC.getLabel("ChatterFileMultiUpload","fileIsEmpty")),this.fileDoesNotMeetLimits=!0);
d.mfuFileId=a};Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.HTML_TEMPLATE='\x3cli class\x3d"multi-item"\x3e\x3cspan class\x3d"multifile-upload-file"\x3e\x3cspan class\x3d"multifile-upload-type"\x3e{type}\x3c/span\x3e\x3cspan class\x3d"multifile-upload-name" title\x3d"{title}"\x3e{name}\x3c/span\x3e\x3cspan class\x3d"multifile-upload-size"\x3e{size}\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"singleProgress"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"warningMessage hidden"\x3e\x3cspan class\x3d"warningMessageSpan"\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"multifile-upload-status"\x3e\x3c/span\x3e\x3ca class\x3d"multifile-upload-cancel" href\x3d"javascript:void(0);"\x3e\x3cimg title\x3d"" alt\x3d"" src\x3d"/s.gif" class\x3d"deleteIconClass"/\x3e\x3c/a\x3e\x3cimg title\x3d"" alt\x3d"" src\x3d"/s.gif" class\x3d"uploadDoneIconClass hidden"/\x3e\x3cimg title\x3d"" alt\x3d"" src\x3d"/s.gif" class\x3d"uploadWarningIconClass hidden"/\x3e\x3c/li\x3e';
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.CSS={successClass:"successClass",failClass:""};Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.makeFileTypeIcon=function(a){return'\x3cimg height\x3d"16" width\x3d"16" src\x3d"/s.gif"  class\x3d"'+Sfdc.MultiFileUploaderUtil.formatFileTypeCSS(a,"16")+'" /\x3e'};Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.prototype.updateProgressBar=function(a){this.progressBar.update(a)};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.prototype.updateFileProgressPercentage=function(a){Sfdc.get(".multifile-upload-status",this.dom).innerHTML=a+"%"};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.prototype.displayWarningMessage=function(a){Sfdc.Dom.addClass(this.dom,"warningBackGround");Sfdc.Dom.hideByDisplay(Sfdc.get(".singleProgress",this.dom));Sfdc.Dom.show(Sfdc.get(".warningMessage",this.dom));var b=Sfdc.get(".warningMessageSpan",this.dom);Sfdc.Dom.setText(b,a);Sfdc.Dom.addClass(b,"warningLabelInRed");Sfdc.Dom.addClass(Sfdc.get(".multifile-upload-cancel",this.dom),"hidden");Sfdc.Dom.removeClass(Sfdc.get(".uploadWarningIconClass",this.dom),
"hidden");Sfdc.Dom.hideByVisibility(Sfdc.get(".multifile-upload-status",this.dom))};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.prototype.displayAsCanceled=function(){var a=this.dom;Sfdc.Dom.addClass(a,"warningBackGround");a&&(a.isAbort=!0);Sfdc.Dom.hideByVisibility(Sfdc.get(".singleProgress",a));Sfdc.Dom.hideByVisibility(Sfdc.get(".multifile-upload-cancel",a));a=Sfdc.get(".multifile-upload-status",a);Sfdc.Dom.setText(a,LC.getLabel("ChatterFileMultiUpload","cancelled"));Sfdc.Dom.hasClass(a,"doneLabelInGreen")&&Sfdc.Dom.removeClass(a,"doneLabelInGreen");Sfdc.Dom.addClass(a,
"warningLabelInRed")};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.prototype.displayAsCompleted=function(a){var b=this.dom;if(b){var c=Sfdc.get(".multifile-upload-status",b);Sfdc.Dom.addClass(c,"doneLabelInGreen");Sfdc.Dom.hideByVisibility(Sfdc.get(".singleProgress",b));c.innerHTML=LC.getLabel("ChatterFileMultiUpload","done");Sfdc.Dom.hasClass(c,"warningLabelInRed")&&Sfdc.Dom.removeClass(c,"warningLabelInRed");Sfdc.Dom.addClass(Sfdc.get(".multifile-upload-cancel",b),"hidden");Sfdc.Dom.removeClass(Sfdc.get(".uploadDoneIconClass",b),
"hidden")}a&&"Success"===a.message?Sfdc.Dom.addClass(b,Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.CSS.successClass):Sfdc.Dom.addClass(b,Sfdc.MultiFileUploaderUiComponents.FileUploadBadge.CSS.failClass)};
function ExternalFileProgressDialog(b,c,d,a){ActionProgressDialog.call(this,b,c,d,a)}ExternalFileProgressDialog.prototype=new ActionProgressDialog;ExternalFileProgressDialog.show=function(b,c,d){var a=sfdcPage.getDialogById(b);a||(a=new ExternalFileProgressDialog(b),a.register());a.setProgressMsgTitle(c);a.setProgressMsgText(d);a.createContent();a.show();return a};
ExternalFileProgressDialog.showOnGetFileInfo=function(b){var c=LC.getLabel("Publisher","externalFileGetInfoProgressTitle"),d=LC.getLabel("Publisher","externalFileGetInfoProgressText");return ExternalFileProgressDialog.show(b,c,d)};
ExternalFileProgressDialog.showOnPostFile=function(b,c){var d=LC.getLabel("Publisher","externalFilePostProgressTitle"),a;a=c?LC.getLabel("Publisher","externalFilePostAsReferenceProgressText"):LC.getLabel("Publisher","externalFilePostAsCopyProgressText");return ExternalFileProgressDialog.show(b,d,a)};
function FeedPostContentUploadDialog(c,b,d,e){ActionProgressDialog.call(this,c,b,d,e)}FeedPostContentUploadDialog.prototype=new ActionProgressDialog;FeedPostContentUploadDialog.prototype.addButtonBar=function(){this.overrideButton(0,LC.getLabel("Publisher","postFileProgressCancel"),"chatter.getPublisher().getHandler('ContentPost').handleFileUploadCancel()")};
FeedPostContentUploadDialog.getDialog=function(c,b,d,e){var a=sfdcPage.getDialogById(c);a||(a=new FeedPostContentUploadDialog(c),a.register());d?(b+=d,c='\x3cspan class\x3d"multifile-upload-type"\x3e\x3cimg height\x3d"16" width\x3d"16" src\x3d"/s.gif"  class\x3d"'+Sfdc.MultiFileUploaderUtil.formatFileTypeCSS(d)+'" /\x3e\x3c/span\x3e',a.setProgressMsgTitle(c+"\x26nbsp;"+b,b)):a.setProgressMsgTitle(LC.getLabel("Publisher","postFileUploading")+" "+b,b);a.setProgressMsgText(LC.getLabel("Publisher","postFileProgressText"));
a.setHelpUrl(e);a.createContent();return a};
function ApprovalPostDialog(a,b,c,d){this.workItemId=a;this.transitionType=b;this.targetObjectType=c;this.servletUrl=d;this.lookupMode=!1;this.comments=this.lookupInputHTML="";this.receivedResponse=this.showNextApprover=!1;this.timeOutId=null}ApprovalPostDialog.prototype=new OverlayDialog;ApprovalPostDialog.prototype.createContent=OverlayDialogElement.prototype.createContent;
ApprovalPostDialog.prototype.getDialog=function(a){var b=sfdcPage.getDialogById(a);if(b)return this.resetDlgContents(),b;OverlayDialogElement.call(this,a);this._initApprovalOverlay();this.register();return this};
ApprovalPostDialog.prototype._initApprovalOverlay=function(){this.allowKeyboardEsc=this.displayX=this.hasButtonsBar=this.isModal=!0;this.extraClass="";this.refreshOnClose=this.isAbsolutePositioned=!1;var a=this._getIdBase();this.buttonContents='\x3cinput value\x3d"'+LC.getLabel("Buttons","ok")+'" class\x3d"'+ZenCss.btn+'" name\x3d"ok" onclick\x3d"'+a+'Var.executeProcessAction();" title\x3d"OK" type\x3d"button" /\x3e\x3cinput value\x3d"'+LC.getLabel("Buttons","cancel")+'" class\x3d"'+ZenCss.btn+'" name\x3d"cancel" onclick\x3d"'+
a+"Var.getDialog('"+a+'overlay\').cancel()" title\x3d"Cancel" type\x3d"button" /\x3e';this.contents='\x3cdiv id\x3d"'+a+'commentDiv" style\x3d"display:block; padding:5px"\x3e\x3cdiv id\x3d"commentPrompt" style\x3d"padding-bottom:5px"\x3e'+LC.getLabel("FeedPostAction","OverlayCommentPrompt")+'\x3c/div\x3e\x3ctextarea class\x3d"feedPostComment" cols\x3d"60" id\x3d"'+a+'comment" maxlength\x3d"1000" name\x3d"'+a+'comment" rows\x3d"5" type\x3d"text" wrap\x3d"soft"\x3e\x3c/textarea\x3e\x3c/div\x3e\x3cdiv id\x3d"'+
a+'nextApproverDiv" class\x3d"overlayPanel nextApproverOverlay" style\x3d"display:none"\x3e\x3c/div\x3e\x3cdiv class\x3d"spinner" id\x3d"'+a+'spinnerDiv" style\x3d"display:none"\x3e\x3c/div\x3e\x3cdiv class\x3d"overlayPanel" id\x3d"'+a+'errorDiv" style\x3d"display:none"\x3e\x3cdiv class\x3d"message errorM3" id\x3d"'+a+'errorMsg"\x3e\x3cdiv class\x3d"messageDiv"\x3e\x3cimg src\x3d"/s.gif" alt\x3d"Error" class\x3d"msgIcon" title\x3d"Error"/\x3e\x3cdiv class\x3d"messageText" style\x3d"padding-left:18px"\x3e\x3c/div\x3e\x3c/div\x3e\x3cscript type\x3d"text/javascript"\x3eif (window.sfdcPage) sfdcPage.registerMessage(\''+
a+'errorMsg\');\x3c/script\x3e\x3c/div\x3e\x3cdiv class\x3d"buttons" id\x3d"'+a+'error_buttons" style\x3d"display:none"\x3e\x3cinput value\x3d"'+LC.getLabel("Buttons","ok")+'" class\x3d"'+ZenCss.btn+'" name\x3d"rejectButton" onclick\x3d"'+a+"Var.getDialog('"+a+'overlay\').cancel()" title\x3d"OK" type\x3d"button" /\x3e\x3c/div\x3e\x3c/div\x3e';this.setWidth(480);"A"==this.transitionType?this.setTitle(LC.getLabel("FeedPostAction","OverlayApproveTitle")):this.setTitle(LC.getLabel("FeedPostAction","OverlayRejectTitle"))};
ApprovalPostDialog.prototype.resetDlgContents=function(){var a=this._getIdBase(),b=Sfdc.get(a+"comment"),a=Sfdc.get(a+"nextApprover");b&&(b.value="");a&&(a.value="");this.lookupMode=!1;a&&this.lookupInputHTML&&this._updateLookupControl(this.lookupInputHTML);this._updateErrorMsg("","error");this._updateLookupErrorMsg("");this._updateCommentErrorMsg("");this.showNextApprover=!1;this._showCommentInputState(!0);this._showButtonBarState(!0);this._showNextApproverInputState(!1);this._showErrorState(!1);
this._showPendingState(!1)};
ApprovalPostDialog.prototype.executeProcessAction=function(){var a=this._getIdBase(),b="",c="",d="005";if(this.showNextApprover){Sfdc.get(a+"nextApproverDiv");var b=(b=Sfdc.get(a+"nextApprover_lkid"))&&b.value?b.value:"",e=Sfdc.get(a+"nextApprover_mlktp");e&&(d=e.value);if(0===b.length||b==Udd.EMPTY_KEY)if(this.lookupMode=!0,b="",c=(c=Sfdc.get(a+"nextApprover"))&&c.value?Sfdc.String.trim(c.value):"",0===c.length){this._updateLookupErrorMsg(LC.getLabel("Edit","Required"));return}}else if(this.comments=
(e=Sfdc.get(a+"comment"))&&e.value?e.value:"",1E3<e.value.length){this._updateCommentErrorMsg(LC.getLabel("Edit","TooLong"));return}this._showCommentInputState(!1);this._showNextApproverInputState(!1);this._showButtonBarState(!1);this._showErrorState(!1);this._showPendingState(!0);d={workitemId:this.workItemId,transitionType:this.transitionType,targetObjectType:this.targetObjectType,comments:this.comments,nextOwnerId:b,nextOwnerLookupVal:c,lookupType:d};d[a+"nextApprover"]=c;this.timeOutId&&(clearTimeout(this.timeOutId),
this.timeOutId=null);var f=window[a+"Var"];this.timeOutId=setTimeout(function(){f._onTimeoutAjaxRequest(f)},6E4);this.receivedResponse=!1;Sfdc.Ajax.post(UserContext.getUrl(this.servletUrl),this.onCompleteProcessAction,{data:d,failure:this.onHttpFailure,context:this,escape:encodeURIComponent})};ApprovalPostDialog.prototype.onCompleteProcessAction=function(a){this.receivedResponse=!0;a=Util.evalAjaxServletOutput(a);a.actionSucceeded?this._processSuccessResponse():this._processFailureResponse(a)};
ApprovalPostDialog.prototype.onHttpFailure=function(a,b,c){this.receivedResponse=!0;this._getIdBase();this._showPendingState(!1);a=LC.getLabel("FeedPostAction","ServletHttpError",b.status);this._updateErrorMsg(a,"error");this._showErrorState(!0)};
ApprovalPostDialog.prototype.expandMore=function(a,b){var c=Sfdc.Dom.getParent(a,".approvalMoreContainer");if(c){var d=Sfdc.get(".approvalMoreLink",c);d&&(d.style.display="none")}d=null;b&&(d=Sfdc.Dom.getParent(a,b));if(c=Sfdc.get(".approvalExpandedContent",d?d:c))c.style.display="inline"};
ApprovalPostDialog.prototype._processSuccessResponse=function(){var a=this._getIdBase(),b=sfdcPage.getDialogById(a+"overlay");b&&b.cancel();if(b=Sfdc.get("buttons_"+this.workItemId))b.style.display="none";if(a=Sfdc.get(a+"status"))a.style.display="block"};
ApprovalPostDialog.prototype._processFailureResponse=function(a){if(a&&a.errMsg&&0<a.errMsg.length){var b=this._getIdBase();this._showPendingState(!1);if(0<a.missingNextApprover.length||this.lookupMode){if(this.lookupMode){this._updateLookupErrorMsg(a.errMsg);if(b=Sfdc.get(b+"nextApprover"))b.value="";this.lookupInputHTML=this._updateLookupControl(a.lookupHtml)}else this._populateNextApproverInput(a.missingNextApprover);ForeignKeyInputElement.reload();this.showNextApprover=!0;this._showNextApproverInputState(!0);
this._showButtonBarState(!0)}else this._updateErrorMsg(a.errMsg,a.severity),this._showErrorState(!0)}};ApprovalPostDialog.prototype._onTimeoutAjaxRequest=function(a){if(!a.receivedResponse){a._showPendingState(!1);var b=LC.getLabel("FeedPostAction","ServletTimeoutError");a._updateErrorMsg(b,"error");a._showErrorState(!0)}a.timeOutId&&(clearTimeout(a.timeOutId),a.timeOutId=null)};
ApprovalPostDialog.prototype._updateCommentErrorMsg=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"commentDiv")){var c=Sfdc.get(".errorMsg",b);c&&Sfdc.Dom.removeChild(c);c="\x3cdiv class\x3d'errorMsg'\x3e\x3c/div\x3e";0<a.length&&(c="\x3cdiv class\x3d'errorMsg'\x3e\x3cb\x3e"+LC.getLabel("Apex","Error")+"\x3c/b\x3e"+a+"\x3c/div\x3e");Sfdc.Dom.insertHTML(b,c)}};
ApprovalPostDialog.prototype._updateLookupErrorMsg=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"nextApproverDiv"))if(b=Sfdc.get(".requiredInput",b)){var c=Sfdc.get(".errorMsg",b);c&&Sfdc.Dom.removeChild(c);c="\x3cdiv class\x3d'errorMsg'\x3e\x3c/div\x3e";0<a.length&&(c="\x3cdiv class\x3d'errorMsg'\x3e\x3cb\x3e"+LC.getLabel("Apex","Error")+"\x3c/b\x3e"+a+"\x3c/div\x3e");Sfdc.Dom.insertHTML(b,c)}};
ApprovalPostDialog.prototype._updateLookupControl=function(a){var b=this._getIdBase();if((b=Sfdc.get(b+"nextApproverDiv"))&&a)(b=Sfdc.get(".requiredInput",b))&&Sfdc.Dom.updateHTML(b,a);return""};ApprovalPostDialog.prototype._updateErrorMsg=function(a,b){var c=this._getIdBase();if(c=Sfdc.get(c+"errorMsg"))if(b&&"info"==b?c.className="message infoM3":b&&"error"==b&&(c.className="message errorM3"),c=Sfdc.get(".messageText",c))c.innerHTML=a};
ApprovalPostDialog.prototype._showCommentInputState=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"commentDiv"))b.style.display=a?"block":"none"};ApprovalPostDialog.prototype._populateNextApproverInput=function(a){var b=this._getIdBase();(b=Sfdc.get(b+"nextApproverDiv"))&&Sfdc.Dom.updateHTML(b,a);this._updateLookupErrorMsg("")};
ApprovalPostDialog.prototype._showNextApproverInputState=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"nextApproverDiv"))a&&this.showNextApprover?(b.style.display="block",this._centerLookupElement()):b.style.display="none"};
ApprovalPostDialog.prototype._centerLookupElement=function(){var a=this._getIdBase(),b=Sfdc.get(a+"nextApproverLookup");if(b){var c=0,d=Sfdc.get(a+"nextApprover_top");d&&(d.style.display="inline");var e=Sfdc.get(".errorMsg",b);e&&(e.style.display="none");c=b.offsetWidth;d&&!Ext.isIE7&&(d.style.display="");a=Sfdc.get(a+"nextApproverDiv").offsetWidth;c=Math.round((parseInt(a)-parseInt(c))/2);b.style.left=c+"px";e&&(e.style.display="",e.style.left="-"+c+"px")}};
ApprovalPostDialog.prototype._showButtonBarState=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"overlay_buttons"))b.style.display=a?"block":"none"};ApprovalPostDialog.prototype._showPendingState=function(a){var b=this._getIdBase();if(b=Sfdc.get(b+"spinnerDiv"))b.style.display=a?"block":"none"};
ApprovalPostDialog.prototype._showErrorState=function(a){var b=this._getIdBase(),c=Sfdc.get(b+"errorDiv"),b=Sfdc.get(b+"error_buttons");c&&(c.style.display=a?"block":"none");b&&(b.style.display=a?"block":"none")};ApprovalPostDialog.prototype._getIdBase=function(){return this.transitionType+"_"+this.workItemId+"_"};chatter.extend("ApprovalPost",ApprovalPostDialog,null);
(function(){chatter.extend("CanvasAuxThumbnailRetriever",function(){function a(){var a=Sfdc.select("."+c.classPrefetch);a&&0<a.length&&Sfdc.each(a,function(a){Sfdc.Dom.removeClass(a,c.classPrefetch);Sfdc.get("\x3e a \x3e img",a).setAttribute("src",a.getAttribute("data-canvasThumbnailUrl"));Sfdc.Dom.addClass(a,c.classFetched)})}var b=chatter.getEventBus(),c={classPrefetch:"canvasThumbnail-prefetch",classFetched:"canvasThumbnail-fetched"};b.addEventListener("chatter:feed","onAfterFeedRefresh",a);b.addEventListener("chatter:feed",
"onAfterShowMoreFeedItems",a);b.addEventListener("chatter:feed","onAfterNewPostFeedUpdate",a);b.addEventListener("chatter:rechat","onAfterPreviewLoaded",a);b.addEventListener("unifiedSearchPage:feedSearchResults","onAfterResultsShown",a);this.parseDOMAndRender=function(){a()}},null);Sfdc.onload(function(){chatter.getCanvasAuxThumbnailRetriever().parseDOMAndRender()})})();
chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterFeed:Start");
function Feed(){function B(){return Sfdc.get("feedwrapper")}function n(){var a=B();return a?Sfdc.get(".cxfeedcontainer",a):null}function t(a,c,b,d,f,h){var g;try{g=I(a+"_"+b,c,d,f,h)}catch(e){g=void 0}g||(g=I(a,c,d,f,h));return g}function I(a,c,b,d,f){return b&&d&&f?LC.getLabel(a,c,b,d,f):b&&d?LC.getLabel(a,c,b,d):b?LC.getLabel(a,c,b):LC.getLabel(a,c)}function X(){var a=Sfdc.get("chatterfeedshell");return a&&Sfdc.select(".feedrightbar",a)[0]}function l(a){return Ext.get(a).findParent(".cxfeeditem",
50,!0)}function y(a){return Ext.get(a).findParent(".cxfeedcomment",50,!0)}function Y(a,c){if(c){var b=!(e.getCommentElement(c.id).getInputValueLength()<=J),d=chatter.getTextareaMessageUtil().isMessageDisplayed(c.id,"CommentMaxLengthErrorMsg"),f=LC.getLabel("Feeds","CommentMaxLengthErrorMsg",J);b!=d&&(d=chatter.getTextareaMessageUtil(),b?(d.showMessage({el:c.id,type:1,append:!0,msg_html:f,msg_id:"CommentMaxLengthErrorMsg"}),chatter.getToolbox().disableButton(K(c))):d.hideMessage({el:c.id,msg_id:"CommentMaxLengthErrorMsg"})||
chatter.getToolbox().enableButton(K(c)))}}function K(a){a=Sfdc.Dom.getParent(a,".cxchattertextareacontainer");return Sfdc.get(".cxchattersubmit",a)}function L(a){if(!a.hasClass("cxiswired")){a.dom.value="";a.on("keyup",Y);chatter.getToolbox().expandableTextArea(a.dom,C,D);chatter.getToolbox().initializeIE8JPNTypingFix(a.dom);var c=a.hasClass("groupAtMentionsEnabled"),b=a.hasClass("externalGroupInputElement"),d=l(a).dom,f=null;Sfdc.Dom.hasClass(d,"cxrechatfeeditem")||(f=d.id);var h=e.getFeedItemData(d),
c=new PublisherAutoComplete(a.dom.id,"/autocomplete",{},f,c,h.parentid,h.parentname);Sfdc.Dom.hasClass(d,"cxfeeditemoverlay")&&c.setIsOverlay(!0);b&&c.toggleExternalGroupWarning(!0);z[c.id]=c;Z(a,d);a.addClass("cxiswired")}}function Z(a,c){var b=e.getFeedItemData(c),d=e.getConfig();if(d&&d.isPrivateGroup&&b&&d.subjectId!==b.parentid){var d=Sfdc.get(".feeditemvisibilitycontainer",c),f=Sfdc.Dom.create(d,{},"div");Sfdc.Dom.addClass(f,"visibilityWidgetParent");f=Sfdc.Dom.create(f,{href:"javascript:void(0);",
title:LC.getLabel("Feeds","WhoCanSeeYourComment")},"a");Sfdc.Dom.addClass(f,"visibilityicon");var h=Sfdc.Dom.create(f,{},"span");Sfdc.Dom.addClass(h,"zen-assistiveText");Sfdc.Dom.insertHTML(h,LC.getLabel("Feeds","WhoCanSeeYourComment"));if(Sfdc.userAgent.isIE7)var g=Sfdc.Dom.getParent(d,".chattertextareacontainer"),k=function(){Sfdc.Dom.addClass(g,"feeditemZIndex")},m=function(){Sfdc.Dom.removeClass(g,"feeditemZIndex")};var p=new VisibilityWidget({icon:f,helpUrl:e.getCommentVisibilityHelpLink(),onexpand:k,
oncollapse:m});Sfdc.Event.add(f,"click",function(){p.toggleDisplay()});var q={text:LC.getLabel("Feeds","WhoCanSeeThisCommentMsg",b.parentActualName),title:LC.getLabel("Feeds","WhoCanSeeThisCommentTitle")},s={text:LC.getLabel("Feeds","WhereCanOthersFindThisCommentMsg",b.parentActualName),title:LC.getLabel("Feeds","WhereCanOthersFindThisCommentTitle")};p.registerHandler(function(){return[q,s]});b=LC.getLabel("Feeds","CommentPostAtmentionPrivateGroupMsg");d=Sfdc.Dom.create(d,{},"div");Sfdc.Dom.addClass(d,
"visibilityWarningMessage");Sfdc.Dom.insertHTML(d,b)}}function M(a,c){var b=a.child(".cxfeedcommentcount");if(b){var d=parseInt(b.dom.innerHTML,10),f=d+c;if(1==f||1==d){b=a.child(".cxshowmorecommentslabel").dom;d=Ext.DomHelper.markup({cls:"cxfeedcommentcount",tag:"span",html:f});f=1==f?LC.getLabel("Feeds","ShowOneComment",d):LC.getLabel("Feeds","ShowAllComments",d);b.innerHTML=f;return}b.dom.innerHTML=f}if(b=a.child(".cxsummarycommentcount"))d=b.dom.getAttribute("data-commentcount"),f=d+c,0<f?r.show(b):
r.hide(b),b.dom.setAttribute("data-commentcount",f)}function N(a){var c=chatter.getToolbox(),b=a.select("div.cxfeedcomment"),d=a.select("div.cxfeeditemlike"),f=a.child(".cxfeedcommentsshowmore"),h=a.child(".cxnewcommenttext"),h=h?h.dom.value:"",g=a.child(".linkedContentDetailsContainer");0===b.getCount()&&(null===f&&0===d.getCount())&&(c.hide(a.child("div.cxcomments")),c.stringIsEmpty(h)&&!g&&(c.hide(a.child("div.cxnewcomment")),c.hide(a.child("div.cxcommentplaceholder"))))}function O(a,c,b){var d=
a.child(".cxshowmorecommentscontainer"),f=chatter.getToolbox();f.mask(d);var h=e.getConfig();c.writable=h.writable;var g=e.search,k;for(k in g)c[k]=g[k];g=e.pagingParams;for(k in g)c[k]=f.htmlDecode(g[k]);c.returnCommentExpanded=h.alwaysShowFullText;f.get({url:"/feeditems/"+c.feeditemid+"/comments",params:c,failure:function(){f.unmask(d)},success:function(c,h){b();a.child(".cxfeedcommentsshowmore").remove();var g=a.child(".cxcomments");g.createChild(h.html,a.child(".cxcomments\x3e.cxfeedcomment:first"));
var e=chatter.getEventBus();SfdcApp.MruHovers.isHoverSection(a)&&e.fireEvent("chatter:hover","onAfterUpdate",{container:g});SfdcCmp.init(g.dom);f.unmask(d);a.child(".cxaddcommentaction").focus()}});return!1}function E(a,c){if(e.getConfig().isCompactFeed){var b=n();b&&(b=Sfdc.select(".cxfeeditem",b),c&&b.length>c&&(b=b.slice(0,c)),Sfdc.each(b,a),chatter.getEventBus().fireEvent("chatter:feed","onAfterExpandedStateChange",{subjectId:e.getConfig().subjectId}))}}function u(){return Sfdc.get(".feedsupermenu",
n())}function P(a,c){e.searchString=c;var b={isPost:!0,verb:";edit",feedType:"SEARCH",isFullRefresh:!1},d;d=a.params?a.params:a;d.showFeedItemsOnly=!0;d.initialViewMode="feeds";d.str=e.searchString;var f=Sfdc.get("filterDisplay");f&&(d.label=f.innerHTML);"SEARCH"!==a.feedType&&(e.findInFeedType=a.feedType);d.findInFeedType=e.findInFeedType;b.params=d;var h=Sfdc.clone(b.onSuccess);b.onSuccess=function(){e.expandSearchAndShowMenu(c);Sfdc.isFunction(h)&&h(json);if(d.isDropDownFiltersVisible){var a=Sfdc.get("filterDisplay");
a&&Sfdc.Dom.updateHTML(a,d.label)}};return b}var e=this,r=chatter.getToolbox(),J=5E3,C=16,D=2,A=null,z={},F={};e.config={};e.commentVisibilityHelpLink;var $=function(a){return(a=a.select("div.cxfeedcomment"))&&0<a.getCount()},Q=function(a,c){var b=chatter.getToolbox(),d=l(a);b.hide(d.child(".cxcontentcommentaction"));chatter.getToolbox().get({params:{q:";linkedContentDetails",contentDocumentId:c,cc:!0},success:function(b,c){l(a).child(".cxcontentcommentinfo").dom.innerHTML=c.html}})},aa=function(a,
c,b){var d=chatter.getToolbox(),f=l(a);d.hide(f.child(".cxcontentcommentaction"));var h=ExternalFileProgressDialog.showOnGetFileInfo("extFileProgress");chatter.getToolbox().get({url:"/contenthub/linkedfiledetails/"+c+"/"+encodeURIComponent(b),params:{cc:!0},success:function(b,c){h.hide();l(a).child(".cxcontentcommentinfo").dom.innerHTML=c.html},failure:function(a,b){h.hide()}})},v=function(a){return attachFileEl=a.child(".cxcontentcommentaction")},R=function(a,c,b){a=l(a).child(".cxnewcommenttext");
b?a.addClass(c):a.removeClass(c)},S=function(a){chatter.getToolbox().log("Fetching feed");var c=a.params||{};c.isFullRefresh=!1;var b=a.verb||"",d=c.subjectId?c.subjectId:UserContext.userId,b=a.url||"/feed/"+d+"/"+a.feedType+b;c.isCompactFeed||(c.isCompactFeed=e.getConfig().isCompactFeed);c={url:b,params:c,success:a.onSuccess,failure:a.onFailure,abortTargets:["feedRefresh"],ajaxInstanceKey:"feedRefresh"};a=a.isPost?"post":"get";chatter.getToolbox()[a](c)},T=function(a,c){chatter.getToolbox().log("Replacing feed with fetched feed");
var b=n();Sfdc.Dom.hideByVisibility(b);var d=chatter.getEventBus();d.fireEvent("chatter:feed","onBeforeRemoveFeed");var f=a.html;Sfdc.Dom.updateHTML(B(),f,!0);(f=Sfdc.get(c.feedItemId,b))&&e.removeItemElement(f);Sfdc.Dom.show(b,!0);a.pollingToken=c.pollingToken;d.fireEvent("chatter:feed","onAfterFeedRefresh",{json:a});G(c)},G=function(a){var c=chatter.getEventBus();c.fireEvent("chatter:feed","onBeforeNewPostFeedUpdate",{json:a});var b=chatter.getToolbox().runScriptReturnHtml(a.html,chatter.getYoutubeVideo().fetchVideoPreviews),
b=e.addFeedItem(b);c.fireEvent("chatter:feed","onAfterNewPostFeedUpdate",{json:a,feedItem:b})},U=function(a,c){G(c.json)},ba=function(a,c){chatter.getToolbox().get({url:"/"+c+"/actionlinks/"+a.id,success:function(a,d){V(c,d)},failure:function(){}})},V=function(a,c){if(c.primaryGroupHtml){var b=Sfdc.get("#"+a+" .actionlinkscontainer.primary",n());b&&Sfdc.Dom.updateHTML(b,c.primaryGroupHtml)}else c.unclassifiedGroupHtml&&(b=Sfdc.get("#"+a+" .actionlinkscontainer.unclassified",n()))&&Sfdc.Dom.updateHTML(b,
c.unclassifiedGroupHtml)},ca=function(a){var c=null,b=a,d=function(){c&&(c.closeDialog(),c=null);var a=Sfdc.get("quickActionContainer");a&&Sfdc.Dom.removeChild(a)};a=chatter.getEventBus();a.addEventListener("chatter:publisher","onAfterUpdateStatus",function(a,b){d()});a.addEventListener("chatter:publisher","onAfterNonFeedUpdateStatus",function(a,b){d()});var f=function(a){a&&"09D"===a.substring(0,3)&&(a+="actionLink");return chatter.getPublisher().getHandler(a)};this.launchQuickAction=function(a,
b){function e(){var a=Sfdc.get("quickActionContainerContent"),b=null,c=null;a&&(b=Sfdc.get("quickactiondata",a))&&(c=f(Sfdc.Dom.getAttribute(b,"data-quickactionid")));if(a&&c){c.setupPanel();c.onShowPanel();var d=function(b,c){var d=Sfdc.get(b,a),f=Sfdc.get(c,a);d&&f&&Sfdc.Dom.replaceChildrenWith(d,f)},h=function(b){(b=Sfdc.get(b,a))&&Sfdc.Dom.show(b)},g=[];g.push({placeholder:".publisherTextAreaPlaceholder",component:".publisherTextAreaContainer"});g.push({placeholder:".publisherBottomBarPlaceholder",
component:".bottomBar"});g.push({placeholder:".publisherShareButtonPlaceholder",component:".quickActionSubmitButton"});var m=Sfdc.get(".quickActionSubmitButton",a);if(m&&c&&Sfdc.isObject(c.config.submitValueAndTitle)){var l=c.config.submitValueAndTitle;Sfdc.Dom.set(m,{value:l.value,title:l.title})}for(m=0;m<g.length;m++)d(g[m].placeholder,g[m].component);for(d=0;d<g.length;d++)h(g[d].component);(function(a){if(a){var d=c.config.promptText;d||b&&(d=Sfdc.Dom.getAttribute(b,"data-defaultprompttext"));
Sfdc.Dom.set(a,"value",d);Sfdc.on(a,"focus",function(){d===a.value&&Sfdc.Dom.set(a,"value","");Sfdc.Dom.addClass(a,"publishertextareafocus")});chatter.getToolbox().initializeIE8JPNTypingFix(a);(new PublisherAutoComplete(a.id,"/autocomplete",{},null,Sfdc.Dom.hasClass(a,"groupAtMentionsEnabled"),"","")).setIsOverlay(!0)}})(Sfdc.get(".publishertextarea",a))}else 50>p&&(p++,setTimeout(e,200))}d();var m={id:"quickActionContainer",title:b.label,url:"/feeditems/quickactions/"+encodeURIComponent(b.apiName)+
"/form",width:"564px",extraClass:"zen publishercontainer quickActionContainer",isDialogPositionAbsolute:!0,params:{contextId:a}};if(c=chatter.createModalOverlay(m))c.register(),c.open();var p=0;setTimeout(e,200)};this.submitQuickAction=function(a,b){var c=chatter.getEventBus(),d=f(a);c.fireEvent("chatter:publisher","onBeforeUpdateStatus");var e=Sfdc.get(".quickActionSubmitButton");e&&(e.disabled=!0);d.config.omnitureEvent&&omnitureWrapper&&omnitureWrapper.trackEvent(chatter.getOmnitureEventMap()[d.config.omnitureEvent]);
var e={feedItemType:a,entityId:b},q=chatter.getFeed();if(q){var s=q.getConfig();s&&(s.feedType&&(e.feedType=s.feedType),s.isCompactFeed&&(e.isCompactFeed=s.isCompactFeed));if(q=q.getPollToken())e.pollingToken=q}var l=function(a,b){c.fireEvent("chatter:publisher","onAfterUpdateStatus",{json:b});if(Sfdc.isFunction(d.onSuccess))d.onSuccess(a,b)},q=function(a){if(Sfdc.isFunction(d.validatePayload)){var b=d.validatePayload(a);if(!b.isValid){if(Sfdc.isFunction(d.onValidationFailure))d.onValidationFailure(b.errorPayload);
return}}Sfdc.isFunction(d.postWithCustomFunction)?d.postWithCustomFunction(a):r.post({url:"/feeditems",params:a,failure:d.onFailure,success:l})},e=d.getPayload(e,q);Sfdc.isDefAndNotNull(e.isAsync)||q(e)};this.setSubjectId=function(a){b=a};this.getSubjectId=function(){return b};this.reflow=function(){var a=Sfdc.get("quickActionContainerContent");a&&(Sfdc.Dom.addClass(a,"reflow"),Sfdc.Dom.removeClass(a,"reflow"))};this.setIsExtensionValidForSubmit=function(){};this.enablePublisher=function(){var a=
Sfdc.get(".quickActionSubmitButton");a&&(a.disabled=!1)};this.showErrors=function(a){alert(a)};A=this;return this};this.wire=function(){SfdcCmp.init(n());var a=X();a&&SfdcCmp.init(a);F={};z={};e.config=e.getConfig();e.listenersWired||(a=chatter.getEventBus(),a.addEventListener("chatter:publisher","onAfterUpdateStatus",function(a,b){n()&&U(a,b)}),a.addEventListener("chatter:feed","onAfterMarkAsBest",function(a,b){var d=chatter.getEventBus(),f=b.feedItemEl,e=f.child(".questionTitleAndBody"),f=f.child(".cxfeeditemattachments");
e&&(Ext.DomHelper.insertBefore(e,b.feedItemBodyHtml),e.remove(),f&&(f.remove(),d.fireEvent("chatter:feed","onAuxBodyChange",{json:b})))}),a.addEventListener("chatter:feed","onAfterDeleteFeedComment",function(a,b){var d=b.feedItemEl,f=d.child(".questionTitleAndBody"),e=d.child(".QuestionPostAuxBody");f&&e&&d.child(".bestAnswerBody").dom.getAttribute("data-bestanswerid")===b.commentId&&e.remove()}),e.listenersWired=!0)};this.initializeFeedFilterReset=function(){chatter.getFeed().wireFeedSwitchAfterPost(Sfdc.clone(chatter.getFeed().getConfig()),
function(){return"all"!==chatter.getFeed().getConfig().feedfilter})};this.wireFeedSwitchAfterPost=function(a,c){var b=null,d=chatter.getEventBus();d.addEventListener("chatter:publisher","onBeforeUpdateStatus",function(f,e){if(n()&&c()){b=null;var g={};g.params=a;g.feedType=a.feedType;g.onSuccess=function(a,c){b=c;d.fireEvent("chatter:feed","onAfterSwitchFeedRetrieved")};g.onFailure=function(a,b){0!==a.status&&(!b||!b.errormessage)&&alert(LC.getLabel("Feeds","GenericFailureNoGack"))};S(g)}});U=function(a,
e){if(c())if(b)T(b,e.json);else{var g=function(){d.removeEventListener("chatter:feed","onAfterSwitchFeedRetrieved",g);T(b,e.json)};d.addEventListener("chatter:feed","onAfterSwitchFeedRetrieved",g)}else G(e.json)}};this.getConfig=function(){var a={},c=n();c&&(c=c.getAttribute("data-feed"))&&Sfdc.apply(a,Sfdc.JSON.parse(c),!0);return a};this.getFeedItemData=function(a){var c={};a&&(a=Sfdc.Dom.getAttribute(a,"data-feeditem"))&&Sfdc.apply(c,Sfdc.JSON.parse(a),!0);return c};this.lazyLoadRechatDropdown=
function(a){F[a]||(F[a]=new CheckedMenu(a,!1))};this.setSearch=function(a){e.search=a};this.setAdditionalPagingParams=function(a){e.pagingParams=a};this.setItemTypeFilter=function(a){e.itemTypeFilter=a};this.isLiveFeed=function(){var a=e.getConfig();return!!e.activePoller&&"NEWS"===a.feedType&&"all"===a.feedfilter};this.getFeedItemData=function(a){return feedItemData=(a=a.getAttribute("data-feeditem"))?Sfdc.JSON.parse(a):{}};this.setCommentVisibilityHelpLink=function(a){this.commentVisibilityHelpLink||
(this.commentVisibilityHelpLink=a)};this.getCommentVisibilityHelpLink=function(){return this.commentVisibilityHelpLink};this.showCommentPlaceholder=function(a){a=Ext.get(a).parent(".feeditemcontent");a.child(".feeditemcommentplaceholder").show();a.child(".cxfeeditemcommentdot").setStyle("display","none");a.child(".feeditemactionlink").setStyle("display","none")};this.showCommentBoxViaAnchor=function(a){var c=l(a),b=chatter.getToolbox(),d=c.child(".cxnewcommentaction");if(a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown())a.source=
null;chatter.onDeferLoad(function(){b.show(c.child(".cxnewcomment").addClass("feedArrow"));b.hide(c.child(".cxcommentplaceholder"));d&&b.enableButton(d);var a=c.child(".cxnewcommenttext");L(a);a.dom.style.minHeight=C*D+"px";b.show(c.child(".cxnewcomment").addClass("feedArrow"));chatter.getFeed().addFileDragListenerToComment(c);a.focus()});return!1};this.showCommentBoxViaPlaceholder=function(a){var c=l(a),b=chatter.getToolbox(),d=c.child(".cxnewcommentaction");if(a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown())a.source=
null;chatter.onDeferLoad(function(){b.hide(c.child(".cxcommentplaceholder"));b.show(c.child(".cxnewcomment").removeClass("feedArrow"));d&&b.enableButton(d);var a=c.child(".cxnewcommenttext");L(a);a.dom.style.minHeight=C*D+"px";b.show(c.child(".cxnewcomment").removeClass("feedArrow"));chatter.getFeed().addFileDragListenerToComment(c);a.focus()});return!1};this.addFileDragListenerToComment=function(a){if(!Sfdc.userAgent.isIE&&!Sfdc.userAgent.isSafariIOS)Sfdc.on(a.child(".cxnewcomment").dom,"dragenter",
function(){var c=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();c&&"uploadFile"===c.source||(chatter.getFeed().createContentComment(a.dom,a.dom.id,!1),Sfdc.AccessibleSelectFileDropDownPanel.doAction("uploadFile"))})};this.showCommentBoxViaPlaceholderOnKeyPress=function(a,c){if(c.keyCode==KEY_ENTER)return this.showCommentBoxViaPlaceholder(a)};this.showFirstCommentBoxAtPageLoad=function(){var a=Ext.get(n()).child(".cxfeeditem").child(".cxcomments"),c=a.child(".cxfeedcomment");Ext.onReady(function(){c?
e.showCommentBoxViaPlaceholder(a):e.showCommentBoxViaAnchor(a)})};this.hideMoreChanges=function(a){a=l(a);var c=chatter.getToolbox();c.show(a.child(".feedTrackedChangePreambleMessage"));c.hide(a.child(".cxexpandedtext"))};this.showMoreChanges=function(a){a=l(a);var c=chatter.getToolbox();c.hide(a.child(".feedTrackedChangePreambleMessage"));c.show(a.child(".cxexpandedtext"))};this.addFeedItem=function(a){var c=Ext.get(n()),b=c.child(".cxfeeditem");if(null===b){if(b=c.child(".emptyfeed"))Ext.DomHelper.insertBefore(b,
a),b.remove()}else Ext.DomHelper.insertBefore(b,a);SfdcCmp.init(Sfdc.Dom.getFirstChild(n(),".cxfeeditem"));return c.child(".feeditem").dom};this.commentBoxBlur=function(a,c){var b=l(a),d=chatter.getToolbox(),f=b.child(".cxnewcommenttext").dom,h=e.getCommentElement(f.id).getValue();chatter.getToolbox().stringIsEmpty(h)&&(!this.getDisableCommentBoxBlur(a)&&!this.getAttachingContent(a)&&!this.hasContentAttached(a)&&!f.hasFocus)&&(d.hide(b.child(".cxnewcomment")),d.show(b.child(".cxcommentplaceholder")))};
this.setDisableCommentBoxBlur=function(a,c){R(a,"disableCommentBoxBlur",c)};this.getDisableCommentBoxBlur=function(a){return l(a).child(".cxnewcommenttext").hasClass("disableCommentBoxBlur")};this.setAttachingContent=function(a,c){R(a,"attachingContent",c)};this.getAttachingContent=function(a){return l(a).child(".cxnewcommenttext").hasClass("attachingContent")};this.hasContentAttached=function(a){return l(a).child(".linkedContentDetailsContainer")?!0:!1};this.contentCommentActionBlur=function(a){this.setDisableCommentBoxBlur(a,
!1);a=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();(!a||!a.hasFocus)&&a&&a.close()};this.contentCommentActionFocus=function(a){this.setDisableCommentBoxBlur(a,!0)};this.contentCommentActionMouseDown=function(a){this.setDisableCommentBoxBlur(a,!0)};this.createContentComment=function(a,c,b){this.setDisableCommentBoxBlur(a,!0);a.focus();a=l(a);a=v(a).dom;if(b=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown(b))(c=Ext.get(Sfdc.AccessibleSelectFileDropDownPanel.SELECT_FILE_DROPDOWN_ID))&&
!c.isStyle("display","none")?b.close():b.show(a)};this.showContentCommentLink=function(a){var c=function(){return chatter.getFeed().getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem")).parentid},b="findExistingContentForContentComment"+c();chatter.getFeed().handleLinkedFile=function(c){OverlayDialogElement.getDialog(b).hide();Q(a,c)};chatter.getFeed().handleExternalLinkedFile=function(c,f){OverlayDialogElement.getDialog(b).hide();aa(a,c,f)};c=chatter.getPublisher().getHandler("ContentPost").openSelectFilesToAttach(b,
!0,c);c.display();c.cancel=function(){IFrameDialog.prototype.cancel.call(this);var b=l(a);v(b).focus()};c.hide=function(){IFrameDialog.prototype.hide.call(this);chatter.getFeed().setAttachingContent(a,!1)}};this.showContentCommentUpload=function(a){var c=l(a);Sfdc.AccessibleUploadFileDialog.open({successHandler:function(b,d){chatter.getFeed().setAttachingContent(a,!1);var f=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();f&&(f.docId=d.docid);Q(a,d.docid);f=v(c);r.hide(f)},isContentComment:!0,
cancelHandler:function(){chatter.getFeed().setAttachingContent(a,!1);v(c).focus()}})};this.removeContentComment=function(a,c){var b=Sfdc.AccessibleSelectFileDropDownPanel.getSelectFileDropdown();if(c&&b&&"uploadFile"==b.source){b.source=null;var b=b.docId,d=chatter.getToolbox();d.post({url:"/chatterfile/"+b+";delete",id:b,success:function(){},failure:function(a,b){}})}d=l(a);b=v(d);(d=d.child(".linkedContentDetailsContainer"))&&d.remove();d=chatter.getToolbox();d.show(b);b.focus()};this.getCommentElement=
function(a){return z[a]};this.removeCommentElement=function(a){z[a]=null};this.newComment=function(a,c,b){var d=l(a),f=chatter.getToolbox(),h=d.child(".cxnewcommenttext").dom;f.disable(h);var g=d.child(".cxnewcommentaction");f.disableButton(g);var k=e.getCommentElement(h.id),m=k.getInputWithEncodedAtMentions(),p=d.child(".cxversionid"),q=d.child(".cxexternaldatasourceid"),s=d.child(".cxexternaldocumentid"),n=d.child(".cxsharedbyreference");if(chatter.getToolbox().stringIsEmpty(m)&&!p&&(!q||!s))f.enable(h),
f.enableButton(g);else{var r;p&&(r=p.dom.innerHTML);var H,t;q&&s&&(H=q.dom.innerHTML,t=s.dom.innerHTML);f.log("comment submit");var W=chatter.getEventBus(),x={feeditemid:c,dom:a};W.fireEvent("chatter:publisher","onBeforeComment",x);p=e.getPollToken();omnitureWrapper.trackEvent(chatter.getOmnitureEventMap().postComment);var w;H&&t&&(w=ExternalFileProgressDialog.showOnPostFile("extFileProgress",n?"true"==n.dom.innerHTML:!1));f.post({url:"/feeditems/"+c+"/comments",params:{text:m,pollingToken:p,relatedRecordId:r,
returnCommentExpanded:e.getConfig().alwaysShowFullText,feedItemType:b,externalDataSourceId:H,externalDocumentId:t,feedType:e.getConfig().feedType},failure:function(a,b){w&&w.hide();b&&(b.errors&&b.errors.comment)&&alert(b.errors.comment);f.enable(h);f.enableButton(g)},success:function(b,c){w&&w.hide();h.value="";h.style.height="";k.clearAtMentions();f.hide(d.child(".cxnewcomment"));f.enable(h);f.show(d.child(".cxcommentplaceholder"));var e=d.child(".cxcomments");f.show(e);chatter.getTextareaMessageUtil().hideMessage({el:h.id,
hideAll:!0});e.createChild(c.html);M(d,1);x.json=c;var e=Sfdc.select(".cxfeedcomment",e.dom),g=null;0<e.length&&(g=e[e.length-1]);x.element=g;SfdcCmp.init(x.element);W.fireEvent("chatter:publisher","onAfterComment",x);chatter.getFeed().removeContentComment(a,!1)}})}};this.IE7ZIndexFeedItemOverflowMenuFix=function(a){var c=Sfdc.Dom.getParent(a,".cxallfeedactions"),b=SfdcCmp.findInstance(c,SfdcCmp.Ui.Dropdown,!0);if(b){var d=Sfdc.Dom.getParent(c,".feeditembodyandfooter");b.attach("onexpand",function(){Sfdc.Dom.addClass(d,
"feeditemZIndex")});b.attach("oncollapse",function(){Sfdc.Dom.removeClass(d,"feeditemZIndex")})}a.onclick=null};this.checkAccessAndDeleteItem=function(a,c,b){var d=this,f=chatter.getToolbox();f.log("checking access before deleting post with id: "+c);f.get({url:"/feeditems/"+c+"/deleteable",success:function(){d.deleteItem(a,c,b)}})};this.deleteItem=function(a,c,b){var d=e.getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem")),f=d.parentid,h=d.feedItemType,d=t("Feeds","FeedPostDeleteConfirmation",h),
g=t("Feeds","FeedConversationDeleteConfirmation",h),h=t("Feeds","FeedPostDeleteNonCreatorMsg",h),d=$(l(a))?g:d;b||(d=d+"\n\n"+h);if(confirm(d)){var k=chatter.getToolbox();k.mask(Ext.fly(a));var m=!1;b=null;0<Ext.query(".contentActionLink",l(a).dom).length&&(m=chatter.getRecentFiles().isWidgetPresent())&&(b=chatter.getRecentFiles().getEntityId());k.post({url:"/feeditems/"+c+";delete",params:{refreshRecentFiles:m,recentFilesEntityId:b,feedItemParentId:f},failure:function(){k.unmask(Ext.fly(a))},success:function(b,
c){e.removeItemElement(a);m&&chatter.getRecentFiles().refresh(c.recentFilesPanelHtml)}});chatter.getEventBus().fireEvent("chatter:feed","onAfterDeleteFeedItem",{el:this})}};this.muteItem=function(a,c){var b=e.getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem")).feedItemType,b=t("Feeds","FeedPostHideConfirmation",b);if(confirm(b)){var d=chatter.getToolbox();d.mask(Ext.fly(a));d.post({url:"/feeditems/"+c+"/mute",failure:function(){d.unmask(Ext.fly(a))},success:function(b,c){e.removeItemElement(a)}});
chatter.getEventBus().fireEvent("chatter:feed","onAfterDeleteFeedItem",{el:this})}};this.unmuteItem=function(a,c){e.getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem"));var b=chatter.getToolbox();b.mask(Ext.fly(a));b.post({url:"/feeditems/"+c+"/mute;delete",failure:function(){b.unmask(Ext.fly(a))},success:function(b,c){e.removeItemElement(a)}});chatter.getEventBus().fireEvent("chatter:feed","onAfterDeleteFeedItem",{el:this})};this.removeItemElement=function(a){var c=l(a),b=Ext.get(n());c.remove();
r.unmask(Ext.fly(a));b.child(".cxfeeditem")||Ext.DomHelper.append(b,{cls:"emptyfeed",tag:"div",html:LC.getLabel("Feeds","emptyFeed")})};this.checkAccessAndDeleteComment=function(a,c,b,d){var f=chatter.getToolbox(),e=this,g=l(a).dom.id,k=e.getFeedItemData(Sfdc.Dom.getParent(a,".cxfeeditem")).feedItemType;f.log("checking access before deleting comment with id: "+b+" from feed item with id "+g);f.get({url:"/feeditems/"+g+"/comments/"+b+"/deleteable",success:function(){e.deleteComment(a,c,k,b,d)}})};
this.deleteComment=function(a,c,b,d,f){c=t("Feeds","CommentDeleteConfirmation",b);b=t("Feeds","CommentDeleteNonCreatorMsg",b);f||(c=c+"\n\n"+b);if(confirm(c)){var e=chatter.getToolbox(),g=Ext.get(a);e.mask(g);f=l(a).dom.id;e.log("delete comment with id: "+d+" from feed item with id "+f);e.post({url:"/feeditems/"+f+"/comments/"+d+";delete",failure:function(){e.unmask(g)},success:function(){var b=l(a);Ext.fly(a).findParent(".cxfeedcomment",50,!0).remove();M(b,-1);N(b);chatter.getEventBus().fireEvent("chatter:feed",
"onAfterDeleteFeedComment",{feedItemEl:b,commentId:d})}})}};this.likeItem=function(a,c,b){var d=chatter.getToolbox(),f=l(a),h=f.child(".cxlikeitemaction");d.mask(h);d.post({url:"/feeditems/"+c+"/likes",params:{feedItemType:b,feedType:e.getConfig().feedType},success:function(a,b){d.hide(h);d.show(f.child(".cxunlikeitemaction"));d.unmask(h);d.show(f.child(".cxcomments"));f.child(".cxlikecontainer").dom.innerHTML=b.html;d.show(f.child(".cxlikecontainer"))},failure:function(a,b){d.unmask(h)}})};this.unlikeItem=
function(a,c){var b=chatter.getToolbox(),d=l(a),f=d.child(".cxunlikeitemaction");b.mask(f);b.post({url:"/feeditems/"+c+"/likes;delete",success:function(a,c){b.hide(f);var e=d.child(".cxlikeitemaction");e?b.show(e):b.hide(d.child(".cxfeeditemlikedot"));b.unmask(f);d.child(".cxlikecontainer").dom.innerHTML=c.html;N(d)},failure:function(a,c){b.unmask(f)}})};this.likeComment=function(a,c,b){var d=chatter.getToolbox(),f=y(a),h=f.child(".cxlikecommentaction");d.mask(h);d.post({url:"/feeditems/"+c+"/likes?commentid\x3d"+
b,params:{feedType:e.getConfig().feedType},success:function(a,b){d.hide(h);d.show(f.child(".cxunlikecommentaction"));f.child(".cxcommentlikecontainer").dom.innerHTML=b.html;d.show(f.child(".cxcommentlikecontainer"));d.unmask(h)},failure:function(a,b){d.unmask(h)}})};this.unlikeComment=function(a,c,b){var d=chatter.getToolbox(),f=y(a),e=f.child(".cxunlikecommentaction");d.mask(e);d.post({url:"/feeditems/"+c+"/likes;delete?commentid\x3d"+b,success:function(a,b){d.hide(e);var c=f.child(".cxlikecommentaction");
c?d.show(c):d.hide(f.child(".cxcommentlikedot"));f.child(".cxcommentlikecontainer").dom.innerHTML=b.html;d.unmask(e)},failure:function(a,b){d.unmask(e)}})};this.markAsBest=function(a,c,b){var d=chatter.getToolbox(),f=y(a),h=l(a),g=f.child(".cxmarkasbestaction");d.mask(g);d.post({url:"/feeditems/"+c+"/bestanswer",params:{feedtype:e.getConfig().feedType,commentid:b},success:function(a,b){d.hide(g);var c=h.query(".cxremovebestaction");c&&Ext.each(c,function(a){d.hide(Ext.get(a))});(c=h.query(".bestAnswerHeader"))&&
Ext.each(c,function(a){d.hide(Ext.get(a))});(c=h.query(".cxmarkasbestaction"))&&Ext.each(c,function(a){d.show(Ext.get(a))});(c=f.child(".cxremovebestaction"))&&d.show(c);if(c=f.child(".bestAnswerHeader"))c.dom.innerHTML=b.bestAnswerHeaderHtml,d.show(c);chatter.getEventBus().fireEvent("chatter:feed","onAfterMarkAsBest",{feedItemEl:h,feedItemBodyHtml:b.feedItemBodyHtml});d.unmask(g);d.hide(g)},failure:function(a,b){d.unmask(g)}})};this.removeAsBest=function(a,c){var b=chatter.getToolbox(),d=y(a),f=
d.child(".cxremovebestaction");b.mask(f);var e=l(a);b.post({url:"/feeditems/"+c+"/bestanswer;delete",success:function(a,c){b.hide(f);var m=d.child(".cxmarkasbestaction");m&&b.show(m);(m=d.child(".bestAnswerHeader"))&&b.hide(m);(m=e.child(".QuestionPostAuxBody"))&&b.hide(m);b.unmask(f)},failure:function(a,c){b.unmask(f)}})};this.bringIntoView=function(a){Sfdc.Dom.removeClass(a,"zen-assistiveText")};this.removeFromView=function(a){Sfdc.Dom.addClass(a,"zen-assistiveText")};this.commentDeleteAddZenAssist=
function(a){a=Sfdc.get(".commentDeleteLink",a);r.addZenAssist(a)};this.commentDeleteRemoveZenAssist=function(a){a=Sfdc.get(".commentDeleteLink",a);r.removeZenAssist(a)};this.bookmark=function(a,c){var b=chatter.getToolbox(),d=Sfdc.Dom.getParent(a,".cxallfeedactions"),f=Sfdc.get(".bookmarked",d),e=LC.getLabel("Feeds","FeedPostUnbookmarkVerb"),g=LC.getLabel("Feeds","FeedPostUnbookmarkTooltip");b.post({url:"/feeditems/"+c+"/bookmarks",success:function(b,d){Sfdc.Dom.show(f);a.onclick=null;a.onclick=function(){chatter.getFeed().unbookmark(a,
c)};Sfdc.Dom.setText(a,e);Sfdc.Dom.set(a,{title:g})},failure:function(a,b){}})};this.unbookmark=function(a,c){var b=chatter.getToolbox(),d=Sfdc.Dom.getParent(a,".cxallfeedactions"),f=Sfdc.get(".bookmarked",d),e=LC.getLabel("Feeds","FeedPostBookmarkVerb"),g=LC.getLabel("Feeds","FeedPostBookmarkTooltip");b.post({url:"/feeditems/"+c+"/bookmarks;delete",success:function(b,d){Sfdc.Dom.hideByDisplay(f);a.onclick=null;a.onclick=function(){chatter.getFeed().bookmark(a,c)};Sfdc.Dom.setText(a,e);Sfdc.Dom.set(a,
{title:g})},failure:function(a,b){}})};this.invokeActionLink=function(a,c){var b=Sfdc.JSON.parse(a.getAttribute("data-actionlink-json"))||{};if(!b.confirmationMessage||confirm(b.confirmationMessage))"Api"===b.subtype||"ApiAsync"===b.subtype?(r.disable(a),r.post({url:"/"+c+"/actionlinks/"+b.id,success:function(a,f){if(f.unclassifiedGroupHtml)for(var e=Sfdc.get("#"+c+" .feeditemActionMenu .zen-options",n()),e=Sfdc.Dom.getFirstChild(e);e;){var g=Sfdc.Dom.getFirstChild(e),k=!1;g&&(g=Sfdc.JSON.parse(g.getAttribute("data-actionlink-json"))||
{},g.actionLinkGroup&&g.actionLinkGroup.id===f.modifiedActionLinkGroupId&&(k=!0));k?(k=e,e=Sfdc.Dom.getNext(e),Sfdc.Dom.removeChild(k)):e=Sfdc.Dom.getNext(e)}V(c,f);"Api"===b.subtype&&ba(b,c)},failure:function(b,c){r.enable(a);c&&(c.errors&&c.errors.comment)&&alert(c.errors.comment)}})):"Ui"===b.subtype||"Download"===b.subtype?window.open(b.actionUrl):"QuickAction"===b.type&&chatter.getFeed().getQuickActionPublisher(c).launchQuickAction(c,b)};this.getQuickActionPublisher=function(a){return A?(A.setSubjectId(a),
A):ca(a)};this.expandItem=function(a,c){var b=chatter.getToolbox(),d=Ext.get(a).findParent(".cxmorecontainer",50,!0);b.hide(d.child(".cxmorelink"));b.show(d.child(".cxexpandedcontent"));b.show(d.child(".cxlesslink"))};this.collapseItem=function(a,c){var b=chatter.getToolbox(),d=Ext.get(a).findParent(".cxmorecontainer",50,!0);b.hide(d.child(".cxlesslink"));b.hide(d.child(".cxexpandedcontent"));b.show(d.child(".cxmorelink"))};this.expandRecordSummaryItem=function(a,c){var b=chatter.getToolbox(),d=Ext.get(a).findParent(".rsmorecontainer",
50,!0);b.hide(d.child(".rsmorelink"));b.show(d.child(".rsexpandedcontent"))};this.toggle=function(a,c){var b={};Sfdc.apply(b,Sfdc.JSON.parse(a),!0);var d=chatter.getToolbox(),e=Sfdc.get(".chatterexpando"),h=null!==e,g=h&&Sfdc.Dom.isVisible(e),k=function(){d.log("Started running animation callback.  Hiding: "+g);var a=Sfdc.get(".hideFeedLink"),c=Sfdc.get(".showFeedLink");g?(Sfdc.Dom.hideByDisplay(a),Sfdc.Dom.show(c),Sfdc.Dom.set(c,{style:{display:"inline-block"}})):(Sfdc.Dom.hideByDisplay(c),Sfdc.Dom.show(a),
Sfdc.Dom.set(a,{style:{display:"inline-block"}}),chatter.getEventBus().fireEvent("chatter:feed","onAfterToggleShow",{entityId:b.subjectId}));Sfdc.Dom.setStyle(e,"overflow","visible");e=null};h&&(Sfdc.Dom.setStyle(e,"overflow","hidden"),g?Sfdc.Effects.rollOut(e,k):Sfdc.Effects.rollIn(e,k));d.post({params:{q:"toggleFeed",id:b.subjectId,feedType:b.feedType,renderFeed:!h,withRecs:c},success:function(a,b){if(!h){var c=Sfdc.get(".chatterfeedshell");Sfdc.Dom.updateHTML(c,b.html,!0);k()}}});return!1};this.onCompactFeedItemClick=
function(a,c){e.getConfig().isCompactFeed&&Sfdc.Dom.hasClass(a,"collapsed")&&(Sfdc.Dom.removeClass(a,"collapsed"),chatter.getEventBus().fireEvent("chatter:feed","onAfterExpandedStateChange",{subjectId:e.getConfig().subjectId}),Sfdc.Event.stop(c))};this.onCompactFeedItemPreambleClick=function(a,c){if(e.getConfig().isCompactFeed){var b=l(a);if(b&&!Sfdc.Dom.hasClass(b.dom,"collapsed")){var d=Sfdc.Event.getEventTarget(c);!Sfdc.Dom.isMatch(d,"a")&&!Sfdc.Dom.getParent(d,"a")&&(Sfdc.Dom.addClass(b.dom,"collapsed"),
chatter.getEventBus().fireEvent("chatter:feed","onAfterExpandedStateChange",{subjectId:e.getConfig().subjectId}),Sfdc.Event.stop(c))}}};this.onCompactFeedItemKeyPress=function(a,c){e.getConfig().isCompactFeed&&(Sfdc.Event.isKeyAction(c,Sfdc.Event.keyCode.ENTER)&&a===Sfdc.Event.getEventTarget(c))&&(Sfdc.Dom.toggleClass(a,"collapsed"),chatter.getEventBus().fireEvent("chatter:feed","onAfterExpandedStateChange",{subjectId:e.getConfig().subjectId}),Sfdc.Event.stop(c))};this.expandLastCompactFeedItem=function(){E(function(a){Sfdc.Dom.removeClass(a,
"collapsed")},1)};this.isCompactFeedFullyExpanded=function(){if(!e.getConfig().isCompactFeed)return!1;var a=n();return a&&0==Sfdc.select(".cxfeeditem.collapsed",a).length};this.expandAllCompactFeedItems=function(){E(function(a){Sfdc.Dom.removeClass(a,"collapsed")})};this.collapseAllCompactFeedItems=function(){E(function(a){Sfdc.Dom.addClass(a,"collapsed")})};this.expandSearch=function(a){var c=Sfdc.get(".feedSearch"),b=Sfdc.get(".feedSearchTerm");c&&b&&(Sfdc.Dom.addClass(c,"feedSearchOpen"),Sfdc.isDefAndNotNull(a)?
(Sfdc.get(".feedSearchForm")&&Sfdc.Dom.set(b,"value",a),Sfdc.Dom.addClass(c,"feedSearchActive")):(Sfdc.Dom.set(b,"value",""),Sfdc.Dom.removeClass(c,"feedSearchActive")),b.focus())};this.expandSearchAndHideMenu=function(a){this.expandSearch(a);a=u();Sfdc.Dom.addClass(a,"menuhidden")};this.expandSearchAndShowMenu=function(a){this.expandSearch(a);a=u();Sfdc.Dom.removeClass(a,"menuhidden");Sfdc.Dom.addClass(a,"shift")};this.closeSearchBox=function(){var a=n(),c=Sfdc.get(".feedSearch",a),a=Sfdc.get(".feedSearchTerm",
a);c&&a&&(a.value="",Sfdc.Dom.removeClass(c,"feedSearchOpen"),c=u(),Sfdc.Dom.removeClass(c,"menuhidden"),Sfdc.Dom.removeClass(c,"shift"))};this.runSearch=function(a){a&&Sfdc.Event.preventDefault(a);a=Sfdc.get(".feedSearchTerm").value;Sfdc.String.trim(a||"")?(a=P(e.getConfig(),a),e.refresh(a)):e.clearSearch()};this.clearSearch=function(){e.closeSearchBox();if(e.findInFeedType){var a=e.getConfig(),c={isPost:!0,verb:";edit",feedType:e.findInFeedType,isFullRefresh:!1,onSuccess:function(){e.closeSearchBox()}};
if("SEARCH"==a.feedType&&e.search)for(var b in e.search)a[b]=chatter.getToolbox().htmlDecode(e.search[b]);var d=e.pagingParams;for(b in d)a[b]=chatter.getToolbox().htmlDecode(d[b]);c.params=a;e.searchString=null;e.findInFeedType=null;e.refresh(c)}};this.searchAllFeeds=function(a){if(a&&(a=a.getAttribute("data-search-url")))window.location.href=Sfdc.Url.generateUrl(a,{str:Sfdc.String.trim(Sfdc.get(".feedSearchTerm").value||"")},{allowMultipleOfParam:!0})};this.toggleSort=function(a,c,b){b&&Sfdc.Event.preventDefault(b);
var d=e.getConfig(),f=chatter.getEventBus(),h={sortByComments:c};f.fireEvent("chatter:FeedSort","onBeforeSortFeed",h);a={isPost:!0,verb:";edit",feedType:d.feedType,isFullRefresh:!1,onSuccess:function(){if("SEARCH"==d.feedType){e.expandSearch(g.str);var a=u();Sfdc.Dom.addClass(a,"shift")}g.isDropDownFiltersVisible&&((a=Sfdc.get("sortDisplay"))&&Sfdc.Dom.updateHTML(a,g.label),(a=Sfdc.get("filterDisplay"))&&Sfdc.Dom.updateHTML(a,g.label));f.fireEvent("chatter:FeedSort","onAfterSortFeed",h)}};var g=d;
g.toggleSort=c;g.showFeedItemsOnly=!0;if(c=Sfdc.get("sortDisplay"))g.label=c.innerHTML;if(c=Sfdc.get("filterDisplay"))g.label=c.innerHTML;if("SEARCH"==d.feedType&&e.search)for(var k in e.search)g[k]=chatter.getToolbox().htmlDecode(e.search[k]);e.itemTypeFilter&&"ENTITY"==d.feedType&&(g.feedfilter="feeditemtype",g.itemtypefilter=e.itemTypeFilter);c=e.pagingParams;for(k in c)g[k]=chatter.getToolbox().htmlDecode(c[k]);a.params=g;e.refresh(a)};this.showMoreFeedItems=function(a,c){var b=Ext.get(n()),d=
b.child(".cxshowmorefeeditemscontainer"),f=chatter.getToolbox(),h=chatter.getEventBus();(new LoadingScreen(d.dom,LC.getLabel("Global","loading"))).show();var g=Sfdc.select("body");0<d.dom.children.length&&(0<g.length&&document.activeElement==g[0]&&chatter.getAutoShowOlder().isReachedMaxExecutions())&&d.dom.children[0].focus();g=e.getConfig();c.writable=g.writable;var k=e.search,m;for(m in k)m&&(c[m]=f.htmlDecode(k[m]));k=e.pagingParams;for(m in k)m&&(c[m]=f.htmlDecode(k[m]));e.itemTypeFilter&&"ENTITY"==
g.feedType&&(c.feedfilter="feeditemtype",c.itemtypefilter=e.itemTypeFilter);"ENTITY"==g.feedType&&(c.itemVisibilityFilter=g.itemVisibilityFilter,c.isCompactFeed=g.isCompactFeed);if(g.feedfilter&&("NEWS"==g.feedType||"ENTITY"==g.feedType))c.feedfilter=g.feedfilter,c.keyprefix=g.keyprefix;chatter.getToolbox().get({url:"/feed/"+g.subjectId+"/"+g.feedType,params:c,failure:function(){f.unmask(d);h.fireEvent("chatter:feed","onAfterShowMoreFeedItems",{firstFeedItem:null})},success:function(a,c){var d=b.child(".emptyfeed");
null!==d&&d.remove();var e=f.runScriptReturnHtml(c.html,chatter.getYoutubeVideo().fetchVideoPreviews),d=b.child(".cxshowmorefeeditemscontainer"),g=d.prev(".cxfeeditem"),k=n();Sfdc.Dom.insertHTML(k,e);SfdcCmp.init(k);if(0<d.dom.children.length&&document.activeElement==d.dom.children[0]){e=d.dom.nextSibling;for(k=[];0==k.length&&null!=e;)k=Sfdc.select("a",e),e=e.nextSibling,0<k.length&&k[0].focus()}d.remove();h.fireEvent("chatter:feed","onAfterShowMoreFeedItems",{firstFeedItem:g.next(".cxfeeditem")})}});
return!1};this.showMoreComments=function(a,c){var b=l(a);return O(b,c,function(){})};this.showFirstPageOfComments=function(a,c){var b=l(a);if(1==b.select(".showmorecommentscontainer").elements.length)return O(b,c,function(){b.select(".cxfeedcomment").each(function(a){a.remove()})})};this.applyDropDownFilter=function(a){var c=e.getConfig(),b={feedType:c.feedType,isFullRefresh:!1};b.params={feedfilter:a.filterType,keyprefix:a.keyprefix,showFeedItemsOnly:!0,isDropDownFiltersVisible:!0,subjectId:c.subjectId||
UserContext.userId,str:e.searchString,findInFeedType:e.findInFeedType,itemVisibilityFilter:a.itemVisibilityFilter};b.onSuccess=function(){if(e.searchString){e.expandSearch(e.searchString);var b=u();Sfdc.Dom.addClass(b,"shift")}(b=Sfdc.get("filterDisplay"))&&Sfdc.Dom.updateHTML(b,a.label)};e.refresh(b);omnitureWrapper.trackEvent(function(a){var b=chatter.getOmnitureEventMap().showDropdownFilter+"-"+a.filterType;"record"==a.filterType&&(b+="-"+a.keyprefix);return b}(a))};this.refresh=function(a){var c=
chatter.getEventBus();if("SEARCH"!==a.feedType){var b=Sfdc.get(".feedSearchTerm",n());if(b){var d=Sfdc.String.trim(b.value||"");d&&(""!=d&&d!=Sfdc.Dom.getAttribute(b,"placeholder"))&&(a=P(a,d))}}var f=Sfdc.clone(a.onSuccess),h=Sfdc.clone(a.onFailure);a.onSuccess=function(a,b){if(!b||!b.html)refreshFailure(a,b);else{c.fireEvent("chatter:feed","onBeforeRemoveFeed");var d=b.html;Sfdc.Dom.updateHTML(B(),d,!0);c.fireEvent("chatter:feed","onAfterFeedRefresh",{json:b});Sfdc.isFunction(f)&&f(b)}};a.onFailure=
function(a,b){Sfdc.isFunction(h)&&h();0!==a.status&&(!b||!b.errormessage)&&alert(LC.getLabel("Feeds","GenericFailureNoGack"));e.loadingScreen&&e.loadingScreen.hide()};c.fireEvent("chatter:feed","onBeforeRemoveFeed");e.loadingScreen=new LoadingScreen(n(),LC.getLabel("Global","loading"));e.loadingScreen.show();S(a)};this.insertFeedItems=function(a){var c=Ext.get(n());c.select(".cxfeeditem").each(function(a){a.remove()});var b=c.child(".cxshowmorefeeditemscontainer");b&&b.remove();(b=c.child(".emptyfeed"))&&
b.remove();(b=c.child(".cxfeedtitle"))?Ext.DomHelper.insertAfter(b,a):Ext.DomHelper.insertFirst(c,a)};this.showNewUpdates=function(){var a=Ext.get(n()).child(".newFeedItemsMessage");a&&a.remove();e.refresh({feedType:"NEWS",params:{isDropDownFiltersVisible:!0}})};this.getPollToken=function(){var a=null;e.isLiveFeed()&&(a=e.pollToken);return a};this.wireLiveFeed=function(a,c){function b(){chatter.getToolbox().log("PAUSING STATUS POLLER");e.activePoller.stop();l=(new Date).getTime()}function d(a,b){b&&
(b.json&&b.json.pollingToken)&&(f(b.json.pollingToken),k&&(b.json.hasNewUpdates?h(b.json):(chatter.getToolbox().log("UNPAUSING STATUS POLLER"),e.activePoller.start())))}function f(a){chatter.getToolbox().log("UPDATE POLL TOKEN: "+a);e.pollToken=a}function h(a){if(k){chatter.getToolbox().log("SHOWING NEW ITEMS MESSAGE");var c=Ext.get(n());if(!c.child(".newFeedItemsMessage")){var d=c.child(".feeditem");c.createChild(a.liveFeedHtml,d);c.first().fadeIn({endOpacity:1,duration:1.25});Sfdc.Aria.notify(LC.getLabel("Feeds",
"live_newitems"));chatter.getEventBus().fireEvent("chatter:feed","onAfterLiveFeedMessageShown")}b()}else chatter.getToolbox().log("NEW ITEMS MESSAGE NOT SHOWN BECAUSE NOT ALLOWED")}function g(){var a;if(c)a=[[3,100]];else{a=Math.round(30);var d=Math.round(90),g=Math.round(840/d),k=Math.round(300),n=Math.round(2700/k),p=Math.round(3600);a=[[a,2],[d,g],[k,n],[p,-1]]}return{name:"live feed- "+UserContext.userId,callback:function(){var a=(new Date).getTime();chatter.getToolbox().log("POLLING ("+a+")");
chatter.getToolbox().get({url:"/feed/"+UserContext.userId+"/news/ismodified",params:{pollingToken:e.pollToken},success:function(b,c){c.pollingToken&&f(c.pollingToken);c.hasNewUpdates&&(0!=l&&a&&a<l?chatter.getToolbox().log("NEW ITEMS MESSAGE NOT SHOWN BECAUSE gatekeeperTimestamp BLOCKED IT"):(chatter.getToolbox().log("NEW MESSAGE GATEKEEPER PASSED("+l+", "+a+")"),h(c)))},failure:b});return!0},intervals:a}}if(null==e.activePoller){var k=!0,l=0;e.pollToken=a;e.activePoller=chatter.getToolbox().poll(g());
var p=chatter.getEventBus();p.addEventListener("chatter:feed","onBeforeRemoveFeed",b);p.addEventListener("chatter:feed","onAfterFeedRefresh",function(a,b){var c=e.getConfig(),f=!c.feedfilter||"all"===c.feedfilter;k="NEWS"===c.feedType&&f;d(a,b)});p.addEventListener("chatter:feed","onBeforeRechat",b);p.addEventListener("chatter:publisher","onBeforeUpdateStatus",b);p.addEventListener("chatter:feed","onAfterNewPostFeedUpdate",d);p.addEventListener("chatter:publisher","onBeforeComment",function(){e.getConfig().sortByComments&&
b()});p.addEventListener("chatter:publisher","onAfterComment",function(a,b){e.getConfig().sortByComments&&d(a,b)})}};this.removeCaseCommentFromPortal=function(a,c,b,d){var f=chatter.getToolbox();l(a);d=d?LC.getLabel("CaseInteraction","ConfirmRemoveCustomerPortalPost"):LC.getLabel("CaseInteraction","ConfirmRemovePortalPost");confirm(d)&&(b={url:"/caseinteraction/privateanswer/"+b+";edit",params:{removeFromPortal:!0}},"undefined"!=typeof caseInteraction?caseInteraction.getCaseFeed().postRemoveCaseComment(c,
b):(b.success=function(b,c){c.feedItem&&feed.addFeedItem(c.feedItem);e.removeItemElement(a)},f.post(b)))};this.deleteReplyFromCase=function(a,c,b){confirm(LC.getLabel("CaseInteraction","ConfirmRemoveCustomerPortalPost"))&&chatter.getToolbox().post({url:"/caseinteraction/publicanswer/"+b+";delete",params:{replyId:c},success:function(b,c){l(a).remove();r.unmask(Ext.fly(a))}})}}chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterFeed:End");chatter.extend("Feed",Feed,null);
function NavigationGroups(){var b={},g;this.addNavigationGroup=function(c){g=c.associatedGroup;var e=c.id;"null"!=g?(b[g]||(b[g]={}),b[g][e]=new NavigationGroup(c)):b[e]?alert(["the id:",e,"is already in use."].join("")):b[e]=new NavigationGroup(c)};this.getAssociatedGroup=function(c){return b[c]};var l=this.clearSelectedStateInAssociatedGroup=function(c){if(b[c]){var e=b[c].selected;e&&(b[c][e].reset(),b[c].selected=null)}};this.changeNavigationItemState=function(c,e,g,h){l(c);b[c][e].changeNavigationItemState(g,
h)}}
function NavigationGroup(b){function g(a){m=a;e?chatter.getNavigationGroups().clearSelectedStateInAssociatedGroup(e):l();f=a;Sfdc.Dom.addClass(f,"selected");(a=Sfdc.Dom.getParent(f,".subNavSection"))&&Sfdc.Dom.setStyle(a,"display","block");a=Sfdc.get(".trigger",f);Sfdc.Dom.set(a,{title:(""!==a.title?a.title:a.innerHTML)+p});e&&(chatter.getNavigationGroups().getAssociatedGroup(e).selected=b.id);m=null}function l(){if(f){var a=m,d=Sfdc.Dom.getParent(f,"div.subNavSection"),a=a?Sfdc.Dom.getParent(a,"div.subNavSection"):
!1;d&&d!=a&&Sfdc.Dom.setStyle(d,"display","none");Sfdc.Dom.removeClass(f,"selected");d=Sfdc.get(".trigger",f);Sfdc.Dom.set(d,{title:(""!==d.title?d.title:d.innerHTML).replace(p,"")});chatter.getEventBus().fireEvent("chatter:navigation","onAfterLeavingItem",f);f=null}}function c(a){var d=Sfdc.get(".subNavSection .default",a);return d?d:Sfdc.get(".subNavSection .trigger",a)}var e=b.associatedGroup,k=b.id,h=Sfdc.get(k),f,m,q=Sfdc.select(".trigger",h),r=Sfdc.get(".overflow",h),n=Sfdc.get(".showMore",
h),p=LC.getLabel("ChatterNavigation","SelectedTitleExtra");(f=Sfdc.get(".subNavSection li.selected",h))||(f=Sfdc.get("li.selected",h));f&&(chatter.getNavigationGroups().getAssociatedGroup(e).selected=k);for(k=0;k<q.length;k++)Sfdc.on(q[k],"click",function(){var a=Sfdc.Dom.getParent(this,"li");if(Sfdc.Dom.hasClass(a,"hasSubNav")){a=c(a);if(a.onclick)a.onclick();a=Sfdc.Dom.getParent(a,"li")}g(a);"undefined"!=typeof directMessage&&directMessage&&directMessage.removeFixedPosition()});if(n)Sfdc.on(n,"click",
function(){Perf.mark("NavigationGroupShowMoreStart");Sfdc.Dom.show(r);Sfdc.Dom.addClass(r,"opened");Sfdc.Dom.hideByDisplay(n);Perf.endMark("NavigationGroupShowMoreStart")});this.reset=function(){l()};this.selectDefaultItem=function(a){var d=Sfdc.get(".trigger",h),b=Sfdc.Dom.getParent(d,"li");Sfdc.Dom.hasClass(b,"hasSubNav")&&(d=c(b),b=Sfdc.Dom.getParent(d,"li"));if(a&&d.onclick)d.onclick();g(b)};this.changeNavigationItemState=function(a,b){var c=Sfdc.select("li.hasSubNav",h);c.length<=a||(c=Sfdc.select(".subNavSection li",
c[a]),c.length<=b||g(c[b]))};this.getSelectedNavItem=function(){return f}}chatter.extend("NavigationGroups",NavigationGroups,null);
chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterPublisher:Start");
function Publisher(){function S(a,b){if("true"===Sfdc.Dom.getAttribute(a,"lazyInit")){var c=Sfdc.String.trim(a.innerHTML).slice(4,-3);a.setAttribute("lazyInit","");Sfdc.Dom.updateHTML(a,c,!0,b)}else b()}function T(a){try{a.onShowPanel()}catch(b){Sfdc.error(b)}}function U(a){var b=e.getHandler(a);if(!V[a]&&Sfdc.isFunction(b.setupPanel))try{b.setupPanel(),V[a]=!0}catch(c){Sfdc.error(c)}}function W(a){var b=e.getHandler(g.actionId);a=window.event||a;!(a.shiftKey&&9==a.keyCode)&&(9===a.keyCode&&!b.focusFirstElement())&&
(a.preventDefault?a.preventDefault():a.returnValue=!1)}function w(){r||chatter.getToolbox().updateHeight(d,C,C*J)}function X(){r&&(r=!1);"TextPost"==p.actionId&&K()&&Sfdc.Dom.hasClass(f,"defaultState")&&(Sfdc.Dom.removeClass(f,"defaultState"),w())}function Y(){return{subjectId:null,entityType:null,isPrivateGroup:!1,isExternalGroup:!1}}function K(){var a=f.getAttribute("data-publisher");return a?Sfdc.JSON.parse(a).useDefaultState:!0}function L(){var a=d;a.value=D();a.title=D();Sfdc.Dom.removeClass(a,
"publishertextareafocus");w();M(!1)}function Z(a){var b=Sfdc.get(".publisherFeedItemTypeChoices",f),c=Sfdc.get(".withArrowAttached",b);Sfdc.Dom.removeClass(c,"withArrowAttached");a=Sfdc.get(a,b);Sfdc.Dom.getParent(a,".publisherTypeOverflow")?Sfdc.Dom.addClass(Sfdc.Dom.getParent(a,".publisherTypeOverflow"),"withArrowAttached"):Sfdc.Dom.addClass(a,"withArrowAttached")}function D(){var a=s[g.actionId];if(a&&Sfdc.isString(a.config.promptText))return a.config.promptText;N||(N=Ext.fly("publisherprompttext").getValue());
return N}function $(){var a=l||Sfdc.get("publishersharebutton"),b;a:{b=s[g.actionId];if(Sfdc.isObject(b.config.submitValueAndTitle)&&(b=b.config.submitValueAndTitle,b.value&&b.title&&Sfdc.isString(b.value)&&Sfdc.isString(b.title)))break a;b=!1}b?Sfdc.Dom.set(a,{value:b.value,title:b.title}):(b=LC.getLabel("Publisher","Share"),Sfdc.Dom.set(a,{value:b,title:b}))}function ea(a,b){if(a){var c=Sfdc.get(".publisherTypeOverflow .zen-trigger",f),k=null!=Sfdc.Dom.getParent(a,".publisherTypeOverflow");if(c){var e=
Sfdc.get(".publisherTypeOverflowSelected",c);if(e){var d=Sfdc.get(".publisherattachtext",e);if(d)if(Sfdc.each(d.childNodes,function(a){3==a.nodeType&&d.removeChild(a)}),k){if(Sfdc.Dom.removeClass(e,"hidden"),k=Sfdc.get(".publisherFeedItemTypeChoice.publisherattach"+b,f),k=Sfdc.Dom.getText(k))d.appendChild(document.createTextNode(k)),Sfdc.Dom.set(c,{title:k})}else Sfdc.Dom.addClass(e,"hidden"),Sfdc.Dom.set(c,{title:LC.getLabel("Publisher","OverflowMenuTitle")})}}}}function fa(){var a=d;e.isPromptText(a.value)&&
(a.value="",Ext.isSafari&&a.focus());Sfdc.Dom.addClass(d,"publishertextareafocus");Sfdc.Dom.addClass(f,"publisheronfocus");aa=Sfdc.Dom.get(d,"title");Sfdc.Dom.set(d,"title","");X()}function ba(){e.isTextBoxEmpty()&&L()}function ca(){var a=d,b;b=m?m.getInputValueLength():d.value.length;b=b>O;var c=chatter.getTextareaMessageUtil().isMessageDisplayed(a.id,"PublisherMaxLengthErrorMsg"),k=l.disabled;b&&!k&&e.disableShareButton();b!=c&&(c=LC.getLabel("Publisher","PublisherMaxLengthErrorMsg"),b?(M(!0),chatter.getTextareaMessageUtil().showMessage({el:a.id,
type:1,append:!0,msg_html:c,msg_id:"PublisherMaxLengthErrorMsg"})):chatter.getTextareaMessageUtil().hideMessage({el:a.id,msg_id:"PublisherMaxLengthErrorMsg"})||M(!1))}function M(a){y!==a&&((y=a)?e.disableShareButton():e.enableShareButtonIfValid())}function ga(){for(var a=0;a<z.length;a++){var b=z[a];A.removeEventListener(b.namespace,b.eventname,b.listener)}z=[]}function ha(){for(var a=u.widgetsToAdd,b=0;b<a.length;b++){var c=a[b];if(Sfdc.isFunction(c.wire))try{c.wire()}catch(e){Sfdc.error(e)}u.currentWidgets[c.widgetName]=
c}u.widgetsToAdd=[]}function da(){var a=Sfdc.get(".activeTemplate",n),b=Sfdc.get("."+g.actionId,n);Sfdc.Dom.hideByVisibility(n);Sfdc.Dom.removeClass(a,"activeTemplate");Sfdc.Dom.addClass(b,"activeTemplate");if(!E){var a=Sfdc.get("publisherTextArea",n),c=Sfdc.get("publisherBottomBar",n),e=Sfdc.get("publisherPostToElement",c),d=Sfdc.get("publisherVisibilityWidget",c),f=Sfdc.get("publishersharebutton",c);E=[{className:"publisherTextAreaPlaceholder",element:a},{className:"publisherBottomBarPlaceholder",
element:c},{className:"publisherPostToElementPlaceholder",element:e},{className:"publisherVisibilityWidgetPlaceholder",element:d},{className:"publisherShareButtonPlaceholder",element:f}]}a=E;for(c=0;c<a.length;c++)if(e=a[c],d=Sfdc.get("."+e.className,b))d.appendChild(e.element),Sfdc.Dom.hasClass(e.element,"hideElement")&&Sfdc.Dom.removeClass(e.element,"hideElement");Sfdc.Dom.show(n)}var e=this,p={actionId:"",actionType:""},g={actionId:"",actionType:""},q=chatter.getToolbox(),A=chatter.getEventBus(),
N,aa,s={},V={},z=[],u={widgetsToAdd:[],currentWidgets:{}},m=null,O,C,J,r,F,y,G,P,t,H,Q,I,R,E=null,d=null,f=null,n=null,l=null,B=null,v=[];this.DEFAULT_MAX_BODY_LENGTH=5E3;this.FEEDITEM_VISIBILITY_INTERNAL_USERS="INTERNAL_USERS";this.FEEDITEM_VISIBILITY_ALL_USERS="ALL_USERS";this.getSubjectId=function(){return e.getSubject().subjectId};this.getRawBody=function(){return m.getInputWithEncodedAtMentions()};this.getTextArea=function(){return d};this.isPromptText=function(a){return a==D()};this.addTopicId=
function(a){null!=a&&""!=a&&v.push(a)};this.removeTopicIds=function(a){a=v.lastIndexOf(a);-1<a&&(v=v.splice(a,1))};this.getTopicIds=function(){return v};this.clearTopicIds=function(){v=[]};this.wire=function(a,b){S(Sfdc.get(".publishercontainer .publisherWrapper ."+a),function(){e.wireDefaultPublisher(a,b)})};this.wireDefaultPublisher=function(a,b){q.log("publisher core wiring started");var c=q.now();ga();u.currentWidgets={};y=!1;P=G=!0;r="TextPost"===a;t=null;isInternalOnly=R=I=Q=H=!1;e.setDefaultAction(a,
b);g.actionId=a||b;g.actionType=b;E=null;d=Sfdc.get("publishereditablearea");f=Sfdc.Dom.getParent(d,".publishercontainer");Sfdc.get(".publisherTextAreaContainer",f);n=Sfdc.Dom.getParent(d,".publisherWrapper");l=Sfdc.get("publishersharebutton");ha();SfdcCmp.init(f);var k=g.actionId,h=e.getHandler(k);if(h){da();U(k);Z("publisherAttach"+g.actionId);Sfdc.on(d,"blur",function(){Sfdc.Dom.set(d,"title",aa)});d.value=D();F=e.getSubject();var x=Sfdc.Dom.hasClass(d,"groupAtMentionsEnabled");chatter.onDeferLoad(function(){Sfdc.on(d,
"focus",fa);chatter.getToolbox().initializeIE8JPNTypingFix(d);m=new PublisherAutoComplete("publishereditablearea","/autocomplete",{},null,x,F.subjectId,F.entityType,t)});Sfdc.on(d,"drop",ba);C=16;J=h.config.defaultTextAreaLines||3;w();Sfdc.on(d,Sfdc.userAgent.isIE8||Sfdc.userAgent.isIE7?"keyup":"input",w);O=e.DEFAULT_MAX_BODY_LENGTH;Sfdc.on(d,"keyup",ca);Sfdc.on(d,"blur",ba);q.log("publisher core wiring finished in "+(q.now()-c)+"ms");Sfdc.userAgent.isIE7&&(Sfdc.on(l,"mouseover",function(){Sfdc.Dom.addClass(l,
"onHover")}),Sfdc.on(l,"mouseout",function(){Sfdc.Dom.removeClass(l,"onHover")}));$();T(h)}};this.submit=function(){var a=chatter.getEventBus(),b=s[g.actionId];q.log("publisher submit");e.disablePublisher();a.fireEvent("chatter:publisher","onBeforeUpdateStatus");b.config.omnitureEvent&&omnitureWrapper.trackEvent(chatter.getOmnitureEventMap()[b.config.omnitureEvent]);var c=f.getAttribute("data-topics");e.addTopicId(c);var c={feedItemType:g.actionId,entityId:e.getSubjectId(),feedItemVisibility:t,topicIds:e.getTopicIds()},
d=chatter.getFeed();if(d){var h=d.getConfig();h&&(h.feedType&&(c.feedType=h.feedType),h.isCompactFeed&&(c.isCompactFeed=h.isCompactFeed));if(d=d.getPollToken())c.pollingToken=d}var x=function(c,d){a.fireEvent("chatter:publisher","onAfterUpdateStatus",{json:d});Sfdc.isFunction(b.onSuccess)&&(b.onSuccess(c,d),Sfdc.isFunction(b.clearPanelState)&&b.clearPanelState());e.switchToDefaultPublisherType()},d=function(a){if(Sfdc.isFunction(b.validatePayload)){var c=b.validatePayload(a);if(!c.isValid){if(Sfdc.isFunction(b.onValidationFailure))b.onValidationFailure(c.errorPayload);
return}}Sfdc.isFunction(b.postWithCustomFunction)?b.postWithCustomFunction(a):q.post({url:"/feeditems",params:a,failure:b.onFailure,success:x})},c=b.getPayload(c,d);Sfdc.isDefAndNotNull(c.isAsync)||d(c)};this.getPublisherContainer=function(){return f};this.isPublisherPresent=function(){return!!Sfdc.get("publishereditablearea")};this.show=function(){Sfdc.Dom.show(f)};this.hide=function(){Sfdc.Dom.hideByDisplay(f)};this.resetPublisher=function(){L();m&&m.clearAtMentions();e.clearTopicIds();e.setIsExtensionValidForSubmit(!0)};
this.enablePublisher=function(){e.enableShareButtonIfValid();e.enableTextArea(!0)};this.disablePublisher=function(){e.disableShareButton();e.enableTextArea(!1)};this.setIsExtensionValidForSubmit=function(a){(P=a)?e.enableShareButtonIfValid():e.disableShareButton()};this.enableShareButtonIfValid=function(){var a=Sfdc.get("."+g.actionId,n),b=P&&G;Sfdc.select(".publishertextarea",a).length&&(b=b&&!y);b&&(l.disabled=!1)};this.disableShareButton=function(){l.disabled=!0};this.enableTextArea=function(a){a?
chatter.getToolbox().enable(d):chatter.getToolbox().disable(d)};this.focusOnTextArea=function(){d.focus();Sfdc.userAgent.isIE&&(d.value=d.value)};this.showErrors=function(a){alert(a)};this.isTextBoxEmpty=function(){var a=d.value;return q.stringIsEmpty(a)||e.isPromptText(a)};this.restoreDefaultUIState=function(){chatter.getTextareaMessageUtil().hideMessage({el:d.id,hideAll:!0});e.resetPublisher();e.enablePublisher();r||(r=!0);"TextPost"==p.actionId&&K()&&(Sfdc.Dom.addClass(f,"defaultState"),d.style.height=
"16px");A.fireEvent("chatter:publisher","onAfterRestoreDefaultUIState")};this.registerFeedItemTypeHandler=function(a,b,c){c=c||{};a=c.handlerId||a;return!s[a]&&Sfdc.isObject(b)&&Sfdc.isFunction(b.getPayload)&&Sfdc.isFunction(b.onShowPanel)&&Sfdc.isFunction(b.onSuccess)&&Sfdc.isFunction(b.onFailure)&&Sfdc.isObject(b.config)?(b.publisherCore=c.publisherCore||this,s[a]=b,!0):!1};this.getHandler=function(a){return s[a]};this.getCurrentActionId=function(){return g.actionId};this.getCurrentActionType=function(){return g.actionType};
this.initializeExtension=function(a,b,c){var d=e.getHandler(b);if(d){U(b);var h=e.getHandler(g.actionId);if(h)try{Sfdc.isFunction(h.removeEventsForPostType)&&h.removeEventsForPostType(),Sfdc.isFunction(h.clearPanelState)&&h.clearPanelState()}catch(x){Sfdc.error(x)}h=e.isTextBoxEmpty();g.actionId=b;g.actionType=c;h&&L();C=d.config.lineHeight||16;J=d.config.defaultTextAreaLines||3;O=d.config.maxBodyLength||e.DEFAULT_MAX_BODY_LENGTH;da();Z("publisherAttach"+g.actionId);b=Sfdc.get("."+g.actionId,n);Sfdc.select(".publishertextarea",
b).length&&(w(),ca());X();b=(b=f.getAttribute("data-publisher"))?Sfdc.JSON.parse(b).useEnhancedKeyboardNavigation:!0;if(b){B&&Sfdc.un(B,"keydown",W);B=a;if(g.actionId!=p.actionId)Sfdc.on(B,"keydown",W);if(!Sfdc.userAgent.isIE7)try{B.focus()}catch(la){}}$();T(d);ea(a,g.actionId);A.fireEvent("chatter:publisher","onOpenTypeSpecificPanel",d)}};this.openTypeSpecificPanel=function(a,b,c){var d=c||b;(g.actionId!==d||r)&&S(Sfdc.get(".publishercontainer .publisherWrapper ."+d),function(){e.initializeExtension(a,
d,b)})};this.switchToDefaultPublisherType=function(){if(K()){var a=Sfdc.get("publisherAttach"+p.actionId,f);e.openTypeSpecificPanel(a,p.actionType,p.actionId)}e.restoreDefaultUIState()};this.hideShowFollowV2Message=function(){chatter.getToolbox().get({url:"/commands/hideFollowV2Message",success:function(){var a=chatter.getPublisher();a.setShowFollowV2Message(!1);a.getWidget("visibilityWidget").hideVisibilityBox();Sfdc.Dom.removeClass(Sfdc.get("publisherVisibilityIcon"),"active")}})};this.getVisibilityMessages=
function(){var a=f.getAttribute("data-topics"),b=[];if(Q){var c=LC.getLabel("ChatterVisibility","GotIt");b.push({HTML:'\x3cdiv class\x3d"zen-box zen-simple visibilityInfoBox"\x3e\x3cdiv class\x3d"zen-inner"\x3e\x3cdiv class\x3d"zen-body"\x3e\x3cp\x3e\x3ch3 class\x3d"infoMessageTitle"\x3e'+LC.getLabel("ChatterVisibility","New")+'\x3c/h3\x3e\x3cp class\x3d"followV2Message"\x3e'+LC.getLabel("ChatterVisibility","FollowV2Message","\x3cb\x3e"+c+"\x3c/b\x3e")+'\x3c/p\x3e\x3cbutton  class\x3d"zen-btn" onclick\x3d"chatter.getPublisher().hideShowFollowV2Message()"title\x3d"'+
c+'"\x3e'+c+"\x3c/button\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"})}b=b.concat(PublisherVisibilityMessages.getVisibilityMessages(e.getSubject(),I,t,H,a));return(c=s[g.actionId])&&Sfdc.isFunction(c.getVisibilityMessages)?b.concat(c.getVisibilityMessages(e.getSubject(),I,t,H,a,R)):b};this.addEventListener=function(a,b,c){A.addEventListener(a,b,c);z[z.length]={namespace:a,eventname:b,listener:c}};this.setSubject=function(a){var b=Y();Sfdc.apply(b,a,!0);m.updateParent(a.subjectId,a.entityType);
a.subjectId?(G=!0,e.enableShareButtonIfValid()):(G=!1,e.disableShareButton());a.isExternalGroup?Sfdc.Dom.addClass(f,"externalGroup"):Sfdc.Dom.removeClass(f,"externalGroup");f.setAttribute("data-publisher",Sfdc.JSON.stringify(a));A.fireEvent("chatter:publisher","onAfterUpdateSubject",{subjectId:a.subjectId})};this.setFeedItemVisibility=function(a){t=a;m&&m.updateFeedItemVisibility(t)};this.setHasUserSharingMessage=function(a){H=a};this.setShowFollowV2Message=function(a){Q=a};this.setIsFollowV2Enabled=
function(a){I=a};this.setIsFilesUserSharingEnabled=function(a){R=a};this.setDefaultAction=function(a,b){p.actionId=a;p.actionType=b};this.getHasTextareaErrors=function(){return y};this.getSubject=function(){var a=f.getAttribute("data-publisher"),b=Y();a&&Sfdc.apply(b,Sfdc.JSON.parse(a),!0);return b};this.getOriginalSubject=function(){return F};this.addWidget=function(a){a.lazyLoad=function(){a.instance||(a.instance=a.get());return a.instance};var b=u.widgetsToAdd;b[b.length]=a};this.getWidget=function(a){var b=
u.currentWidgets[a];Sfdc.isDebug&&!b&&Sfdc.log(a+" has not been wired yet.  Either the widget wasn't added with addWidget() or wireWidgets() was not called after it was added.",Sfdc.Logging.LogLevel.ERROR);return b.lazyLoad()};this.addPostToWidget=function(){var a=chatter.getPublisher();a.addWidget({widgetName:"postToWidget",get:function(){var b=Sfdc.get(".postTo",a.getPublisherContainer()),c=new PostToWidget(b,a.setSubject);a.addEventListener("chatter:publisher","onAfterRestoreDefaultUIState",c.reset);
a.addEventListener("chatter:publisher","onOpenTypeSpecificPanel",function(b){b=Sfdc.get(".activeTemplate",a.getPublisherContainer());Sfdc.get(".postTo",b)?e.setSubject(c.getSubject()):e.setSubject(a.getOriginalSubject())});return c}})};this.addVisibilityWidget=function(a,b,c,d,e){var f=chatter.getPublisher();f.addWidget({widgetName:"visibilityWidget",get:function(){f.setHasUserSharingMessage(b);f.setShowFollowV2Message(d);f.setIsFollowV2Enabled(c);f.setIsFilesUserSharingEnabled(e);var g=Sfdc.Dom.getParent(Sfdc.get("publisherVisibilityIcon")),
g=new VisibilityWidget({icon:g,helpUrl:a});g.registerHandler(f.getVisibilityMessages);return g},wire:function(){f.addEventListener("chatter:publisher","onAfterUpdateSubject",function(a,b){var c=f.getWidget("visibilityWidget");b.subjectId?c.enableWidget():c.disableWidget()})}})};this.addVisibilityDropdownWidget=function(){var a=chatter.getPublisher();a.addWidget({widgetName:"visibilityDropdownWidget",get:function(){a.addEventListener("chatter:publisher","onAfterRestoreDefaultUIState",function(){a.setFeedItemVisibility(a.FEEDITEM_VISIBILITY_INTERNAL_USERS);
var b=Sfdc.get(".internalExternalDropdown .zen-select",a.getPublisherContainer());SfdcCmp.getInstance(b).reset()});return{setFeedItemVisibility:function(b){a.setFeedItemVisibility(b)}}},wire:function(){a.setFeedItemVisibility(a.FEEDITEM_VISIBILITY_INTERNAL_USERS)}})};if(q.getPerfEnabled()){var ia=this.openTypeSpecificPanel,ja=this.submit,ka=this.registerFeedItemTypeHandler;this.openTypeSpecificPanel=function(a,b,c){Perf.mark("openTypeSpecificPanel: "+b);ia.call(this,a,b,c);Perf.endMark("openTypeSpecificPanel: "+
b)};this.submit=function(){Perf.mark("Publisher: submit");ja.call()};this.registerFeedItemTypeHandler=function(a,b,c){if(a=ka.call(this,a,b,c)){var d=b.onSuccess,e=b.onFailure;b.onSuccess=function(a,c){d.call(b,a,c);Perf.endMark("Publisher: submit")};b.onFailure=function(a,c){e.call(b,a,c);Perf.endMark("Publisher: submit")}}return a}}}chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterPublisher:End");chatter.extend("Publisher",Publisher,null);
chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterTabUtil:Start");
function ChatterTab(){function n(a,b,c,d){y();var e="get";d.isPost&&(e="post");chatter.getEventBus().fireEvent("chatter:feed","onBeforeRemoveFeed");(null!=d.params.showRefreshStatus?d.params.showRefreshStatus:1)&&D(a);var z=function(a,c){if(d.onFailure)d.onFailure(c);0!==a.status&&(!c||!c.errormessage)&&alert(LC.getLabel("Feeds","GenericFailureNoGack"));if(b)for(var e=0;e<b.length;e++){var f=b[e].pane;chatter.getToolbox().updateHTML(f,b[e].html,!0)}y()},p={url:d.url,params:d.params,success:function(b,
e){if(Sfdc.isFunction(c)&&!c(e))z(b,e);else{chatter.getToolbox().updateHTML(f(),"",!1);chatter.getToolbox().updateHTML(l(),"",!1);chatter.getToolbox().updateHTML(k(),"",!1);d.params.showDefaultRightPane&&E();for(var g=0;g<a.length;g++){var p=a[g].pane,h=a[g].responseHTMLKey;chatter.getToolbox().updateHTML(p,e[h],!0)}if(d.onSuccess)d.onSuccess(b,e);e.showVideoLink&&"true"==e.showVideoLink?(e.videoLinkUrl&&(g=e.videoLinkUrl,Ext.select("a.videoLinkElement").set({href:g})),chatter.getToolbox().show(Ext.select("a.videoLinkElement"))):
F();defaultHelpLinkUrl&&(e.helpLinkUrl?A(e.helpLinkUrl):G());chatter.getEventBus().fireEvent("chatter:navigation","onAfterHtmlUpdate")}},failure:z,abortTargets:["feedRefresh","chatterTabRefresh"],ajaxInstanceKey:["chatterTabRefresh"]};chatter.getToolbox()[e](p)}function y(){for(var a=0;a<h.length;a++)h[a].hide();h=[]}function D(a){for(var b=0;b<a.length;b++){var c=new LoadingScreen(a[b].pane.dom,LC.getLabel("Global","loading"));c.show();h.push(c)}}function q(a){switch(a){case "middle":return r||(r=
Ext.get("centerContent")),r;case "right":return s||(s=Ext.get("rightContent")),s;case "whole":return t||(t=Ext.get("wholeContent")),t;default:alert("unknown pane type")}}function H(a,b){switch(a){case "ListViews":return chatter.getOmnitureEventMap().showListView+"-"+b.type+"-"+b.filter;default:var c="",d;for(d in b)c+=d+"\x3d"+b[d]+"\x26";return a+"?"+c}}var h=[],s,r,t,u,v={},w=null,I=this.refreshMiddlePane=function(a){m();var b=k(),b=x([b]),c=[{pane:l(),responseHTMLKey:"html"}];a.params.showDefaultRightPane=
!0;n(c,b,function(a){return a&&a.html},a)},J=this.refreshWholePane=function(a){m();var b=l(),c=f(),d=k(),b=x([b,c]);n([{pane:d,responseHTMLKey:"html"}],b,function(a){return a&&a.html},a)},K=this.refreshBothPanes=function(a){m();var b=l(),c=f(),d=k(),d=x([d]);n([{pane:b,responseHTMLKey:"middlePaneHtml"},{pane:c,responseHTMLKey:"rightPaneHtml"}],d,function(a){return a&&a.middlePaneHtml&&Sfdc.isString(a.rightPaneHtml)},a)},G=this.revertToDefaultHelpLinkUrl=function(){A(defaultHelpLinkUrl)},B={};this.isOnChatterTab=
function(){return null!==Ext.get("chatterTab")};this.handleMainFeedFiltersClick=function(){m();chatter.getToolbox().updateHTML(k(),"",!1)};this.setDefaultHelpLinkUrl=function(a){defaultHelpLinkUrl=a};this.getHelpLinkHref=function(a){return(a=B[a])?a:null};this.setHelpLinkHref=function(a,b){B[a]=b};var l=this.getMiddlePane=function(){return q("middle")},f=this.getRightPane=function(){return q("right")},k=this.getWholePane=function(){return q("whole")};this.handleListViewSearch=function(a){var b=Sfdc.select("#chatterListViewContainer h2 span.text")[0];
switch(a){case "groups":a=!1;var c=Sfdc.get("#mainNavigation .ftr_recent");c&&(a=Sfdc.Dom.hasClass(c.parentNode,"selected"));if(a){if(Sfdc.get("#mainNavigation .ftr_all")){Sfdc.Dom.setText(b,LC.getLabel("ChatterGroups","groupFilter_all"));chatter.getNavigationGroups().changeNavigationItemState("chatterTabNavigation","mainNavigation",2,2);break}if(Sfdc.get("#mainNavigation .ftr_my")){Sfdc.Dom.setText(b,LC.getLabel("ChatterGroups","groupFilter_my"));chatter.getNavigationGroups().changeNavigationItemState("chatterTabNavigation",
"mainNavigation",2,0);break}}break;default:Sfdc.log(a+" not supported")}};this.initializeFeedTypeList=function(){chatter.getFeed().wireFeedSwitchAfterPost({feedType:"NEWS",isDropDownFiltersVisible:!0},function(){var a=chatter.getFeed().getConfig();return"NEWS"!==a.feedType||"all"!==a.feedfilter});chatter.getEventBus().addEventListener("chatter:feed","onAfterNewPostFeedUpdate",function(){C().selectDefaultItem()})};this.registerRefreshTypeHandler=function(a,b){v[a]?Sfdc.error(a+" refresh handler has already been implemented"):
v[a]=b};this.refresh=function(a,b){omnitureWrapper.trackEvent(H(a,b));var c=v[a],d={isPost:!1};if(!c||!c.getRefreshTarget||!c.getEndPoint)alert("handler "+a+" is not implemented properly.");else{var e=c.getRefreshTarget(b),f={};d.url=c.getEndPoint(b);c.getAjaxParams&&(f=c.getAjaxParams(b));d.params=f;c.getAjaxMethod&&(d.isPost="post"===c.getAjaxMethod());d.onSuccess=function(a,b){if(c.onSuccess)try{c.onSuccess(a,b)}catch(d){Sfdc.error(d)}};d.onFailure=function(a,b){if(c.onFailure)try{c.onFailure(a,
b)}catch(d){Sfdc.error(d)}};switch(e){case "middle":I(d);break;case "both":K(d);break;case "whole":J(d);break;case "feed":d.feedType=d.params.feedType;chatter.getFeed().refresh(d);break;default:alert("refreshTarget: "+e+" not supported")}}};this.isDefaultFeedSelected=function(){var a=C();if(!a)return!1;a=a.getSelectedNavItem();return!!Sfdc.get(".trigger.NEWS",a)};var E=this.showDefaultRightContent=function(){if(u){var a=u;chatter.getToolbox().updateHTML(f(),a,!0)}else chatter.getToolbox().get({url:"/chattertab/rightContent",
success:function(a,c){chatter.getToolbox().updateHTML(f(),c.html,!0)}})},m=this.cacheDefaultRightContent=function(){var a=f().select(".defaultRightContentDiv").item(0);a&&(u=a.dom.innerHTML)},x=function(a){var b=[];if(Sfdc.isArray(a))for(var c=0;c<a.length;c++)b[c]={pane:a[c],html:a[c].dom.innerHTML},chatter.getToolbox().updateHTML(a[c],"",!1);return b},A=function(a){Ext.select("a.helpLinkElement").set({href:a})},F=this.hideVideoLink=function(){chatter.getToolbox().hide(Ext.select("a.videoLinkElement"))},
C=function(){return chatter.getNavigationGroups().getAssociatedGroup("chatterTabNavigation").mainNavigation};this.customFilterRefresh=function(a,b){var c=this;w=null;w={refresh:function(d){d&&(b.customFilterParams=Sfdc.JSON.stringify(d));c.refresh(a,b)}};this.refresh(a,b)};this.currentCustomFilter=function(){return w}}chatter.getToolbox().getPerfEnabled()&&Perf.mark("Sfdc.ChatterTabUtil:End","Sfdc.ChatterTabUtil:Start");chatter.extend("ChatterTab",ChatterTab,null);
chatter.getChatterTab().registerRefreshTypeHandler("CanvasApps",function(){return{getAjaxParams:function(a){return{showRefreshStatus:!1}},getEndPoint:function(a){return"/canvas?canvas\x3d"+a.canvas+(a.namespace?"\x26namespace\x3d"+a.namespace:"")},getRefreshTarget:function(a){return"whole"},onSuccess:function(a,b){if(Sfdc.canvas){var d=Sfdc.get("canvas-iframe"),e=Sfdc.JSON.parse(b.application),c=Sfdc.JSON.parse(b.xorSessionResult);Sfdc.canvas.parent.render({app:e,login:b.loginUrl,version:b.version,
sid:Sfdc.String.decryptXOR(c.maskedSid,c.mask)},d,{displayLocation:"Chatter"})}},onFailure:function(a,b){}}}());
chatter.getChatterTab().registerRefreshTypeHandler("DirectMessages",function(){return{getEndPoint:function(a){return"/directmessages/"},getRefreshTarget:function(a){return"both"},onSuccess:function(a,b){HelpBubble.hideBubble();directMessage.renderInboxOnSuccess(b)}}}());
chatter.getChatterTab().registerRefreshTypeHandler("FeedFavorites",function(){return{getEndPoint:function(a){return"/feed/favorites/"+a.feedFavoriteId},getAjaxParams:function(a){return{feedFavoriteId:a.feedFavoriteId,type:a.type,str:a.str,filterId:a.filterId,topicId:a.topicId,isPost:!0}},getAjaxMethod:function(a){return"post"},onSuccess:function(a,b){chatter.getEventBus().fireEvent("chatter:feed","onAfterFeedRefresh",{json:b})},getRefreshTarget:function(a){return"middle"}}}());
chatter.getChatterTab().registerRefreshTypeHandler("FeedTypes",function(){return{getEndPoint:function(a){return"/feed/"+UserContext.userId+"/"+a.type},getAjaxParams:function(a){var b="NEWS"===a.type;return{feedType:a.type,showFeedItemsOnly:chatter.getPublisher().isPublisherPresent(),isDropDownFiltersVisible:b}},getRefreshTarget:function(a){return chatter.getPublisher().isPublisherPresent()?"feed":"middle"},onSuccess:function(a,b){chatter.getEventBus().fireEvent("chatter:feed","onAfterFeedRefresh",
{json:b})}}}());
function ChatterTabGuidedTour(){var c=LC.getLabel("ChatterTab","GuidedTourSortByText"),b=LC.getLabel("ChatterTab","LearnMoreLink"),b="\x3ca class\x3d'chattertabguidedtour' href\x3d\""+chatter.getChatterTab().getHelpLinkHref("SortByHelpDoc")+'"\x3e'+b+"\x3c/a\x3e",c=c+"\x3cbr\x3e\x3cbr\x3e"+b,e={locator:".feedcontainer .feedSortMenuContainer",position:"tr-b",useArrow:!0,offsets:[15,-3],arrowOffset:-60,width:350,title:LC.getLabel("ChatterTab","GuidedTourSortByTitle"),content:c,countStep:!0,toolbarItems:[{xtype:"tbfill"}]};
this.startGuidedTour=function(c){var b=new Sfdc.GuidedTour({steps:[e]});b.closeForeverHandler=function(){var a;a:{for(a=this.currentStepNum;a<this.steps.length-1;)if(a+=1,this.shouldShowTheStep(this.steps[a])){a=!0;break a}a=!1}a?this.nextStepHandler():(UserContext.userPreferences.setBoolean("ShowChatterTab178GuidedTour",!1),Sfdc.GuidedTour.prototype.closeForeverHandler.call(this))};var d=chatter.getEventBus();d.addEventListener("chatter:feed","onBeforeRemoveFeed",function(){d.removeEventListener("chatter:feed",
"onBeforeRemoveFeed",arguments.callee);b.showLaterHandler()});b.start()}}chatter.extend("ChatterTabGuidedTour",ChatterTabGuidedTour,null);
chatter.getChatterTab().registerRefreshTypeHandler("ListViews",function(){return{getEndPoint:function(a){return"/listview/"+a.type},getAjaxParams:function(a){return{type:a.type,filter:a.filter,fldr:a.fldr,linkDesc:a.linkDesc,customFilterParams:a.customFilterParams}},getRefreshTarget:function(a){return"file"===a.type?(Sfdc.ChatterFileUploader&&(Sfdc.ChatterFileUploader.isFileSync="fs"===a.filter?!0:!1),"whole"):"note"===a.type||"topics"===a.type?"whole":"both"}}}());
chatter.getPublisher().registerFeedItemTypeHandler("ContentPost",function(){var k={visiblePanel:null,config:{omnitureEvent:"postFile"},setupPanel:function(){this.config.promptText=LC.getLabel("Publisher","FileGhostText")},state:{currentContentAction:null},clearPanelState:function(){this.onShowPanel();this.state={currentContentAction:null};chatter.getFileUploader().reset(this.fileInfoUpdate)},onShowPanel:function(){this.showPanel("chatterFileStageOne");this.publisherCore.setIsExtensionValidForSubmit(!1)},
onFailure:function(a,b){var c=chatter.getPublisher().getHandler("ContentPost");"UPLOAD"===c.state.currentContentAction?c.publisherCore.showErrors(b.html):"ATTACH_EXISTING"===c.state.currentContentAction?c.publisherCore.showErrors(b.errors.message):"ATTACH_EXTERNAL"===c.state.currentContentAction&&c.publisherCore.showErrors(b.errors.message);c.publisherCore.enablePublisher()},onSuccess:function(a,b){var c=chatter.getPublisher().getHandler("ContentPost");c.clearPanelState();c.publisherCore.switchToDefaultPublisherType();
chatter.getRecentFiles().isWidgetPresent()&&b.recentFilesPanelHtml&&(c=chatter.getFileUploader().getBase64Decoder().decode(b.recentFilesPanelHtml),chatter.getRecentFiles().refresh(c))},getPayload:function(a){var b=this.publisherCore.getRawBody();"UPLOAD"===this.state.currentContentAction?a.q=";postFile":"ATTACH_EXISTING"===this.state.currentContentAction?a.contentDocumentId=this.state.contentDocumentId:"ATTACH_EXTERNAL"===this.state.currentContentAction&&(a.externalDataSourceId=this.state.externalDataSourceId,
a.externalDocumentId=this.state.externalDocumentId);a.refreshRecentFiles=chatter.getRecentFiles().isWidgetPresent();this.publisherCore.isPromptText(b)||(a.text=b);return a},postWithCustomFunction:function(a){var b=chatter.getToolbox(),c=this.publisherCore,d=c.getHandler("ContentPost"),e=function(a,b){chatter.getEventBus().fireEvent("chatter:publisher","onAfterUpdateStatus",{json:b});d.onSuccess(a,b)};if("UPLOAD"===this.state.currentContentAction)if(!0===d.state.showNewStageTwo){var g=function(a,d){Sfdc.AccessibleMultiUploadFilesDialog.closeIt(!0);
b.xhrFailure(a,d);c.switchToDefaultPublisherType();c.enablePublisher()},h=Sfdc.get("sfdcSyncOption");h&&(a.sfdcSync=h.checked?"1":"0");Sfdc.AccessibleMultiUploadFilesDialog.open({fileInput:this.state.fileInput,displayDDTargetIcon:!1,filterParentId:"",parentEntityName:"",uploaderOrigin:"PUBLISHER",uploadActionUrl:b.sitePrefix()+b.apiurl(),params:a,customHandlers:{failureHandler:function(a,b){Sfdc.AccessibleMultiUploadFilesDialog.closeIt(!0);d.onFailure(a,b)},errorHandler:g,successHandler:function(a,
b){Sfdc.AccessibleMultiUploadFilesDialog.closeIt(!0);e(a,b)},cancelHandler:function(){Sfdc.AccessibleMultiUploadFilesDialog.uploader.cancelRemainingUploads();c.openTypeSpecificPanel(Sfdc.get("publisherAttachContentPost"),"ContentPost");c.enablePublisher()}}})}else chatter.getFileUploader().upload(b.sitePrefix()+b.apiurl(),a,{failureHandler:this.onFailure,errorHandler:g,successHandler:e},this.state.helpUrl);else if("ATTACH_EXISTING"==this.state.currentContentAction)b.post({url:"/feeditems",params:a,
failure:this.onFailure,success:e});else if("ATTACH_EXTERNAL"==this.state.currentContentAction){var f=ExternalFileProgressDialog.showOnPostFile("extFileProgress",this.state.externalFileSharedByReference);b.post({url:"/feeditems",params:a,failure:function(a,b){f.hide();d.onFailure(a,b)},success:function(a,b){f.hide();e(a,b)}})}},fileInfoUpdate:function(){var a=chatter.getPublisher().getHandler("ContentPost");chatter.getFileUploader().fileInfoUpdate();a.publisherCore.setIsExtensionValidForSubmit(!0)},
fileNewInfoUpdate:function(a){var b=chatter.getPublisher().getHandler("ContentPost");if(a.files&&1==a.files.length){b.state.showNewStageTwo=!0;b.state.currentContentAction="UPLOAD";b.state.fileInput=a;a=a.files[0];var c="undefined"!=typeof a.fileName?a.fileName:a.name,d="undefined"!=typeof a.fileSize?a.fileSize:a.size,d=Sfdc.MultiFileUploaderUtil.formatFileSize(d);Sfdc.get("chatterSelectedFileName").innerHTML=chatter.getToolbox().htmlEncode(c);Sfdc.get("chatterSelectedFileSize").innerHTML=chatter.getToolbox().htmlEncode(LC.getLabel("ChatterFileMultiUpload",
"valueInParentheses",d));a=Sfdc.MultiFileUploaderUtil.formatFileTypeCSS(a.type,"32");Sfdc.get("chatterSelectedFileTypeIcon").className=a;b.showPanel("chatterFileNewStageTwo");b.publisherCore.setIsExtensionValidForSubmit(!0)}},focusFirstElement:function(){var a=Sfdc.get("chatterLinkFileAction");if(Sfdc.Dom.isVisible(a,!0))a.focus();else return!0},showFileInfo:function(a,b,c){isIPhone||isIPad?alert(LC.getLabel("Publisher","fileUploadNotSupportedOnDevice")):c&&Sfdc.MultiFileUploaderUtil.isFileAPISupported()&&
!Sfdc.userAgent.isSafari&&!Sfdc.userAgent.isChromium?Sfdc.get("hiddenFileBtn").click():(this.showPanel("chatterFileStageTwo"),this.state.currentContentAction="UPLOAD",this.state.helpUrl=b?b:null,a=chatter.getFileUploader(),a.resetDialogAppendix(),a.initFields(),a.initValidation(function(a){var b=chatter.getPublisher().getHandler("ContentPost");a?b.publisherCore.setIsExtensionValidForSubmit(!0):b.publisherCore.setIsExtensionValidForSubmit(!1)}))},setMyFilesFilterFlag:function(a){this.config.isMyFilesFilterOn=
a},openSelectFilesToAttach:function(a,b,c){this.getCurrentFeedParentId=c;if(c=sfdcPage.getDialogById(a))return c;c=558;Ext.isIE&&(c=560);var d="?feedParentId\x3d"+this.getCurrentFeedParentId();b&&(d+="\x26cc\x3dtrue");c=new IFrameDialog(a,LC.getLabel("Publisher","selectFileDialogTitle"),UserContext.getUrl("/_ui/content/view/files/sharing/FindLinkedFilesPage"+d),c,946);c.getContent=function(){return'\x3ciframe frameborder\x3d"no" scrolling\x3d"no" id\x3d"'+this.contentId+'" style\x3d"overflow:hidden; border:0;height:'+
this.height+'px;width: 100%;" src\x3d"'+this.url+'"\x3e\x3c/iframe\x3e'};c.register();return c},showLinkFile:function(){this.openSelectFilesToAttach("chatterFindExistingContent",!1,function(){return chatter.getPublisher().getSubjectId()}).display()},showSharingOptions:function(a,b){if(a.match(Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX_MATCH)==Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX){var c=this,d=[{text:LC.getLabel("ChatterFileSharing","viewer"),value:Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_VIEWER},
{text:LC.getLabel("ChatterFileSharing","collaborator"),value:Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_COLLABORATOR}];b?(d={entityId:a},chatter.getToolbox().get({url:"/file/sharingright/"+b,params:d,success:function(a,b){for(var d=[],f=0;f<b.length;f++)d[f]={text:b[f].label,value:b[f].sharingType};c.publisherCore.setOptionsMenu(d)},failure:function(a,b){}})):c.publisherCore.setOptionsMenu(d)}},showLinkedFileInfo:function(a){this.state.currentContentAction="ATTACH_EXISTING";OverlayDialogElement.getDialog("chatterFindExistingContent").hide();
var b=this;chatter.getToolbox().get({params:{q:";linkedContentDetails",contentDocumentId:a},failure:function(a,d){d.errors&&b.publisherCore.showErrors(d.errors);b.publisherCore.setIsExtensionValidForSubmit(!1)},success:function(c,d){b.showPanel("chatterFileContent");var e=Ext.get("chatterExistContentInfo");Ext.DomHelper.overwrite(e,d.html);b.state.contentDocumentId=a;b.publisherCore.setIsExtensionValidForSubmit(!0);Ext.get("publishersharebutton").focus()}})},showExternalLinkedFileInfo:function(a,
b,c){this.state.currentContentAction="ATTACH_EXTERNAL";OverlayDialogElement.getDialog("chatterFindExistingContent").hide();var d=this,e=ExternalFileProgressDialog.showOnGetFileInfo("extFileProgress");chatter.getToolbox().get({url:"/contenthub/linkedfiledetails/"+a+"/"+encodeURIComponent(b),failure:function(a,b){e.hide();b.errors&&d.publisherCore.showErrors(b.errors.message);d.publisherCore.setIsExtensionValidForSubmit(!1)},success:function(g,h){e.hide();d.showPanel("chatterFileContent");var f=Ext.get("chatterExistContentInfo");
Ext.DomHelper.overwrite(f,h.html);d.state.externalDataSourceId=a;d.state.externalDocumentId=b;d.state.externalFileSharedByReference=c;d.publisherCore.setIsExtensionValidForSubmit(!0);Ext.get("publishersharebutton").focus()}})},handleFileUploadCancel:function(){for(i=0;i<window.frames.length;i++)try{0<=window.frames[i].name.indexOf("ext-gen")&&(window.frames[i].location="/img/s.gif")}catch(a){}this.publisherCore.openTypeSpecificPanel(Sfdc.get("publisherAttachContentPost"),"ContentPost");this.publisherCore.enablePublisher();
return!0},getVisibilityMessages:function(a,b,c,d,e,g){b=UserContext.isDefaultNetwork;a=a.subjectId.substr(0,3);e="0F9"===a;c="005"===a?d&&g?LC.getLabel("ContentPostVisibility","whoCanSeeThis_UserPost_UserSharing"):b?LC.getLabel("ContentPostVisibility","whoCanSeeThis_UserPostInCompany"):LC.getLabel("ContentPostVisibility","whoCanSeeThis_UserPostInNetwork"):e?LC.getLabel("ContentPostVisibility","whoCanSeeThis_GroupPost"):"INTERNAL_USERS"==c?LC.getLabel("ContentPostVisibility","whoCanSeeThis_RecordPost_InternalUsers"):
LC.getLabel("ContentPostVisibility","whoCanSeeThis_RecordPost_AllUsers");d=LC.getLabel("ContentPostVisibility","whoCanSeeThisFileTitle");return[{text:c,title:d}]},showPanel:function(a){var b=this.publisherCore.getPublisherContainer(),c=Sfdc.get(k.visiblePanel,b);c&&Sfdc.Dom.addClass(c,"hidden");(b=Sfdc.get(a,b))&&Sfdc.Dom.removeClass(b,"hidden");k.visiblePanel=a},_addDragEnterListener:function(a){var b=chatter.getPublisher().getPublisherContainer(),c=Sfdc.get("publisherAttachContentPost");null!=b&&
null!=c?(Sfdc.on(b,"drop",function(a){a&&(a.target&&("INPUT"!==a.target.tagName||"file"!==a.target.type))&&a.preventDefault()}),Sfdc.on(b,"dragover",function(a){a&&a.preventDefault()}),Sfdc.on(b,"dragenter",function(a){a=chatter.getPublisher();var b=a.getHandler("ContentPost"),g=a.getCurrentActionType();"TextPost"!==g&&"ContentPost"!==g||("TextPost"===g&&a.openTypeSpecificPanel(c,"ContentPost"),"UPLOAD"!=b.state.currentContentAction&&b.showFileInfo(b.state.fileInput,null,!1))})):20>a&&window.setTimeout(function(){chatter.getPublisher().getHandler("ContentPost")._addDragEnterListener(++a)},
1E3)}};!Sfdc.userAgent.isIE&&!Sfdc.userAgent.isSafariIOS&&window.setTimeout(function(){chatter.getPublisher().getHandler("ContentPost")._addDragEnterListener(1)},100);return k}());
Sfdc.ns("Sfdc.CreateRecordHandler");
Sfdc.CreateRecordHandler=function(){this.registerFeedItemTypeHandler=function(k,m,r,g,s,u,v){g||(g=k);chatter.getPublisher().registerFeedItemTypeHandler("CreateRecordEvent",function(){function p(){window.picklist&&(picklist.initialized=!1,picklist.initAll())}function q(a,b){var c=Sfdc.get(d.config.formId);if(c){var w=c.parentNode;Sfdc.Dom.removeChild(c);Sfdc.Dom.insertHTML(w,a.htmlForm);Sfdc.userAgent.isIE7&&chatter.getFeed().getQuickActionPublisher().reflow();if(c=Sfdc.get(d.config.formId))if(c=
Sfdc.Resource.getScriptsFromHtml(c),b){var h=0,f=[],e=[],g=!1;Sfdc.Array.forEach(c,function(a){a.src?(0<a.src.indexOf("ckeditor")&&(g=!0),f.push(a.src)):e.push(a)});if(g){var l=function(){"loaded"===CKEDITOR.status?Sfdc.Resource.execScripts(e,p):20>h&&(h++,setTimeout(l,500))};Sfdc.Resource.addJavaScripts(f,function(){setTimeout(l,200)})}else Sfdc.Resource.execScripts(c,p)}else Sfdc.Resource.execScripts(c,p)}}var d={config:{omnitureEvent:"recordCreate",urlMaxLen:1E3,urlNameMaxLen:255,disallowedLinkChars:/[\s\\]+/},
state:{}};d.config.actionIdParam=k;d.config.formId=m;d.config.formSuffix=g;d.setupPanel=function(){Sfdc.onload(function(){window.picklist&&picklist.initAll()});d.config.submitValueAndTitle={value:r,title:r}};d.clearPanelState=function(){};d.focusFirstElement=function(){var a;a:{a=Sfdc.get(m);for(var b=a.getElementsByTagName("input"),c=0;c<b.length;c++)if("text"==b[c].getAttribute("type")){a=b[c];break a}for(var d="undefined"!==typeof CKEDITOR,b=a.getElementsByTagName("textarea"),c=0;c<b.length;){a=
d&&CKEDITOR.instances[b[c].name]?CKEDITOR.instances[b[c].name]:b[c];break a}a=null}a&&(a.focus(),"undefined"!==typeof CKEDITOR&&a instanceof CKEDITOR.editor?a.createRange&&(b=a.createRange(),b.moveToElementEditEnd(b.root),a.getSelection().selectRanges([b])):a.select())};d.onShowPanel=function(){var a=Sfdc.get(d.config.formId);Sfdc.Dom.hasClass(a,"stub")&&(a={url:"/quickcreate/",params:{entityId:s.getSubjectId(),actionIdParam:k,formSuffix:d.config.formSuffix},success:function(a,c){q(c,!0)}},"undefined"!==
typeof entityFeedPage?entityFeedPage.getObjectUpdate(chatter.getFeed().getConfig().subjectId,a):chatter.getToolbox().get(a));this.publisherCore.setIsExtensionValidForSubmit(!0)};var t=null;d.onSuccess=function(a,b){var c=chatter.getEventBus();b.feedItemId&&"undefined"===typeof entityFeedPage&&c.fireEvent("chatter:publisher","onAfterUpdateStatus",{json:b});q(b);if(!b.feedItemId&&b.successMessage){var d=document.querySelectorAll(".nonFeedSuccess")[0],h=document.querySelectorAll(".nonFeedSuccessMessage")[0];
Sfdc.Dom.setText(h,b.successMessage);Sfdc.Dom.setStyle(d,"display","block");Sfdc.Animation.opacity(d,0,1,{duration:1E3});clearTimeout(t);t=setTimeout(function(){Sfdc.Animation.opacity(d,1,0,{duration:1E3,onComplete:function(){Sfdc.Dom.setStyle(d,"display","none")}})},5E3);c.fireEvent("chatter:publisher","onAfterNonFeedUpdateStatus",{json:b})}chatter.getPublisher().getHandler(g).publisherCore.enablePublisher()};d.onFailure=function(a,b){var c=chatter.getPublisher().getHandler(g);b.errors?c.publisherCore.showErrors(b.errors.message):
q(b);c.publisherCore.enablePublisher()};d.getPayload=function(a){a.actionIdParam=this.config.actionIdParam;a.formSuffix=d.config.formSuffix;for(var b=["input","select","textarea"],c=document.getElementById(m),g="undefined"!==typeof CKEDITOR,h=0;h<b.length;h++)for(var f=c.getElementsByTagName(b[h]),e=0;e<f.length;e++)if("checkbox"!=f[e].getAttribute("type")||f[e].checked)if("TEXTAREA"==f[e].tagName&&(g&&CKEDITOR.instances[f[e].name])&&(CKEDITOR.instances[f[e].name].updateElement(),CKEDITOR.instances[f[e].name].destroy(!0)),
"SELECT"==f[e].tagName){for(var k=[],l=f[e].options,n=0;n<l.length;n++)l[n].selected&&k.push(l[n].value);a[f[e].name]=k}else a[f[e].name]=f[e].value;a.save_new="Saving...";return a};d.postWithCustomFunction=function(a){a={url:"/quickcreate",params:a,failure:this.onFailure,success:this.onSuccess};"undefined"!==typeof entityFeedPage?entityFeedPage.postObjectUpdate(chatter.getFeed().getConfig().subjectId,a):chatter.getToolbox().post(a)};return d}(),{handlerId:g,publisherCore:s});Sfdc.resolve("Sfdc.EntityFeed.QuickAction")&&
Sfdc.EntityFeed.QuickAction.register({actionName:u,actionId:k,handlerId:g,formId:m,contextId:v,excludeClass:"stub"})}};var createRecordHandler=new Sfdc.CreateRecordHandler;
chatter.getPublisher().registerFeedItemTypeHandler("AnnouncementPost",function(){var c={config:{omnitureEvent:"post"},setupPanel:function(){this.config.promptText=LC.getLabel("ChatterGroups","announcementGhostText");this.config.expirationDateElement=Sfdc.get("expirationDate");d(this.config.expirationDateElement,e);var a=chatter.getPublisher().getTextArea();d(a,e)}},e=function(){var a=chatter.getPublisher().getHandler("AnnouncementPost"),b=chatter.getPublisher(),c=b.getRawBody(),b=!(chatter.getToolbox().stringIsEmpty(c)||
b.isPromptText(c))&&a.dateValidator(a.config.expirationDateElement.value);a.publisherCore.setIsExtensionValidForSubmit(b)}.bind(this),d=function(a,b){Sfdc.Event.add(a,"keyup",b);Sfdc.Event.add(a,"change",function(){b.defer(10)});Sfdc.Event.add(a,"cut",function(){b.defer(10)});Sfdc.Event.add(a,"paste",function(){b.defer(10)})};c.dateValidator=function(a){a=Sfdc.Date.isDate(a,UserContext.dateFormat);var b=Sfdc.get(".expirationDateErrorMsg");a?Sfdc.Dom.addClass(b,"hidden"):(Sfdc.Dom.updateHTML(b,LC.getLabel("ChatterGroups",
"announcementExpirationDateInvalid")),Sfdc.Dom.removeClass(b,"hidden"));return a};c.onShowPanel=function(){this.publisherCore.setIsExtensionValidForSubmit(!1)};c.focusFirstElement=function(){this.publisherCore.focusOnTextArea()};c.onSuccess=function(a,b){chatter.getPublisher().getHandler("AnnouncementPost").publisherCore.restoreDefaultUIState();if(b.announcement){var c=Sfdc.get("announcementPanel");Sfdc.Dom.updateHTML(c,b.announcement);(c=Sfdc.get("announcementActionDropDownButton"))&&SfdcCmp.init(c)}};
c.onFailure=function(a,b){var c=chatter.getPublisher().getHandler("AnnouncementPost");b.errors&&c.publisherCore.showErrors(b.errors.message);c.publisherCore.enablePublisher()};c.getPayload=function(a){var b=this.publisherCore.getRawBody();a.text=b;a.expirationDate=this.config.expirationDateElement.value;return a};c.validatePayload=function(a){var b=!(Sfdc.isEmpty(a.text)||this.publisherCore.isPromptText(a.text));a=Sfdc.Date.isDate(a.expirationDate,UserContext.dateFormat);return{isValid:b&&a}};c.onValidationFailure=
function(){this.publisherCore.resetPublisher();this.publisherCore.enablePublisher()};return c}());
(function(){chatter.extend("LinkMetadataRetriever",function(){function r(){for(var a=Sfdc.select("div.richPost div.inlinePlayer iframe"),b=a.length,c=0;c<b;c++){var k=a[c],e=t(k),d=Sfdc.get(".content",e),e=Sfdc.get(".inlinePlayerTrigger",e);Sfdc.Dom.show(e);Sfdc.Dom.removeClass(d,"full");Sfdc.Dom.hideByDisplay(k);Sfdc.Dom.removeChild(k)}}function E(){var a=F();n++;""!==a&&(a={url:"/link/metadata",params:{urls:a},success:function(a,c){v&&console.log(c);for(var k=c.linkMetadata,e=0;e<k.length;e++){var d=
k[e];try{if(y(d)){var f=d.original_url,l=d.type,p=g[f],q=d.title?x(d.title,h.titleLength):"",s="";d.description&&(s=x(d.description,h.descriptionLength));if(p){p.type=l;p.state="fetched";p.data={title:q,thumbnail_url:d.thumbnail_url,description:s,original_url:d.original_url,provider_url:d.provider_url};d.frame_src&&(p.data.frame_src=d.frame_src+"\x26width\x3d"+d.width+"\x26height\x3d"+d.height+"\x26autoplay\x3d1\x26wmode\x3dtransparent",p.data.frame_width=d.width,p.data.frame_height=d.height);for(var d=
f,m=g[d],r=m.previews,t=z(m),s=0;s<r.length;s++){var n=r[s],u=Sfdc.get(n.getPlaceholderId());Sfdc.Dom.hasClass(u,h.classFetching)&&d===n.getUrl()&&t(n,m.data)}}}}catch(w){v&&Sfdc.log('chatter:richLinkPost failed on parsing embed.ly response for "'+f+'": '+w,Sfdc.Logging.LogLevel.ERROR)}}},failure:function(){},dieSilently:!0},q&&(a.params.runningTest=q),G.get(a))}function y(a){return q?!0:a.error_code?!1:(a=a.thumbnail_url)&&(0!=a.indexOf("https")||-1<a.indexOf(window.location.hostname))?!1:!0}function x(a,
b){var c=document.createElement("DIV");Sfdc.Dom.setText(c,a);a=c.innerHTML;return a.length>b?a.substr(0,b)+"...":a}function z(a){var b="";switch(a.type){case "link":b=m;break;case "photo":b=m;break;case "video":b=a.data&&a.data.frame_src?w:m;break;case "rich":b=a.data&&a.data.frame_src?w:m;break;case "error":return}return b}function m(a,b){var c=A(a,H,b),c=b.thumbnail_url&&""!==b.thumbnail_url?c.replace("{!#thumbnail}",I).replace("{!#thumbnail_url}",b.thumbnail_url).replace("{!#rich_link_url}",b.original_url):
c.replace("{!#thumbnail}",B).replace("{!#rich_link_url}",b.original_url);C(a.getPlaceholderId(),c)}function w(a,b){var c=A(a,J,b),c=b.thumbnail_url&&""!==b.thumbnail_url?c.replace("{!#thumbnail}",K).replace("{!#thumbnail_url}",b.thumbnail_url).replace("{!#frame_src}",b.frame_src).replace("{!#frameWidth}",b.frame_width).replace("{!#frameHeight}",b.frame_height):c.replace("{!#thumbnail}",B).replace("{!#rich_link_url}",b.original_url);C(a.getPlaceholderId(),c)}function C(a,b){var c=Sfdc.get(a);if(c){var k=
t(c),k=Sfdc.select(".linkPostLinkContainer",k);Sfdc.Dom.hideByDisplay(k);Sfdc.Dom.insertHTML(c,b)}Sfdc.Dom.removeClass(c,h.classFetching);Sfdc.Dom.addClass(c,h.classFetched);L(c)}function t(a){return Sfdc.Dom.getParent(a,".feeditem")}function A(a,b,c){a=""!=a.getTitle()?a.getTitle():c.title;""===a&&(a=c.provider_url);return b=b.replace("{!#title}",a).replace("{!#description}",c.description).replace(/{!#original_url}/g,c.original_url).replace(/{!#provider_url}/g,c.provider_url)}function F(){var a=
"",b=0,c;for(c in g){if(b>=u)break;"initial"===g[c].state&&(a+=encodeURIComponent(c)+",",g[c].state="fetching",b++)}return a.substring(0,a.length-1)}function l(a){n=0;var b=Sfdc.select("."+h.classPrefetch);v&&console.log("event: "+a+" | found:"+b.length);if(0<b.length){Sfdc.each(b,function(a,b){var e=a.id,d=a.getAttribute("data-richUrl"),f=a.getAttribute("data-title")||"";q="true"==a.getAttribute("data-runningTest")||!1;Sfdc.Dom.removeClass(a,h.classPrefetch);Sfdc.Dom.addClass(a,h.classFetching);
e=new M(e,d,f);g[d]?"fetching"===g[d].state||"initial"===g[d].state?g[d].previews.push(e):"fetched"===g[d].state&&(d=g[d],z(d)(e,d.data)):g[d]={state:"initial",previews:[e],type:"",data:{}}});for(a=0;a<b.length/u;a++)E()}}function L(a){function b(){Sfdc.logServer("LinkMetadataRetriever",h.brokenImageErrorMessage,Sfdc.Logging.LogLevel.ERROR);Sfdc.un(c,"error",b,null);Sfdc.Dom.addClass(f,["thumbnail","default"]);Sfdc.Dom.updateHTML(f,N)}var c=Sfdc.get(".thumb",a),f=Sfdc.get(".thumbContainer",a);Sfdc.on(c,
"error",b,null,null)}function M(a,b,c){this.getPlaceholderId=function(){return a};this.getTitle=function(){return c};this.getUrl=function(){return b}}var h={titleLength:60,descriptionLength:150,poweredByText:LC.getLabel("Feeds","poweredByEmbedly"),classPrefetch:"richLink-prefetch",classFetching:"richLink-fetching",classFetched:"richLink-fetched",brokenImageErrorMessage:"Embed.ly returned thumbnail url is broken."},q=!1,v=!1,g={},f=chatter.getEventBus(),G=chatter.getToolbox(),u=5,n=0,D="\x3cdiv class\x3d'richPost {!#type}'\x3e{!#thumbnail}{!#inlinePlayer}\x3cdiv class\x3d'content'\x3e\x3ch4 class\x3d'title'\x3e\x3ca target\x3d'_blank' href\x3d'{!#original_url}'\x3e{!#title}\x3c/a\x3e\x3c/h4\x3e\x3ch5 class\x3d'provider'\x3e\x3ca target\x3d'_blank' href\x3d'{!#provider_url}'\x3e{!#provider_url}\x3c/a\x3e\x3cspan class\x3d'embedlyIcon' title\x3d'"+
h.poweredByText+"'\x3e"+h.poweredByText+"\x3c/span\x3e\x3c/h5\x3e\x3cdiv class\x3d'desc'\x3e{!#description}\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'chatter-clear'/\x3e\x3c/div\x3e",K="\x3cspan class\x3d'thumbContainer'\x3e\x3ca data-iframeSrc\x3d'{!#frame_src}' data-frameWidth\x3d'{!#frameWidth}' data-frameHeight\x3d'{!#frameHeight}' href\x3d'javascript:;' onclick\x3d'chatter.getLinkMetadataRetriever().launchVideo(this);' class\x3d'thumbnail inlinePlayerTrigger'\x3e\x3cimg src\x3d'/img/chatter/play.png' class\x3d'play' /\x3e\x3cimg src\x3d'{!#thumbnail_url}' class\x3d'thumb' width\x3d'120px' /\x3e\x3c/a\x3e\x3c/span\x3e",
I="\x3cspan class\x3d'thumbContainer'\x3e\x3ca target\x3d'_blank' href\x3d'{!#rich_link_url}' class\x3d'thumbnail'\x3e\x3cimg class\x3d'thumb' src\x3d'{!#thumbnail_url}'/\x3e\x3c/a\x3e\x3c/span\x3e",B="\x3cspan class\x3d'thumbContainer default'\x3e\x3ca target\x3d'_blank' href\x3d'{!#rich_link_url}' class\x3d'thumbnail default'\x3e\x3cimg class\x3d'thumb' src\x3d'/s.gif'/\x3e\x3c/a\x3e\x3c/span\x3e",H=D.replace("{!#type}","link").replace("{!#inlinePlayer}",""),J=D.replace("{!#type}","video").replace("{!#inlinePlayer}",
"\x3cdiv class\x3d'inlinePlayer'\x3e\x3c/div\x3e"),N="\x3cimg src\x3d'/s.gif'\x3e";this.setRunningTest=function(a){q=a};this.setDebugMode=function(a){v=a};this.getBatchSize=function(){return u};this.getBatchCallCount=function(){return n};this.parseDOMAndRender=function(){l()};this.launchVideo=function(a){var b=a.getAttribute("data-iframeSrc"),c=a.getAttribute("data-frameWidth"),f=a.getAttribute("data-frameHeight"),e=t(a);a=Sfdc.get(".content",e);var d=Sfdc.get(".inlinePlayerTrigger",e),e=Sfdc.get(".inlinePlayer",
e);Sfdc.Dom.addClass(a,"full");Sfdc.Dom.hideByDisplay(d);Sfdc.Dom.insertHTML(e,"\x3ciframe src\x3d'{!#frame_src}' width\x3d'{!#frameWidth}px' height\x3d'{!#frameHeight}px' frameborder\x3d'0' scrolling\x3d'no'\x3e\x3c/iframe\x3e".replace("{!#frame_src}",b).replace("{!#frameWidth}",c).replace("{!#frameHeight}",f))};this.isResultSafeToRender=function(a){return y(a)};this.getProperLengthString=function(a,b){return x(a,b)};f.addEventListener("chatter:feed","onAfterFeedRefresh",l);f.addEventListener("chatter:feed",
"onAfterShowMoreFeedItems",l);f.addEventListener("chatter:feed","onAfterNewPostFeedUpdate",l);f.addEventListener("chatter:feed","onAuxBodyChange",l);f.addEventListener("chatter:rechat","onAfterPreviewLoaded",l);f.addEventListener("unifiedSearchPage:feedSearchResults","onAfterResultsShown",l);f.addEventListener("chatter:modalOverlay","onBeforeOverlayShown",r);f.addEventListener("chatter:feed","onBeforeRemoveFeed",r);f.addEventListener("UIComponent:OverlayDialog","onBeforeOverlayShow",r)},null);Sfdc.onload(function(){chatter.getLinkMetadataRetriever().parseDOMAndRender()})})();
chatter.getPublisher().registerFeedItemTypeHandler("LinkPost",function(){var e={config:{omnitureEvent:"postLink",urlMaxLen:1E3,urlNameMaxLen:255,disallowedLinkChars:/[\s\\]+/},state:{},setupPanel:function(){var a=this;a.config.promptText=LC.getLabel("Publisher","LinkGhostText");a.config.urlElement=Ext.get("url");a.config.urlNameElement=Ext.get("urlName");a.config.urlErrorEl=chatter.getToolbox().getElementErrorContainer(e.config.urlElement);a.config.urlNameErrorEl=chatter.getToolbox().getElementErrorContainer(e.config.urlNameElement);
var b=function(){var b=chatter.getToolbox(),f=b.stringTrim(a.config.urlElement.getValue()),d=f,c=d.indexOf("https://");0<c&&10>c?d=d.substring(c):(c=d.indexOf("ftp://"),0<c&&10>c?d=d.substring(c):(c=d.indexOf("http://"),0<c&&10>c?d=d.substring(c):0===c&&(c=d.substring(7).indexOf("http://"),-1<c&&3>c&&(d=d.substring(7+c)))));d!=f&&(f=a.config.urlElement.dom.value=d);var e=f.length,g=b.stringTrim(a.config.urlNameElement.getValue()).length,d=LC.getLabel("Publisher","postInvalidLinkUrl"),c=LC.getLabel("Publisher",
"postLinkRequired"),h=LC.getLabel("Publisher","postValueMaxLen",a.config.urlMaxLen),k=LC.getLabel("Publisher","postValueMaxLen",a.config.urlNameMaxLen);b.validateElement(a.config.urlErrorEl,function(){return 0<e},c)&&b.validateElement(a.config.urlErrorEl,function(){return e<=a.config.urlMaxLen},h)&&b.validateElement(a.config.urlErrorEl,function(){return!a.config.disallowedLinkChars.test(f)},d)&&b.validateElement(a.config.urlNameErrorEl,function(){return g<=a.config.urlNameMaxLen},k)?a.publisherCore.setIsExtensionValidForSubmit(!0):
a.publisherCore.setIsExtensionValidForSubmit(!1)};chatter.getToolbox().wireFieldChange(a.config.urlElement,b);chatter.getToolbox().wireFieldChange(a.config.urlNameElement,b)},clearPanelState:function(){this.config.urlElement.dom.value=LC.getLabel("Publisher","httpProtocolPrefix");this.config.urlNameElement.dom.value="";Sfdc.Dom.addClass(this.config.urlErrorEl.dom,"hidden");Sfdc.Dom.addClass(this.config.urlNameErrorEl.dom,"hidden")},focusFirstElement:function(){this.config.urlElement.focus();this.config.urlElement.dom.select()},
onShowPanel:function(){var a=Sfdc.get("publishereditablearea");if(a){var b=a.value;if(b&&-1===b.indexOf(" ")&&(0===b.indexOf("http://")||0===b.indexOf("https://")||0===b.indexOf("ftp://"))){this.config.urlElement.dom.value=b;a.value="";this.publisherCore.setIsExtensionValidForSubmit(!0);this.config.urlNameElement.focus();this.config.urlNameElement.dom.select();return}}this.publisherCore.setIsExtensionValidForSubmit(!1)},onSuccess:function(a,b){chatter.getPublisher().getHandler("LinkPost");chatter.getYoutubeVideo().fetchVideoPreviews()},
onFailure:function(a,b){var e=chatter.getPublisher().getHandler("LinkPost");b.errors&&e.publisherCore.showErrors(b.errors.message);e.publisherCore.enablePublisher()},getPayload:function(a){var b=this.publisherCore.getRawBody();this.publisherCore.isPromptText(b)||(a.text=b);a.url=this.config.urlElement.getValue();a.urlName=this.config.urlNameElement.getValue();return a}};return e}());
chatter.getPublisher().registerFeedItemTypeHandler("NotePost",function(){var a={},h="";a.config={};a.state={};a.setupPanel=function(){this.config.promptText=LC.getLabel("Publisher","NoteGhostText");this.unsubmittedContent="";h=Sfdc.get("#formatting-container").innerHTML;Sfdc.on(window,"unload",k)};a.removeEventsForPostType=function(){f()};a.onShowPanel=function(){a.editor=CKEDITOR.replace(document.querySelector("#editor"),{resize_enabled:!1,height:"100%",extraAllowedContent:"p[onclick], li[onclick]",
removePlugins:"elementspath, magicline",toolbar:[{name:"basicstyles",groups:["basicstyles","cleanup"],items:["NumberedList","BulletedList"]}],on:{change:function(c){_this.checkDirty()}}},"");a.editor.setData(a.unsubmittedContent);d();l()};a.clearPanelState=function(){chatter.getPublisher().getHandler("NotePost").unsubmittedContent=g();Sfdc.get("#editor").innerHTML="";Sfdc.get("#formatting-container").innerHTML=h;f()};a.getPayload=function(c){var b=chatter.getToolbox(),a=g(),d=Sfdc.get(".noteTitleInput"),
b=b.stringTrim(d.value);c.content=a;c.noteTitle=b;return c};a.validatePayload=function(c){chatter.getToolbox();c=0!==c.content.length;return{isValid:c,errorPayload:{hasContent:c}}};a.onValidationFailure=function(c){var a=chatter.getPublisher().getHandler("NotePost"),e=LC.getLabel("Publisher","noteMissingBody");c.hasContent||a.publisherCore.showErrors(e);a.publisherCore.enablePublisher()};a.onSuccess=function(c,a){var e=chatter.getPublisher().getHandler("NotePost");Sfdc.get(".noteTitleInput").value=
"";e.editor.setData("");e.unsubmittedContent="";f()};a.onFailure=function(a,b){var e=chatter.getPublisher().getHandler("NotePost");b.errors&&e.publisherCore.showErrors(b.errors.message);e.publisherCore.enablePublisher()};var k=function(){Sfdc.un(window,"unload",k)},d=function(){var a=chatter.getToolbox(),b=chatter.getPublisher(),e=0!==g().length,d=Sfdc.get(".noteTitleInput"),a=0<a.stringTrim(d.value).length;e&&a?b.setIsExtensionValidForSubmit(!0):b.setIsExtensionValidForSubmit(!1)},g=function(){return chatter.getPublisher().getHandler("NotePost").editor.getData()},
l=function(){var a=chatter.getPublisher().getHandler("NotePost"),b=Sfdc.get(".noteTitleInput");Sfdc.Event.add(b,"keyup",d);Sfdc.Event.add(a.editor.root,"keyup",d)},f=function(){var a=chatter.getPublisher().getHandler("NotePost"),b=Sfdc.get(".noteTitleInput");Sfdc.Event.remove(b,"keyup",d);Sfdc.Event.remove(a.editor.root,"keyup",d)};return a}());
function PollPostHelper(){function g(a){a=new LoadingScreen(a,LC.getLabel("Global","loading"));a.show();b=a}var e=chatter.getToolbox(),b=null;this.vote=function(a){var c=Ext.get(a),d=c.findParent(".pollauxiliarybody",null,!0);if(a=d.child(".pollchoices").child("input:checked")){a=a.dom.id;var b=Sfdc.Dom.getParent(d.dom,".cxfeeditem").id;e.disableButton(c);e.post({url:"/poll/choices/"+a+"/votes",params:{feeditemid:b},success:function(a,b){b.html&&Sfdc.Dom.updateHTML(d.dom,b.html)},failure:function(a,
b){e.enableButton(c)}})}else alert(LC.getLabel("Feeds","PollNoChoiceSelectedVoteError"))};this.toggleView=function(a,c,d){var f=Ext.get(c).parent(".pollauxiliarybody");d&&g(f.dom);c=Sfdc.Dom.getParent(f.dom,".cxfeeditem").id;e.get({url:"/poll/"+c+"/",params:{viewtype:a},success:function(a,c){d&&(b.hide(),b=null);c.html&&Sfdc.Dom.updateHTML(f.dom,c.html)},failure:function(a,c){d&&(b.hide(),b=null)}})}}chatter.extend("PollPostHelper",PollPostHelper,null);
chatter.getPublisher().registerFeedItemTypeHandler("PollPost",function(){var k={config:{defaultNumChoicesDisplayed:2,minNumChoices:2,maxNumChoices:10,maxChoiceLength:100},state:{numChoicesShown:2},wiredFields:{},setupPanel:function(){this.config.promptText=LC.getLabel("Publisher","QuestionGhostPrompt");Sfdc.on(window,"unload",l)},validatePollChoices:function(){for(var a=chatter.getPublisher().getHandler("PollPost"),b=chatter.getToolbox(),d=LC.getLabel("Feeds","PollChoiceLengthError",a.config.maxChoiceLength),
c=Sfdc.select(".publisherpollchoiceinput"),e=c.length,f=!0,g=0;g<e;g++){var h=b.stringTrim(c[g].value),k=Sfdc.get(".errorMsg",Sfdc.Dom.getParent(c[g]));h?f=a.validateElement(k,function(){return h.length<=a.config.maxChoiceLength},d)&&f:Sfdc.Dom.addClass(k,"hidden")}return f},validateElement:function(a,b,d){if(b())return Sfdc.Dom.addClass(a,"hidden"),!0;Sfdc.Dom.updateHTML(a,d);Sfdc.Dom.removeClass(a,"hidden");return!1},removeEventsForPostType:function(){m()},focusFirstElement:function(){this.publisherCore.focusOnTextArea()},
onShowPanel:function(){chatter.getPublisher().getHandler("PollPost");this.publisherCore.setIsExtensionValidForSubmit(!1);for(var a=Sfdc.select("input.publisherpollchoiceinput"),b=a.length,d=chatter.getPublisher().getHandler("PollPost"),c=0;c<b;c++){var e=a[c];d.wiredFields[a[c].id]=e.value;Sfdc.Event.add(e,"keyup",n)}a=chatter.getPublisher().getTextArea();Sfdc.Event.add(a,"keyup",h);this.publisherCore.enablePublisher()},clearPanelState:function(){var a=this.config.defaultNumChoicesDisplayed;LC.getLabel("Publisher",
"MoreChoicesLabel");for(var b=Sfdc.select("div.publisherpollchoice"),d=b.length,c=0;c<d;c++){var e=b[c];c<a?Sfdc.get(".publisherpollchoiceinput",e).value="":e.parentNode.removeChild(e)}chatter.getPublisher().getHandler("PollPost").wiredFields={};a=Sfdc.get(".publisherpolladdchoice");Sfdc.Dom.show(a);k.state.numChoicesShown=k.config.defaultNumChoicesDisplayed;a=Sfdc.select(".errorMsg",Sfdc.get(".publisherpollchoices"));for(b=0;b<a.length;b++)Sfdc.Dom.setText(a[b],"")},getPayload:function(a){for(var b=
chatter.getToolbox(),d=this.publisherCore.getRawBody(),c=Sfdc.select(".publisherpollchoiceinput"),e=[],f=0;f<c.length;f++){var g=b.stringTrim(c[f].value);g&&e.push(g)}a.question=d;a.choices=e;return a},validatePayload:function(a){var b=chatter.getPublisher().getHandler("PollPost"),d=chatter.getToolbox(),c=a.choices.length;a=!(d.stringIsEmpty(a.question)||chatter.getPublisher().isPromptText(a.question));d=c>=b.config.minNumChoices;c=c<=b.config.maxNumChoices;return{isValid:a&&d&&c&&b.validatePollChoices(),
errorPayload:{questionPresent:a,hasMinNumChoices:d,hasLessThanMaxNumChoices:c}}},onValidationFailure:function(a){var b=chatter.getPublisher().getHandler("PollPost"),d=LC.getLabel("Feeds","PollTooFewChoicesError",b.config.minNumChoices);LC.getLabel("Feeds","PollTooManyChoicesError",b.config.maxNumChoices);var c=LC.getLabel("Feeds","PollQuestionRequiredError");a.questionPresent?a.hasMinNumChoices?a.hasLessThanMaxNumChoices||b.publisherCore.showErrors(c):b.publisherCore.showErrors(d):b.publisherCore.showErrors(c);
b.publisherCore.enablePublisher()},onSuccess:function(a,b){chatter.getPublisher().getHandler("PollPost");m()},onFailure:function(a,b){var d=chatter.getPublisher().getHandler("PollPost");b.errors&&d.publisherCore.showErrors(b.errors.message);d.publisherCore.enablePublisher()},addPollChoiceInputElement:function(a){var b=chatter.getPublisher().getHandler("PollPost"),d=Sfdc.get(".publisherpollchoice").cloneNode(!0),c=Sfdc.get(".publisherpollchoicelabel",d),e=Sfdc.get(".publisherpollchoiceinput",d);b.state.numChoicesShown++;
var f=p(e.getAttribute("id")),g=p(e.getAttribute("title"));Sfdc.Dom.set(e,{value:"",title:g,id:f});Sfdc.Dom.set(c,{attributes:{"for":f}});Sfdc.Dom.setText(c,g);b.state.numChoicesShown==b.config.maxNumChoices&&Sfdc.Dom.hideByDisplay(Sfdc.Dom.getParent(a,".publisherpolladdchoice"));a=Sfdc.get(".errorMsg",d);Sfdc.Dom.addClass(a,"hidden");Sfdc.Event.add(e,"keyup",n);Sfdc.get(".publisherpollchoices").appendChild(d);e.focus()}},l=function(){for(var a=Sfdc.select(".publisherpollchoiceinput"),b=0;b<a.length;b++)a[b].onfocus=
null;Sfdc.un(window,"unload",l)},n=function(){chatter.getPublisher().getHandler("PollPost").wiredFields[this.id]=this.value;h()},h=function(){chatter.getPublisher().getHandler("PollPost");chatter.getToolbox();var a=chatter.getPublisher();a.getRawBody();var b;if(b=!a.isTextBoxEmpty()&&!a.getHasTextareaErrors()){b=chatter.getToolbox();var d=chatter.getPublisher().getHandler("PollPost"),c=d.wiredFields,e=0,f;for(f in c)b.stringTrim(c[f])&&e++;b=e>=d.config.minNumChoices}b?a.setIsExtensionValidForSubmit(!0):
a.setIsExtensionValidForSubmit(!1)},m=function(){var a=chatter.getPublisher().getTextArea();Sfdc.Event.remove(a,"keyup",h)},p=function(a){var b=chatter.getPublisher().getHandler("PollPost");return a.replace(/\d/,b.state.numChoicesShown)};return k}());
PublisherVisibilityMessages=function(){};PublisherVisibilityMessages.getVisibilityMessages=function(a,d,f,b,g){d=PublisherVisibilityMessages.getLabels(a,d,f,UserContext.isDefaultNetwork,b,g);a={text:d.directedTo,title:LC.getLabel("ChatterVisibility","DirectedToTitle")};d={text:d.accessibleFrom,title:LC.getLabel("ChatterVisibility","AccessibleFromTitle")};return[a,d]};
PublisherVisibilityMessages.getLabels=function(a,d,f,b,g,k){var c=a.subjectId.substr(0,3),l="005"===c,h=a.subjectId===UserContext.userId,m="0F9"===c,e;b?(c=LC.getLabel("ChatterVisibility","TheAllCompanyFeed"),e=","):e=c="";l?k?(a=LC.getLabel("ChatterVisibility","DirectedToTopic"),b=LC.getLabel("ChatterVisibility","AccessibleFromTopic",c)):h||d?(a=LC.getLabel("ChatterVisibility","DirectedToYourProfile"),b=h?LC.getLabel("ChatterVisibility","AccessibleFromYourProfile",c,e):LC.getLabel("ChatterVisibility",
"AccessibleFromOtherUserProfile",c,e)):g?(a=LC.getLabel("ChatterVisibility","DirectedToOtherUserProfileWhenUserSharingEnabled"),b=b?LC.getLabel("ChatterVisibility","AccessibleFromOtherUserProfileWhenUserSharingEnabledCommunityZero",c):LC.getLabel("ChatterVisibility","AccessibleFromOtherUserProfileWhenUserSharingEnabledOtherCommunity")):(a=LC.getLabel("ChatterVisibility","DirectedToOtherUserProfile"),b=LC.getLabel("ChatterVisibility","AccessibleFromOtherUserProfile",c,e)):m?a.isExternalGroup?(a=LC.getLabel("ChatterVisibility",
"DirectedToExternalGroup"),b=LC.getLabel("ChatterVisibility","AccessibleFromPrivateGroup",c)):a.isPrivateGroup?(a=LC.getLabel("ChatterVisibility","DirectedToPrivateGroup"),b=LC.getLabel("ChatterVisibility","AccessibleFromPrivateGroup",c)):(a=LC.getLabel("ChatterVisibility","DirectedToPublicGroup"),b=LC.getLabel("ChatterVisibility","AccessibleFromPublicGroup",c)):"INTERNAL_USERS"==f?(a=LC.getLabel("ChatterVisibility","DirectedToRecordDetailEmployees"),b=LC.getLabel("ChatterVisibility","AccessibleFromRecordDetailEmployees",
c)):(a=LC.getLabel("ChatterVisibility","DirectedToRecordDetailEveryone"),b=LC.getLabel("ChatterVisibility","AccessibleFromRecordDetailEveryone",c));return{directedTo:a,accessibleFrom:b}};
chatter.getPublisher().registerFeedItemTypeHandler("QuestionPost",function(){var d={config:{},setupPanel:function(){var a=this;a.config.questionTitleEl=Sfdc.get("publisherQuestionTitle");a.config.questionTitleGhostText=LC.getLabel("QuestionFeedItemPublisher","QuestionTitleGhostText");a.config.promptText=LC.getLabel("QuestionFeedItemPublisher","QuestionBodyGhostText");var b={subjectId:chatter.getFeed().getConfig().subjectId};if(a.isDeflectionEnabled())chatter.onDeferLoad(function(){a.config.deflectionAutoCompleteComp=
new DeflectionAutoComplete("publisherQuestionTitle",chatter.getToolbox().sitePrefix()+"/_ui/deflection/QuestionDeflectionAutoCompleteServlet",b,chatter)});Sfdc.on(a.config.questionTitleEl,"focus",function(){d.onFocus(a.config.questionTitleEl)});Sfdc.on(a.config.questionTitleEl,"blur",function(){d.onUnfocus(a.config.questionTitleEl)});chatter.getToolbox().wireFieldChange(Ext.get("publisherQuestionTitle"),function(){a.isTitleEmptyOrPrompt()?a.publisherCore.setIsExtensionValidForSubmit(!1):a.publisherCore.setIsExtensionValidForSubmit(!0)});
var c=LC.getLabel("QuestionFeedItemPublisher","Ask");a.config.submitValueAndTitle={value:c,title:c}},onFocus:function(a){chatter.getPublisher().getHandler("QuestionPost").isTitlePromptText()&&(a.value="",Sfdc.userAgent.isSafari&&a.focus());Sfdc.Dom.addClass(a,"publisherQuestionTitlefocus")},onUnfocus:function(a){var b=chatter.getPublisher().getHandler("QuestionPost");b.isTitleEmptyOrPrompt()&&(a.value=b.config.questionTitleGhostText,Sfdc.Dom.removeClass(a,"publisherQuestionTitlefocus"))},onShowPanel:function(){chatter.getPublisher().getHandler("QuestionPost").publisherCore.setIsExtensionValidForSubmit(!1)},
onFailure:function(a,b){var c=chatter.getPublisher().getHandler("QuestionPost");c.publisherCore.enablePublisher();(c=c.config.deflectionAutoCompleteComp)&&c.hideNoResultsMessage();b.errors&&alert(b.errors.message)},focusFirstElement:function(){chatter.getPublisher().getHandler("QuestionPost").config.questionTitleEl.focus()},clearPanelState:function(){var a=chatter.getPublisher().getHandler("QuestionPost");a.config.questionTitleEl.value="";a.onUnfocus(a.config.questionTitleEl);if(a=a.config.deflectionAutoCompleteComp)a.clearSuggestions(),
a.hideNoResultsMessage()},onSuccess:function(){var a=chatter.getPublisher().getHandler("QuestionPost").config.deflectionAutoCompleteComp;a&&(a.clearCache(),a.clearSuggestions(),a.hideNoResultsMessage())},getPayload:function(a){var b=chatter.getPublisher().getHandler("QuestionPost"),c=b.publisherCore.getRawBody();b.publisherCore.isPromptText(c)||(a.text=c);b.isTitleEmptyOrPrompt()||(a.title=b.config.questionTitleEl.value);return a},isDeflectionEnabled:function(){var a=chatter.getPublisher().getHandler("QuestionPost");
return"y"==Sfdc.Dom.getAttribute(a.config.questionTitleEl,"data-deflection","n")},isTitlePromptText:function(){var a=chatter.getPublisher().getHandler("QuestionPost");return a.config.questionTitleEl.value==a.config.questionTitleGhostText},isTitleEmptyOrPrompt:function(){var a=chatter.getPublisher().getHandler("QuestionPost");return 0==chatter.getToolbox().stringTrim(a.config.questionTitleEl.value).length||a.isTitlePromptText()},modifyPublisherForDeflectionResults:function(){chatter.getPublisher().getHandler("QuestionPost").publisherCore.setIsExtensionValidForSubmit(!1)},
modifyPublisherWithoutDeflectionResults:function(){var a=chatter.getPublisher().getHandler("QuestionPost");a.publisherCore.setIsExtensionValidForSubmit(!a.isTitleEmptyOrPrompt())},validatePayload:function(){var a=!0,b={};chatter.getPublisher().getHandler("QuestionPost").isTitleEmptyOrPrompt()&&(a=!1,b={emptyQuestionTitle:!0});return{isValid:a,errorPayload:b}},onValidationFailure:function(a){var b=LC.getLabel("QuestionFeedItemPublisher","postTitleRequired");a.emptyQuestionTitle&&this.publisherCore.showErrors(b);
chatter.getPublisher().getHandler("QuestionPost").publisherCore.enablePublisher()}};return d}());
chatter.getPublisher().registerFeedItemTypeHandler("RypplePost",function(){var l=null,b=null,f=null,d=null,p=null,g=null,m=null,n=null,w=function(a,b){for(;null!==a.firstChild;)a.removeChild(a.firstChild);a.appendChild(document.createTextNode(b))},q=function(){void 0===thanksRecipientContainer&&(thanksRecipientContainer=Sfdc.get("thanksRecipientContainer"))},x=function(){var a=Sfdc.get("thanksRecipientInputBox");a.value=LC.getLabel("Rypple_Publisher","recipientghosttextJS");Sfdc.Dom.addClass(a,UserAndGroupAutoCompleteInputElement.INPUTBOX_GHOSTTEXT_CSS_CLASS)},
s=function(){Sfdc.get("thanksRecipientInputBox").value=""},y=function(){q();return Sfdc.Dom.getElementXY(thanksRecipientContainer).y+Sfdc.Dom.getHeight(thanksRecipientContainer)},r=function(a){b.state.thanksRecipientid="";var c=Sfdc.get("thanksRecipientInputBox"),e=Sfdc.Dom.getParent(c),h=Sfdc.get("thanksRecipient");a=Sfdc.get(".item_"+a+"",h);Sfdc.Dom.removeChild(a);Sfdc.Dom.show(e);b.state.usernoaccesstogrp="";z();k();A();null!=a&&(b.state.ryppleThanksSuccess||(Sfdc.userAgent.isIE?window.setTimeout("Sfdc.get('thanksRecipientInputBox').focus()",
200):c.focus()))},t=function(a,c){if(b.state.thanksRecipientid!=UserContext.userId){b.state.thanksRecipientid=a;var e=Sfdc.get("thanksRecipientInputBox"),h=Sfdc.Dom.getParent(e),d='\x3cdiv userid\x3d"'+a+'" class\x3d"item_'+a+' item " tabindex\x3d"0"\x3e\x3cspan class\x3d"recipientName"\x3e'+c+'\x3c/span\x3e\x3cdiv class\x3d"rypple-thanksRecipientRemove"\x3e\x3ca href\x3d"javascript:void(0)" class\x3d"remove"\x3e\x3cimg src\x3d"/s.gif"/\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e',g=Sfdc.get("thanksRecipient"),
d=Sfdc.Dom.insertHTML(g,d);remove=Sfdc.get(".remove",d[0]);Sfdc.on(remove,"click",function(){r(a)});Sfdc.on(g,"keydown",function(b){if(b.keyCode==Sfdc.Event.keyCode.BACKSPACE||b.keyCode==Sfdc.Event.keyCode.DELETE)r(a),Sfdc.Event.stopPropagation(),e.focus()});Sfdc.Dom.hideByDisplay(h);k();Sfdc.userAgent.isIE?window.setTimeout("chatter.getPublisher().getTextArea().focus()",200):f.focus()}UserAndGroupAutoCompleteInputElement.needDefer()?s.defer(100):s();H();I(a,c)},k=function(){result=!1;if(!b.config.ryppleReturnedError){var a=
f,c=Sfdc.get("thanksRecipient"),c=Sfdc.get(".recipientName",c),e=LC.getLabel("Rypple_Publisher","descriptionghosttextJS");""!=b.state.usernoaccesstogrp&&B(b.state.usernoaccesstogrp);result=null!=c&&null!=a.value&&a.value!=e&&0<a.value.length&&null==a.value.match(/^\s*$/)?!0:!1}b.publisherCore.setIsExtensionValidForSubmit(result)},H=function(){var a=Sfdc.get("thanksRecipientInputBox");Sfdc.Dom.set(a,"size",a.value.length+25);b.config.thankedWidget.acBox&&b.config.thankedWidget.acBox.setStyle("top",
y()+"px")},J=function(){b.state.isRyppleAuthorized&&(b.state.badgesRetrieved||chatter.getToolbox().get({url:"/workbadges",params:{},success:function(a,c){b.state.badgeHTML=c.html;b.state.badgesRetrieved=!0;Sfdc.Dom.set(g,"innerHTML",b.state.badgeHTML)}}))},u=function(){var a=Sfdc.get("badgeInfo");null!==a&&(b.state.badgeUrl=a.getAttribute("data-url"),b.state.badgeName=a.getAttribute("data-name"),b.state.badgeId=a.getAttribute("data-externalid"),b.state.badgeDescription=a.getAttribute("data-description"),
!0!==b.state.defaultBadgeImageSet&&(Sfdc.Dom.set(Sfdc.get(".publisherBadge"),"src",b.state.badgeUrl),b.state.defaultBadgeImageSet=!0))},A=function(){chatter.getTextareaMessageUtil().hideMessage({el:f.id,msg_id:"ryppleThanksFailed"});b.config.ryppleReturnedError=!1},z=function(){chatter.getTextareaMessageUtil().hideMessage({el:f.id,msg_id:"thanksRecipientWithoutAccess"})},B=function(a){var b=LC.getLabel("PublisherAutoComplete","allCannotReadNoEntitySingular"),b=b.replace("{0}",a),b=b.replace("{1}",
l.getSubject().entityType);chatter.getTextareaMessageUtil().showMessage({el:f.id,type:2,append:!0,msg_html:b,msg_id:"thanksRecipientWithoutAccess"})},I=function(a,c){var e=chatter.getFeed().config.feedType,e=["/feed/",b.state.subjectId,"/",e,"/checkaccess/",a].join("");chatter.getToolbox().get({url:e,success:function(e,d){!1===d[a]&&(b.state.usernoaccesstogrp=c,B(c))}})},C=function(){k()},D=function(){k()},E=function(){k()},F=function(){f.focus()},G=function(){b.state.isRyppleAuthorized&&(r(b.state.subjectId),
b.state.defaultUserRetrieved?""!=b.state.defaultUserName&&t(b.state.subjectId,b.state.defaultUserName):(b.state.subjectId=l.getSubjectId(),/^005/.test(b.state.subjectId)&&b.state.subjectId!=UserContext.userId&&chatter.getToolbox().get({url:"/userlookup",params:{subjectId:b.state.subjectId},success:function(a,c){if(0<c.name.length){var e=chatter.getToolbox().htmlEncode(c.name);t(b.state.subjectId,e);b.state.defaultUserRetrieved=!0;b.state.defaultUserName=e}}})))},v=function(a){Sfdc.Dom.addClass(g,
"hidden");Sfdc.Dom.addClass(m,"hidden");Sfdc.Dom.set(n,"innerHTML",a);Sfdc.Dom.removeClass(n,"hidden")},K=function(){if(null!==d){var a=d.value.trim();0===a.length||a===p?(Sfdc.Dom.removeClass(g,"hidden"),Sfdc.Dom.addClass(m,"hidden"),Sfdc.Dom.addClass(n,"hidden")):1===a.length?v(LC.getLabel("Rypple_Badge","searchTermsLongerThanOneCharacter")):chatter.getToolbox().get({url:"/workbadges",params:{terms:a},success:function(a,b){var h=b.html.trim();0<h.length?(Sfdc.Dom.addClass(g,"hidden"),Sfdc.Dom.set(m,
"innerHTML",h),Sfdc.Dom.removeClass(m,"hidden"),Sfdc.Dom.addClass(n,"hidden")):v(LC.getLabel("Rypple_Badge","searchNoBadgesFound"))},failure:function(a,b){v(LC.getLabel("Rypple_Badge","searchNoBadgesFound"))}})}},L=function(){var a=0;return function(b,e){clearTimeout(a);a=setTimeout(b,e)}}();return{config:{omnitureEvent:"postThanks",maxthanksRecipients:1,defaultTextAreaLines:7,maxBodyLength:978},state:{thanksRecipientid:"",ryppleDialog:null,badgesRetrieved:!1,defaultUserRetrieved:!1,defaultUserName:"",
isRyppleAuthorized:!1,ryppleReturnedError:!1,ryppleThanksSuccess:!1},setupPanel:function(){var a=Sfdc.get("thanksRecipientInputBox");if(null!==a){this.state.isRyppleAuthorized=null!=Sfdc.get("showingrypplethanks");q();var c=Sfdc.get("thanksRecipient");l=chatter.getPublisher();b=l.getHandler("RypplePost");b.config.maxBodyLength=l.DEFAULT_MAX_BODY_LENGTH-22;b.config.promptText=LC.getLabel("Rypple_Publisher","descriptionghosttextJS");f=l.getTextArea();Sfdc.on(c,"click",function(){a.focus()});this.config.thankedWidget=
new UserAndGroupAutoCompleteInputElement({elementId:"thanksRecipientInputBox",inDialog:!0,disableGhostText:!1,entityType:UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER,fixedACYPosition:0,ghostText:LC.getLabel("Rypple_Publisher","recipientghosttextJS"),handleSelect:function(a){t(a.itemId,a.itemName);this.complete()},getMinimumWidth:function(){q();return Sfdc.Dom.getWidth(thanksRecipientContainer)-2},getACXPosition:function(){q();return Sfdc.Dom.getElementXY(thanksRecipientContainer).x},getACYPosition:function(){return y()}});
this.config.thankedWidget.isValidSuggestion=function(a,b){return b.ItemId===UserContext.userId?!1:UserAndGroupAutoCompleteInputElement.prototype.isValidSuggestion.call(this,a,b)};Sfdc.on(a,"blur",function(){var c=Sfdc.get(".recipientName",a);b.config.thankedWidget.allowHideAC&&null==c&&(s(),x())});c=document.createElement("script");c.setAttribute("src","/soap/ajax/32.0/connection.js");document.head.appendChild(c);c=Sfdc.get("thanks_publisher_render_error");null!==c&&chatter.getTextareaMessageUtil().showMessage({el:f.id,
type:1,append:!0,msg_html:c.value,msg_id:"thanksPublisherRenderErrorMessage"})}},onShowPanel:function(){this.state.isRyppleAuthorized&&(u(),G(),x());J();Sfdc.Event.add(f,"keyup",C);Sfdc.Event.add(f,"paste",D);Sfdc.Event.add(f,"blur",E);var a=Sfdc.get("publisherTextArea");Sfdc.Event.add(a,"click",F);k()},focusFirstElement:function(){Sfdc.get("thanksRecipientInputBox").focus()},clearPanelState:function(){A();z();b.state.isRyppleAuthorized&&(r(b.state.thanksRecipientid),b.state.thanksRecipientid="",
b.state.usernoaccesstogrp="",G(),u(),publisherBadgeImageElement=Sfdc.get(".publisherBadge"),Sfdc.Dom.set(publisherBadgeImageElement,"src",b.state.badgeUrl),Sfdc.Dom.set(publisherBadgeImageElement,"alt",b.state.badgeName),Sfdc.Dom.set(publisherBadgeImageElement,"title",b.state.badgeDescription));b.config.ryppleReturnedError=!1;b.state.ryppleThanksSuccess=!1},getPayload:function(a){a.thanked=b.state.thanksRecipientid;a.thankyounote=this.publisherCore.getRawBody();a.smallurl=b.state.badgeUrl;a.fullurl=
b.state.badgeUrl;a.name=b.state.badgeName;a.externalid=b.state.badgeId;a.description=b.state.badgeDescription;return a},validatePayload:function(a){var c=chatter.getToolbox();null==a.thanked&&(a.thanked="");var c=!c.stringIsEmpty(a.thankyounote),e=a.thankyounote.length<=b.config.maxBodyLength,h=a.thankyounote!=b.config.promptText,d=0<a.thanked.length;a=void 0!==a.externalid&&null!==a.externalid;return{isValid:d&&e&&h&&c&&a,errorPayload:{thankyounote:c,thankyounotetoobig:e,thankyounoteghosttext:h,
thanked:d,badgeidempty:a}}},onValidationFailure:function(a){var c=LC.getLabel("Rypple_Publisher","ryppleThankedRequired"),e=LC.getLabel("Feeds","CommentMaxLengthErrorMsg",b.config.maxBodyLength+18),d=LC.getLabel("Rypple_Publisher","ryppleBadgeRequired");a.thanked?a.thankyounotetoobig?a.badgeidempty||this.publisherCore.showErrors(d):this.publisherCore.showErrors(e):this.publisherCore.showErrors(c);b.publisherCore.enablePublisher()},onSuccess:function(a,c){b.state.ryppleThanksSuccess=!0;b.publisherCore.switchToDefaultPublisherType();
u()},onFailure:function(a,c){if(c.errors){b.config.ryppleReturnedError=!0;k();var e=c.errors.message;chatter.getTextareaMessageUtil().showMessage({el:f.id,type:1,append:!0,msg_html:e?e:LC.getLabel("Rypple_Publisher","ryppleThanksFailed"),msg_id:"ryppleThanksFailed"})}b.publisherCore.enablePublisher()},removeEventsForPostType:function(){Sfdc.Event.remove(f,"keyup",C);Sfdc.Event.remove(f,"paste",D);Sfdc.Event.remove(f,"blur",E);var a=Sfdc.get("publisherTextArea");Sfdc.Event.remove(a,"click",F)},showRyppleDialog:function(){var a;
if(null!==b.state.ryppleDialog)a=b.state.ryppleDialog;else{a=new SimpleDialog("rypple",!0);b.state.ryppleDialog=a;a.displayX=!0;a.register();var c=Sfdc.get(".badgeSelectorDialogContents");a.importContentNode(c);Sfdc.Dom.removeClass(c,"hidden")}a.setTitle(LC.getLabel("Rypple_Badge","selectBadgeTitle"));a.setWidth("520px");a.setMinHeight("500px");c=Sfdc.get("ryppleContent");Sfdc.Dom.addClass(c,"ryppleBadgeContent");a.show();g=Sfdc.get(".allBadgesList");b.state.badgesRetrieved?Sfdc.Dom.set(g,"innerHTML",
b.state.badgeHTML):Sfdc.Dom.set(g,"innerHTML",LC.getLabel("Global","loading"));d=Sfdc.get(".badgeListSearchInputElement");p=LC.getLabel("Rypple_Badge","searchGhostText");m=Sfdc.get(".searchResultsBadgesList");n=Sfdc.get(".badgeSearchResultsMessage");Sfdc.on(d,"focus",function(){null!==d&&d.value===p&&(d.value="",Sfdc.Dom.removeClass(d,"ghostText"))});Sfdc.on(d,"blur",function(){null!==d&&""===d.value&&(d.value=p,Sfdc.Dom.addClass(d,"ghostText"))});Sfdc.on(d,"keyup",function(){L(K,200)})},displayBadgeList:function(){b.state.ryppleDialog.setTitle(LC.getLabel("Rypple_Badge",
"selectBadgeTitle"));var a=Sfdc.get(".ryppleBadgeList"),c=Sfdc.get(".ryppleBadgeDetail");Sfdc.Dom.addClass(c,"hidden");Sfdc.Dom.removeClass(a,"hidden")},displayBadgeDetail:function(a,c,e,d,f){b.state.ryppleDialog.setTitle(LC.getLabel("Rypple_Badge","infoBadgeTitle"));var g=Sfdc.get(".badgeTitle");w(g,decodeURIComponent(c));Sfdc.Dom.set(g,"data-id",a);a=Sfdc.get(".badgeSelectionDescription");w(a,decodeURIComponent(e));e=Sfdc.get(".badgeLargeImage");Sfdc.Dom.set(e,"src",d);d=Sfdc.get(".ryppleBadgeList");
Sfdc.Dom.addClass(d,"hidden");d=Sfdc.get(".ryppleBadgeDetail");Sfdc.Dom.removeClass(d,"hidden");Sfdc.get("ryppleContent").style.height="auto";d=Sfdc.get(".limitRemaining");e=Sfdc.get(".badgeLimitsSection");null===f?(Sfdc.Dom.set(d,"innerHTML",""),Sfdc.Dom.addClass(e,"hidden")):(Sfdc.Dom.set(d,"innerHTML",f),Sfdc.Dom.removeClass(e,"hidden"))},updateSelectedBadge:function(){var a=Sfdc.get(".badgeTitle"),c=Sfdc.get(".badgeSelectionDescription"),d=Sfdc.get(".badgeLargeImage");Sfdc.get(".badgeTitle");
var f=Sfdc.get(".badgeInfo");b.state.badgeUrl=Sfdc.Dom.get(d,"src");b.state.badgeName=Sfdc.Dom.get(a,"innerHTML");b.state.badgeId=Sfdc.Dom.get(a,"data-id");b.state.badgeDescription=Sfdc.Dom.get(c,"innerHTML");a=Sfdc.get(".publisherBadge");b.state.ryppleDialog.hide();Sfdc.Dom.set(a,"src",b.state.badgeUrl);Sfdc.Dom.set(a,"alt",b.state.badgeName);Sfdc.Dom.set(a,"title",b.state.badgeDescription);Sfdc.Dom.set(f,"data-badgename",b.state.badgeName)},getVisibilityMessages:function(a){var b=[];a.isPrivateGroup&&
b.push({title:LC.getLabel("WorkThanksInChatterVisibilityMessages","RecognitionVisibilityTitle"),text:LC.getLabel("WorkThanksInChatterVisibilityMessages","RecognitionAppearsOnWorkDotComProfile")});return b}}}());
chatter.getPublisher().registerFeedItemTypeHandler("TextPost",function(){return{config:{omnitureEvent:"post",lastPastedLink:null},setupPanel:function(){if(null!=Sfdc.get("publisherAttachLinkPost"))Sfdc.on(Ext.get("publishereditablearea").dom,"paste",function(a){var b=this;window.setTimeout(function(){var a=b.value;if(a&&-1===a.indexOf(" ")&&(0===a.indexOf("http://")||0===a.indexOf("https://")||0===a.indexOf("ftp://"))){var c=chatter.getPublisher().getHandler("TextPost");a!=c.config.lastPastedLink&&
(c.config.lastPastedLink=a,chatter.getPublisher().openTypeSpecificPanel(Sfdc.get("publisherAttachLinkPost"),"LinkPost"))}},100)})},onShowPanel:function(){this.publisherCore.setIsExtensionValidForSubmit(!0)},onFailure:function(a,b){chatter.getPublisher().getHandler("TextPost").publisherCore.enablePublisher();b.errors&&alert(b.errors.message)},focusFirstElement:function(){this.publisherCore.focusOnTextArea()},onSuccess:function(a,b){chatter.getPublisher().getHandler("TextPost").publisherCore.restoreDefaultUIState()},
getPayload:function(a){var b=this.publisherCore.getRawBody();a.text=b;return a},validatePayload:function(a){return{isValid:!(chatter.getToolbox().stringIsEmpty(a.text)||this.publisherCore.isPromptText(a.text))}},onValidationFailure:function(){this.publisherCore.resetPublisher();this.publisherCore.enablePublisher()}}}());
Sfdc.ns("Sfdc.CreateVFPublisherHandler");
Sfdc.CreateVFPublisherHandler=function(){function c(a){var b=chatter.getFeed();"undefined"!=typeof entityFeedPage?entityFeedPage.getApi().refresh(b.getConfig().subjectId,a):a.feed&&b.refresh({params:{subjectId:b.getConfig().subjectId},feedType:b.getConfig().feedType})}function e(a){Sfdc.resolve("Sfdc.EntityFeed.PublisherApi")&&Sfdc.EntityFeed.PublisherApi.selectAction(chatter.getFeed().getConfig().subjectId,a)}function f(a){Sfdc.resolve("Sfdc.EntityFeed.PublisherApi")&&Sfdc.EntityFeed.PublisherApi.setActionInputValues(chatter.getFeed().getConfig().subjectId,
a)}function g(a){Sfdc.resolve("Sfdc.EntityFeed.PublisherApi")&&Sfdc.EntityFeed.PublisherApi.invokeAction(chatter.getFeed().getConfig().subjectId,a)}function h(a){var b=d[a.actionName];b&&Sfdc.canvas.parent.publish({name:"publisher.customActionMessage",payload:a,target:{iframe:b.frameId}})}var d={};this.registerFeedItemTypeHandler=function(a,b,c){d[c]={frameId:b};chatter.getPublisher().registerFeedItemTypeHandler("VisualforcePage",function(){Sfdc.onload(function(){if("undefined"!=typeof entityFeedPage)entityFeedPage.getApi().onRefresh(b,
function(a){Sfdc.canvas.parent.publish({name:"publisher.refresh",payload:a,target:{iframe:b}})})});return{config:{},onFailure:function(){},onSuccess:function(){},getPayload:function(){},validatePayload:function(){},onValidationFailure:function(){},setupPanel:function(){Sfdc.canvas.parent.publish({name:"publisher.setupPanel",payload:{},target:{iframe:b}})},clearPanelState:function(){Sfdc.canvas.parent.publish({name:"publisher.clearPanelState",payload:{},target:{iframe:b}})},onShowPanel:function(){Sfdc.canvas.parent.publish({name:"publisher.showPanel",
payload:{},target:{iframe:b}})}}}(),{handlerId:a})};Sfdc.onload(function(){Sfdc.canvas.parent.subscribe({name:"publisher.refresh",onData:c});Sfdc.canvas.parent.subscribe({name:"publisher.selectAction",onData:e});Sfdc.canvas.parent.subscribe({name:"publisher.setActionInputValues",onData:f});Sfdc.canvas.parent.subscribe({name:"publisher.invokeAction",onData:g});Sfdc.canvas.parent.subscribe({name:"publisher.customActionMessage",onData:h})})};var createVFPublisherHandler=new Sfdc.CreateVFPublisherHandler;
function VisibilityWidget(c){function h(){Sfdc.Dom.hideByDisplay(g());Sfdc.Event.fireEvent(g(),"visibilitybox:oncollapse",g());k=!1;Sfdc.un(document.body,"click",n)}function n(a){(a=Sfdc.Event.getEventTarget(a))&&(Sfdc.Dom.getParent(a,".visibilityWidgetParent")||h())}function g(){if(!e){var a=Sfdc.Dom.getParent(c.icon,".visibilityWidgetParent"),a=Sfdc.Dom.create(a);Sfdc.Dom.addClass(a,[r,"zen-sideNorth","zen-arrowCenter","zen-callout"]);var b=Sfdc.Dom.create(a,{},"b");Sfdc.Dom.addClass(b,["zen-arrow",
"vis-arrow"]);b=Sfdc.Dom.create(a);Sfdc.Dom.addClass(b,"zen-inner");var d=Sfdc.Dom.create(b);Sfdc.Dom.addClass(d,[q,"zen-body"]);b=Sfdc.Dom.create(b);Sfdc.Dom.addClass(b,"visibilityFooter");b=Sfdc.Dom.create(b,{href:s},"a");Sfdc.Dom.addClass(b,"visibilitylearnmorelink");Sfdc.Dom.setText(b,LC.getLabel("ChatterVisibility","LearnMore"));Sfdc.on(b,"keydown",t);e=a;Sfdc.on(c.icon,"keydown",u);Sfdc.on(document.body,"click",n);Sfdc.isFunction(c.onexpand)&&Sfdc.Event.add(e,"visibilitybox:onexpand",c.onexpand);
Sfdc.isFunction(c.oncollapse)&&Sfdc.Event.add(e,"visibilitybox:oncollapse",c.oncollapse)}return e}function u(a){a=window.event||a;a.shiftKey&&9===a.keyCode&&h()}function t(a){a=window.event||a;a.shiftKey&&9==a.keyCode||9===a.keyCode&&h()}var l=this;l.disabled=!1;var r="visibilityHelpContainer",q="visibilityHelpBody",k=!1,e,p,m=[],s=c.helpUrl;this.hideVisibilityBox=function(){k&&h()};this.registerHandler=function(a){m[m.length]=a};this.toggleDisplay=function(){if(!k&&!l.disabled){var a=Sfdc.Dom.create(null,
{},"ul"),b;b=[];for(var d,c=0;c<m.length;c++)d=m[c],d=d(),Sfdc.isArray(d)&&(b=b.concat(d));for(c=0;c<b.length;c++){d=b[c];var f=Sfdc.Dom.create(a,{},"li");Sfdc.Dom.addClass(f,"visibilityMessage");if(d.HTML)Sfdc.Dom.addClass(f,"visibilityCustomHTMLMsg"),Sfdc.Dom.updateHTML(f,d.HTML);else{var e=Sfdc.Dom.create(f,{},"h3");Sfdc.Dom.insertHTML(e,d.title);Sfdc.Dom.addClass(e,"visibilityMessageTitle");f=Sfdc.Dom.create(f);Sfdc.Dom.addClass(f,"visibilityMsgAnchor");Sfdc.Dom.insertHTML(f,d.text)}}p||(p=Sfdc.get("."+
q,g()));b=p;Sfdc.Dom.updateHTML(b,"");b.appendChild(a);Sfdc.Event.fireEvent(g(),"visibilitybox:onexpand",g());Sfdc.Dom.show(g());k=!0;Sfdc.on(document.body,"click",n)}else h()};this.disableWidget=function(){l.disabled=!0;Sfdc.Dom.addClass(c.icon,"disable")};this.enableWidget=function(){l.disabled=!1;Sfdc.Dom.removeClass(c.icon,"disable")}};
function VideoPreview(g,h,m,d){var k=m.replace("{0}",window.location.protocol);this.getVideoLinkTitle=function(){return d};this.getVideoUrl=function(){return k};this.getContainerId=function(){return g};this.getVideoId=function(){return h};this.getInlinePlayerUrl=function(){return window.location.protocol+"//www.youtube.com/embed/"+h+"?version\x3d3\x26autoplay\x3d1\x26rel\x3d0\x26fs\x3d1\x26autohide\x3d1\x26wmode\x3dtransparent\x26enablejsapi\x3d0"}}
function YoutubeVideo(){function g(a){var b=a.getVideoUrl();Sfdc.Ajax.crossDomainRequest(b,function(c){if(c=Sfdc.JSON.parseSafe(c)){var b=a.getContainerId(),l=c.error;if(b=Ext.get(b)){if(!l&&(b&&c.data)&&c.data.thumbnail){var f,d;if(c.data.title&&(f=a.getVideoLinkTitle(),d=b.child(".linkPostLinkTitleText").dom.innerHTML,"www.youtube.com"===f||"youtu.be"===f))d=f=c.data.title;k[b.parent().id]=a.getInlinePlayerUrl();var l=m(c.data.duration),g=b.child(".linkPostLink").dom.href;b.dom.innerHTML=h(c.data.thumbnail.sqDefault.replace("http",
"https"),l,"www.youtube.com","chatter.getYoutubeVideo().expandInlinePlayer(this);",f,d,g)}b.setDisplayed("block")}}},{})}function h(a,b,c,e,d,f,g){return q.replace("{2}",b).replace("{3}",c).replace("{6}",f).replace("{7}",d).replace("{9}",g).replace("{5}",e).replace("{4}",e).replace("{8}",d).replace("{0}",a)}function m(a){if(a){var b=parseInt(a/60);a=parseInt(a%60);var c;1>b&&(b="00");10>a&&(a="0"+a);return 60<b?(c=parseInt(b/60),b=parseInt(b%60),LC.getLabel("Feeds","lengthLong",c,b,a)):LC.getLabel("Feeds",
"lengthShort",b,a)}return""}var d=[],k=[],n=!1,p=!0,q='\x3cdiv class\x3d"videoImages"\x3e\x3cimg src\x3d"{0}" alt\x3d"{8}" class\x3d"thumbnail" onclick\x3d"{4}" title\x3d""\x3e\x3cspan class\x3d"play" onclick\x3d"{5}"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"videoLinkMetaClass"\x3e\x3cdiv class\x3d"videoLinkPostTitle"\x3e\x3ca href\x3d"{9}" title\x3d"{7}" target\x3d"_blank"\x3e{6}\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"videoLinkDescription"\x3e{3}\x3c/div\x3e\x3cdiv class\x3d"videoLinkLengthClass"\x3e{2}\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e';
chatter.getEventBus().addEventListener("UIComponent:OverlayDialog","onBeforeOverlayShow",function(){Ext.select(".videoLinkPostOuterContainer \x3e iframe").remove();Ext.select(".videoLinkPostContainer").setDisplayed("block")});this.testInlinePlayer=function(a){a=Ext.get(a).parent().parent();var b=a.parent().id;a.setVisibilityMode(Ext.Element.DISPLAY);a.hide();Ext.DomHelper.append(b,{tag:"iframe",width:"420px",height:"300px",src:"",name:"youtubePlayer",frameborder:"0"})};this.setTestMode=function(a){n=
a};this.isRenderTypeVideoLinkPost=function(a){p=a};this.onPageLoaded=function(){Ext.EventManager.onDocumentReady(function(){chatter.getYoutubeVideo().fetchVideoPreviews()},null,null)};this.fetchVideoPreviews=function(){for(var a=d.length,b=0;b<a;b++){var c=d.shift();if(n){var e=c,c=Ext.get(e.getContainerId());if(p){k[c.parent().id]="";var l=m("10000"),e=e.getVideoLinkTitle(),f=c.child(".linkPostLinkTitleText").dom.innerHTML;if("www.youtube.com"===e||"youtu.be"===e)f=e="user did not enter url name";
c.dom.innerHTML=h(null,l,"www.youtube.com","chatter.getYoutubeVideo().testInlinePlayer(this);",e,f,"www.youtube.com")}}else g(c)}};this.appendToQueue=function(a){d.push(a)};this.expandInlinePlayer=function(a){a=Ext.get(a).parent().parent();var b=a.parent().id,c=k[b];a.setVisibilityMode(Ext.Element.DISPLAY);a.hide();Ext.DomHelper.append(b,{tag:"iframe",width:"420px",height:"300px",src:c,name:"youtubePlayer",frameborder:"0"})}}chatter.extend("YoutubeVideo",YoutubeVideo,null);
Sfdc.ns("Sfdc.SocialPostHandler");
Sfdc.SocialPostHandler=function(){this.registerFeedItemTypeHandler=function(c,l,p,q){chatter.getPublisher().registerFeedItemTypeHandler("SocialPostEvent",function(){function g(a){var e=Sfdc.get("editPage__"+c),b=e.parentNode;Sfdc.Dom.removeChild(e);Sfdc.Dom.insertHTML(b,a.htmlForm);(e=Sfdc.get("editPage__"+c))&&Sfdc.Resource.execScripts(Sfdc.Resource.getScriptsFromHtml(e));window.picklist&&(picklist.initialized=!1,picklist.initAll());SfdcCmp.init(Sfdc.get(".socialPubSenderContainer"))}var b={config:{omnitureEvent:"recordCreate",
urlMaxLen:1E3,urlNameMaxLen:255,disallowedLinkChars:/[\s\\]+/},state:{}};b.config.actionIdParam=c;b.config.formId=l;b.setupPanel=function(){Sfdc.onload(function(){window.picklist&&picklist.initAll()});var a=LC.getLabel("Publisher","Create");b.config.submitValueAndTitle={value:a,title:a}};b.clearPanelState=function(){};b.focusFirstElement=function(){var a=Sfdc.get("Content__"+c);if(Sfdc.Dom.isVisible(a,!0))a.focus(),"number"==typeof a.selectionStart?a.selectionStart=a.selectionEnd=a.value.length:"undefined"!=
typeof a.createTextRange&&(a.focus(),a=a.createTextRange(),a.collapse(!1),a.select());else return!0};b.onShowPanel=function(){this.publisherCore.setIsExtensionValidForSubmit(!0);SfdcApp.social.publisher.onShowPanel(c)};b.onSuccess=function(a,e){e.feedItemId&&"undefined"===typeof entityFeedPage&&chatter.getEventBus().fireEvent("chatter:publisher","onAfterUpdateStatus",{json:e});var b=chatter.getPublisher().getHandler(c);g(e);b.publisherCore.enablePublisher()};b.onFailure=function(a,b){var h=chatter.getPublisher().getHandler(c);
b.errors?h.publisherCore.showErrors(b.errors.message):b.htmlForm?g(b):a.isTimeout?h.publisherCore.showErrors(LC.getLabel("SocialPublisherSendingErrors","Timeout")):h.publisherCore.showErrors(LC.getLabel("SocialPublisherSendingErrors","UnknownException"));h.publisherCore.enablePublisher()};b.getPayload=function(a){a.actionIdParam=this.config.actionIdParam;for(var b=["input","select","textarea"],c=document.getElementById(l),m=0;m<b.length;m++)for(var f=c.getElementsByTagName(b[m]),d=0;d<f.length;d++)if("checkbox"!=
f[d].getAttribute("type")||f[d].checked)if("SELECT"==f[d].tagName){for(var g=[],n=f[d].options,k=0;k<n.length;k++)n[k].selected&&g.push(n[k].value);a[f[d].name]=g}else a[f[d].name]=f[d].value;a.save_new="Saving...";return a};b.postWithCustomFunction=function(a){a={url:"/quickcreate/social",params:a,failure:this.onFailure,success:this.onSuccess};"undefined"!==typeof entityFeedPage?entityFeedPage.postObjectUpdate(chatter.getFeed().getConfig().subjectId,a):chatter.getToolbox().post(a)};return b}(),{handlerId:c});
Sfdc.resolve("Sfdc.EntityFeed.QuickAction")&&Sfdc.EntityFeed.QuickAction.register({actionName:p,actionId:c,handlerId:c,formId:l,contextId:q})}};var socialPostHandler=new Sfdc.SocialPostHandler;
Sfdc.ns("Sfdc.AccessibleFileSharedWithListDialog");Sfdc.AccessibleFileSharedWithListDialog=function(a){Sfdc.BaseAccessibleFileListDialog.call(this,a);this.id=a.id;this.title=unescape(a.title);this.dataLoadUrl=a.dataLoadUrl;this.docId=a.docId;this.height=a.height;this.sharedWithEntityType=a[EntitySharingConstants.SHAREDWITH_PARAM];this.areSharingTypesUpdatable=!1;this.fileOwnerID="";this.ghostMsg=LC.getLabel("ChatterFileSharing","optionalMsgGhostText");this.fileTitle=a.fileTitle};
Ext.extend(Sfdc.AccessibleFileSharedWithListDialog,Sfdc.BaseAccessibleFileListDialog);Sfdc.AccessibleFileSharedWithListDialog.ID="chatterFileSharedWithListDialog";Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID="sharedWithInputBox";Sfdc.AccessibleFileSharedWithListDialog.MaxSharedLimit=100;Sfdc.AccessibleFileSharedWithListDialog.MaxVisibleRowNumber=3;Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_COUNT=9;Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_MSG_ID="maxSharedWithPeopleCntMsg";
Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_COLLABORATOR="C";Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_VIEWER="V";Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_INFERRED="I";Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_NOACCESS="N";Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX="0F9";Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX_MATCH="^0F9";Sfdc.AccessibleFileSharedWithListDialog.sharingRowCounter=0;
Sfdc.AccessibleFileSharedWithListDialog.MYENTITY_PREFIX_MATCH="0U0";Sfdc.AccessibleFileSharedWithListDialog.areSharingTypesUpdatable=!1;Sfdc.AccessibleFileSharedWithListDialog.chatterMessagesPerm=!1;Sfdc.AccessibleFileSharedWithListDialog.isPrivateFile=!1;Sfdc.AccessibleFileSharedWithListDialog.MAX_COMPANY_NAME_LENGTH=10;Sfdc.AccessibleFileSharedWithListDialog.ENTITY_TYPE_ORGANIZATION="c";Sfdc.AccessibleFileSharedWithListDialog.shareWithButtonLocked=!1;
Sfdc.AccessibleFileSharedWithListDialog.NOTIFICATION_EMAIL_PANEL_ID="notificationEmailPanelTextArea";Sfdc.AccessibleFileSharedWithListDialog.GROUP_STATUS_PUBLIC="public";Sfdc.AccessibleFileSharedWithListDialog.GROUP_STATUS_PRIVATE="private";Sfdc.AccessibleFileSharedWithListDialog.isFileDetailPage=function(){return 0<Sfdc.select("body.FileDetailPage").length};
Sfdc.AccessibleFileSharedWithListDialog.isChatterPageWithFeed=function(){return 0<Sfdc.select("body.homepage").length||0<Sfdc.select("body.ChatterPage").length&&0===Sfdc.select("div.chatterFileListView").length||0<Sfdc.select("body.UserProfilePage").length||0<Sfdc.select("body.GroupProfilePage").length};
Sfdc.AccessibleFileSharedWithListDialog.showDialog=function(a){Perf.mark(OverlayDialog.LOAD_MARK);var b=Sfdc.AccessibleFileSharedWithListDialog.ID,d=Sfdc.BaseAccessibleFileDialog.getDialogById(b);d?(d.dataLoadUrl=a.dataLoadUrl,d.docId=a.docId,d.setTitle(a.title),d.fileTitle=a.fileTitle,d.sharedWithEntityType=a[EntitySharingConstants.SHAREDWITH_PARAM]):(d={id:b,title:a.title,dataLoadUrl:a.dataLoadUrl,fileTitle:a.fileTitle,docId:a.docId,height:600},d[EntitySharingConstants.SHAREDWITH_PARAM]=a[EntitySharingConstants.SHAREDWITH_PARAM],
d=new Sfdc.AccessibleFileSharedWithListDialog(d),d.width=650,d.register());d.callback=a.callback;d.syncUpMainPage=!1;d.refreshMainPage=!1;b={};a[EntitySharingConstants.SHAREDWITH_PARAM]&&(b[EntitySharingConstants.SHAREDWITH_PARAM]=a[EntitySharingConstants.SHAREDWITH_PARAM]);a[EntitySharingConstants.SHARE_OPTION_PARAM_NAME]&&(b[EntitySharingConstants.SHARE_OPTION_PARAM_NAME]=a[EntitySharingConstants.SHARE_OPTION_PARAM_NAME]);d.open(b)};
Sfdc.AccessibleFileSharedWithListDialog.prototype.cancel=function(){Sfdc.AccessibleFileSharedWithListDialog.closeACList();Sfdc.AccessibleFileSharedWithListDialog.superclass.cancel.call(this)};
Sfdc.AccessibleFileSharedWithListDialog.showSharedWithList=function(a,b,d){a=Sfdc.AccessibleFileSharedWithListDialog.getFileTitle(a);var c=null!==a?LC.getLabel("ChatterFileSharing","sharingSettingWithFileTitle",a):LC.getLabel("ChatterFileSharing","sharingSetting");Sfdc.AccessibleFileSharedWithListDialog.closeACList();Sfdc.AccessibleFileSharedWithListDialog.showDialog({title:chatter.getToolbox().htmlEncode(c),docId:b,fileTitle:a,dataLoadUrl:d?d:"/file/sharedwithlist/"})};
Sfdc.AccessibleFileSharedWithListDialog.showSharedWithPeople=function(a,b,d,c,f,e){this.fileOwnerID=d;b=Sfdc.AccessibleFileSharedWithListDialog.getFileTitle(b);d=null!==b?LC.getLabel("ChatterFileSharing","shareWithPeopleWithFileTitle",b):LC.getLabel("ChatterFileSharing","shareWithPeople");e&&(d=LC.getLabel("ChatterFileSharing","shareInScope",d,e));Sfdc.AccessibleFileSharedWithListDialog.showSharedWithWizard(d,a,b,EntitySharingConstants.SHAREDWITH_PEOPLE,c,f)};
Sfdc.AccessibleFileSharedWithListDialog.showSharedWithGroups=function(a,b,d,c,f,e){this.fileOwnerID=d;b=Sfdc.AccessibleFileSharedWithListDialog.getFileTitle(b);d=null!==b?LC.getLabel("ChatterFileSharing","shareWithGroupsWithFileTitle",b):LC.getLabel("ChatterFileSharing","shareWithGroups");e&&(d=LC.getLabel("ChatterFileSharing","shareInScope",d,e));Sfdc.AccessibleFileSharedWithListDialog.showSharedWithWizard(d,a,b,EntitySharingConstants.SHAREDWITH_GROUPS,c,f)};
Sfdc.AccessibleFileSharedWithListDialog.showSharedWithCompany=function(a,b,d,c,f){this.fileOwnerID=d;b=Sfdc.AccessibleFileSharedWithListDialog.getFileTitle(b);d=null!==b?LC.getLabel("ChatterFileSharing","shareWithCompanyWithFileTitle",b):LC.getLabel("ChatterFileSharing","shareWithCompany");Sfdc.AccessibleFileSharedWithListDialog.showSharedWithWizard(d,a,b,EntitySharingConstants.SHAREDWITH_COMPANY,c,f)};Sfdc.AccessibleFileSharedWithListDialog.getFileTitle=function(a){return null};
Sfdc.AccessibleFileSharedWithListDialog.showSharedWithWizard=function(a,b,d,c,f,e){this.areSharingTypesUpdatable=Sfdc.AccessibleFileSharedWithListDialog.areSharingTypesUpdatable;a={title:chatter.getToolbox().htmlEncode(a),docId:b,fileTitle:d,dataLoadUrl:f?f:"/file/sharedwithwizard/",callback:Sfdc.AccessibleFileSharedWithListDialog.callBack};a[EntitySharingConstants.SHAREDWITH_PARAM]=c;e&&(a[EntitySharingConstants.SHARE_OPTION_PARAM_NAME]=e);Sfdc.AccessibleFileSharedWithListDialog.showDialog(a)};
Sfdc.AccessibleFileSharedWithListDialog.clearInputText=function(){var a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID);a.blur();Sfdc.Dom.set(a,"value","");a.focus()};Sfdc.AccessibleFileSharedWithListDialog.getOptionalMessageLength=function(a){return a&&a===EntitySharingConstants.SHAREDWITH_GROUPS?1E3:255};
Sfdc.AccessibleFileSharedWithListDialog.wireACBox=function(a,b){var d=a&&a===EntitySharingConstants.SHAREDWITH_GROUPS?UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP:UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER;new UserAndGroupAutoCompleteInputElement({servletURI:b,elementId:Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID,inDialog:!0,entityType:d,fixedACYPosition:0,zIndex:80200,handleSelect:function(a){var b=Sfdc.AccessibleFileSharedWithListDialog.hasEntityRow()?!1:!0;!Sfdc.AccessibleFileSharedWithListDialog.isNumberOfRowOverLimit()&&
!Sfdc.AccessibleFileSharedWithListDialog.isRowExist(a.itemId)&&Sfdc.AccessibleFileSharedWithListDialog.addEntityRow({itemID:a.itemId,itemName:a.itemName,itemTitle:a.itemTitle,itemPhoto:a.imageLink,entityType:d,badgeHtml:a.badgeHtml,imageHtml:a.imageHtml,itemPrivacy:a.itemPrivacy});this.select(a.rowIndex);this.complete();a=Sfdc.select(".overlayScrollList");0<a.length&&(a[0].scrollTop+=50);a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID);d===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?
(this.allowHideAC=!0,a.blur(),this.displayGhostText(),Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.NOTIFICATION_EMAIL_PANEL_ID).focus()):(this.allowHideAC=!0,b?(a.blur(),this.displayGhostText(),(b=Sfdc.select(".sharingOptionRadio"))&&0<b.length&&b[b.length-1].focus()):UserAndGroupAutoCompleteInputElement.needDefer()?Sfdc.AccessibleFileSharedWithListDialog.clearInputText.defer(100):Sfdc.AccessibleFileSharedWithListDialog.clearInputText())},handleBlur:function(){this.clearSuggestions();this.displayGhostText()},
handleFocusExtra:function(){if(Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem().rows.length>=Sfdc.AccessibleFileSharedWithListDialog.MaxVisibleRowNumber){var a=Sfdc.select(".overlayScrollList");0<a.length&&(a[0].scrollTop=a[0].scrollHeight)}},getACYPosition:function(a){if(Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem().rows.length<=Sfdc.AccessibleFileSharedWithListDialog.MaxVisibleRowNumber-1)this.fixedACYPosition=AutoCompleteInputElement.prototype.getACYPosition(a);
else{var b=Sfdc.select(".overlayScrollList"),d=0;0<b.length&&(d=b[0].scrollHeight-b[0].offsetHeight+3);this.fixedACYPosition=AutoCompleteInputElement.prototype.getACYPosition(a)-d}return this.fixedACYPosition}});Sfdc.get("shareHelpLinkElement").focus();addEvent(document.body,"keydown",function(a){getEvent(a).keyCode==KEY_ESC&&Sfdc.AccessibleFileSharedWithListDialog.closeACList()})};
Sfdc.AccessibleFileSharedWithListDialog.callBack=function(a,b){Sfdc.AccessibleFileSharedWithListDialog.areSharingTypesUpdatable="true"===b.areSharingTypesUpdatable?!0:!1;Sfdc.AccessibleFileSharedWithListDialog.chatterMessagesPerm="true"===b.chatterMessagesPerm?!0:!1;Sfdc.AccessibleFileSharedWithListDialog.isPrivateFile="true"===b.isPrivateFile?!0:!1;Sfdc.AccessibleFileSharedWithListDialog.CurrentEntities={};var d=b.sharedWithType===EntitySharingConstants.SHAREDWITH_COMPANY;if(d){var c=b.orgId;if(!c){alert(LC.getLabel("Feeds",
"GenericFailureNoGack"));return}Sfdc.Dom.addClass(Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID),"hidden");Sfdc.AccessibleFileSharedWithListDialog.areSharingTypesUpdatable?LC.getLabel("ChatterFileSharing","collaborator"):LC.getLabel("ChatterFileSharing","viewer");Sfdc.AccessibleFileSharedWithListDialog.addEntityRow({itemID:c,itemName:LC.getLabel("ChatterFileSharing","shareWithCompanyLabel"),itemTitle:"",itemPhoto:"/img/chatterfiles/sharewithcompany32x32.png",entityType:Sfdc.AccessibleFileSharedWithListDialog.ENTITY_TYPE_ORGANIZATION,
badgeHtml:""});var c=Sfdc.get("selectedPeopleToShareList"),f=Sfdc.get(".overlayListLink",c);Sfdc.Dom.hideByDisplay(f);Sfdc.AccessibleFileSharedWithListDialog.areSharingTypesUpdatable?(c.child(".shortSharedWithName").dom.setAttribute("title",""),c.child(".shortSharedWithName").removeClass("shortSharedWithName"),c.child(".displayNameWidthWithViewCollaborator").removeClass("displayNameWidthWithViewCollaborator")):(c.child(".longSharedWithName").dom.setAttribute("title",""),c.child(".longSharedWithName").removeClass("longSharedWithName"));
Sfdc.Dom.setText(Sfdc.get("sendEmailOptionLabel"),LC.getLabel("ChatterFileSharing","shareWithCompanyMessageLabel"));c.addClass("noBottomBorder")}else c="/myentity/"==a.substr(0,10)?"/chatter/handlers/myentity/shareAutoComplete":"/chatter/handlers/file/shareAutoComplete",Sfdc.AccessibleFileSharedWithListDialog.wireACBox(this.sharedWithEntityType,c);var e=Ext.fly(this.id).child(".optionalMsg"),g=this;if(e){var h=chatter.getToolbox(),k=Sfdc.AccessibleFileSharedWithListDialog.getOptionalMessageLength(this.sharedWithEntityType),
l=h.getElementErrorContainer(e);h.updateHTML(l,"");var m=LC.getLabel("Publisher","postValueMaxLen",k);e.on("focus",function(){e.dom.value==g.ghostMsg&&(e.dom.value="",e.removeClass("optionalMsgGhostText"))});e.on("blur",function(){""===e.dom.value&&(e.addClass("optionalMsgGhostText"),e.dom.value=g.ghostMsg)});e.on("keyup",function(){var a=h.stringTrim(e.getValue()).length,b=h.validateElement(l,function(){return a<=k},m)&&Sfdc.AccessibleFileSharedWithListDialog.hasEntityRow();Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(b)})}if(d){e.setVisibilityMode(Ext.Element.DISPLAY).hide();
var n=Sfdc.get(".sendEmailOption",Sfdc.get(this.id));Sfdc.Dom.removeClass(n,"hidden");if(n)Sfdc.on(n,"click",function(){e&&(n.checked?e.setVisibilityMode(Ext.Element.DISPLAY).show():e.setVisibilityMode(Ext.Element.DISPLAY).hide())})}};
Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton=function(a,b){if("undefined"==typeof b){if(!0===Sfdc.AccessibleFileSharedWithListDialog.shareWithButtonLocked)return}else Sfdc.AccessibleFileSharedWithListDialog.shareWithButtonLocked=b;var d=Sfdc.get("fileSharedWithBtn"),c=chatter.getToolbox();a?c.enableButton(d):c.disableButton(d)};
Sfdc.AccessibleFileSharedWithListDialog.closeDialog=function(){var a=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID);a&&a.closeDialog()};Sfdc.AccessibleFileSharedWithListDialog.nextPage=function(a,b,d){(a=sfdcPage.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID))&&a.loadList({p:d+1})};Sfdc.AccessibleFileSharedWithListDialog.prevPage=function(a,b,d){(a=sfdcPage.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID))&&a.loadList({p:d-1})};
Sfdc.AccessibleFileSharedWithListDialog.getEntityTypeForId=function(a){return a.substr(0,Sfdc.AccessibleFileSharedWithListDialog.MYENTITY_PREFIX_MATCH.length)==Sfdc.AccessibleFileSharedWithListDialog.MYENTITY_PREFIX_MATCH?"myentity":"file"};
Sfdc.AccessibleFileSharedWithListDialog.shareWithEntity=function(a,b,d){var c=LC.getLabel("ChatterFileSharing","sharingSetting",a);a=chatter.getToolbox();Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(!1,!0);var f="/"+Sfdc.AccessibleFileSharedWithListDialog.getEntityTypeForId(b)+"/sharedwithwizard/"+b+";create",e=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID),g=Sfdc.get(".optionalMsg",Sfdc.get(e.id));g&&a.stringTrim(g.value)==e.ghostMsg&&(g.value=
"");g={};d&&(g[EntitySharingConstants.SHAREDWITH_PARAM]=d);a.post({url:f,params:g,form:"shareWithEntityForm",failure:function(a,b){Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(!1,!1);b&&!b.errormessage&&alert(LC.getLabel("Feeds","GenericFailureNoGack"))},success:function(a,d){Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(!1,!1);try{e&&(e.setTitle(c),e.updateContent(d)),e.syncUpMainPage=!0,Sfdc.AccessibleFileSharedWithListDialog.updateTitle(b,d.isPrivate)}catch(f){}}})};
Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem=function(){return Sfdc.select(".overlayListTable")[0]};Sfdc.AccessibleFileSharedWithListDialog.isNumberOfRowOverLimit=function(){return Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem()).rows.length>=Sfdc.AccessibleFileSharedWithListDialog.MaxSharedLimit?!0:!1};Sfdc.AccessibleFileSharedWithListDialog.isRowExist=function(a){return Sfdc.AccessibleFileSharedWithListDialog.CurrentEntities[a]?!0:!1};
Sfdc.AccessibleFileSharedWithListDialog.deleteEntityRow=function(a,b,d){var c=Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem().rows.length;Sfdc.Dom.removeChild(Sfdc.Dom.getParent(a,"tr"));delete Sfdc.AccessibleFileSharedWithListDialog.CurrentEntities[b];Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(Sfdc.AccessibleFileSharedWithListDialog.hasEntityRow());c===Sfdc.AccessibleFileSharedWithListDialog.MaxVisibleRowNumber&&Sfdc.Dom.removeClass(Sfdc.get(Sfdc.select(".overlayList")[0]),
"overlayScrollList");Sfdc.AccessibleFileSharedWithListDialog.showHideExternalUserLabel();d===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP&&Sfdc.AccessibleFileSharedWithListDialog.showHidePublicGroupWarningLabel();Sfdc.AccessibleFileSharedWithListDialog.chatterMessagesPerm&&d===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER&&c==Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_COUNT&&Sfdc.AccessibleFileSharedWithListDialog.toggleMaxPeopleCountWarningMsg(!1)};
Sfdc.AccessibleFileSharedWithListDialog.hasEntityRow=function(){return 0<Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem()).rows.length};
Sfdc.AccessibleFileSharedWithListDialog.addEntityRow=function(a){var b=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem()),d=b.rows.length,c=b.insertRow(d),f="";0<d&&(f=" notFirstRow");var e=a.itemTitle,g=a.itemName,h=a.entityType,k=document.createElement("td");k.className="overlayListPhoto"+f;k.setAttribute("valign","top");k.innerHTML=a.imageHtml?a.imageHtml:'\x3cimg width\x3d"32" height\x3d"32" title\x3d"'+g+" - "+e+'" class\x3d"followerIcon" alt\x3d"'+g+" - "+e+'" src\x3d"'+
a.itemPhoto+'"\x3e';var l=[];l.push('\x3cspan title\x3d"'+g+'" class\x3d"'+(!0===this.areSharingTypesUpdatable?"shortSharedWithName":"longSharedWithName")+'"\x3e');l.push(g);this.areSharingTypesUpdatable||l.push('\x3cinput type\x3d"hidden" name\x3d"'+EntitySharingConstants.ENTITY_ID+'" value\x3d"'+a.itemID+'"/\x3e');l.push("\x3c/span\x3e");l.push(a.badgeHtml);l.push("\x3cbr\x3e");l.push('\x3cspan title\x3d"'+e+'" class\x3d"titleSpan"\x3e'+e+"\x3c/span\x3e");g=l.join("");e=document.createElement("td");
e.className="overlayListName"+f;!0===this.areSharingTypesUpdatable&&(e.className+=" displayNameWidthWithViewCollaborator");h===Sfdc.AccessibleFileSharedWithListDialog.ENTITY_TYPE_ORGANIZATION&&(e.className+=" displayNameWidthWithCompanyShare");e.setAttribute("valign","top");e.innerHTML=g;g=document.createElement("td");g.className="overlayListLink"+f;l=h===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?LC.getLabel("ChatterFileSharing","removeGroup"):LC.getLabel("ChatterFileSharing","removePerson");
g.innerHTML='\x3ca href\x3d"javascript:void(0);" onclick\x3d"Sfdc.AccessibleFileSharedWithListDialog.deleteEntityRow(this,\x26quot;'+a.itemID+"\x26quot;,\x26quot;"+h+'\x26quot);" title\x3d"'+l+'"\x3e\x3cimg alt\x3d"'+l+'" title\x3d"'+l+'" class\x3d"deleteIconClass" src\x3d"/s.gif"\x3e\x3c/a\x3e';c.appendChild(k);c.appendChild(e);c.appendChild(g);!0===this.areSharingTypesUpdatable&&(!0===(a.itemID===this.fileOwnerID?!0:!1)?(k=document.createElement("td"),k.className="overlayListOwner"+f,f=document.createElement("span"),
f.className="overlayOwnerSpan",e=document.createTextNode(LC.getLabel("ChatterFileSharing","alreadyOwner")),f.appendChild(e),e=document.createElement("input"),e.type="hidden",e.name=EntitySharingConstants.SHARING_TYPE+Sfdc.AccessibleFileSharedWithListDialog.sharingRowCounter,e.value=a.itemID+":"+Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_INFERRED,k.appendChild(f),k.appendChild(e),c.appendChild(k),k.setAttribute("colSpan","2")):(k=EntitySharingConstants.SHARING_TYPE+Sfdc.AccessibleFileSharedWithListDialog.sharingRowCounter,
e=document.createElement("td"),e.className="overlayListViewer"+f,g=document.createElement("td"),g.className="overlayListCollaborator"+f,Sfdc.userAgent.isIE8||Sfdc.userAgent.isIE7?(f=document.createElement('\x3cinput type\x3d"radio" name\x3d"'+k+'"\x3e'),l=document.createElement('\x3cinput type\x3d"radio" name\x3d"'+k+'"\x3e')):(f=document.createElement("input"),f.type="radio",f.name=k,l=document.createElement("input"),l.type="radio",l.name=k),f.className="sharingOptionRadio",f.value=a.itemID+":"+
Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_VIEWER,e.appendChild(f),l.className="sharingOptionRadio",l.value=a.itemID+":"+Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_COLLABORATOR,g.appendChild(l),c.appendChild(e),c.appendChild(g),h===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP?a.itemPrivacy&&a.itemPrivacy===Sfdc.AccessibleFileSharedWithListDialog.GROUP_STATUS_PRIVATE?l.checked=!0:f.checked=!0:h===Sfdc.AccessibleFileSharedWithListDialog.ENTITY_TYPE_ORGANIZATION?f.checked=
!0:l.checked=!0));Sfdc.AccessibleFileSharedWithListDialog.CurrentEntities[a.itemID]=a;Sfdc.get("selectedPeopleToShareList").scrollTop+=50;Sfdc.AccessibleFileSharedWithListDialog.toggleShareWithButton(!0);d===Sfdc.AccessibleFileSharedWithListDialog.MaxVisibleRowNumber-1&&Sfdc.Dom.addClass(Sfdc.get(Sfdc.select(".overlayList")[0]),"overlayScrollList");Sfdc.AccessibleFileSharedWithListDialog.sharingRowCounter++;Sfdc.AccessibleFileSharedWithListDialog.showHideExternalUserLabel();h===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_GROUP&&
!0===Sfdc.AccessibleFileSharedWithListDialog.isPrivateFile&&Sfdc.AccessibleFileSharedWithListDialog.showHidePublicGroupWarningLabel();Sfdc.AccessibleFileSharedWithListDialog.chatterMessagesPerm&&h===UserAndGroupAutoCompleteInputElement.ENTITY_TYPE_USER&&(d=b.rows.length,d==Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_COUNT&&Sfdc.AccessibleFileSharedWithListDialog.toggleMaxPeopleCountWarningMsg(!0))};
Sfdc.AccessibleFileSharedWithListDialog.toggleMaxPeopleCountWarningMsg=function(a){var b=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_MSG_ID);b||(b=document.createElement("div"),b.id=Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_MSG_ID,b.className="maxSharedWithPeopleCntMsg",b.innerHTML=LC.getLabel("ChatterFileSharing","maxSharedWithPeopleCntMsg"),Sfdc.get("selectedPeopleToShareList").parentNode.appendChild(b),b=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.MAX_SHAREDWITH_PEOPLE_MSG_ID));
a?(Sfdc.Dom.addClass(Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID),"hidden"),Sfdc.Dom.removeClass(b,"hidden")):(Sfdc.Dom.removeClass(Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID),"hidden"),Sfdc.Dom.addClass(b,"hidden"))};
Sfdc.AccessibleFileSharedWithListDialog.showHideExternalUserLabel=function(){for(var a=!1,b=Sfdc.select("span[class\x3dchatterUserGuestBadge]",Sfdc.get("selectedPeopleToShareList")),d=0;d<b.length;d++)if(b[d].innerHTML){var c=b[d].innerHTML;if(0<=c.indexOf(LC.getLabel("ChatterExternal","withGuests"))||0<=c.indexOf(LC.getLabel("ChatterExternal","privateWithGuests"))){a=!0;break}}a?Sfdc.Dom.removeClass(Sfdc.get("shareWithPeopleListHeader"),"hidden"):Sfdc.Dom.addClass(Sfdc.get("shareWithPeopleListHeader"),
"hidden")};Sfdc.AccessibleFileSharedWithListDialog.showHidePublicGroupWarningLabel=function(){var a=!1,b=Sfdc.get("selectedPeopleToShareList"),d=Sfdc.select("img.chatter-photo",b),b=Sfdc.select(".chatter-privateIcon",b);d.length>b.length&&(a=!0);a?(Sfdc.Dom.addClass(Sfdc.get("defaultWallPostLabel"),"hidden"),Sfdc.Dom.removeClass(Sfdc.get("publicWallPostLabel"),"hidden")):(Sfdc.Dom.removeClass(Sfdc.get("defaultWallPostLabel"),"hidden"),Sfdc.Dom.addClass(Sfdc.get("publicWallPostLabel"),"hidden"))};
Sfdc.AccessibleFileSharedWithListDialog.prototype.show=function(){Sfdc.BaseAccessibleFileDialog.prototype.show.call(this);this.dialog.style.top=getScrollTop()+this.dialog.offsetTop+"px";Sfdc.userAgent.isChrome&&window.scrollBy(0,1)};
Sfdc.AccessibleFileSharedWithListDialog.closeNoGroupMembershipOverlay=function(a,b,d){var c=location.href;0<c.indexOf("\x26so\x3dgrp")||0<c.indexOf("?so\x3dgrp")?Sfdc.BaseAccessibleFileListDialog.closeDialog("chatterFileSharedWithListDialog"):(Sfdc.BaseAccessibleFileListDialog.closeDialog("chatterFileSharedWithListDialog"),Sfdc.AccessibleFileSharedWithListDialog.showSharedWithList(a,b,d))};
Sfdc.AccessibleFileSharedWithListDialog.prototype.hook_cancel=function(){var a=Sfdc.BaseAccessibleFileDialog.getDialogById(this.id);if(a&&(!0===a.refreshMainPage||!0===a.syncUpMainPage)){var b=Sfdc.AccessibleFileSharedWithListDialog.isFileDetailPage(),d=Sfdc.AccessibleFileSharedWithListDialog.isChatterPageWithFeed();if(!0===a.refreshMainPage||!0===b||!0===d){var a=location.href,c;if(0<(b=a.indexOf("?fa\x3d"))||0<(b=a.indexOf("?so\x3d")))a=0<(c=a.indexOf("\x26",b+4))?0<a.indexOf("?fa\x3d")?a.substr(0,
b+1)+a.substr(c+1):a.substr(0,b)+a.substr(c):a.substr(0,b);navigateToUrl(a)}else Sfdc.ChatterFileFeedActions.resetDocUpload(a.docId)}};Sfdc.AccessibleFileSharedWithListDialog.PERM_DROPDOWN_ID="permissionDropdown";Sfdc.FileSharedWithPermissionDropdown=function(a,b){Sfdc.DropdownPanel.call(this,a,b)};Ext.extend(Sfdc.FileSharedWithPermissionDropdown,Sfdc.DropdownPanel);
Sfdc.FileSharedWithPermissionDropdown.prototype.initCustomEvents=function(){var a=this;addEvent(document.getElementById("sharedWithListScrollPanel"),"scroll",function(){a.close()})};Sfdc.FileSharedWithPermissionDropdown.prototype.getXY=function(a){var b=document.getElementById("sharedWithListScrollPanel"),d=0,c=0;Sfdc.userAgent.isIE8?(d=9,c=-1):Sfdc.userAgent.isIE7&&(d=10,c=0);return{x:a.x-14+c,y:a.y-b.scrollTop+d}};
Sfdc.FileSharedWithPermissionDropdown.prototype.getContent=function(a){var b=a.docId,d=a.sharedWithId,c=a.sharedFileOwnerId,f=a.isAdmin,e=a.shareId,g=a.isChatterFile,h=a.fileTitle,k=a.sharedWithName,l=a.isSharedWithPublicGroup;a=a.useStopLinkShareLabel;var m=[];m.push('\x3cdiv class\x3d"permissionLabelPanel"\x3e\x3ca onclick\x3d"Sfdc.AccessibleFileSharedWithListDialog.closePermissionDropdown(); return false;" href\x3d"javascript:void(0);"\x3e'+this.anchorElem.innerHTML+"\x3c/a\x3e\x3c/div\x3e");var n=
Sfdc.get("sharingOptionJSONStr"+d),p,s=[];if(n)for(var q=Sfdc.JSON.parse(n.innerHTML),n=q[EntitySharingConstants.SHARING_CURRENT_TYPE],r=0;r<q.sharingOption.length;r++){var k=q.sharingOption[r],t=k.sharingType,u=k.label;t[0]===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_NOACCESS?(k=LC.getLabel("ChatterFileSharing","inYourCompanyLabel"),p='\x3cdiv class\x3d"permissionActionLinkPanel"\x3e\x3ca onclick\x3d"Sfdc.MakeFilePrivateConfirmDialog.showDialog({isChatterFile:\x26quot;'+g+"\x26quot;, docId:\x26quot;"+
b+"\x26quot;, fileTitle:\x26quot;"+escape(h)+"\x26quot;, sharedWithId:\x26quot;"+d+"\x26quot;, sharedWithName:\x26quot;"+k+"\x26quot;, shareId:\x26quot;"+e+"\x26quot;, isSharedWithPublicGroup:"+l+", useStopLinkShareLabel:"+a+'}); return false;" class\x3d"permissionActionLink"\x3e\x3cspan class\x3d"permissionLabel"\x3e'+u+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e"):s.push('\x3cdiv class\x3d"permissionActionLinkPanel"\x3e\x3ca onclick\x3d"Sfdc.AccessibleFileSharedWithListDialog.changeSharingType(\x26quot;'+
b+"\x26quot;, \x26quot;"+d+"\x26quot;, \x26quot;"+c+"\x26quot;, \x26quot;"+n+"\x26quot;, \x26quot;"+t+"\x26quot;, \x26quot;"+k.label+"\x26quot;, "+f+", \x26quot;"+e+'\x26quot;); return false;" class\x3d"permissionActionLink"\x3e\x3cspan class\x3d"permissionLabel"\x3e'+u+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e")}p&&m.push(p);m=m.concat(s);if(Sfdc.userAgent.isIE7||Sfdc.userAgent.isIE8)m.push('\x3cdiv class\x3d"usid-roundedCornerDropdown usid-trDropdown"\x3e\x3c/div\x3e'),2==q.sharingOption.length?m.push('\x3cdiv class\x3d"usid-topSpacer usid-topSpacerThreeRows"\x3e'):
m.push('\x3cdiv class\x3d"usid-topSpacer"\x3e'),m.push('\x3cimg src\x3d"/s.gif" height\x3d"8"/\x3e\x3c/div\x3e'),m.push('\x3cdiv class\x3d"usid-roundedCornerDropdown usid-tlDropdown"\x3e\x3c/div\x3e'),m.push('\x3cdiv class\x3d"usid-roundedCornerDropdown usid-brDropdown"\x3e\x3c/div\x3e'),2==q.sharingOption.length?m.push('\x3cdiv class\x3d"usid-bottomSpacer usid-bottomSpacerThreeRows"\x3e'):m.push('\x3cdiv class\x3d"usid-bottomSpacer"\x3e'),m.push('\x3cimg src\x3d"/s.gif" height\x3d"8"/\x3e\x3c/div\x3e'),
m.push('\x3cdiv class\x3d"usid-roundedCornerDropdown usid-blDropdown"\x3e\x3c/div\x3e');return m.join("")};Sfdc.AccessibleFileSharedWithListDialog.getPermissionDropdown=function(){var a=Sfdc.DropdownPanel.getPanel(Sfdc.AccessibleFileSharedWithListDialog.PERM_DROPDOWN_ID);a||(a=new Sfdc.FileSharedWithPermissionDropdown(Sfdc.AccessibleFileSharedWithListDialog.PERM_DROPDOWN_ID,"sharedWithPermissionDropdown"));return a};
Sfdc.AccessibleFileSharedWithListDialog.showPermissionDropdown=function(a,b,d,c,f,e,g,h,k,l,m,n){var p=Sfdc.AccessibleFileSharedWithListDialog.getPermissionDropdown();p&&(b={docId:b,sharedWithId:d,sharingOptionJSONStr:c,sharedFileOwnerId:f,isAdmin:e,shareId:g,x:getObjX(a),y:getObjY(a),isChatterFile:h,fileTitle:k,sharedWithName:l,isSharedWithPublicGroup:m,useStopLinkShareLabel:n},p.show(a,b))};
Sfdc.AccessibleFileSharedWithListDialog.closePermissionDropdown=function(){var a=Sfdc.AccessibleFileSharedWithListDialog.getPermissionDropdown();a&&a.close()};Sfdc.AccessibleFileSharedWithListDialog.closeACList=function(){var a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.INPUTBOX_ID+TagAutoComplete.BOX_ID);a&&Sfdc.Dom.hideByDisplay(a)};
Sfdc.AccessibleFileSharedWithListDialog.changeSharingType=function(a,b,d,c,f,e,g,h){Sfdc.AccessibleFileSharedWithListDialog.closePermissionDropdown();a={docId:a,sharedWithId:b,currentType:c,type:f,label:e,syncUpMainPage:!1,shareId:h};e=UserContext.userId;e===d||g||c===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_VIEWER&&f===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_COLLABORATOR?Sfdc.AccessibleFileSharedWithListDialog.postSharingTypeChange(a):(e===b||b.match(Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX_MATCH)==
Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX)&&c===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_COLLABORATOR&&f===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_VIEWER?(a.syncUpMainPage=!0,Sfdc.ChangeSharingTypeConfirmDialog.showDialog(a)):Sfdc.AccessibleFileSharedWithListDialog.postSharingTypeChange(a)};
Sfdc.AccessibleFileSharedWithListDialog.postSharingTypeChange=function(a,b){var d=a.docId,c=a.sharedWithId,f=a.currentType,e=a.type,g=chatter.getToolbox(),d="/"+Sfdc.AccessibleFileSharedWithListDialog.getEntityTypeForId(d)+"/sharedwithwizard/"+d+";edit",h=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID);f===Sfdc.AccessibleFileSharedWithListDialog.SHARING_TYPE_NOACCESS&&h&&(h.syncUpMainPage=!0);g.post({url:d,params:{st:e,reload:!0,eid:c,shareId:a.shareId},failure:function(a,
c){c&&!c.errormessage&&alert(LC.getLabel("Feeds","GenericFailureNoGack"));b&&b()},success:function(a,c){var d=!1;h&&h.updateContent(c);var d=!0,e=null;Sfdc.ChangeSharingTypeConfirmDialog.dialogExists()&&(e=OverlayDialogElement.getDialog(Sfdc.ChangeSharingTypeConfirmDialog.ID));d&&e&&(!0===e.syncUpMainPage&&h)&&(h.syncUpMainPage=!0);b&&b()}})};
Sfdc.AccessibleFileSharedWithListDialog.updateTitle=function(a,b){a=ApiUtils.to18CharId(a);var d=Sfdc.get(a+"_title");if(d){var d=Sfdc.get(".fileTypeIcon",Sfdc.Dom.getParent(d,"div")),c=Sfdc.get(".filePrivateIcon",d);b?c||(c=Sfdc.Dom.create(document,!1,"img"),c.className="filePrivateIcon",c.src="/s.gif",d.appendChild(c)):c&&Sfdc.Dom.removeChild(c)}};Sfdc.ns("Sfdc.FileCollaborationConfirmDialog");
Sfdc.FileCollaborationConfirmDialog=function(a){this.id=a.id;this.docId=a.docId;this.windowName=a.id;this.setupDefaultButtons();this.addEvents();this.buttonContents=this.contents="";this.hasButtonsBar=!0};Ext.extend(Sfdc.FileCollaborationConfirmDialog,OverlayDialogElement);Sfdc.FileCollaborationConfirmDialog.prototype.makeContent=function(a){};
Sfdc.FileCollaborationConfirmDialog.prototype.showDialog=function(a){this.makeContent(a);this.isModal=!1;this.createContent();this.setWidth(540);this.show();a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.ID);Sfdc.Dom.hideByDisplay(a)};Sfdc.FileCollaborationConfirmDialog.prototype.cancel=function(){this.hide();var a=Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.ID);Sfdc.Dom.show(a)};Sfdc.ns("Sfdc.MakeFilePrivateConfirmDialog");
Sfdc.MakeFilePrivateConfirmDialog=function(a){Sfdc.FileCollaborationConfirmDialog.call(this,a);this.isChatterFile=a.isChatterFile};Ext.extend(Sfdc.MakeFilePrivateConfirmDialog,Sfdc.FileCollaborationConfirmDialog);Sfdc.MakeFilePrivateConfirmDialog.ID="makePrivateConfirmDialog";
Sfdc.MakeFilePrivateConfirmDialog.showDialog=function(a){Sfdc.AccessibleFileSharedWithListDialog.closePermissionDropdown();var b=null;document.getElementById(Sfdc.MakeFilePrivateConfirmDialog.ID)?b=OverlayDialogElement.getDialog(Sfdc.MakeFilePrivateConfirmDialog.ID):(a.id=Sfdc.MakeFilePrivateConfirmDialog.ID,b=new Sfdc.MakeFilePrivateConfirmDialog(a),b.register());b.showDialog(a)};
Sfdc.MakeFilePrivateConfirmDialog.prototype.makeContent=function(a){var b,d;a.sharedWithId?(b=LC.getLabel("ChatterFileSharing","stopSharing"),d=a.useStopLinkShareLabel?LC.getLabel("ChatterFileSharing","stopSharingViaLinkMsg","\x3cb\x3e"+escapeHTML(a.fileTitle)+"\x3c/b\x3e"):"00D"===a.sharedWithId.substr(0,3)?'\x3cdiv class\x3d"stopSharingWithCompany"\x3e'+LC.getLabel("ChatterFileSharing","stopSharingMsg",escapeHTML(unescape(a.fileTitle)),LC.getLabel("ChatterFileSharing","yourCompanyLabel"))+'\x3c/div\x3e\x3cdiv class\x3d"stopSharingWithCompanyDescription"\x3e'+
LC.getLabel("ChatterFileSharing","stopSharingWithCompany")+"\x3c/div\x3e":"0DB"===a.sharedWithId.substr(0,3)?'\x3cdiv class\x3d"stopSharingWithCompany"\x3e'+LC.getLabel("ChatterFileSharing","stopSharingMsg",escapeHTML(unescape(a.fileTitle)),LC.getLabel("ChatterFileSharing","yourCommunityLabel"))+'\x3c/div\x3e\x3cdiv class\x3d"stopSharingWithCompanyDescription"\x3e'+LC.getLabel("ChatterFileSharing","stopSharingWithCommunity")+"\x3c/div\x3e":LC.getLabel("ChatterFileSharing","stopSharingMsg","\x3cb\x3e"+
escapeHTML(unescape(a.fileTitle))+"\x3c/b\x3e","\x3cb\x3e"+escapeHTML(a.sharedWithName)+"\x3c/b\x3e")):a.isChatterFile?(b=LC.getLabel("ChatterFileSharing","makePrivate"),d=LC.getLabel("ChatterFileSharing","makePrivateMsgForChatterFile")):(b=LC.getLabel("ChatterFileSharing","restrictAccess"),d=LC.getLabel("ChatterFileSharing","makePrivateMsgForContentFile"));this.setTitle(b);this.isModal=!1;var c=[];c.push('\x3cdiv class\x3d"makePrivateMsgPanel"\x3e');a.sharedWithId?c.push('\x3cdiv class\x3d"stopSharingMsg"\x3e'+
d+"\x3c/div\x3e"):a.isChatterFile?(c.push('\x3cdiv class\x3d"makePrivateMsgIcon"\x3e\x3c/div\x3e'),c.push('\x3cdiv class\x3d"makePrivateMsgForChatterFile"\x3e'+d+"\x3c/div\x3e")):c.push('\x3cdiv class\x3d"makePrivateMsgForContentFile"\x3e'+d+"\x3c/div\x3e");c.push("\x3c/div\x3e");this.contents=c.join("");c=[];c.push('\x3cinput type\x3d"button" value\x3d"');a.sharedWithId?c.push(LC.getLabel("ChatterFileSharing","stopSharing")):c.push(b);c.push('" class\x3d"'+ZenCss.btn+'"');c.push(' onclick\x3d"Sfdc.MakeFilePrivateConfirmDialog.execute(');
c.push("{isChatterFile: ");c.push(a.isChatterFile?"true":"false");c.push(", docId: \x26quot;");c.push(a.docId);a.sharedWithId&&(c.push("\x26quot;, sharedWithId: \x26quot;"),c.push(a.sharedWithId));a.shareId&&(c.push("\x26quot;, shareId: \x26quot;"),c.push(a.shareId));c.push("\x26quot;}");c.push(');"/\x3e');c.push('\x3cinput type\x3d"button" value\x3d"');c.push(LC.getLabel("Buttons","cancel"));c.push('" class\x3d"'+ZenCss.btn+'" onclick\x3d"Sfdc.MakeFilePrivateConfirmDialog.closeDialog();"/\x3e');
this.buttonContents=c.join("")};Sfdc.MakeFilePrivateConfirmDialog.closeDialog=function(){OverlayDialogElement.getDialog(Sfdc.MakeFilePrivateConfirmDialog.ID).cancel()};
Sfdc.MakeFilePrivateConfirmDialog.execute=function(a){var b=chatter.getToolbox(),d="/"+Sfdc.AccessibleFileSharedWithListDialog.getEntityTypeForId(a.docId)+"/sharedwithwizard/"+a.docId+";delete",c=!1;a.sharedWithId&&(d+="?eid\x3d"+a.sharedWithId,c=!0);a.shareId&&(d=d+(c?"\x26":"?")+"shareId\x3d"+a.shareId);b.post({url:d,failure:function(a,b){b&&!b.errormessage&&alert(LC.getLabel("Feeds","GenericFailureNoGack"));Sfdc.MakeFilePrivateConfirmDialog.closeDialog()},success:function(b,c){try{var d=Sfdc.AccessibleFileSharedWithListDialog.isFileDetailPage();
if(c.url)if(d)navigateToUrl(c.url,null,Desktop.CLOSETAB_ACTION);else{var h=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID);h.refreshMainPage=!0;Sfdc.MakeFilePrivateConfirmDialog.closeDialog();Sfdc.BaseAccessibleFileListDialog.closeDialog("chatterFileSharedWithListDialog")}else(h=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID))&&h.updateContent(c),h.syncUpMainPage=!0,Sfdc.MakeFilePrivateConfirmDialog.closeDialog();var k=
Sfdc.AccessibleFileSharedWithListDialog.getSharedWithListDomElem().rows.length;Sfdc.AccessibleFileSharedWithListDialog.updateTitle(a.docId,2>k)}catch(l){}}})};Sfdc.ns("Sfdc.ChangeSharingTypeConfirmDialog");Sfdc.ChangeSharingTypeConfirmDialog=function(a){Sfdc.FileCollaborationConfirmDialog.call(this,a);this.isChatterFile=a.isChatterFile};Ext.extend(Sfdc.ChangeSharingTypeConfirmDialog,Sfdc.FileCollaborationConfirmDialog);Sfdc.ChangeSharingTypeConfirmDialog.ID="changeSharingTypeConfirmDialog";
Sfdc.ChangeSharingTypeConfirmDialog.dialogExists=function(){return document.getElementById(Sfdc.ChangeSharingTypeConfirmDialog.ID)?!0:!1};Sfdc.ChangeSharingTypeConfirmDialog.showDialog=function(a){var b=null;Sfdc.ChangeSharingTypeConfirmDialog.dialogExists()?b=OverlayDialogElement.getDialog(Sfdc.ChangeSharingTypeConfirmDialog.ID):(a.id=Sfdc.ChangeSharingTypeConfirmDialog.ID,b=new Sfdc.ChangeSharingTypeConfirmDialog(a),b.register());b.syncUpMainPage=a.syncUpMainPage;b.showDialog(a)};
Sfdc.ChangeSharingTypeConfirmDialog.prototype.makeContent=function(a){var b=LC.getLabel("ChatterFileSharing","changePermission"),d;d=a.sharedWithId.match(Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX_MATCH)==Sfdc.AccessibleFileSharedWithListDialog.GROUP_ENTITY_PREFIX?LC.getLabel("ChatterFileSharing","changeGroupPermissionAlert"):LC.getLabel("ChatterFileSharing","changePeoplePermissionAlert");this.setTitle(b);this.isModal=!1;var c=[];c.push('\x3cdiv class\x3d"changePermissionMsgPanel"\x3e');
c.push('\x3cdiv class\x3d"changePermissionMsg"\x3e'+d+"\x3c/div\x3e");c.push("\x3c/div\x3e");this.contents=c.join("");c=[];c.push('\x3cinput type\x3d"button" value\x3d"');c.push(b);c.push('" class\x3d"'+ZenCss.btn+'"');c.push(' onclick\x3d"Sfdc.ChangeSharingTypeConfirmDialog.execute(');c.push("{docId: \x26quot;");c.push(a.docId);c.push("\x26quot;, sharedWithId: \x26quot;");c.push(a.sharedWithId);c.push("\x26quot;, type: \x26quot;");c.push(a.type);c.push("\x26quot;, label: \x26quot;");c.push(a.label);
c.push("\x26quot;}");c.push(');"/\x3e');c.push('\x3cinput type\x3d"button" value\x3d"');c.push(LC.getLabel("Buttons","cancel"));c.push('" class\x3d"'+ZenCss.btn+'" onclick\x3d"Sfdc.ChangeSharingTypeConfirmDialog.closeDialog();"/\x3e');this.buttonContents=c.join("")};Sfdc.ChangeSharingTypeConfirmDialog.closeDialog=function(){OverlayDialogElement.getDialog(Sfdc.ChangeSharingTypeConfirmDialog.ID).cancel()};
Sfdc.ChangeSharingTypeConfirmDialog.execute=function(a){Sfdc.AccessibleFileSharedWithListDialog.postSharingTypeChange(a,Sfdc.ChangeSharingTypeConfirmDialog.closeDialog)};
Sfdc.ns("Sfdc.MultiFileUploaderBase");
Sfdc.MultiFileUploaderBase=function(b){this.config={uploadActionUrl:"",statsActionUrl:"",params:{},uploadBtnAnchor:null,maxFileSize:0,progressBarWidth:150,overallProgressBarWidth:250,onStartCallback:function(a,b){},onProgressCallback:function(a,b,d,e){},onCompleteCallback:function(a,b,d){},onCancelCallback:function(a,b){},onErrorCallback:function(a,b,d){},errMsg:{leavePage:LC.getLabel("ChatterFileMultiUpload","leavingUploadWarningMsg")}};Sfdc.MultiFileUploaderUtil.extend(this.config,b);this.totalNumberOfFilesSelected=
this.completedSize=this.selectedSize=this.filesInProgress=this.filesCompleted=this.filesSelected=0;this.uploadHandler=this.createUploadHandler();this.config.uploadBtnAnchor&&(this.uploadButton=this.hookupUploadButton(this.config.uploadBtnAnchor));this.uploadToFolderId=this.config.fldr;this.preventLeaveInProgress()};
Sfdc.MultiFileUploaderBase.prototype={uploadFiles:function(b){if(b){for(var a=0;a<b.length;a++)this.scheduleFileUpload(b[a]);this.afterAllFileUploadsScheduled()}},onStartHandler:function(b,a){this.filesInProgress++;this.filesSelected++;a&&(this.selectedSize+=a.size)},onProgressHandler:function(b,a,c,d){},onCompleteHandler:function(b,a,c){this.filesInProgress--;this.filesCompleted++;a&&(this.completedSize+=a.size)},onCancelHandler:function(b,a){this.filesInProgress--;this.filesSelected--;a&&(this.selectedSize-=
a.size)},onErrorHandler:function(b,a,c){},afterAllFileUploadsScheduled:function(){},scheduleFileUpload:function(b){this.totalNumberOfFilesSelected++;var a=this.uploadHandler.addToUploadList(b);!1!==this.config.onStartCallback(a,b)&&this.onStartHandler(a,b)&&(Sfdc.MultiFileUploaderUtil.checkFileSyncOption(),this.uploadHandler.scheduleUpload(a,{fileSync:Sfdc.ChatterFileUploader.isFileSync,filterParentId:this.filterParentId,fldr:this.uploadToFolderId,params:this.config.params}))},hookupUploadButton:function(b){var a=
this;return new Sfdc.UploadButton({uploadBtnAnchor:b,onChange:function(b){a.uploadFiles(b.files)}})},createUploadHandler:function(){var b=this;return new Sfdc.ChatterFileUploadHandler({uploadActionUrl:this.config.uploadActionUrl,uploader:this,onProgressCallback:function(a,c,d,e){b.onProgressHandler(a,c,d,e);b.config.onProgressCallback(a,c,d,e)},onCompleteCallback:function(a,c,d){b.onCompleteHandler(a,c,d);b.config.onCompleteCallback(a,c,d)},onCancelCallback:function(a,c){b.onCancelHandler(a,c);b.config.onCancelCallback(a,
c)},onErrorCallback:function(a,c,d){b.onErrorHandler(a,c,d);b.config.onErrorCallback(a,c,d)},customHandlers:this.config.customHandlers})},preventLeaveInProgress:function(){var b=this,a=this.config.errMsg.leavePage;Sfdc.on(window,"beforeunload",function(c){if(b.filesSelected!==b.filesCompleted)return c=c||window.event,c.returnValue=a})}};
Sfdc.ns("Sfdc.SWFUploadButton");Sfdc.SWFUploadButton=function(a){this.swfUrlPrefix=a.swfUrlPrefix;this.uploadDlgConfig=a.uploadDlgConfig;Sfdc.UploadButton.apply(this,arguments)};Sfdc.MultiFileUploaderUtil.extend(Sfdc.SWFUploadButton.prototype,Sfdc.UploadButton.prototype);Sfdc.SWFUploadButton.SWF_BUTTON_ID="multiFileUploaderSwfBtn";Sfdc.SWFUploadButton.SUPPORTED_FLASH_VERSION=11;
Sfdc.MultiFileUploaderUtil.extend(Sfdc.SWFUploadButton.prototype,{createInputBtn:function(){Sfdc.get("uploadFileButtonLink").innerHTML=LC.getLabel("ChatterFilesTabPage","uploadMultiFilesLinkText");var a=this.swfUrlPrefix+"/flex/MultiFileUploader.swf",b=Sfdc.MultiFileUploaderUtil.createElementFromHTML('\x3cdiv class\x3d"swfbtn-panel"\x3e\x3cdiv id\x3d"'+Sfdc.SWFUploadButton.SWF_BUTTON_ID+'"\x3e\x26nbsp;\x3c/div\x3e\x3c/div\x3e');this.uploadBtnAnchor.appendChild(b);swfobject.embedSWF(a,Sfdc.SWFUploadButton.SWF_BUTTON_ID,
"100%","100%",Sfdc.SWFUploadButton.SUPPORTED_FLASH_VERSION.toString(),"",{},{codebase:"http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab",src:a,quality:"high",play:"true",loop:"false",pluginspage:"http://www.adobe.com/go/getflashplayer",name:Sfdc.SWFUploadButton.SWF_BUTTON_ID,allowScriptAccess:"sameDomain",movie:a,type:"application/x-shockwave-flash",wmode:"transparent"});return b}});
Sfdc.ns("Sfdc.SingleUploadButton");Sfdc.SingleUploadButton=function(a){Sfdc.UploadButton.apply(this,arguments)};Sfdc.MultiFileUploaderUtil.extend(Sfdc.SingleUploadButton.prototype,Sfdc.UploadButton.prototype);
Sfdc.MultiFileUploaderUtil.extend(Sfdc.SingleUploadButton.prototype,{createInputBtn:function(){var a=this.createHiddenInputBtn();addEvent(a,"mouseover",function(){var b=a.parentNode.firstChild;b&&Sfdc.Dom.addClass(b,"ahover")});addEvent(a,"mouseout",function(){var b=a.parentNode.firstChild;b&&Sfdc.Dom.removeClass(b,"ahover")});return a}});
Sfdc.ns("Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList");
Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList=function(a){this.fileUploadListContainerId=a.fileUploadListContainerId;this.fileUploadListContainerElem=document.getElementById(this.fileUploadListContainerId);this.fileUploadListContainerElem.innerHTML=Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.HTML_TEMPLATE;this.fileUploadListElem=a.fileUploadListElem||Sfdc.get("multifile-upload-list",this.fileUploadListContainerElem);this.cancelFileUploadCallback=a.cancelFileUploadCallback;this.idToFileUploadBadge=
{};this.setupCancelAction()};Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.HTML_TEMPLATE='\x3cul id\x3d"multifile-upload-list" class\x3d"multifile-upload-list"\x3e\x3c/ul\x3e';Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.prototype.setupCancelAction=function(){var a=this;addEvent(this.fileUploadListElem,"click",function(b){b=b||window.event;var c=b.target||b.srcElement;Sfdc.Dom.hasClass(c,"deleteIconClass")&&(a.preventDefault(b),a.cancelFileUploadCallback(c.parentNode.parentNode))})};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.prototype.preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.prototype.add=function(a){this.idToFileUploadBadge[a.dom.mfuFileId]=a;this.fileUploadListElem.appendChild(a.dom);a=Ext.fly(this.fileUploadListContainerId);var b=a.parent(".overlayDialog ").dom,c=b.id,b=b.offsetTop+b.offsetHeight,d=Sfdc.Window.getWindowHeight();b>d&&(b-=d,d=a.getHeight(),d>b&&a.setHeight(d-b),a.setStyle("overflow-y","auto"),c&&(a=sfdcPage.getDialogById(c))&&a.position())};
Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList.prototype.get=function(a){return this.idToFileUploadBadge[a]};
Sfdc.ns("Sfdc.CreateCanvasPublisherHandler");
Sfdc.CreateCanvasPublisherHandler=function(){this.registerFeedItemTypeHandler=function(e){chatter.getPublisher().registerFeedItemTypeHandler("CanvasPost",function(){return{config:{},setupPanel:function(){Sfdc.canvas.parent.publish({name:"publisher.setupPanel",payload:{},target:{canvas:e}})},clearPanelState:function(){Sfdc.canvas.parent.publish({name:"publisher.clearPanelState",payload:{},target:{canvas:e}})},onShowPanel:function(){var a=this.publisherCore;Sfdc.canvas.parent.publish({name:"publisher.showPanel",
payload:{},target:{canvas:e}});Sfdc.canvas.parent.subscribe({name:"publisher.setValidForSubmit",onData:function(c){a.setIsExtensionValidForSubmit(c)}});a.setIsExtensionValidForSubmit(!1)},onSuccess:function(){Sfdc.canvas.parent.publish({name:"publisher.success",payload:{},target:{canvas:e}})},onFailure:function(a,c){var d=this.publisherCore;"undefined"!==typeof d&&"undefined"!==typeof d.setIsExtensionValidForSubmit&&d.setIsExtensionValidForSubmit(!1);Sfdc.canvas.parent.publish({name:"publisher.failure",
payload:c,target:{canvas:e}})},getPayload:function(a,c){var d=this.publisherCore,f=d.getRawBody();a.text=d.isPromptText(f)?"":f;Sfdc.canvas.parent.publish({name:"publisher.getPayload",payload:a,target:{canvas:e}});Sfdc.canvas.parent.subscribe({name:"publisher.setPayload",onData:function(b){a.feedItemType=b.feedItemType;"CanvasPost"===b.feedItemType?(a.auxText=b.auxText,a.namespacePrefix=b.namespace,a.developerName=b.developerName,a.title=b.title,a.height=b.height,a.parameters=chatter.getToolbox().htmlEncode(b.parameters),
a.description=b.description,a.thumbnailUrl=b.thumbnailUrl):(Sfdc.isEmpty(b.auxText)||(a.text=a.text+"\n\n"+b.auxText),"LinkPost"===b.feedItemType&&(a.url=b.url,a.urlName=b.urlName));c(a)}});return{isValid:!0,isAsync:!0,errorPayload:{}}},validatePayload:function(a){var c=!0,d={validFeedItemType:!0};"TextPost"!==a.feedItemType&&("LinkPost"!==a.feedItemType&&"CanvasPost"!==a.feedItemType)&&(d.validFeedItemType=!1,d.feedItemType=a.feedItemType,c=!1);return{isValid:c,errorPayload:d}},onValidationFailure:function(a){var c=
this.publisherCore;a.validFeedItemType||(a={errors:{message:LC.getLabel("CanvasPublisher","invalidFeedItemType",a.feedItemType)}},Sfdc.canvas.parent.publish({name:"publisher.failure",payload:a,target:{canvas:e}}));c.enablePublisher()}}}(),{handlerId:e})}};var createCanvasPublisherHandler=new Sfdc.CreateCanvasPublisherHandler;
Sfdc.ns("Sfdc.AccessibleFilePublicLinksDialog");Sfdc.AccessibleFilePublicLinksDialog=function(a){Sfdc.BaseAccessibleFileListDialog.call(this,a);this.id=a.id;this.title=unescape(a.title);this.docId=a.docId;this.fileTitle=a.fileTitle;this.versionId=a.versionId;this.height=a.height;this.width=525};Sfdc.AccessibleFilePublicLinksDialog.prototype=new Sfdc.BaseAccessibleFileListDialog({});Sfdc.AccessibleFilePublicLinksDialog.ID="chatterFilePublicLinkDialog";
Sfdc.AccessibleFilePublicLinksDialog.DATA_LOAD_URL="/file/publiclinks/";
Sfdc.AccessibleFilePublicLinksDialog.showDialog=function(a,b,c,d){c=Sfdc.AccessibleFileSharedWithListDialog.getFileTitle(c);var e=Sfdc.isDefAndNotNull(c)?LC.getLabel("ChatterFilePublicLink","createPublicLinkWithFileTitle",c):LC.getLabel("ChatterFilePublicLink","createPublicLink");d&&(e=LC.getLabel("ChatterFileSharing","shareInScope",e,d));Perf.mark(OverlayDialog.LOAD_MARK);chatter.getEventBus().addEventListener("chatter:files","onAfterPublicLinkDialogOpen",Sfdc.AccessibleFilePublicLinksDialog.highLightLink);
sfdcPage.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID)&&Sfdc.Dom.hideByDisplay(Sfdc.get(Sfdc.AccessibleFileSharedWithListDialog.ID));var f=Sfdc.AccessibleFilePublicLinksDialog.ID;d=sfdcPage.getDialogById(f);a={id:f,title:chatter.getToolbox().htmlEncode(e),docId:a,versionId:b,fileTitle:c};d||(d=new Sfdc.AccessibleFilePublicLinksDialog(a),d.register());d.open(a)};
Sfdc.AccessibleFilePublicLinksDialog.highLightLink=function(){setTimeout(function(){var a=Sfdc.get("overrideInput");a&&(a.focus(),a.select())},100)};
Sfdc.AccessibleFilePublicLinksDialog.hideShowLinkDetail=function(){var a=Sfdc.get("linkSettingDetailDiv"),b=Sfdc.get("linkSettingHeader_icon");Sfdc.Dom.isVisible(a)?(Sfdc.Dom.addClass(a,"hidden"),Sfdc.Dom.removeClass(b,"publicLinkSetupImageExpand"),Sfdc.Dom.addClass(b,"publicLinkSetupImageCollapse")):(Sfdc.Dom.removeClass(a,"hidden"),Sfdc.Dom.removeClass(b,"publicLinkSetupImageCollapse"),Sfdc.Dom.addClass(b,"publicLinkSetupImageExpand"))};Sfdc.AccessibleFilePublicLinksDialog.needRefresh=!1;
Sfdc.AccessibleFilePublicLinksDialog.copyLinkForIE=function(){var a=Sfdc.get("overrideInput").value;window.clipboardData.setData("text",a)};
Sfdc.AccessibleFilePublicLinksDialog.prototype.clickShareBtn=function(a){this.hide();Sfdc.AccessibleFileSharedWithListDialog.showSharedWithList(this.fileTitle,this.docId);Sfdc.AccessibleFileSharedWithListDialog.updateTitle(this.docId,!1);var b=Sfdc.BaseAccessibleFileDialog.getDialogById(Sfdc.AccessibleFileSharedWithListDialog.ID);a||(Sfdc.AccessibleFilePublicLinksDialog.needRefresh=!0);b&&Sfdc.AccessibleFilePublicLinksDialog.needRefresh&&(b.syncUpMainPage=!0)};
Sfdc.AccessibleFilePublicLinksDialog.prototype.open=function(a){var b=Sfdc.AccessibleFilePublicLinksDialog.DATA_LOAD_URL+a.docId,c=this;Sfdc.apply(this,a,!0);chatter.getToolbox().post({url:b,params:{versionId:c.versionId},success:function(a,e){c.updateContent(e);c.hasExistingLink="true"===e.hasExistingLink?!0:!1;c.callback&&c.callback(b)}})};Sfdc.AccessibleFilePublicLinksDialog.prototype.cancel=function(){this.clickShareBtn(this.hasExistingLink)};
Sfdc.AccessibleFilePublicLinksDialog.prototype.show=function(){Sfdc.BaseAccessibleFileDialog.prototype.show.call(this);chatter.getEventBus().fireEvent("chatter:files","onAfterPublicLinkDialogOpen")};
window.Perf&&Perf.enabled&&Perf.mark("MultiFileUploader:Start");Sfdc.ns("Sfdc.ChatterFileUploader");
Sfdc.ChatterFileUploader=function(a){Sfdc.MultiFileUploaderBase.apply(this,arguments);Sfdc.MultiFileUploaderUtil.extend(this.config,{progressBarWidth:200,overallProgressBarWidth:330,fileUploadListContainerId:null,fileUploadListElem:null});Sfdc.MultiFileUploaderUtil.extend(this.config,a);this.ui=Sfdc.MultiFileUploaderUi;this.overallProgressBar=new Sfdc.MultiFileUploaderUiComponents.ProgressBar(Sfdc.get("overallProgress"),this.config.overallProgressBarWidth);var c=this,b=this.uploadHandler;this.fileUploadBadgeList=
new Sfdc.MultiFileUploaderUiComponents.FileUploadBadgeList({fileUploadListContainerId:this.config.fileUploadListContainerId,fileUploadListElem:this.config.fileUploadListElem,cancelFileUploadCallback:function(a){if(Sfdc.MultiFileUploaderUtil.isIE9AndBelow()){Sfdc.ChatterFileSWFUploader.cancelCurrentUpload(a.mfuFileId);var d=Sfdc.ChatterFileSWFUploader.getFileObj(a.mfuFileId);c.onCancelHandler(a.mfuFileId,d);c.config.onCancelCallback(a.mfuFileId,d)}else b.cancelCurrentUpload(a.mfuFileId),b.uploadNextIfNoneInProgress()}});
this.filterParentId=this.config.filterParentId;this.uploadedDocId=null;var d=this.config.fileInput?1:2,e=Sfdc.ChatterFileUploader.getOriginOfMultiUpload(this.filterParentId);this.usageStats=new Sfdc.MultiFileUploaderUsageStats({filterParentId:this.config.filterParentId,origin:e,uploadMethod:d,statsActionUrl:this.config.statsActionUrl})};Sfdc.MultiFileUploaderUtil.extend(Sfdc.ChatterFileUploader.prototype,Sfdc.MultiFileUploaderBase.prototype);
Sfdc.MultiFileUploaderUtil.extend(Sfdc.ChatterFileUploader.prototype,{setUploadedDocId:function(a){a&&(this.uploadedDocId=a)},afterUploadFinished:function(){var a=this.filesCompleted,c=this.filesSelected;a<c?this.ui.updateUploadingStatusInfoWithInProgressMessage(a,c):this.afterAllUploadsFinished()},afterAllUploadsFinished:function(){var a=this.filesSelected;0<this.filesCompleted?this.ui.updateUploadingStatusInfoWithSuccessMessage(a):this.ui.updateUploadingStatusInfoWithAllCanceledMessage(this.totalNumberOfFilesSelected);
this.ui.hideOverallProgressBar();this.ui.hideCancelRemainingUploadsButton();this.ui.showCloseButton();this.shouldShowSharingSettingsButton()?this.ui.showSharingSettingsBtn(Sfdc.AccessibleUploadFileDialog.getBaseUrl(),this.uploadedDocId):this.ui.hideSharingSettingBtn();this.usageStats.sendUsageStats(this.filesSelected)},shouldShowSharingSettingsButton:function(){if(this.isSingleFileMode&&this.uploadedDocId){var a=Sfdc.ChatterFileUploader.getOriginOfMultiUpload(this.config.filterParentId);if(a!=Sfdc.ChatterFileUploader.GROUP_PAGE&&
a!=Sfdc.ChatterFileUploader.PROFILE_PAGE)return!0}return!1},constructFileUploadBadge:function(a,c){var b=new Sfdc.MultiFileUploaderUiComponents.FileUploadBadge(a,c,this.config.maxFileSize,this.config.progressBarWidth,this.isSingleFileMode);this.fileUploadBadgeList.add(b);return b},onStartHandler:function(a,c){var b=new Sfdc.MultiFileUploaderFile(c);this.usageStats.start(b);b=this.constructFileUploadBadge(a,b);if(b.fileDoesNotMeetLimits)return!1;Sfdc.MultiFileUploaderBase.prototype.onStartHandler.apply(this,
arguments);b.dom.isAbort=!1;return!0},onProgressHandler:function(a,c,b,d){Sfdc.MultiFileUploaderBase.prototype.onProgressHandler.apply(this,arguments);var e=this.fileUploadBadgeList.get(a),h=e.dom;if(!h||!(h.isAbort&&!0===h.isAbort)){e.updateProgressBar(b/d);if(b!=d){var l=Math.round(100*(b/d));100>l?e.updateFileProgressPercentage(l):(Sfdc.get(".multifile-upload-status",h).innerHTML=LC.getLabel("ChatterFileMultiUpload","processing"),Sfdc.Dom.addClass(Sfdc.get(".multifile-upload-cancel",h),"hidden"))}this.filesCompleted<
this.filesSelected&&this.ui.updateUploadingStatusInfoWithInProgressMessage(this.filesCompleted,this.filesSelected);this.overallProgressBar.update((b+this.completedSize)/this.selectedSize)}},onCancelHandler:function(a,c){Sfdc.MultiFileUploaderBase.prototype.onCancelHandler.apply(this,arguments);this.fileUploadBadgeList.get(a).displayAsCanceled();this.afterUploadFinished()},onErrorHandler:function(a,c,b){a=Sfdc.MultiUploadErrorHandlingDialog.open(b);Sfdc.ChatterFileUploader.dragAndDropZone.errorDialog=
a;Sfdc.ChatterFileUploader.dragAndDropZone.isEntered=!1;Sfdc.AccessibleMultiUploadFilesDialog.isOpened()&&Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!1)},onCompleteHandler:function(a,c,b){var d=new Sfdc.MultiFileUploaderFile(c);this.usageStats.finish(d);Sfdc.MultiFileUploaderBase.prototype.onCompleteHandler.apply(this,arguments);this.fileUploadBadgeList.get(a).displayAsCompleted(b);this.setUploadedDocId(b.docid);this.afterUploadFinished()},cancelRemainingUploads:function(){Sfdc.MultiFileUploaderUtil.isIE9AndBelow()?
Sfdc.ChatterFileSWFUploader.cancelRemainingUploads():this.uploadHandler.cancelRemainingUploads()},afterAllFileUploadsScheduled:function(){(this.isSingleFileMode=1===this.totalNumberOfFilesSelected)?(this.ui.hideOverallProgressBar(),this.ui.hideListTableHeader(),this.ui.showSingleFileModeUploadList()):(this.ui.showOverallProgressBar(),this.ui.showListTableHeader(),this.ui.hideSharingSettingBtn());0<this.filesInProgress?(this.ui.hideCloseButton(),this.ui.showCancelRemainingUploadsButton()):this.afterAllUploadsFinished()}});
Sfdc.ChatterFileUploader.GROUP_ENTITY_PREFIX="0F9";Sfdc.ChatterFileUploader.PROFILE_ENTITY_PREFIX="005";Sfdc.ChatterFileUploader.ORG_ENTITY_PREFIX="00D";Sfdc.ChatterFileUploader.GROUP_PAGE="GROUP_PAGE";Sfdc.ChatterFileUploader.PROFILE_PAGE="PROFILE_PAGE";Sfdc.ChatterFileUploader.CHATTER_FILE_PAGE="CHATTER_PAGE";Sfdc.ChatterFileUploader.FILE_TAB_PAGE="FILE_TAB_PAGE";Sfdc.ChatterFileUploader.PUBLISHER="PUBLISHER";Sfdc.ChatterFileUploader.maxFileSize=0;Sfdc.ChatterFileUploader.maxFileSizeLabel="";
Sfdc.ChatterFileUploader.ACTION_URL="/chatterfile/";Sfdc.ChatterFileUploader.createInstance=function(a,c){var b=a.fileInput,d={fileUploadListContainerId:"multiUploadListPanel",fileInput:b,maxFileSize:Sfdc.ChatterFileUploader.maxFileSize,filterParentId:c,uploadActionUrl:Sfdc.MultiFileUploaderUtil.getActionUrl()+Sfdc.ChatterFileUploader.ACTION_URL,statsActionUrl:Sfdc.ChatterFileUploader.ACTION_URL};Sfdc.MultiFileUploaderUtil.extend(d,a);d=new Sfdc.ChatterFileUploader(d);b&&d.uploadFiles(b.files);return d};
Sfdc.ChatterFileUploader.dragAndDropZone=null;
Sfdc.ChatterFileUploader.setupPageDragDropZone=function(a){Sfdc.ChatterFileUploader.setupDropZoneSavedConfig=a;if(!Sfdc.ChatterFileUploader.dragAndDropZone){var c=new Sfdc.UploadFileDragDropZone({onEnterCallback:function(){c.isEntered=!0;c.createDragAndDropOverlay();if(Sfdc.AccessibleMultiUploadFilesDialog.isOpened())Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!0);else{var a=Sfdc.ChatterFileUploader.setupDropZoneSavedConfig;a.fileInput=null;a.displayDDTargetIcon=!0;Sfdc.AccessibleMultiUploadFilesDialog.open(a)}},
onDropCallback:function(a){c.isEntered=!1;c.destroyDragAndDropOverlay();a=Sfdc.MultiFileUploaderUtil.processDirectoriesInFileList(a.dataTransfer);var d=Sfdc.AccessibleMultiUploadFilesDialog.uploader;0<a.length&&d?(Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!1),d.uploadFiles(a)):Sfdc.AccessibleMultiUploadFilesDialog.closeIt(!0)},onLeaveCallback:function(){c.isEntered=!1;c.destroyDragAndDropOverlay();var a=Sfdc.AccessibleMultiUploadFilesDialog.uploader;a&&0===a.filesCompleted+
a.filesInProgress?Sfdc.AccessibleMultiUploadFilesDialog.closeIt():Sfdc.AccessibleMultiUploadFilesDialog.displayDragAndDropTargetIcon(!1)}});Sfdc.ChatterFileUploader.dragAndDropZone=c}};
Sfdc.ChatterFileUploader.getOriginOfMultiUpload=function(a){return a&&a.substr(0,3)===Sfdc.ChatterFileUploader.GROUP_ENTITY_PREFIX&&0<window.location.href.indexOf("GroupFileListPage")?Sfdc.ChatterFileUploader.GROUP_PAGE:a&&a.substr(0,3)===Sfdc.ChatterFileUploader.PROFILE_ENTITY_PREFIX&&0<window.location.href.indexOf("UserFileListPage")?Sfdc.ChatterFileUploader.PROFILE_PAGE:0<window.location.href.indexOf("ChatterPage")?Sfdc.ChatterFileUploader.CHATTER_FILE_PAGE:Sfdc.ChatterFileUploader.FILE_TAB_PAGE};
Sfdc.ChatterFileUploader.isMultiFileUpload=!1;Sfdc.ChatterFileUploader.isIEMultiFileUpload=!1;Sfdc.ChatterFileUploader.isFileSync=!1;Sfdc.ChatterFileUploader.createAndAttachUploadButton=function(a,c){new Sfdc.UploadButton({uploadBtnAnchor:a,onChange:function(a){c.fileInput=a;c.displayDDTargetIcon=!1;Sfdc.AccessibleMultiUploadFilesDialog.open(c)}})};Sfdc.ChatterFileUploader.hideUploadFileButtonLink=function(){Sfdc.Dom.hideByDisplay("uploadFileButtonLink")};
Sfdc.ChatterFileUploader.addDragDropZoneButtonStyle=function(a){Sfdc.Dom.addClass(a,"dragDropZoneButton")};Sfdc.ChatterFileUploader.addDragDropZoneDashedBorder=function(a){Sfdc.Dom.addClass(a,"dragDropZoneDiv")};
Sfdc.ChatterFileUploader.addIndicatorTextStringNonIE=function(a){var c=document.createElement("div");c.setAttribute("class","multifile-upload-draganddrop-indicactor");var b=document.createElement("span");b.appendChild(document.createTextNode(LC.getLabel("ChatterFileMultiUpload","dragAndDropIndicatorNoIE")));c.appendChild(b);a.appendChild(c)};Sfdc.ChatterFileUploader.adjustParentStyling=function(a){(a=Sfdc.Dom.getParent(a))&&Sfdc.Dom.addClass(a,"multiUploadControl")};
Sfdc.ChatterFileUploader.hookupInputForMultiFileUpload=function(a){var c=a.btnDivId,b=a.enableMultiFileUploading,d=a.enableMultiFileUploadingForIE,e=a.filterParentId,h=a.parentEntityName,l=a.maxFileSize,p=a.maxFileSizeLabel,q=a.swfUrlPrefix,f=a.multiUploadHelpUrl;a=a.fldr;var g=Sfdc.ChatterFileUploader.getOriginOfMultiUpload(e),k={fileInput:null,displayDDTargetIcon:!1,filterParentId:e,parentEntityName:h,uploaderOrigin:g};a&&(k.fldr=a);Sfdc.ChatterFileUploader.maxFileSize=l;Sfdc.ChatterFileUploader.maxFileSizeLabel=
p.replace(/&nbsp;/gi," ");var e=document.getElementById("fileUploaderDiv"),m=document.getElementById(c);if(m)if(c=Ext.isWindows&&Sfdc.userAgent.isSafari,b&&Sfdc.MultiFileUploaderUtil.isMultiFileUploadSupported()&&!c)Sfdc.ChatterFileUploader.isMultiFileUpload=!0,Sfdc.ChatterFileUploader.hideUploadFileButtonLink(),Sfdc.ChatterFileUploader.createAndAttachUploadButton(m,k),Sfdc.ChatterFileUploader.setupPageDragDropZone(k),Sfdc.ChatterFileUploader.addDragDropZoneButtonStyle(m),Sfdc.ChatterFileUploader.addDragDropZoneDashedBorder(e),
Sfdc.ChatterFileUploader.addIndicatorTextStringNonIE(e),Sfdc.ChatterFileUploader.adjustParentStyling(e);else if(c=swfobject.getFlashPlayerVersion().major,b&&d&&Sfdc.userAgent.isIE&&c>=Sfdc.SWFUploadButton.SUPPORTED_FLASH_VERSION)Sfdc.ChatterFileUploader.isMultiFileUpload=!0,Sfdc.ChatterFileUploader.isIEMultiFileUpload=!0,Sfdc.AccessibleMultiUploadFilesDialog.loadForm(k,function(){Sfdc.ChatterFileSWFUploader.setSwfUploadButton(new Sfdc.SWFUploadButton({uploadBtnAnchor:m,swfUrlPrefix:q,uploadDlgConfig:k,
openUploadDialog:function(){k.fileInput=null;k.displayDDTargetIcon=!1;Sfdc.AccessibleMultiUploadFilesDialog.open(k)}}))}),Sfdc.Dom.addClass(e,"dragDropZoneDivNoBorder"),Sfdc.ChatterFileUploader.addDragDropZoneButtonStyle(m),b=document.createElement("div"),Sfdc.Dom.addClass(b,"multifile-upload-draganddrop-indicactor"),d=document.createElement("span"),Sfdc.Dom.addClass(d,"multifile-upload-draganddrop-indicactor-tip"),d.appendChild(document.createTextNode(LC.getLabel("ChatterFileMultiUpload","tip"))),
b.appendChild(d),d=document.createElement("span"),d.appendChild(document.createTextNode(LC.getLabel("ChatterFileMultiUpload","dragAndDropIndicatorIE"))),b.appendChild(d),d=document.createElement("a"),Sfdc.Dom.addClass(d,"multifile-upload-draganddrop-indicactor-help"),d.setAttribute("href",f),d.appendChild(document.createTextNode(LC.getLabel("ChatterFileMultiUpload","learnMoreLinkText"))),b.appendChild(d),e.appendChild(b),Sfdc.ChatterFileUploader.adjustParentStyling(e);else{Sfdc.userAgent.isChrome&&
(f=Sfdc.get(".uploadArrow",Sfdc.get("fileUploadBtnDiv")),Sfdc.Dom.addClass(f,"uploadArrowWithMorePadding"));var n={title:LC.getLabel("ChatterFilesTabPage","uploadFileDialogTitle")};a&&(n.fldr=a);addEvent(m,"click",function(){Sfdc.AccessibleUploadFileDialog.open(n)})}Sfdc.ChatterFileUploader.config=k;Sfdc.Dom.show(e)};
Sfdc.ChatterFileUploader.hookupInputForSingleFileUpload=function(a,c,b){Sfdc.ChatterFileUploader.maxFileSize=c;Sfdc.ChatterFileUploader.maxFileSizeLabel=b.replace(/&nbsp;/gi," ");if((a=document.getElementById(a))&&Sfdc.MultiFileUploaderUtil.isFileAPISupported()&&(Sfdc.userAgent.isSafari||Sfdc.userAgent.isChromium))Sfdc.ChatterFileUploader.isMultiFileUpload=!1,new Sfdc.SingleUploadButton({uploadBtnAnchor:a,onChange:function(a){chatter.getPublisher().getHandler("ContentPost").fileNewInfoUpdate(a)}})};
Sfdc.ChatterFileUploader.setVisible=function(a){var c=document.getElementById("fileUploaderDiv");c&&(!1===a?Sfdc.Dom.hideByDisplay(c):Sfdc.Dom.show(c))};Sfdc.ns("Sfdc.ChatterFileSWFUploader");
Sfdc.ChatterFileSWFUploader=function(){var a=null,c=null,b={},d=0,e=null,h=null,l=function(){c.each(function(a){a=c.get(a);var b=a.index;b>=d&&(Sfdc.ChatterFileSWFUploader.cancelCurrentUpload(parseInt(b,10),!0),e.onCancelHandler(parseInt(b,10),a),e.config.onCancelCallback(parseInt(b,10),a))});e.afterAllUploadsFinished()};return{setSwfUploadButton:function(c){a=c},startSelectFileCallback:function(){a.config.openUploadDialog();c=new Map;e=Sfdc.AccessibleMultiUploadFilesDialog.uploader;e.totalNumberOfFilesSelected=
0;e.filesCompleted=0;e.filesSelected=0;var b=Sfdc.SWFUploadButton.SWF_BUTTON_ID;h=Sfdc.userAgent.isIE?document.getElementById(b):document[b]},selectFileCallback:function(a,d,f,g){f={index:a,name:d,size:f,type:g};c.put(d,f);b[a]=f;e.totalNumberOfFilesSelected++;e.onStartHandler(a,f);Sfdc.userAgent.isIE7&&Sfdc.Dom.hideByDisplay(Sfdc.get("multiUploadCancelRemainingBtn"));e.afterAllFileUploadsScheduled()},uploadProgressCallback:function(a,b,d){a=c.get(a);e.onProgressHandler(a.index,a,b,d);e.config.onProgressCallback(a.index,
a,b,d)},uploadCompleteCallback:function(a){},uploadCompleteDataCallback:function(a,b){var f=c.get(a);d=f.index;var g=Sfdc.MultiFileUploaderUtil.parseResponseResult(b);if("Failure"===g.message)return g.html=g.html&&chatter.getFileUploader().getBase64Decoder().decode(g.html),Sfdc.MultiUploadErrorHandlingDialog.open(g.html),"true"===g.ignoreIt?(Sfdc.ChatterFileSWFUploader.cancelCurrentUpload(parseInt(d,10)),e.onCancelHandler(parseInt(d,10),f),e.config.onCancelCallback(parseInt(d,10),f)):l(),g.ignoreIt;
e.onCompleteHandler(f.index,f,g);e.config.onCompleteCallback(f.index,f,g);e.setUploadedDocId(g.docid);0===e.filesSelected?e.overallProgressBar.update(0):e.afterUploadFinished();d++;return"true"},ioErrorCallback:function(a){},getRequestToken:function(){return chatter.getToolbox().token()},getActionRequestUrl:function(){return Sfdc.MultiFileUploaderUtil.getActionUrl()+Sfdc.ChatterFileUploader.ACTION_URL},getFilterParentId:function(){return e.filterParentId},getFolderId:function(){return e.config.fldr},
getIsFileSync:function(){Sfdc.MultiFileUploaderUtil.checkFileSyncOption();return Sfdc.ChatterFileUploader.isFileSync?"true":"false"},cancelCurrentUpload:function(a,b){!0!==b&&(b=!1);h.cancelUpload(a,b)},cancelRemainingUploads:function(){l()},getFileObj:function(a){return b[a]}}}();window.Perf&&Perf.enabled&&Perf.endMark("MultiFileUploader:Start");

//# sourceMappingURL=/javascript/1428053752000/sfdc/source/Chatter.js.map
