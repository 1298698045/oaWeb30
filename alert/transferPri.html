<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <link rel="stylesheet" href="/css/themes/lightning/alerts.css" />
    <link rel="stylesheet" href="/css/themes/lightning/iconfont.css" />
    <link href="/element/element.css" rel="stylesheet" />
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        .el-input {
            float: left;
            width: 100%;
            margin-top: 5px;
        }

        .shift-name-title {
            float: left;
            margin-top: 5px;
        }

        .modal-body {
            font-size: 12px;
            color: #606266;
        }

        #photo .uiModal--medium .modal-container {
            width: 70%;
        }

        .title-text {
            color: rgb(196, 196, 196);
        }

        .number-title {
            margin-left: 60px;
        }

        .ant-radio-group-time {
            float: left;
            margin-left: 15px;
            margin-right: 40px;
        }

        .ant-radio-group-set-number {
            float: left;
            margin-top: 5px;
        }

        .ant-radio-group-set {
            margin-top: 10px;
        }

        .ant-radio-group-time > span {
            float: left;
            margin-top: 5px;
        }

        .ant-radio-group-time .el-input {
            margin-left: 5px;
            width: 100px;
        }

        .el-time-panel {
            z-index: 10000 !important;
        }

        .ant-radio-group-set {
            height: 30px;
        }

        .rest {
            float: left;
            margin-top: 5px;
        }

        .el-input--prefix .el-input__inner {
            padding-left: 22px;
            padding-right: 20px;
        }

        .el-input__prefix {
            left: 0px;
        }

        .el-input__suffix {
            right: 0px;
        }

        .el-input-number {
            top: 10px;
        }

            .el-input-number:hover .el-input-number__decrease {
                display: block;
            }

            .el-input-number:hover .el-input-number__increase {
                display: block;
            }

        .el-input-number__decrease {
            height: 13px;
            line-height: 13px;
            width: 20px;
            bottom: 1px;
            top: auto;
            left: auto;
            right: 1px;
            border: 0;
            border-left: 1px solid #C0C4CC;
            border-top: 1px solid #C0C4CC;
            border-radius: 0;
            display: none;
        }

        .el-input-number__increase {
            height: 12px;
            line-height: 12px;
            width: 20px;
            top: 1px;
            left: auto;
            right: 1px;
            border: 0;
            border-left: 1px solid #C0C4CC;
            border-radius: 0;
            display: none;
        }

        .el-input-number .el-input {
            width: 50px;
            margin-left: 0;
        }

            .el-input-number .el-input input {
                width: 50px;
                padding: 0;
                text-align: left;
                text-indent: 5px;
            }

        .el-input-number {
            width: 50px;
        }

        .class-manage-section-interval .title-text {
            margin-top: 13px;
        }

        .class-manage-section-interval {
            margin-top: 10px;
        }

        .late {
            margin-top: 10px;
            float: left;
            width: 50%;
            height: 30px;
            margin-top: 10px;
        }

            .late .el-input-number {
                margin-left: 10px;
            }

            .late .el-input-number, .late .el-input input {
                width: 70px;
            }

        .timesizechecked {
            margin-top: 10px;
        }

        .timesizechecked-tr {
            height: 40px;
            line-height: 40px;
        }

        .table-coloer {
            background-color: #f6f6f6;
            padding-left: 30px;
        }

        .timesizechecked-tr .ant-radio-group-time .el-input {
            margin-top: 6px;
        }

        .timesizechecked-tr .ant-radio-group-set-number {
            margin: 0;
        }

        .timesizechecked-tr .ant-radio-group-time > span {
            margin: 0;
        }

        .timesizechecked-tr .ant-radio-group-time > span {
            float: left;
        }

        .size-time {
            float: left;
            margin-left: 60px;
            height: 40px;
        }

            .size-time .ant-radio-group-time {
                margin: 0;
            }

            .size-time .el-input {
                margin-left: 0;
            }

            .size-time .ant-radio-group-time > span {
                margin-left: 5px;
                margin-right: 5px;
            }

        .shift-head .el-input {
            margin-right: 10px;
        }

        .shift-head .el-select, .shift-head .el-input {
            float: right;
        }

        .shift-body-foot .el-select, .shift-body-foot .el-input {
            float: right;
        }

        .shift-body-foot .el-input {
            margin-right: 15px;
        }

        .shift-item {
            width: 235px;
            margin-top: 10px;
        }

        .shift-body-main {
            width: 100%;
            padding: 0rem 3rem;
            box-sizing: border-box;
        }

        .modal-body {
            padding: 0;
            padding-bottom: 20px;
        }

        .shift-body-titme {
            height: 30px;
            background-color: rgb(243, 242, 242);
            line-height: 30px;
            border-radius: 4px;
            padding-left: 15px;
            margin: 2rem 2rem 0.5rem 2rem;
        }

        .late4 + div {
            float: left;
            width: 100%;
        }

        .clear {
            clear: both;
        }

        .shift-item .el-checkbox {
            margin-top: 5px;
        }

        .shift-item-cheekbox {
            float: left;
            margin-top: 20px;
        }

            .shift-item-cheekbox .el-checkbox {
                margin-right: 5px;
            }

        .el-popper {
            z-index: 10000 !important;
        }

        #photo .el-select__input:focus {
            outline: none;
            border: 0;
            box-shadow: none;
        }

        .required {
            margin-top: 3px;
        }

        .item-left {
            float: left;
            width: 48%;
        }

        .item-right {
            float: right;
            width: 48%;
        }

        .shift-item {
            width: 100%;
        }

        .el-select {
            width: 100%;
        }

        .el-date-editor.el-input {
            margin-top: 5px;
            width: 100%;
        }

        .el-textarea {
            margin-bottom: 20px;
        }

        .el-message {
            z-index: 9999 !important;
        }

        .tableinput {
            width: 50%;
        }

        .tableinput {
            margin: 2px 0;
        }

            .tableinput input {
                height: 32px;
                line-height: 32px;
            }

        .el-table__row td {
            padding: 5px 0;
        }

        .line-out {
            height: 3px;
            border-radius: 4px;
            width: 60%;
            background-color: #747e96;
            position: relative;
        }

        .line-in {
            height: 3px;
            border-radius: 7px;
            width: 0%;
            background: rgb(21, 137, 238);
        }

        .line-item {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #333;
            text-align: left;
        }

        .stepitem {
            flex: 1;
        }

        .step-skin {
            width: 15px;
            height: 15px;
            background-color: white;
            border-radius: 50%;
            margin-top: -10px;
        }

        .stepline {
            position: absolute;
            margin-top: 8px;
            width: 100%;
        }

        .step-skin.active {
            border-color: #0070d2;
        }

        .step-skin.finish {
            background: url('/img/cal/23.check_1(14x14).png') no-repeat center;
            background-size: 12px;
            background-color: white;
        }

        .step-skin {
            border: 1px solid #747e96;
        }

        .stepend {
            position: absolute;
            right: 0;
            text-align: right;
            top: 3px;
            color: #333;
            font-size: 12px;
            line-height: 30px;
        }

            .stepend .step-skin {
                position: absolute;
                right: 0;
            }

        .entitydetail {
            float: right;
            color: #108def;
            cursor: pointer;
        }

        #changeDiv {
            width: 100%;
            height: 100%;
            position: fixed;
            top: 0px;
            left: 0px;
            z-index: 9999;
            display: none;
        }

        #iframe {
            width: 100%;
            height: 100% !important;
            position: fixed;
            top: 0;
            left: 0;
        }

        .item-left {
            position: relative;
        }

        .lookresultbtn {
            font-size: 14px;
        }

        .lookresultbtn {
            top: 36px;
        }
        body #iframe{
            width: 100% !important;
            left: 0% !important;
            top: 0% !important;
            border:0;
        }
    </style>
</head>
<body>
    <div id="photo" class="photo1">
        <div class="DESKTOP uiContainerManager" id="vueapp">
            <div class="DESKTOP uiModal--medium uiModal forceModal open active" style="z-index: 1;">
                <div class="modal-glass slds-backdrop fadein slds-backdrop--open" style="opacity: 1;"></div>
                <div class="panel slds-modal slds-fade-in-open">
                    <div class="modal-container slds-modal__container">
                        <div class="modal-header slds-modal__header">
                            <h2 class="title slds-text-heading--medium">选择被转移人</h2>
                            <button class="slds-button slds-modal__close closeIcon slds-button_icon-bare slds-button_icon-inverse" type="button" title="关闭此窗口" id="closeds">
                                <span>
                                    <span style="font-size: 34px;">×</span>
                                </span>
                                <span class="slds-assistive-text">关闭此窗口</span>
                            </button>
                        </div>
                        <div class="modal-body scrollable slds-modal__content slds-p-around--medium">
                                <div class="shift-body-titme"><span>基本信息</span></div>
                                <div class="shift-body-main">
                                    <div class="shift-item">
                                        <div class="item-left">
                                            <span class="required">*</span>
                                            <span class="shift-name-title">姓名</span>
                                            <el-select class='save-checking-input'
                                                       v-model="list.EmployeeId.Id"
                                                       filterable
                                                       remote
                                                       @change="peoplechange"
                                                       @visible-change="getlookup('30020','EmployeeId')"
                                                       :remote-method="function(query){searchlookup(query,'30020','EmployeeId')}"
                                                       placeholder="请选择">
                                                <el-option v-for="item in search.EmployeeId"
                                                           :key="item.ID"
                                                           :label="item.Name"
                                                           :value="item.ID">
                                                </el-option>
                                            </el-select>
                                            <div @click="openslookup('EmployeeId',30020)" class="lookresultbtn">
                                                <i class="el-icon-search"></i>
                                            </div>
                                            <!--<div v-show="list.EmployeeId.Id" class="entitydetail" @click="showentity(list.EmployeeId.Id,'30020','人员详情')">人员详情</div>-->
                                        </div>
                                        <div class="item-right">
                                            <span class="shift-name-title">隶属部门</span>
                                            <el-select 
                                                       v-model="list.DeptId.Id"
                                                       filterable
                                                       remote
                                                       @visible-change="getlookup('10','DeptId')"
                                                       :remote-method="function(query){searchlookup(query,'10','DeptId')}"
                                                       placeholder="">
                                                <el-option v-for="item in search.DeptId"
                                                           :key="item.ID"
                                                           :label="item.Name"
                                                           :value="item.ID">
                                                </el-option>
                                            </el-select>

                                        </div>
                                        <div class="clear"></div>
                                    </div>
                                  
                                </div>
                            
                        </div>
                        <div class="modal-footer slds-modal__footer">
                            <div data-aura-rendered-by="9549:0" class="forceModalActionContainer--footerAction forceModalActionContainer">
                                <button class="slds-button slds-button--neutral uiButton forceActionButton" type="button" title="取消" id="closedsa">
                                    <span class="label bBody">取消</span>
                                </button>
                                <button id="Save2" class="slds-button slds-button--neutral uiButton--default uiButton--brand uiButton forceActionButton" title="附加文件 （新窗口）" type="button">
                                    <span class="label bBody">保存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
    </script>
    <script src="/js/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="/js/CommonUtils.js"></script>
    <script type="text/javascript" src="/element/vue.js"></script>
    <script type="text/javascript" src="/element/element.js"></script>
    <script type="text/javascript" src="/element/vue-resource.js"></script>
    <script>
        var vum = new Vue({
            el: '#vueapp',
            data: {
                disabled:true,
                list: {
                    EmployeeId: {},
                    DeptId: {},
                },
              
                search: {
                    DeptId: [],
                    EmployeeId: [],
                },
                picklistFieldMap:[]
            },
            created: function () {
                //this.getData()
                //this.getselect()
            },
            methods: {
                
                saveData: function () {

                },
               
                getlookup: function (Lktp, name) {
                    var that = this
                    var d = {}
                    d = {
                        Lktp: Lktp
                    }
                    ajaxMethodGetData('ui.entity.lookup', d, callback)
                    function callback(data) {
                        that.search[name] = data.listData
                        var id = getQueryString('id')
                        if (id != null) {
                            var ID = that.list[name].Id
                            var Name = that.list[name].Name
                            var newlist = {
                                ID: ID,
                                Name: Name
                            }
                            if (ID) {
                                if (JSON.stringify(that.search[name]).indexOf(JSON.stringify(newlist.ID)) == -1) {
                                    that.search[name].push(newlist)
                                }
                            }
                        }
                    }
                },
                openslookup: function (name, objtypecode) {
                    $('#changeDiv').show()
                    if (objtypecode == 30020) {
                        $('#iframe').attr('src', '/_ui/common/data/UserLookResult.html?name=' + name)
                    } else if (objtypecode == 10) {
                        $('#iframe').attr('src', '/_ui/common/data/deptchose_form.html?name=' + name)
                    } else if (objtypecode == 8) {
                        $('#iframe').attr('src', '/_ui/common/data/UserLookResult.html?name=' + name)
                    } else {
                        $('#iframe').attr('src', '/alert/lookupiframe.html?name=' + name + '&objtypecode=' + objtypecode)
                    }
                },
                searchlookup: function (query, Lktp, name) {
                    var that = this
                    var d = {}
                    d = {
                        Lktp: Lktp,
                        Lksrch: query
                    }
                    ajaxMethodGetData('ui.entity.lookup', d, callback)
                    function callback(data) {
                        that.search[name] = data.listData
                    }
                },
                peoplechange: function (val) {
                    var that = this
                    var d = {
                        id: val,
                        ObjTypeCode:30020
                    }
                    ajaxMethodGetData('entity.detail.get', d, function (data) {
                        that.list.DeptId.Id = data.record.DeptId.Id
                        that.search.DeptId = [{
                            ID: data.record.DeptId.Id,
                            Name: data.record.DeptId.Name
                        }]
                    })

                },
                showentity: function (id, objectTypeCode, name) {
                    $('#changeDiv').show()
                    $('#iframe').attr('src', '/alert/entitydetail.html?id=' + id + '&objectTypeCode=' + objectTypeCode + '&name=' + name)
                }
            }
        })
    </script>
    <script src="/js/alert.js"></script>
    <script>
        function error3(type) {
            $("body").append('<div class="success red red3" style="left: 45%;width: auto; z-index:9999;"><span class="success_icon" style="background: #C23934;border: 1px solid #fff;"><i class="iconfont icon-cuohao" style="top: -7px;position: relative;left: 2px;font-size: 20px;"></i></span><div class="toastContent slds-notify__content" style="flex: 1;"><div class="slds-align-middle slds-hyphenate" style="font-size: 16px;"><span class="toastMessage slds-text-heading--small forceActionsText"></span></div></div></div>')
            if (type) {
                $(".toastMessage").html(type)
            }
            setTimeout(function () {
                $(".success").remove()
                parent.$('#changeDiv').hide()
            }, 3000)
        }
        $('#Save2').click(function () {
            function callback(data) {
                if (data.code == 1) {
                    parent.success('权限转移成功')
                    parent.$('#changeDiv').hide()
                } else {
                    error3(data.msg)
                }
            }
            var d = vum.list
            var id = getQueryString('id')
            ajaxMethodPostData('attendance.employee.change&EmployeeId=' + d.EmployeeId.Id, null, callback)
        })
    </script>
    <div id="changeDiv">
        <iframe id="iframe"></iframe>
    </div>
</body>
</html>
