<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html style="">
<head>
    <script src="/static/js/perf/stub.js"></script>
    <title>选择人员</title>
    <meta http-equiv="PRAGMA" content="NO-CACHE" />
    <style>
        .hasMotif {
            margin: 0;
        }

        * {
            margin: 0;
            padding: 0;
        }

        body, html {
            color: #333;
            height: 100%;
        }

        .clear {
            clear: both;
        }

        .head {
            background-color: #f2f2f2;
            height: 50px;
            line-height: 50px;
            border-bottom: 1px solid #dedede;
            position: absolute;
            width: 100%;
        }

            .head img {
                float: left;
                width: 30px;
                margin: 0 20px;
                margin-top: 10px;
            }

        .nav-item {
            float: left;
            height: 50px;
            line-height: 50px;
            padding: 0 20px;
            cursor: pointer;
        }

            .nav-item.active {
                color: #2db7f5;
                border-bottom: 3px solid #2db7f5;
            }

        .body-nav {
            float: left;
        }

        .body-search {
            float: right;
            margin-top: 10px;
        }

        .left {
            float: left;
        }

        .search-btn {
            border: 1px solid #dedede;
            padding: 0px 20px;
            height: 30px;
            line-height: 30px;
            cursor: pointer;
        }

        .search-input {
            height: 30px;
            border: 1px solid #dedede;
            border-right: 1px;
        }

            .search-input input {
                border: 0;
                outline: none;
                height: 28px;
                width: 100%;
            }

        .body-top {
            border-bottom: 1px solid #dedede;
            padding-right: 15px;
        }

        .main-item img {
            width: 40px;
            height: 40px;
        }

        .right {
            float: right;
        }

        .main-item {
            border-bottom: 1px solid #dedede;
            padding: 10px 20px;
        }

        .item-mi {
            margin-left: 20px;
        }

        .item-right img {
            display: none;
        }

        .main-item.active img {
            display: block;
        }

        .main-item.active {
            background-color: #f2f2f2;
        }

        .main-item:hover {
            background-color: #f2f2f2;
            cursor: pointer;
        }
        #changyongzutree{
            display:none;
        }
        .foot {
            border-top: 1px solid #dedede;
            position: absolute;
            bottom: 0px;
            width: 100%;
            padding-top: 20px;
            padding-bottom: 20px;
            z-index: 2;
            background-color: white;
        }

        .foot > div {
            float: right;
        }
        
        .foot > div > div {
            border: 1px solid #dedede;
            border-radius: 4px;
            float: left;
            margin-right: 15px;
            padding: 5px 15px;
            cursor: pointer;
        }

        .foot > div > div:hover {
            background-color: #f2f2f2;
        }
        
        .shur {
            background-color: #0094ff;
            color: white;
        }

        .shur:hover {
            background-color: #20699c !important;
        }

        .body {
            float: left;
            width: 100%;
            padding-top: 51px;
            box-sizing: border-box;
            height: 100%;
            padding-bottom: 74px;
        }

        .body-right {
            float: left;
            width: 20%;
            border-left: 1px solid #dedede;
            box-sizing: border-box;
            padding:5px 5px 60px 5px;
            height: 100%;
            overflow-y:auto;
        }

        .body-right img {
            width: 14px;
            float: right;
            margin-top: 3px;
            margin-right: 8px;
            cursor: pointer;
        }

        .checked-item {
            border: 1px solid #dedede;
            border-radius: 4px;
            padding: 5px 0;
            padding-left: 10px;
            margin-top: 10px;
        }

            .checked-item:hover {
                background-color: #f2f2f2;
            }

        .main-item-group,.main-item-role {
            border-bottom: 1px solid #dedede;
            padding: 5px 0;
            cursor: pointer;
        }

            .main-item-group:hover,.main-item-role:hover {
                background-color: #f2f2f2;
            }

        .body-main {
            overflow-y: auto;
            height: 100%;
            box-sizing: border-box;
            padding-bottom: 53px;
            float:left;
            width:100%;
        }

        .panel-header {
            border-top: 0 !important;
        }

        #treePanel {
            border-bottom: 0 !important;
        }

        .panel.panel-htop {
            float: left;
        }

        .zuzhijiegou-people, .changyongzu-people ,.juese-people{
            float: left;
            box-sizing: border-box;
            height: 100%;
            overflow-y: auto;
        }

        #zuzhijiegou, #changyongzu,#juese {
            height: 100%;
            width: 100%;
        }

        #changyongzutree,#juesetree {
            border-right: 1px solid #dedede;
            float: left;
            overflow: auto;
            height: 100%;
            box-sizing: border-box;
        }

        .main-item .name {
            color: blue;
        }

        #new {
            height: 100%;
        }

        .hightsearch-head {
            padding: 20px;
            border-bottom: 1px solid #dedede;
        }

            .hightsearch-head > div {
                padding: 0 20px;
                height: 50px;
                line-height: 50px;
            }

            .hightsearch-head select {
                position: relative \9;
                top: 10px \9;
            }

        .search-btn.active {
            background-color: #0094ff;
            color: white;
        }

        .search-name {
            display: inline-block;
            width: 60px;
        }

        .hightsearch-head .search-input {
            border-right: 1px solid #dedede;
            width: 300px;
        }

        .hightsearch-head > div > div {
            padding: 0 20px;
        }

        .hightsearch-footbtn {
            border-bottom: 1px solid #dedede;
            height: 65px;
            padding: 15px 0;
            box-sizing: border-box;
        }

            .hightsearch-footbtn > div {
                width: 300px;
                margin: 0 auto;
                height: 50px;
            }

        .hightsearch-footbtn > div div {
            border: 1px solid #dedede;
            border-radius: 4px;
            float: left;
            margin-right: 15px;
            padding: 5px 15px;
            cursor: pointer;
        }

            .hightsearch-footbtn > div div:hover {
                background-color: #f2f2f2;
            }

            .hightsearch-footbtn .hightsearch-shur {
                background-color: #0094ff;
                color: white;
            }

                .hightsearch-footbtn .hightsearch-shur:hover {
                    background-color: #20699c;
                }

        .hightsearch-people {
            overflow: auto;
        }

        .hightsearch {
            display: none;
        }

        .main-item-group.active,.main-item-role.active {
            background-color: #f2f2f2;
        }

        .main-item-group,.main-item-role {
            padding: 10px 0;
        }

        .maincontent {
            height: 100%;
            
        }

        .easyui-tree li {
            margin-left: 0;
        }
        .allchose {
            height:30px;
            line-height:30px;
            box-sizing:border-box;
            padding:0 15px;
            background-color:#f2f2f2;
            position:absolute;
            width:100%;
            top:0;
        }
        .maincontent {
            position:relative;
        }
        .allchose label{
            margin-right:10px;
        }
        .zuzhijiegou-people,#latestusediv,#tongbumen,#wodexiashu,.changyongzu-people,.juese-people,#searchpeoplediv{
            box-sizing:border-box;
            padding-top:31px;
        }
        #searchpeoplediv {
            overflow-y:auto;
            height:100%;
        }
        .right-people {
            box-sizing:border-box;
            padding-top:0;
        }
        #gridcontent .panel-body-noheader{
            border:0;
        }
        #changyongzu{
            overflow:hidden;
        }
    </style>
</head>
<body>
    <!-- Main Body Starts Here -->
    <div class="head">
        <img src="/img/images/Personal1.png" alt="选择人员" />
        <span>选择人员</span>
    </div>
    <div class="body">
        <div class="body-top">
            <div class="body-nav">
                <div class="nav-item active">全部联系人</div>
                <div class="nav-item">小组</div>
                <div class="clear"></div>
            </div>
            <div class="body-search">
                <div class="search-input left">
                    <input type="search" name="name" value="" />
                </div>
                <div class="search-btn left">搜索</div>
            </div>
            <div class="clear"></div>
        </div>
        <div class="body-main">
            <div class="maincontent">
                <div id="changyongzu" class="main" >
                    <div id="changyongzutree" style="width: 240px; min-height: 0!important;">
                    </div>
                    <div class="changyongzu-people right-people" style="width:100%;">
                        <div id="gridcontent" style="height:100%;width:100%;">
                            <table id="datagrid" style="height:100%;width:100%;"></table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="foot">
        <div>
            <div class="clearchook">清除</div>
            <div class="quite">取消</div>
            <div class="shur">确定</div>
        </div>
    </div>

    <script src="/js/jquery/1.7.1/jquery.min.js"></script>
    <script src="/js/CommonUtils.js"></script>
    <link href="/easyui/themes/bootstrap/easyui.css" rel="stylesheet" />
    <link href="/easyui/themes/icon.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="/easyui/js/treeLoader.js"></script>
    <script type="text/javascript" src="/easyui/js/GridEasy.js"></script>
    <script type="text/javascript" src="/easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="/easyui/locale/easyui-lang-zh_CN.js"></script>
    <script>


        ajaxMethodGetData('contact.group.search', null, function (data) {
            for (var i = 0; i < data.rows.length; i++) {
                $('#changyongzutree').append('<div class=" main-item-group" groupid="' + data.rows[i].contactGroupId + '"><div class="item-mi left"><div class="name">'+data.rows[i].name+'</div></div><div class="clear"></div></div>')
            }
            $('.main-item-group').click(function () {
                $('.main-item-group').not($(this)).removeClass('active')
                $(this).toggleClass('active')
                getdata()
            })
        })















        var columnsArray = []
        var col = { field: "Id", title: "姓名", checkbox: true }
        columnsArray.push(col)
        var col = { field: "FullName", title: "姓名" }
        columnsArray.push(col)
        var col = { field: "MobilePhone", title: "电话" }
        columnsArray.push(col)
        var col = { field: "EmailAddress", title: "邮箱" }
        columnsArray.push(col)
        $('#datagrid').datagrid({
            columns: [columnsArray],
            /*toolbar: [this.toolbar],
            toolbar: this.toolbar,*/
            fitCloumns: true,
            idField: "LIST_RECORD_ID",
            singleSelect: false,
            checkOnSelect: true,
            method: 'POST',
            pagination: true,
            rownumbers: true,
            url: '/apps/CommandProcessor.ashx?c=1&cmd=contact.my.search',
            striped: false,
            // 隔行变色特性
            pageSize: 15,
            pageList: [10, 15, 20, 25, 30, 50, 100],
        });
        function getdata() {
            var data = {}
            var id = $('.main-item-group.active').attr('groupid')
            if (id) {
                data.contactGroupId = id
            }
            $('#datagrid').datagrid('reload', data)
            $('#datagrid').datagrid('clearChecked')

        }
        //头部导航
        $('.nav-item').eq(1).click(function () {
            if ($(this).hasClass('active')) { } else {
                $('.nav-item').removeClass('active')
                $(this).addClass('active')
                $('#changyongzutree').show()
                $('.changyongzu-people.right-people').width($('.changyongzu-people.right-people').width() - 240)
                $('#datagrid').datagrid('resize')
            }
        })
        $('.nav-item').eq(0).click(function () {
            if ($(this).hasClass('active')) { } else {
                $('.nav-item').removeClass('active')
                $(this).addClass('active')
                $('#changyongzutree').hide()
                $('.changyongzu-people.right-people').width($('.changyongzu-people.right-people').width() + 240)
                $('#datagrid').datagrid('resize')
            }
        })

        $('.quite').click(function () {
            window.close();
        })
        $('.shur').click(function () {
            var ids = []
            var names = []
            var rows = $('#datagrid').datagrid('getChecked')
            console.log(rows)
            for (var i = 0; i < rows.length; i++) {
                ids.push(rows[i].Id)
                names.push(rows[i].FullName)
            }
            var lknm = getQueryString('lknm')
            window.opener.invitepeople(ids, names, lknm)
            window.close();
        })

    </script>

</body>
</html>