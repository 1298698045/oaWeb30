<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title></title>
    <link rel="stylesheet" href="/css/themes/lightning/alerts.css" />
    <script src="/js/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="/element/vue.js"></script>
    <script type="text/javascript" src="/element/element.js"></script>
    <link href="/element/element.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/themes/lightning/iconfont.css">
    <style>
        * {
            margin:0;
            padding:0;
        }
        .shift-name-title {
            float:left;
            margin-top:5px;
        }
        .modal-body {
            font-size:12px;
            color:#606266;
        }
        #photo .uiModal--medium .modal-container {
            width: 70%;
        }
        .title-text {
             color: rgb(196, 196, 196)
        }
        .number-title {
            margin-left:60px;
        }
        .ant-radio-group-time {
            float:left;
            margin-left:15px;
            margin-right:40px;
        }
        .ant-radio-group-set-number{
            float:left;
            margin-top:5px;
            
        }
        .ant-radio-group-set {
            margin-top:10px;
        }
        .ant-radio-group-time>span {
            float:left;
            margin-top:5px;
        }
        .ant-radio-group-time .el-input {
            margin-left:5px;
            width:100px;
        }
        .el-time-panel {
            z-index:10000 !important;
        }
        .ant-radio-group-set {
            height:30px;
        }
        .rest {
            float:left;
            margin-top:5px;
        }
        .el-input--prefix .el-input__inner {
            padding-left: 22px;
            padding-right: 20px;
        }
        .el-input__prefix {
            left:0px;
        }
        .el-input__suffix {
            right:0px;
        }
        .el-input-number {
            top:10px;
        }
        .el-input-number:hover .el-input-number__decrease {
            display:block;
        }
        .el-input-number:hover .el-input-number__increase {
            display:block;
        }
        .el-input-number__decrease {
            height:13px;
            line-height:13px;
            width:20px;
            bottom:1px;
            top:auto;
            left:auto;
            right:1px;
            border:0;
            border-left:1px solid #C0C4CC;
            border-top:1px solid #C0C4CC;
            border-radius:0;
            display:none;
        }
        .el-input-number__increase {
            height:12px;
            line-height:12px;
            width:20px;
            top:1px;
            left:auto;
            right:1px;
            border:0;
            border-left:1px solid #C0C4CC;
            border-radius:0;
            display:none;

        }
        .el-input-number .el-input {
            width:50px;
            margin-left:0;
        }
        .el-input-number .el-input input{
            width:50px;
            padding:0;
            text-align:left;
            text-indent:5px;

        }
        .el-input-number {
            width:50px;
        }
        .class-manage-section-interval .title-text {
            margin-top:13px;
        }
        .class-manage-section-interval {
            margin-top:10px;
        }
        .late {
            margin-top:10px;
            float:left;
            width:50%;
            height:30px;
            margin-top:10px;
        }
        .late .el-input-number{
            margin-left:10px;
        }
        .late .el-input-number,.late .el-input input{
            width:70px;
        }
        .timesizechecked {
            margin-top:10px;
        }
        .timesizechecked-tr {
            height:40px;
            line-height:40px;
        }
        .table-coloer {
            background-color:#f6f6f6;
            padding-left:30px;
        }
        .timesizechecked-tr .ant-radio-group-time .el-input {
            margin-top:6px;
        }
        .timesizechecked-tr .ant-radio-group-set-number {
            margin:0;
        }
        .timesizechecked-tr .ant-radio-group-time > span {
            margin:0;
            
        }
        .timesizechecked-tr .ant-radio-group-time > span {
            float:left;
        }
        .size-time {
            float:left;
            margin-left:60px;
            height:40px;
        }
        .size-time .ant-radio-group-time {
            margin:0;
        }
        .size-time .el-input {
            margin-left:0;
        }
        .size-time .ant-radio-group-time > span {
            margin-left:5px;
            margin-right:5px;
        }
        .shift-head .el-input {
            margin-right:10px;
        }
       .shift-head .el-select,.shift-head .el-input{
            float:right;
        }
       .shift-body-foot .el-select,.shift-body-foot .el-input{
            float:right;
        }
       .shift-body-foot .el-input {
            margin-right:15px;
        }
        .shift-item {
            width:235px;
            margin-top:10px;
        }
        .shift-body-main {
            width:100%;
            padding:0rem 3rem;
            box-sizing:border-box;
        }
        .modal-body {
            padding:0;
            padding-bottom:20px;
        }
        .shift-body-titme {
            height:30px;
            background-color: rgb(243, 242, 242);
            line-height:30px;
            border-radius:4px;
            padding-left:15px;
            margin:2rem 2rem 0.5rem 2rem;
        }
        .late4 + div {
            float:left;
            width:100%;
        }
        .clear {
            clear:both;
        }
        .shift-item-cheekbox {
            float:left;
            margin-top:20px;
        }
        .shift-item-cheekbox .el-checkbox{
            margin-right:5px;
        }
        .el-popper {
            z-index:10000 !important;
        }
        #photo .el-select__input:focus{
            outline: none;
            border: 0;
            box-shadow: none;
        }
        .required {
            margin-top:3px;
        }
        .item-left {
            float:left;
            width:48%;
        }
        .item-right {
            float:right;
            width:48%;
        }
        .shift-item {
            width:100%;
        }
        .el-select {
            width:100%;
        }
        .el-date-editor.el-input {
            margin-top:5px;
            width:100%;
        }
        .el-textarea {
            margin-bottom:20px;
        }
        .el-message {
            z-index:9999 !important;
        }
        .el-transfer .el-input {
            width:auto;
        }
        .el-transfer {
            margin-top:10px;
        }
        .el-transfer-panel {
            width:350px;
            margin-left:100px;
        }
        .el-transfer .el-transfer-panel__item {
            display:block;
            box-sizing:border-box;
            border-bottom:1px solid #dedede;
            line-height:34px;
            height:34px;
            margin-right:0;
        }
        .el-transfer .el-transfer-panel__item:first-of-type{
            border-top:1px solid #dedede;
        }
        .sortbtn {
            position:absolute;
            top:110px;
            right:150px;
        }
        .sortbtn span{
            display:block;
            width:14px;
            height:14px;
            transform:rotate(90deg);
        }
        .shift-body-main {
            position:relative;

        }
        .el-transfer__buttons button:first-child {
            margin-top:50px;
        }
        .el-transfer__buttons button:last-child {
            margin-top:-100px;
        }
        .el-transfer-panel:first-child{
            display:none;
        }
        .el-transfer .el-transfer__buttons{
            display:none;
        }
        .el-transfer-panel__header .el-checkbox__input{
            display:none;
        }
    </style>
</head>
<body>
    <div id="photo">
            <div class="DESKTOP uiContainerManager">
                <div class="DESKTOP uiModal--medium uiModal forceModal open active" style="z-index: 1;">
                    <div class="modal-glass slds-backdrop fadein slds-backdrop--open" style="opacity: 1;"></div>
                    <div class="panel slds-modal slds-fade-in-open">
                        <div class="modal-container slds-modal__container">
                            <div class="modal-header slds-modal__header">
                                <h2 class="title slds-text-heading--medium">人员排序</h2>
                                <button class="slds-button slds-modal__close closeIcon slds-button_icon-bare slds-button_icon-inverse" type="button" title="关闭此窗口" id="closeds">
                                    <span>
                                        <span style="font-size: 34px;">×</span>
                                    </span>
                                    <span class="slds-assistive-text">关闭此窗口</span>
                                </button>
                            </div>
                            <div class="modal-body scrollable slds-modal__content slds-p-around--medium" id="vueapp">
                                <div class="shift-body-main">
                                    <div class="shift-item" style="margin-left:30px;">
                                       <el-transfer
                                        @right-check-change="sortchange"
                                        filterable
                                        :filter-method="filterMethod"
                                        filter-placeholder="请输入搜索字符"
                                        v-model="module"
                                        :data="listdata"
                                        :titles="['可用项目','全部人员']">
                                      <div slot-scope="{ option }">{{option.label}}</div>
                                      </el-transfer>
                                    <div class="sortbtn">
                                        <div class="el-transfer__buttons">
                                            <button @click="sortupf" disabled="disabled" id="sortup" type="button" class="el-button el-button--primary is-disabled el-transfer__button"><span><i class="el-icon-arrow-left"></i><!----></span></button>
                                            <button @click="sortdownf" disabled="disabled" id="sortdown" type="button" class="el-button el-button--primary is-disabled el-transfer__button"><!----><!----><span><!----><i class="el-icon-arrow-right"></i></span></button></div>
                                    </div>
                                    <div class="clear"></div>       
                                </div>
                            </div>
                            </div>
                           
                            <div class="modal-footer slds-modal__footer">
                                <div data-aura-rendered-by="9549:0" class="forceModalActionContainer--footerAction forceModalActionContainer">
                                    <button class="slds-button slds-button--neutral uiButton forceActionButton" type="button" title="取消" id="closedsa">
                                        <span class=" label bBody">取消</span>
                                    </button>
                                    <button class="slds-button slds-button--neutral uiButton--default uiButton--brand uiButton forceActionButton" id="Save" name="Save" title="附加文件 （新窗口）" type="button">
                                        <span class=" label bBody">保存排序</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="changeDiv" style="width: 100%; height: 100%; position: fixed; top: 0; left: 0; z-index: 9; display: none;">
        <iframe style="width: 100%; height: 100%; position: absolute; top: 0; left: 0;" id="iframe" src=""></iframe>
    </div>



    <script type="text/javascript" src="/js/CommonUtils.js"></script>
        <script>
            var app = new Vue({
                el: '#vueapp',
                data: {
                    enabled: true,
                    listdata:[],
                    dragging: false,
                    module:[],
                },
                created:function(){
                    
                },
                computed: {
                },
                methods: {
               
                filterMethod: function (query, item) {
                    if (item) {
                        return item.label.indexOf(query) > -1;
                    }
                },
                sortchange: function (arr) {
                    var newarr = []
                    for (var j = 0; j < this.module.length; j++) {
                        for (var i = 0; i < arr.length; i++) {
                            if (arr[i] == this.module[j]) {
                                newarr.push(arr[i])
                                break;
                            }
                        }
                    }
                    if (arr.length > 0) {
                        $('#sortdown').prop('disabled', '')
                        $('#sortdown').removeClass('is-disabled')
                        $('#sortup').prop('disabled', '')
                        $('#sortup').removeClass('is-disabled')
                    } else {
                        $('#sortdown').prop('disabled', 'disabled')
                        $('#sortdown').addClass('is-disabled')
                        $('#sortup').prop('disabled', 'disabled')
                        $('#sortup').addClass('is-disabled')
                    }
                    this.sortitem = newarr[0]
                    this.sortitem2 = newarr[newarr.length - 1]
                },
                sortupf: function () {
                    var number
                    var number2
                    for (var i = 0; i < this.module.length; i++) {
                        if (this.sortitem == this.module[i]) {
                            number = i
                        }
                        if (this.sortitem2 == this.module[i]) {
                            number2 = i
                        }
                    }
                    if (number > 0) {
                        var item = this.module.splice(number, number2 - number + 1)
                        for (var i = 0; i < item.length; i++) {
                            this.module.splice(number - 1 + i, 0, item[i])
                        }
                    }
                },
                sortdownf: function () {
                    var number
                    var number2
                    for (var i = 0; i < this.module.length; i++) {
                        if (this.sortitem == this.module[i]) {
                            number = i
                        }
                        if (this.sortitem2 == this.module[i]) {
                            number2 = i
                        }
                    }
                    var item = this.module.splice(number, number2 - number + 1)
                    for (var i = 0; i < item.length; i++) {
                        this.module.splice(number + 1 + i, 0, item[i])
                    }
                },
            },

            })

            $(document).ready(function(){
                var data = parent.peopledata.rows
                console.log(data)
                for (var i = 0; i < data.length; i++) {
                    console.log(i)
                    app.listdata.push({
                        key: data[i].SystemUserId,
                        label: data[i].Name,
                    })
                }
                
                for (var i = 0; i < data.length; i++) {
                    app.module.push(data[i].SystemUserId)
                }
                //console.log(app.module)
            })


            $('#closeds').click(function () {
                window.parent.document.getElementById("changeDiv").style.display = "none";
            })
            $('#closedsa').click(function () {
                window.parent.document.getElementById("changeDiv").style.display = "none";
            })
            $('#Save').click(function () {

                function callback(data){

                }

                var EmployeeId = app.module.join(',')
                var d = {
                    roleid: getQueryString('roleid'),
                    userids: EmployeeId,
                }
                ajaxMethodPostData("role.member.sort", d, callback)
                window.parent.document.getElementById("changeDiv").style.display = "none";
                // parent.success('排序成功')
                parent.getRoleMember(getQueryString('roleid'))

            })
    </script>

</body>
</html>
